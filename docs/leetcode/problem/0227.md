# [227. Basic Calculator II](https://leetcode.com/problems/basic-calculator-ii/)

ğŸŠ <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ ˆ`](../solution/stack.md) [`æ•°å­¦`](../solution/mathematics.md) [`å­—ç¬¦ä¸²`](../solution/string.md)

### é¢˜ç›®

Given a stringÂ `s`Â which represents an expression,Â *evaluate this expression and return its value*.

The integer division should truncate toward zero.

**Example 1:**

::: tip

Input: s = "3+2\*2"

Output: 7

:::

**Example 2:**

::: tip

Input: s = " 3/2 "

Output: 1

:::

**Example 3:**

::: tip

Input: s = " 3+5 / 2 "

Output: 5

:::

**Constraints:**

- `1 <= s.length <= 3 * 10^5`
- `s`Â consists of integers and operatorsÂ `('+', '-', '*', '/')`Â separated by some number of spaces.
- `s`Â representsÂ **a valid expression**.
- All the integers in the expression are non-negative integers in the rangeÂ `[0, 2^31Â - 1]`.
- The answer isÂ **guaranteed**Â to fit in aÂ **32-bit integer**.

### é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸²è¡¨è¾¾å¼ Â `s`Â ï¼Œè¯·ä½ å®ç°ä¸€ä¸ªåŸºæœ¬è®¡ç®—å™¨æ¥è®¡ç®—å¹¶è¿”å›å®ƒçš„å€¼ã€‚æ•´æ•°é™¤æ³•ä»…ä¿ç•™æ•´æ•°éƒ¨åˆ†ã€‚

### è§£é¢˜æ€è·¯

- è¿™é“é¢˜æ˜¯ [ç¬¬ 224 é¢˜](./0224.md) çš„åŠ å¼ºç‰ˆã€‚ç¬¬ 224 é¢˜ä¸­åªæœ‰åŠ å‡è¿ç®—å’Œæ‹¬å·ï¼Œè¿™ä¸€é¢˜å¢åŠ äº†ä¹˜é™¤è¿ç®—ã€‚ç”±äºä¹˜é™¤è¿ç®—çš„ä¼˜å…ˆçº§é«˜äºåŠ å‡ã€‚æ‰€ä»¥å…ˆè®¡ç®—ä¹˜é™¤è¿ç®—ï¼Œå°†ç®—å‡ºæ¥çš„ç»“æœå†æ›¿æ¢å›åŸæ¥çš„ç®—å¼ä¸­ã€‚æœ€ååªå‰©ä¸‹åŠ å‡è¿ç®—ï¼Œäºæ˜¯é¢˜ç›®é™çº§æˆäº†ç¬¬ 224 é¢˜ã€‚
- æŠŠåŠ å‡è¿ç®—ç¬¦å·åé¢çš„æ•°å­—å‹å…¥æ ˆä¸­ï¼Œé‡åˆ°ä¹˜é™¤è¿ç®—ï¼Œç›´æ¥å°†å®ƒä¸æ ˆé¡¶çš„å…ƒç´ è®¡ç®—ï¼Œå¹¶å°†è®¡ç®—åçš„ç»“æœæ”¾å…¥æ ˆé¡¶ã€‚è‹¥è¯»åˆ°ä¸€ä¸ªè¿ç®—ç¬¦ï¼Œæˆ–è€…éå†åˆ°å­—ç¬¦ä¸²æœ«å°¾ï¼Œå³è®¤ä¸ºæ˜¯éå†åˆ°äº†æ•°å­—æœ«å°¾ã€‚å¤„ç†å®Œè¯¥æ•°å­—åï¼Œæ›´æ–° `preSign` ä¸ºå½“å‰éå†çš„å­—ç¬¦ã€‚éå†å®Œå­—ç¬¦ä¸² `s` åï¼Œå°†æ ˆä¸­å…ƒç´ ç´¯åŠ ï¼Œå³ä¸ºè¯¥å­—ç¬¦ä¸²è¡¨è¾¾å¼çš„å€¼ã€‚æ—¶é—´å¤æ‚åº¦ O(n)ï¼Œç©ºé—´å¤æ‚åº¦ O(n)ã€‚

### ä»£ç 

```go
// TODO: add code
package leetcode

func calculate(s string) int {
	stack, preSign, num, res := []int{}, '+', 0, 0
	for i, ch := range s {
		isDigit := '0' <= ch && ch <= '9'
		if isDigit {
			num = num*10 + int(ch-'0')
		}
		if !isDigit && ch != ' ' || i == len(s)-1 {
			switch preSign {
			case '+':
				stack = append(stack, num)
			case '-':
				stack = append(stack, -num)
			case '*':
				stack[len(stack)-1] *= num
			default:
				stack[len(stack)-1] /= num
			}
			preSign = ch
			num = 0
		}
	}
	for _, v := range stack {
		res += v
	}
	return res
}
```
