# [138. Copy List with Random Pointer](https://leetcode.com/problems/copy-list-with-random-pointer/)

ğŸŠ <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`å“ˆå¸Œè¡¨`](../solution/hash-table.md) [`é“¾è¡¨`](../solution/linked-list.md)

### é¢˜ç›®

A linked list is given such that each node contains an additional random pointer which could point to any node in the list or null.

Return aÂ **[deep copy](https://en.wikipedia.org/wiki/Object_copying#Deep_copy)**Â of the list.

The Linked List is represented in the input/output as a list ofÂ `n`Â nodes. Each node is represented as a pair ofÂ `[val, random_index]`Â where:

- `val`: an integer representingÂ `Node.val`
- `random_index`: the index of the node (range fromÂ `0`Â toÂ `n-1`) where random pointer points to, orÂ `null`Â if it does not point to any node.

**Example 1:**

![](https://assets.leetcode.com/uploads/2019/12/18/e1.png)

::: tip

Input: head = [[7,null],[13,0],[11,4],[10,2],[1,0]]

Output: [[7,null],[13,0],[11,4],[10,2],[1,0]]

:::

**Example 2:**

![](https://assets.leetcode.com/uploads/2019/12/18/e2.png)

::: tip

Input: head = [[1,1],[2,1]]

Output: [[1,1],[2,1]]

:::

**Example 3:**

![](https://assets.leetcode.com/uploads/2019/12/18/e3.png)

::: tip

Input: head = [[3,null],[3,0],[3,null]]

Output: [[3,null],[3,0],[3,null]]

:::

**Example 4:**

::: tip

Input: head = []

Output: []

:::

Explanation: Given linked list is empty (null pointer), so return null.

**Constraints:**

- `10000 <= Node.val <= 10000`
- `Node.random`Â is null or pointing to a node in the linked list.
- The number of nodes will not exceed 1000.

### é¢˜ç›®å¤§æ„

ç»™å®šä¸€ä¸ªé“¾è¡¨ï¼Œæ¯ä¸ªèŠ‚ç‚¹åŒ…å«ä¸€ä¸ªé¢å¤–å¢åŠ çš„éšæœºæŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆå¯ä»¥æŒ‡å‘é“¾è¡¨ä¸­çš„ä»»ä½•èŠ‚ç‚¹æˆ–ç©ºèŠ‚ç‚¹ã€‚è¦æ±‚è¿”å›è¿™ä¸ªé“¾è¡¨çš„æ·±æ‹·è´ã€‚

æˆ‘ä»¬ç”¨ä¸€ä¸ªç”± Â nÂ  ä¸ªèŠ‚ç‚¹ç»„æˆçš„é“¾è¡¨æ¥è¡¨ç¤ºè¾“å…¥/è¾“å‡ºä¸­çš„é“¾è¡¨ã€‚æ¯ä¸ªèŠ‚ç‚¹ç”¨ä¸€ä¸ª Â [val, random_index]Â  è¡¨ç¤ºï¼š

- valï¼šä¸€ä¸ªè¡¨ç¤º Â Node.valÂ  çš„æ•´æ•°ã€‚
- random_indexï¼šéšæœºæŒ‡é’ˆæŒ‡å‘çš„èŠ‚ç‚¹ç´¢å¼•ï¼ˆèŒƒå›´ä» Â 0Â  åˆ° Â n-1ï¼‰ï¼›å¦‚æœä¸æŒ‡å‘ä»»ä½•èŠ‚ç‚¹ï¼Œåˆ™ä¸º Â Â nullÂ ã€‚

### è§£é¢˜æ€è·¯

- è¿™é“é¢˜ä¸¥æ ¼æ„ä¹‰ä¸Šæ˜¯æ•°æ®ç»“æ„é¢˜ï¼Œæ ¹æ®ç»™å®šçš„æ•°æ®ç»“æ„ï¼Œå¯¹å®ƒè¿›è¡Œæ·±æ‹·è´ã€‚
- å…ˆå°†æ¯ä¸ªèŠ‚ç‚¹éƒ½å¤åˆ¶ä¸€ä»½ï¼Œæ”¾åœ¨å®ƒçš„ next èŠ‚ç‚¹ä¸­ã€‚å¦‚æ­¤ç©¿æ’çš„å¤åˆ¶ä¸€ä»½é“¾è¡¨ã€‚

![https://img.halfrost.com/Leetcode/leetcode_138_1_0.png](https://img.halfrost.com/Leetcode/leetcode_138_1_0.png)

- å†å°†ç©¿æ’ç‰ˆçš„é“¾è¡¨çš„ random æŒ‡é’ˆæŒ‡å‘æ­£ç¡®çš„ä½ç½®ã€‚

![https://img.halfrost.com/Leetcode/leetcode_138_2.png](https://img.halfrost.com/Leetcode/leetcode_138_2.png)

- å†å°†ç©¿æ’ç‰ˆçš„é“¾è¡¨çš„ next æŒ‡é’ˆæŒ‡å‘æ­£ç¡®çš„ä½ç½®ã€‚æœ€ååˆ†å¼€è¿™äº¤ç»‡åœ¨ä¸€èµ·çš„ä¸¤ä¸ªé“¾è¡¨çš„å¤´èŠ‚ç‚¹ï¼Œå³å¯åˆ†å¼€ 2 ä¸ªé“¾è¡¨ã€‚

![https://img.halfrost.com/Leetcode/leetcode_138_3.png](https://img.halfrost.com/Leetcode/leetcode_138_3.png)

### ä»£ç 

```go
// TODO: add code
package leetcode

// Node define
type Node struct {
	Val    int
	Next   *Node
	Random *Node
}

func copyRandomList(head *Node) *Node {
	if head == nil {
		return nil
	}
	tempHead := copyNodeToLinkedList(head)
	return splitLinkedList(tempHead)
}

func splitLinkedList(head *Node) *Node {
	cur := head
	head = head.Next
	for cur != nil && cur.Next != nil {
		cur.Next, cur = cur.Next.Next, cur.Next
	}
	return head
}

func copyNodeToLinkedList(head *Node) *Node {
	cur := head
	for cur != nil {
		node := &Node{
			Val:  cur.Val,
			Next: cur.Next,
		}
		cur.Next, cur = node, cur.Next
	}
	cur = head
	for cur != nil {
		if cur.Random != nil {
			cur.Next.Random = cur.Random.Next
		}
		cur = cur.Next.Next
	}
	return head
}
```
