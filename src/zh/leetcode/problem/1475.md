# [1475. Final Prices With a Special Discount in a Shop](https://leetcode.com/problems/final-prices-with-a-special-discount-in-a-shop/)

ðŸŸ¢ <font color=#15bd66>Esay</font>&emsp; ðŸ”–&ensp; [`æ ˆ`](../solution/stack.md) [`æ•°ç»„`](../solution/array.md) [`å•è°ƒæ ˆ`](../solution/monotonic-stack.md)

## é¢˜ç›®

You are given an integer array `prices` where `prices[i]` is the price of the `ith` item in a shop.

There is a special discount for items in the shop. If you buy the `ith` item, then you will receive a discount equivalent to `prices[j]` where `j` is the minimum index such that `j > i` and `prices[j] <= prices[i]`. Otherwise, you will not receive any discount at all.

Return an integer array `answer` where `answer[i]` is the final price you will pay for the `ith` item of the shop, considering the special discount.

**Example 1:**

::: tip

Input: `prices = [8,4,6,2,3]`

Output: `[4,2,4,2,3]`

:::

Explanation:

- For item `0` with `price[0]=8` you will receive a discount equivalent to `prices[1]=4`, therefore, the final price you will pay is `8 - 4 = 4`.
- For item `1` with `price[1]=4` you will receive a discount equivalent to `prices[3]=2`, therefore, the final price you will pay is `4 - 2 = 2`.
- For item `2` with `price[2]=6` you will receive a discount equivalent to `prices[3]=2`, therefore, the final price you will pay is `6 - 2 = 4`.
- For items `3` and `4` you will not receive any discount at all.

**Example 2:**

::: tip

Input: `prices = [1,2,3,4,5]`

Output: `[1,2,3,4,5]`

:::

Explanation: In this case, for all items, you will not receive any discount at all.

**Example 3:**

::: tip

Input: `prices = [10,1,1,6]`

Output: `[9,0,1,6]`

:::

**Constraints:**

- `1 <= prices.length <= 500`
- `1 <= prices[i] <= 1000`

## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªæ•°ç»„ `prices` ï¼Œå…¶ä¸­ `prices[i]` æ˜¯å•†åº—é‡Œç¬¬ `i` ä»¶å•†å“çš„ä»·æ ¼ã€‚

å•†åº—é‡Œæ­£åœ¨è¿›è¡Œä¿ƒé”€æ´»åŠ¨ï¼Œå¦‚æžœä½ è¦ä¹°ç¬¬ i ä»¶å•†å“ï¼Œé‚£ä¹ˆä½ å¯ä»¥å¾—åˆ°ä¸Ž `prices[j] `ç›¸ç­‰çš„æŠ˜æ‰£ï¼Œå…¶ä¸­ `j` æ˜¯æ»¡è¶³ `j > `i ä¸” `prices[j] <= prices[i]` çš„ æœ€å°ä¸‹æ ‡ ï¼Œå¦‚æžœæ²¡æœ‰æ»¡è¶³æ¡ä»¶çš„ `j` ï¼Œä½ å°†æ²¡æœ‰ä»»ä½•æŠ˜æ‰£ã€‚

è¯·ä½ è¿”å›žä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­ç¬¬ `i` ä¸ªå…ƒç´ æ˜¯æŠ˜æ‰£åŽä½ è´­ä¹°å•†å“ `i` æœ€ç»ˆéœ€è¦æ”¯ä»˜çš„ä»·æ ¼ã€‚

## è§£é¢˜æ€è·¯

æœ¬é¢˜ä¸Ž [ç¬¬ 496 é¢˜](./0496.md) æ€è·¯ä¸€æ ·ï¼Œéƒ½å¯ä»¥ä½¿ç”¨å•è°ƒæ ˆã€‚

å€’åºéåŽ† `prices` ï¼Œå¹¶ç”¨å•è°ƒæ ˆä¸­ç»´æŠ¤å½“å‰ä½ç½®å³è¾¹çš„æ›´å°çš„å…ƒç´ åˆ—è¡¨ï¼Œä»Žæ ˆåº•åˆ°æ ˆé¡¶çš„å…ƒç´ æ˜¯å•è°ƒé€’å¢žçš„ã€‚

å½“éåŽ†ç¬¬ `i` ä¸ªå…ƒç´  `prices[i]` æ—¶ï¼š

- å¦‚æžœå½“å‰æ ˆé¡¶çš„å…ƒç´ å¤§äºŽ `prices[i]`ï¼Œåˆ™å°†æ ˆé¡¶å…ƒç´ å‡ºæ ˆï¼Œç›´åˆ°æ ˆé¡¶çš„å…ƒç´ å°äºŽç­‰äºŽ `prices[i]`ï¼Œæ ˆé¡¶çš„å…ƒç´ å³ä¸ºå³è¾¹ç¬¬ä¸€ä¸ªå°äºŽ `prices[i]` çš„å…ƒç´ ï¼›
- å¦‚æžœå½“å‰æ ˆé¡¶çš„å…ƒç´ å°äºŽç­‰äºŽ `prices[i]`ï¼Œæ­¤æ—¶å¯ä»¥çŸ¥é“å½“å‰æ ˆé¡¶å…ƒç´ å³ä¸º `i` çš„å³è¾¹ç¬¬ä¸€ä¸ªå°äºŽç­‰äºŽ `prices[i]` çš„å…ƒç´ ï¼Œæ­¤æ—¶ç¬¬ `i` ä¸ªç‰©å“æŠ˜åŽçš„ä»·æ ¼ä¸º `prices[i]` ä¸Žæ ˆé¡¶çš„å…ƒç´ çš„å·®ã€‚
- å¦‚æžœå½“å‰æ ˆä¸­çš„å…ƒç´ ä¸ºç©ºï¼Œåˆ™æ­¤æ—¶æŠ˜æ‰£ä¸º `0`ï¼Œå•†å“çš„ä»·æ ¼ä¸ºåŽŸä»· `prices[i]`ï¼›
- å°† `prices[i]` åŽ‹å…¥æ ˆä¸­ï¼Œä¿è¯ `prices[i]` ä¸ºå½“å‰æ ˆä¸­çš„æœ€å¤§å€¼ï¼›

## ä»£ç 

```javascript
/**
 * @param {number[]} prices
 * @return {number[]}
 */
var finalPrices = function (prices) {
  let stack = [];
  let res = new Array(prices.length).fill(0);
  for (let i = prices.length - 1; i >= 0; i--) {
    while (stack.length && stack[stack.length - 1] > prices[i]) {
      stack.pop();
    }
    res[i] =
      stack.length === 0 ? prices[i] : prices[i] - stack[stack.length - 1];
    stack.push(prices[i]);
  }
  return res;
};
```
