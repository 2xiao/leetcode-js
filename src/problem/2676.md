---
title: 2676. èŠ‚æµ ğŸ”’
description: LeetCode,2676. èŠ‚æµ ğŸ”’,èŠ‚æµ,Throttle,è§£é¢˜æ€è·¯
keywords:
  - LeetCode
  - 2676. èŠ‚æµ ğŸ”’
  - èŠ‚æµ
  - Throttle
  - è§£é¢˜æ€è·¯
---

# 2676. èŠ‚æµ ğŸ”’

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/throttle) [`LeetCode`](https://leetcode.com/problems/throttle)

## é¢˜ç›®

Given a function `fn` andÂ a time in milliseconds `t`, returnÂ a **throttled** version of that function.

A **throttled** function is first called without delay and then, for a time interval of `t` milliseconds, can't be executed but should store the latest function arguments provided to call `fn` with them after the end of the delay.

For instance, `t = 50ms`, and the function was called at `30ms`, `40ms`, and `60ms`.

At `30ms`, without delay, theÂ **throttled** function `fn` should be called with the arguments, and calling the **throttled** function `fn` should be blocked for the following `t` milliseconds.

At `40ms`, the function should just save arguments.

At `60ms`, arguments should overwrite currently stored arguments from the second call because the second and third calls are made before `80ms`. Once the delay has passed, the **throttled** function `fn` should be called with the latest arguments provided during the delay period, and it should also create another delay period of `80ms + t`.

![Throttle Diagram](https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/2600-2699/2676.Throttle/images/screen-shot-2023-04-08-at-120313-pm.png)

The above diagramÂ shows how throttleÂ will transformÂ events. Each rectangle represents 100ms and the throttleÂ time is 400ms. Each color represents a different set of inputs.

**Example 1:**

> **Input:**
> t = 100,
> calls = [{"t":20,"inputs":[1]}]
>
> **Output:** [{"t":20,"inputs":[1]}]
>
> **Explanation:** The 1st call is always called without delay

**Example 2:**

> **Input:**
> t = 50,
> calls = [
> {"t":50,"inputs":[1]},
> {"t":75,"inputs":[2]}
> ]
>
> **Output:** [{"t":50,"inputs":[1]},{"t":100,"inputs":[2]}]
>
> **Explanation:**
>
> - The 1st is called a function with arguments (1) without delay.
> - The 2nd is called at 75ms, within the delay period because 50ms + 50ms = 100ms, so the next call can be reached at 100ms. Therefore, we save arguments from the 2nd call to use them at the callback of the 1st call.

**Example 3:**

> **Input:**
> t = 70,
> calls = [
> {"t":50,"inputs":[1]},
> {"t":75,"inputs":[2]},
> {"t":90,"inputs":[8]},
> {"t": 140, "inputs":[5,7]},
> {"t": 300, "inputs": [9,4]}
> ]
>
> **Output:** [{"t":50,"inputs":[1]},{"t":120,"inputs":[8]},{"t":190,"inputs":[5,7]},{"t":300,"inputs":[9,4]}]
>
> **Explanation:**
>
> - The 1st is called a function with arguments (1) without delay.
> - The 2nd is called at 75ms within the delay period because 50ms + 70ms = 120ms, so it should only save arguments.
> - The 3rd is also called within the delay period, and because we need just the latest function arguments, we overwrite previous ones. After the delay period, we do a callback at 120ms with saved arguments. That callback makes another delay period of 120ms + 70ms = 190ms so that the next function can be called at 190ms.
> - The 4th is called at 140ms in the delay period, so it should be called as a callback at 190ms. That will create another delay period of 190ms + 70ms = 260ms.
> - The 5th is called at 300ms, but it is after 260ms, so it should be called immediately and should create another delay period of 300ms + 70ms = 370ms.

**Constraints:**

- `0 <= t <= 1000`
- `1 <= calls.length <= 10`
- `0 <= calls[i].t <= 1000`
- `0 <= calls[i].inputs[j], calls[i].inputs.length <= 10`

## é¢˜ç›®å¤§æ„

ç°ç»™å®šä¸€ä¸ªå‡½æ•° `fn` å’Œä¸€ä¸ªä»¥æ¯«ç§’ä¸ºå•ä½çš„æ—¶é—´ `t` ï¼Œè¯·ä½ è¿”å›è¯¥å‡½æ•°çš„ **èŠ‚æµ** ç‰ˆæœ¬ã€‚

**èŠ‚æµ** å‡½æ•°é¦–å…ˆç«‹å³è¢«è°ƒç”¨ï¼Œç„¶ååœ¨ `t` æ¯«ç§’çš„æ—¶é—´é—´éš”å†…ä¸èƒ½å†æ¬¡æ‰§è¡Œï¼Œä½†åº”è¯¥å­˜å‚¨æœ€æ–°çš„å‡½æ•°å‚æ•°ï¼Œä»¥ä¾¿åœ¨å»¶è¿Ÿç»“æŸåä½¿ç”¨è¿™äº›å‚æ•°è°ƒç”¨ `fn` ã€‚

ä¾‹å¦‚ï¼Œ`t = 50ms` ï¼Œå¹¶ä¸”å‡½æ•°åœ¨ `30ms` ã€ `40ms` å’Œ `60ms` æ—¶è¢«è°ƒç”¨ã€‚

åœ¨ `30ms`ï¼ŒèŠ‚æµå‡½æ•° `fn` ä¼šä»¥è¿™äº›å‡½æ•°è°ƒç”¨ï¼Œå¹¶ä¸”å¯¹èŠ‚æµå‡½æ•°`fn` çš„è°ƒç”¨åœ¨æ¥ä¸‹æ¥çš„`t` æ¯«ç§’ä¼šè¢«é˜»å¡ã€‚

åœ¨ `40ms`ï¼Œå‡½æ•°åº”å½“åªæ˜¯å­˜å‚¨å‚æ•°ã€‚

åœ¨ `60ms`ï¼Œå‚æ•°åº”è¯¥è¦†ç›–ç¬¬äºŒæ¬¡è°ƒç”¨ä¸­å½“å‰å­˜å‚¨çš„å‚æ•°ï¼Œå› ä¸ºç¬¬äºŒæ¬¡å’Œç¬¬ä¸‰æ¬¡è°ƒç”¨æ˜¯åœ¨ `80ms` ä¹‹å‰è¿›è¡Œçš„ã€‚å»¶è¿Ÿç»“æŸåï¼Œåº”è¯¥ä½¿ç”¨å»¶è¿ŸæœŸé—´æä¾›çš„æœ€æ–°å‚æ•°æ¥è°ƒç”¨ **èŠ‚æµ** å‡½æ•° `fn`ï¼Œå¹¶ä¸”å®ƒè¿˜åº”è¯¥åˆ›å»ºå¦ä¸€ä¸ª `80ms + t` çš„å»¶è¿Ÿã€‚

## è§£é¢˜æ€è·¯

è¿™ä¸ª `throttle` å‡½æ•°çš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡æ§åˆ¶å‡½æ•°çš„æ‰§è¡Œé¢‘ç‡ï¼Œé˜²æ­¢åœ¨çŸ­æ—¶é—´å†…é¢‘ç¹è°ƒç”¨åŒä¸€ä¸ªå‡½æ•°ã€‚é€šè¿‡è®¾ç½®ä¸€ä¸ªå»¶è¿Ÿæ—¶é—´ `t`ï¼Œå¯ä»¥ç¡®ä¿åœ¨æŸä¸ªæ—¶é—´çª—å£å†…ï¼Œå‡½æ•°åªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚å¦‚æœåœ¨å»¶è¿ŸæœŸé—´å†æ¬¡è°ƒç”¨å‡½æ•°ï¼Œå®ƒä¼šä¿å­˜æœ€æ–°çš„å‚æ•°ï¼Œå¹¶åœ¨å»¶è¿Ÿç»“æŸåä½¿ç”¨è¿™äº›å‚æ•°å†æ¬¡æ‰§è¡Œå‡½æ•°ã€‚

1. **åˆå§‹åŒ–å˜é‡**ï¼š

   - `pending`: ç”¨æ¥æ ‡è¯†å½“å‰æ˜¯å¦æœ‰ä¸€ä¸ªæ­£åœ¨è¿›è¡Œçš„å»¶è¿Ÿè®¡æ—¶ï¼Œå¦‚æœä¸º `true`ï¼Œæ„å‘³ç€å½“å‰å‡½æ•°è°ƒç”¨æ­£åœ¨è¢«èŠ‚æµï¼Œä¸å…è®¸ç«‹å³å†æ¬¡è°ƒç”¨ã€‚
   - `nestArgs`: ç”¨æ¥å­˜å‚¨æœ€æ–°çš„å‡½æ•°å‚æ•°ï¼Œå½“èŠ‚æµæœŸé—´å†æ¬¡è°ƒç”¨å‡½æ•°æ—¶ï¼Œå®ƒä¼šä¿å­˜æœ€æ–°ä¼ é€’çš„å‚æ•°ã€‚

2. **ç«‹å³æ‰§è¡Œ**ï¼š

   - åœ¨æ²¡æœ‰å»¶è¿Ÿçš„æƒ…å†µä¸‹ï¼ˆ`pending` ä¸º `false`ï¼‰ï¼Œç«‹å³è°ƒç”¨ä¼ é€’çš„å‡½æ•° `fn(...args)`ï¼Œå¹¶å°† `pending` è®¾ä¸º `true`ï¼Œè¡¨ç¤ºæ­¤æ—¶å‡½æ•°è¿›å…¥èŠ‚æµçŠ¶æ€ã€‚
   - è®¾ç½®ä¸€ä¸ª `setTimeout`ï¼Œç¡®ä¿åœ¨å»¶è¿Ÿ `t` æ¯«ç§’åï¼Œé‡ç½® `pending` çŠ¶æ€ï¼Œä»¥å…è®¸å‡½æ•°åœ¨å»¶è¿Ÿç»“æŸåå†æ¬¡æ‰§è¡Œã€‚

3. **å»¶è¿ŸæœŸé—´å­˜å‚¨æœ€æ–°å‚æ•°**ï¼š
   - å½“å»¶è¿Ÿæ—¶é—´å†…å†æ¬¡è°ƒç”¨èŠ‚æµå‡½æ•°æ—¶ï¼Œæ›´æ–°æœ€æ–°çš„å‚æ•°åˆ° `nestArgs`ï¼Œç¡®ä¿æœ€æ–°çš„ä¸€æ¬¡è°ƒç”¨ä¸ä¼šä¸¢å¤±ã€‚
4. **å»¶è¿Ÿç»“æŸåæ‰§è¡Œæœ€æ–°å‚æ•°**ï¼š
   - ä¸€æ—¦å»¶è¿Ÿç»“æŸï¼Œæ£€æŸ¥æ˜¯å¦å­˜åœ¨å­˜å‚¨çš„æœ€æ–°å‚æ•°ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™å†æ¬¡é€’å½’è°ƒç”¨èŠ‚æµå‡½æ•°ï¼Œä½¿ç”¨æœ€æ–°çš„å‚æ•°è¿›è¡Œè°ƒç”¨ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(1)`ï¼Œæ¯æ¬¡è°ƒç”¨ `throttle` å‡½æ•°çš„æ—¶é—´å¤æ‚åº¦ä¸º `O(1)`ï¼Œå› ä¸ºå®ƒåªæ˜¯ç®€å•çš„æ£€æŸ¥è®¡æ—¶å™¨å’Œå­˜å‚¨å‚æ•°ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(1)`ï¼Œä¸»è¦ç”¨äºå­˜å‚¨æœ€æ–°å‚æ•° `lastArgs`ã€‚

## ä»£ç 

```javascript
/**
 * @param {Function} fn
 * @param {number} t milliseconds
 * @return {Function}
 */
var throttle = function (fn, t) {
	let pending = false,
		nestArgs;
	const throttleFn = function (...args) {
		// æ›´æ–°æœ€æ–°çš„å‚æ•°
		nestArgs = args;
		if (!pending) {
			// ç«‹å³è°ƒç”¨
			fn(...args);
			pending = true;
			nestArgs = undefined;
			setTimeout(() => {
				pending = false;
				// åœ¨å»¶è¿Ÿç»“æŸåï¼Œä½¿ç”¨æœ€æ–°å‚æ•°é€’å½’è°ƒç”¨èŠ‚æµå‡½æ•°
				if (nestArgs) {
					throttleFn(...nestArgs);
				}
			}, t);
		}
	};
	return throttleFn;
};

/**
 * const throttled = throttle(console.log, 100);
 * throttled("log"); // logged immediately.
 * throttled("log"); // logged at t=100ms.
 */

/**
 * // æµ‹è¯•å‡½æ•°
 * function runTest() {
 * 	const calls = [
 * 		{ t: 50, inputs: [1] },
 * 		{ t: 75, inputs: [2] },
 * 		{ t: 90, inputs: [8] },
 * 		{ t: 140, inputs: [5, 7] },
 * 		{ t: 300, inputs: [9, 4] }
 * 	];
 *
 * 	const results = [];
 * 	const start = performance.now();
 * 	const throttledLog = throttle((...args) => {
 * 		const time = performance.now();
 * 		results.push({ t: Math.floor(time), inputs: args });
 * 		console.log(`Executed at ${time - start}ms with arguments:`, args);
 * 	}, 70);
 *
 * 	calls.forEach((call) => {
 * 		setTimeout(() => {
 * 			throttledLog(...call.inputs);
 * 		}, call.t);
 * 	});
 *
 * 	// å»¶è¿Ÿ300msåæ‰“å°ç»“æœ
 * 	setTimeout(() => {
 * 		console.log('Final Results:', results);
 * 	}, 400);
 * }
 * runTest();
 */
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ | åŠ›æ‰£ |
| :------: | :------ | :------: | :------ | :------: | :------: |
| 2627 | å‡½æ•°é˜²æŠ– | [[âœ“]](/problem/2627.md) |  | ğŸŸ  | [ğŸ€„ï¸](https://leetcode.cn/problems/debounce) [ğŸ”—](https://leetcode.com/problems/debounce) |
| 2636 | Promise å¯¹è±¡æ±  ğŸ”’ | [[âœ“]](/problem/2636.md) |  | ğŸŸ  | [ğŸ€„ï¸](https://leetcode.cn/problems/promise-pool) [ğŸ”—](https://leetcode.com/problems/promise-pool) |
| 2637 | æœ‰æ—¶é—´é™åˆ¶çš„ Promise å¯¹è±¡ | [[âœ“]](/problem/2637.md) |  | ğŸŸ  | [ğŸ€„ï¸](https://leetcode.cn/problems/promise-time-limit) [ğŸ”—](https://leetcode.com/problems/promise-time-limit) |