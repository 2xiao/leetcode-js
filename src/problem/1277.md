# [1277. ç»Ÿè®¡å…¨ä¸º 1 çš„æ­£æ–¹å½¢å­çŸ©é˜µ](https://leetcode.com/problems/count-square-submatrices-with-all-ones)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°ç»„`](/tag/array.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md) [`çŸ©é˜µ`](/tag/matrix.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/count-square-submatrices-with-all-ones)

## é¢˜ç›®

Given a `m * n` matrix of ones and zeros, return how many **square**
submatrices have all ones.

**Example 1:**

> Input: matrix =
>
> [
>
> [0,1,1,1],
>
> [1,1,1,1],
>
> [0,1,1,1]
>
> ]
>
> Output: 15
>
> Explanation:
>
> There are **10** squares of side 1.
>
> There are **4** squares of side 2.
>
> There is **1** square of side 3.
>
> Total number of squares = 10 + 4 + 1 = **15**.

**Example 2:**

> Input: matrix =
>
> [
>
> [1,0,1],
>
> [1,1,0],
>
> [1,1,0]
>
> ]
>
> Output: 7
>
> Explanation:
>
> There are **6** squares of side 1.
>
> There is **1** square of side 2.
>
> Total number of squares = 6 + 1 = **7**.

**Constraints:**

- `1 <= arr.length <= 300`
- `1 <= arr[0].length <= 300`
- `0 <= arr[i][j] <= 1`

## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ª `m * n` çš„çŸ©é˜µï¼ŒçŸ©é˜µä¸­çš„å…ƒç´ ä¸æ˜¯ `0` å°±æ˜¯ `1`ï¼Œè¯·ä½ ç»Ÿè®¡å¹¶è¿”å›å…¶ä¸­å®Œå…¨ç”± `1` ç»„æˆçš„ **æ­£æ–¹å½¢** å­çŸ©é˜µçš„ä¸ªæ•°ã€‚

**ç¤ºä¾‹ 1ï¼š**

> **è¾“å…¥ï¼š** matrix =
>
> [
>
> [0,1,1,1],
>
> [1,1,1,1],
>
> [0,1,1,1]
>
> ]
>
> **è¾“å‡ºï¼š** 15
>
> **è§£é‡Šï¼š**
>
> è¾¹é•¿ä¸º 1 çš„æ­£æ–¹å½¢æœ‰ **10** ä¸ªã€‚
>
> è¾¹é•¿ä¸º 2 çš„æ­£æ–¹å½¢æœ‰ **4** ä¸ªã€‚
>
> è¾¹é•¿ä¸º 3 çš„æ­£æ–¹å½¢æœ‰ **1** ä¸ªã€‚
>
> æ­£æ–¹å½¢çš„æ€»æ•° = 10 + 4 + 1 = **15**.

**ç¤ºä¾‹ 2ï¼š**

> **è¾“å…¥ï¼š** matrix =
>
> [
>
> [1,0,1],
>
> [1,1,0],
>
> [1,1,0]
>
> ]
>
> **è¾“å‡ºï¼š** 7
>
> **è§£é‡Šï¼š**
>
> è¾¹é•¿ä¸º 1 çš„æ­£æ–¹å½¢æœ‰ **6** ä¸ªã€‚
>
> è¾¹é•¿ä¸º 2 çš„æ­£æ–¹å½¢æœ‰ **1** ä¸ªã€‚
>
> æ­£æ–¹å½¢çš„æ€»æ•° = 6 + 1 = **7**.

**æç¤ºï¼š**

- `1 <= arr.length <= 300`
- `1 <= arr[0].length <= 300`
- `0 <= arr[i][j] <= 1`

## è§£é¢˜æ€è·¯

å¯ä»¥ä½¿ç”¨åŠ¨æ€è§„åˆ’çš„æ–¹æ³•æ¥è§£å†³è¿™é“é¢˜ã€‚

1. **åŠ¨æ€è§„åˆ’æ•°ç»„**ï¼š

   - åˆ›å»ºä¸€ä¸ªä¸è¾“å…¥çŸ©é˜µå¤§å°ç›¸åŒçš„åŠ¨æ€è§„åˆ’æ•°ç»„ `dp`ï¼Œ`dp[i][j]` è¡¨ç¤ºä»¥ `(i, j)` ä¸ºå³ä¸‹è§’çš„æ­£æ–¹å½¢å­çŸ©é˜µçš„æœ€å¤§è¾¹é•¿ã€‚
   - å¦‚æœ `matrix[i][j]` æ˜¯ `1`ï¼Œåˆ™ `dp[i][j]` çš„å€¼å–å†³äºå®ƒçš„ä¸Šã€å·¦å’Œå·¦ä¸Šå¯¹è§’çš„å€¼ï¼š

   `dp[i][j] = min(dp[i-1][j], dp[i][j-1], dp[i-1][j-1]) + 1`

   - å¦åˆ™ï¼Œå¦‚æœ `matrix[i][j]` æ˜¯ `0`ï¼Œåˆ™ `dp[i][j]` çš„å€¼ä¸º `0`ã€‚

2. **æ€»è®¡æ•°**ï¼š

   - æ¯æ¬¡æ›´æ–° `dp[i][j]` æ—¶ï¼Œå°†å…¶å€¼ç´¯åŠ åˆ°æ€»è®¡æ•°ä¸­ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨éå†å®Œæˆåå¾—åˆ°æ‰€æœ‰æ­£æ–¹å½¢å­çŸ©é˜µçš„æ€»æ•°ã€‚

3. **è¾¹ç•Œæ¡ä»¶**ï¼š
   - å¯¹äºç¬¬ä¸€è¡Œå’Œç¬¬ä¸€åˆ—çš„å…ƒç´ ï¼Œ`dp[i][j]` åªèƒ½ç­‰äº `matrix[i][j]` æœ¬èº«ï¼Œå› ä¸ºå®ƒä»¬ä¸èƒ½å½¢æˆæ›´å¤§çš„æ­£æ–¹å½¢ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(m * n)`ï¼Œå…¶ä¸­ `m` æ˜¯çŸ©é˜µçš„è¡Œæ•°ï¼Œ`n` æ˜¯çŸ©é˜µçš„åˆ—æ•°ï¼Œéœ€è¦éå†æ•´ä¸ªçŸ©é˜µä¸€æ¬¡ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(m * n)`ï¼Œä½¿ç”¨ä¸€ä¸ªä¸è¾“å…¥çŸ©é˜µç›¸åŒå¤§å°çš„åŠ¨æ€è§„åˆ’æ•°ç»„ã€‚

## ä»£ç 

```javascript
/**
 * @param {number[][]} matrix
 * @return {number}
 */
var countSquares = function (matrix) {
	if (!matrix || matrix.length == 0 || matrix[0].length == 0) return 0;
	const m = matrix.length,
		n = matrix[0].length;
	let dp = new Array(m).fill(0).map((i) => new Array(n).fill(0));
	let res = 0;
	for (let i = 0; i < m; i++) {
		for (let j = 0; j < n; j++) {
			if (matrix[i][j] == 1) {
				// ç¬¬ä¸€è¡Œæˆ–ç¬¬ä¸€åˆ—
				if (i == 0 || j == 0) {
					dp[i][j] = 1;
				} else {
					dp[i][j] = Math.min(dp[i - 1][j], dp[i - 1][j - 1], dp[i][j - 1]) + 1;
				}

				// æ›´æ–°æ€»è®¡æ•°
				res += dp[i][j];
			}
		}
	}
	return res;
};
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 2087 | [ç½‘æ ¼å›¾ä¸­æœºå™¨äººå›å®¶çš„æœ€å°ä»£ä»·](https://leetcode.com/problems/minimum-cost-homecoming-of-a-robot-in-a-grid) |  |  [`è´ªå¿ƒ`](/tag/greedy.md) [`æ•°ç»„`](/tag/array.md) | <font color=#ffb800>Medium</font> |
| 2088 | [ç»Ÿè®¡å†œåœºä¸­è‚¥æ²ƒé‡‘å­—å¡”çš„æ•°ç›®](https://leetcode.com/problems/count-fertile-pyramids-in-a-land) |  |  [`æ•°ç»„`](/tag/array.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md) [`çŸ©é˜µ`](/tag/matrix.md) | <font color=#ff334b>Hard</font> |