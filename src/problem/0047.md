# [47. å…¨æ’åˆ— II](https://leetcode.com/problems/permutations-ii)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°ç»„`](/tag/array.md) [`å›æº¯`](/tag/backtracking.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/permutations-ii)

## é¢˜ç›®

Given a collection of numbers, `nums`, that might contain duplicates, return
_all possible unique permutations **in any order**._

**Example 1:**

> Input: nums = [1,1,2]
>
> Output:
>
> [[1,1,2],
>
> [1,2,1],
>
> [2,1,1]]

**Example 2:**

> Input: nums = [1,2,3]
>
> Output: [[1,2,3],[1,3,2],[2,1,3],[2,3,1],[3,1,2],[3,2,1]]

**Constraints:**

- `1 <= nums.length <= 8`
- `-10 <= nums[i] <= 10`

## é¢˜ç›®å¤§æ„

ç»™å®šä¸€ä¸ªå¯åŒ…å«é‡å¤æ•°å­—çš„åºåˆ— `nums` ï¼Œ**æŒ‰ä»»æ„é¡ºåº** è¿”å›æ‰€æœ‰ä¸é‡å¤çš„å…¨æ’åˆ—ã€‚

## è§£é¢˜æ€è·¯

å¯ä»¥ä½¿ç”¨å›æº¯ç®—æ³•ç”Ÿæˆå…¨æ’åˆ—ï¼ŒåŒæ—¶å¤„ç†æ•°ç»„ä¸­å¯èƒ½å­˜åœ¨é‡å¤å…ƒç´ çš„æƒ…å†µï¼š

1. å®šä¹‰ä¸€ä¸ªç»“æœæ•°ç»„ `res`ï¼Œä¸€ä¸ªè·¯å¾„æ•°ç»„ `track` ç”¨äºè®°å½•å½“å‰æ’åˆ—çš„è·¯å¾„ï¼Œä»¥åŠä¸€ä¸ªå¸ƒå°”æ•°ç»„ `used` ç”¨äºæ ‡è®°æŸä¸ªå…ƒç´ æ˜¯å¦å·²ç»è¢«ä½¿ç”¨è¿‡ã€‚
2. å¯¹è¾“å…¥æ•°ç»„ `nums` è¿›è¡Œå‡åºæ’åºï¼Œä»¥æ–¹ä¾¿åœ¨åç»­å»é‡çš„è¿‡ç¨‹ä¸­åˆ¤æ–­ç›¸é‚»å…ƒç´ æ˜¯å¦ç›¸åŒã€‚
3. åˆ›å»ºä¸€ä¸ªåä¸º `backtrack` çš„é€’å½’å‡½æ•°ï¼Œè¯¥å‡½æ•°ç”¨äºç”Ÿæˆå…¨æ’åˆ—ã€‚å‡½æ•°æ²¡æœ‰å‚æ•°ï¼Œé€šè¿‡æ•°ç»„ `track` å’Œå¸ƒå°”æ•°ç»„ `used` è®°å½•å½“å‰çš„è·¯å¾„å’ŒçŠ¶æ€ã€‚
4. åœ¨ `backtrack` å‡½æ•°ä¸­ï¼Œé¦–å…ˆæ£€æŸ¥å½“å‰è·¯å¾„çš„é•¿åº¦æ˜¯å¦ç­‰äºè¾“å…¥æ•°ç»„ `nums` çš„é•¿åº¦ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¯´æ˜å·²ç»ç”Ÿæˆäº†ä¸€ä¸ªå®Œæ•´çš„æ’åˆ—ï¼Œå°†å½“å‰è·¯å¾„åŠ å…¥åˆ°ç»“æœæ•°ç»„ `res` ä¸­ï¼Œå¹¶ç›´æ¥è¿”å›ã€‚
5. ç„¶åï¼Œä»å¤´å¼€å§‹éå†æ’åºåçš„æ•°ç»„ `nums`ï¼Œå¯¹äºæ¯ä¸ªå…ƒç´ ï¼š
   - å¦‚æœè¯¥å…ƒç´ å·²ç»è¢«ä½¿ç”¨è¿‡ (`used[i]` ä¸º `true`)ï¼Œåˆ™è·³è¿‡å½“å‰å…ƒç´ ã€‚
   - å¦‚æœè¯¥å…ƒç´ å’Œå‰ä¸€ä¸ªå…ƒç´ ç›¸åŒï¼Œä¸”å‰ä¸€ä¸ªå…ƒç´ æ²¡æœ‰è¢«ä½¿ç”¨è¿‡ (`!used[i - 1]`)ï¼Œåˆ™è·³è¿‡å½“å‰å…ƒç´ ã€‚è¿™æ˜¯ä¸ºäº†é¿å…ç”Ÿæˆé‡å¤çš„æ’åˆ—ï¼Œç¡®ä¿ç›¸åŒå…ƒç´ åªåœ¨åŒä¸€å±‚é€’å½’ä¸­å‡ºç°ä¸€æ¬¡ã€‚
   - å¦åˆ™ï¼Œå°†å½“å‰å…ƒç´ åŠ å…¥åˆ°è·¯å¾„ `track` ä¸­ï¼Œæ ‡è®°è¯¥å…ƒç´ ä¸ºå·²ä½¿ç”¨ï¼Œé€’å½’è°ƒç”¨ `backtrack` å‡½æ•°ï¼Œè¿›å…¥ä¸‹ä¸€å±‚ï¼Œå¹¶åœ¨é€’å½’è°ƒç”¨ç»“æŸåï¼Œå°†å½“å‰å…ƒç´ ä»è·¯å¾„ä¸­å¼¹å‡ºï¼Œæ ‡è®°ä¸ºæœªä½¿ç”¨ï¼Œä»¥ä¾¿å›æº¯åˆ°ä¸Šä¸€å±‚ï¼Œç»§ç»­éå†å…¶ä»–å…ƒç´ ã€‚
6. æœ€åï¼Œè¿”å›ç»“æœæ•°ç»„ `res`ï¼Œå…¶ä¸­åŒ…å«äº†æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„å…¨æ’åˆ—ã€‚

æ ‡å‡†å…¨æ’åˆ—ç®—æ³•ä¹‹æ‰€ä»¥å‡ºç°é‡å¤ï¼Œæ˜¯å› ä¸ºæŠŠç›¸åŒå…ƒç´ å½¢æˆçš„æ’åˆ—åºåˆ—è§†ä¸ºä¸åŒçš„åºåˆ—ï¼Œä½†å®é™…ä¸Šå®ƒä»¬åº”è¯¥æ˜¯ç›¸åŒçš„ï¼›è€Œå¦‚æœå›ºå®šç›¸åŒå…ƒç´ å½¢æˆçš„åºåˆ—é¡ºåºï¼Œä¿è¯ç›¸åŒå…ƒç´ åœ¨æ’åˆ—ä¸­çš„ç›¸å¯¹ä½ç½®ä¿æŒä¸å˜ï¼Œå°±é¿å…äº†é‡å¤ã€‚

## ä»£ç 

```javascript
/**
 * @param {number[]} nums
 * @return {number[][]}
 */
var permuteUnique = function (nums) {
	let res = [];
	let track = [];
	let used = new Array(nums.length).fill(false);

	// å…ˆæ’åºï¼Œè®©ç›¸åŒçš„å…ƒç´ é åœ¨ä¸€èµ·
	nums.sort((a, b) => a - b);

	const backtrack = () => {
		if (track.length == nums.length) {
			res.push([...track]);
			return;
		}
		for (let i = 0; i < nums.length; i++) {
			// æ–°æ·»åŠ çš„å‰ªæé€»è¾‘ï¼Œå›ºå®šç›¸åŒçš„å…ƒç´ åœ¨æ’åˆ—ä¸­çš„ç›¸å¯¹ä½ç½®
			if (used[i] || (i > 0 && nums[i] == nums[i - 1] && !used[i - 1])) {
				continue;
			}
			track.push(nums[i]);
			used[i] = true;
			backtrack(i + 1);
			track.pop();
			used[i] = false;
		}
	};

	backtrack();
	return res;
};
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 31 | [ä¸‹ä¸€ä¸ªæ’åˆ—](https://leetcode.com/problems/next-permutation) | [[âœ“]](/problem/0031.md) |  [`æ•°ç»„`](/tag/array.md) [`åŒæŒ‡é’ˆ`](/tag/two-pointers.md) | <font color=#ffb800>Medium</font> |
| 46 | [å…¨æ’åˆ—](https://leetcode.com/problems/permutations) | [[âœ“]](/problem/0046.md) |  [`æ•°ç»„`](/tag/array.md) [`å›æº¯`](/tag/backtracking.md) | <font color=#ffb800>Medium</font> |
| 267 | [å›æ–‡æ’åˆ— II](https://leetcode.com/problems/palindrome-permutation-ii) |  |  [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`å­—ç¬¦ä¸²`](/tag/string.md) [`å›æº¯`](/tag/backtracking.md) | <font color=#ffb800>Medium</font> |
| 996 | [å¹³æ–¹æ•°ç»„çš„æ•°ç›®](https://leetcode.com/problems/number-of-squareful-arrays) |  |  [`ä½è¿ç®—`](/tag/bit-manipulation.md) [`æ•°ç»„`](/tag/array.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) `4+` | <font color=#ff334b>Hard</font> |