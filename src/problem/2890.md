---
title: 2890. é‡å¡‘æ•°æ®ï¼šèåˆ
description: LeetCode 2890. é‡å¡‘æ•°æ®ï¼šèåˆé¢˜è§£ï¼ŒReshape Data Meltï¼ŒåŒ…å«è§£é¢˜æ€è·¯ã€å¤æ‚åº¦åˆ†æä»¥åŠå®Œæ•´çš„ JavaScript ä»£ç å®ç°ã€‚
keywords:
  - LeetCode
  - 2890. é‡å¡‘æ•°æ®ï¼šèåˆ
  - é‡å¡‘æ•°æ®ï¼šèåˆ
  - Reshape Data Melt
  - è§£é¢˜æ€è·¯
---

# 2890. é‡å¡‘æ•°æ®ï¼šèåˆ

ğŸŸ¢ <font color=#15bd66>Easy</font>&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/reshape-data-melt) [`LeetCode`](https://leetcode.com/problems/reshape-data-melt)

## é¢˜ç›®

> DataFrame report
>
> ```
> +-------------+--------+
> | Column Name | Type   |
> +-------------+--------+
> | product     | object |
> | quarter_1   | int    |
> | quarter_2   | int    |
> | quarter_3   | int    |
> | quarter_4   | int    |
> +-------------+--------+
> ```

Write a solution to **reshape** the data so that each row represents sales
data for a product in a specific quarter.

The result format is in the following example.

**Example 1:**

> Input:
>
> ```
> +-------------+-----------+-----------+-----------+-----------+
> | product     | quarter_1 | quarter_2 | quarter_3 | quarter_4 |
> +-------------+-----------+-----------+-----------+-----------+
> | Umbrella    | 417       | 224       | 379       | 611       |
> | SleepingBag | 800       | 936       | 93        | 875       |
> +-------------+-----------+-----------+-----------+-----------+
> ```
>
> Output:
>
> ```
> +-------------+-----------+-------+
> | product     | quarter   | sales |
> +-------------+-----------+-------+
> | Umbrella    | quarter_1 | 417   |
> | SleepingBag | quarter_1 | 800   |
> | Umbrella    | quarter_2 | 224   |
> | SleepingBag | quarter_2 | 936   |
> | Umbrella    | quarter_3 | 379   |
> | SleepingBag | quarter_3 | 93    |
> | Umbrella    | quarter_4 | 611   |
> | SleepingBag | quarter_4 | 875   |
> +-------------+-----------+-------+
> ```
>
> Explanation:
>
> The DataFrame is reshaped from wide to long format. Each row represents the sales of a product in a quarter.

## é¢˜ç›®å¤§æ„

> DataFrame report
>
> ```
> +-------------+--------+
> | Column Name | Type   |
> +-------------+--------+
> | product     | object |
> | quarter_1   | int    |
> | quarter_2   | int    |
> | quarter_3   | int    |
> | quarter_4   | int    |
> +-------------+--------+
> ```

ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œå°†æ•°æ® **é‡å¡‘** æˆæ¯ä¸€è¡Œè¡¨ç¤ºç‰¹å®šå­£åº¦äº§å“é”€å”®æ•°æ®çš„å½¢å¼ã€‚

ç»“æœæ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼š

**ç¤ºä¾‹ 1ï¼š**

> **è¾“å…¥ï¼š**

> ```
> +-------------+-----------+-----------+-----------+-----------+
> | product     | quarter_1 | quarter_2 | quarter_3 | quarter_4 |
> +-------------+-----------+-----------+-----------+-----------+
> | Umbrella    | 417       | 224       | 379       | 611       |
> | SleepingBag | 800       | 936       | 93        | 875       |
> +-------------+-----------+-----------+-----------+-----------+
> ```
>
> **è¾“å‡ºï¼š**
>
> ```
> +-------------+-----------+-------+
> | product     | quarter   | sales |
> +-------------+-----------+-------+
> | Umbrella    | quarter_1 | 417   |
> | SleepingBag | quarter_1 | 800   |
> | Umbrella    | quarter_2 | 224   |
> | SleepingBag | quarter_2 | 936   |
> | Umbrella    | quarter_3 | 379   |
> | SleepingBag | quarter_3 | 93    |
> | Umbrella    | quarter_4 | 611   |
> | SleepingBag | quarter_4 | 875   |
> +-------------+-----------+-------+
> ```
>
> **è§£é‡Šï¼š**
>
> DataFrame å·²ä»å®½æ ¼å¼é‡å¡‘ä¸ºé•¿æ ¼å¼ã€‚æ¯ä¸€è¡Œè¡¨ç¤ºä¸€ä¸ªå­£åº¦å†…äº§å“çš„é”€å”®æƒ…å†µã€‚

## è§£é¢˜æ€è·¯

åœ¨ Pandas ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ `melt()` æ–¹æ³•å°†å®½è¡¨ï¼ˆWide Format Tableï¼‰è½¬æ¢ä¸ºé•¿è¡¨ï¼ˆLong Format Tableï¼‰ã€‚è¿™æ˜¯æ•°æ®æ•´ç†ä¸­çš„å¸¸è§æ“ä½œï¼Œç”¨äºå°†åˆ—æ•°æ®è½¬ä¸ºè¡Œæ•°æ®ã€‚

1. **æŒ‡å®šä¿ç•™åˆ— (`id_vars`)**ï¼š
   - ä½¿ç”¨ `['product']` æŒ‡å®šä¸éœ€è¦è½¬æ¢çš„åˆ—ï¼Œè¿™äº›åˆ—ä¼šåœ¨ç»“æœè¡¨ä¸­ä¿ç•™ä¸ºå›ºå®šçš„åˆ—ã€‚
2. **è®¾ç½®æ–°åˆ—å (`var_name`)**ï¼š
   - ä½¿ç”¨ `var_name='quarter'` ä¸ºè½¬æ¢åçš„åˆ—åï¼ˆå³åŸå§‹å®½è¡¨ä¸­çš„åˆ—åï¼‰å‘½åä¸º `'quarter'`ã€‚
3. **è®¾ç½®æ–°å€¼åˆ—å (`value_name`)**ï¼š
   - ä½¿ç”¨ `value_name='sales'` ä¸ºåŸå§‹å®½è¡¨ä¸­åˆ—å¯¹åº”çš„å€¼å‘½åä¸º `'sales'`ã€‚
4. **è¾“å‡ºç»“æœ**ï¼š
   - è½¬æ¢åçš„è¡¨æ˜¯ä¸€ä¸ªé•¿è¡¨ï¼Œå…¶ä¸­æ¯è¡ŒåŒ…å« `product`ã€`quarter` å’Œå¯¹åº”çš„ `sales` å€¼ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n * m)`ï¼Œå…¶ä¸­ `n` æ˜¯åŸå§‹è¡¨çš„è¡Œæ•°ï¼Œ`m` æ˜¯åŸå§‹è¡¨çš„åˆ—æ•°ã€‚`melt()` éœ€è¦éå†æ‰€æœ‰åˆ—å¹¶é‡æ„ä¸ºè¡Œã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(n * m)`ï¼Œéœ€è¦åˆ†é…å†…å­˜å­˜å‚¨è½¬æ¢åçš„é•¿è¡¨ï¼Œæ¯ä¸ªåŸå§‹å€¼ä¼šå ç”¨ä¸€è¡Œã€‚

## ä»£ç 

```python
import pandas as pd

def meltTable(report: pd.DataFrame) -> pd.DataFrame:
  return pd.melt(report, id_vars=['product'], var_name='quarter', value_name='sales')
```
