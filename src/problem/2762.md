---
title: 2762. ä¸é—´æ–­å­æ•°ç»„
description: LeetCode 2762. ä¸é—´æ–­å­æ•°ç»„é¢˜è§£ï¼ŒContinuous Subarraysï¼ŒåŒ…å«è§£é¢˜æ€è·¯ã€å¤æ‚åº¦åˆ†æä»¥åŠå®Œæ•´çš„ JavaScript ä»£ç å®ç°ã€‚
keywords:
  - LeetCode
  - 2762. ä¸é—´æ–­å­æ•°ç»„
  - ä¸é—´æ–­å­æ•°ç»„
  - Continuous Subarrays
  - è§£é¢˜æ€è·¯
  - é˜Ÿåˆ—
  - æ•°ç»„
  - æœ‰åºé›†åˆ
  - æ»‘åŠ¨çª—å£
  - å•è°ƒé˜Ÿåˆ—
  - å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰
---

# 2762. ä¸é—´æ–­å­æ•°ç»„

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`é˜Ÿåˆ—`](/tag/queue.md) [`æ•°ç»„`](/tag/array.md) [`æœ‰åºé›†åˆ`](/tag/ordered-set.md) [`æ»‘åŠ¨çª—å£`](/tag/sliding-window.md) [`å•è°ƒé˜Ÿåˆ—`](/tag/monotonic-queue.md) [`å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰`](/tag/heap-priority-queue.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/continuous-subarrays) [`LeetCode`](https://leetcode.com/problems/continuous-subarrays)

## é¢˜ç›®

You are given a **0-indexed** integer array `nums`. A subarray of `nums` is
called **continuous** if:

- Let `i`, `i + 1`, ..., `j` be the indices in the subarray. Then, for each pair of indices `i <= i1, i2 <= j`, `0 <= |nums[i1] - nums[i2]| <= 2`.

Return _the total number of**continuous** subarrays._

A subarray is a contiguous **non-empty** sequence of elements within an array.

**Example 1:**

> Input: nums = [5,4,2,4]
>
> Output: 8
>
> Explanation:
>
> Continuous subarray of size 1: [5], [4], [2], [4].
>
> Continuous subarray of size 2: [5,4], [4,2], [2,4].
>
> Continuous subarray of size 3: [4,2,4].
>
> Thereare no subarrys of size 4.
>
> Total continuous subarrays = 4 + 3 + 1 = 8.
>
> It can be shown that there are no more continuous subarrays.

**Example 2:**

> Input: nums = [1,2,3]
>
> Output: 6
>
> Explanation:
>
> Continuous subarray of size 1: [1], [2], [3].
>
> Continuous subarray of size 2: [1,2], [2,3].
>
> Continuous subarray of size 3: [1,2,3].
>
> Total continuous subarrays = 3 + 2 + 1 = 6.

**Constraints:**

- `1 <= nums.length <= 10^5`
- `1 <= nums[i] <= 10^9`

## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªä¸‹æ ‡ä» **0** å¼€å§‹çš„æ•´æ•°æ•°ç»„ `nums` ã€‚`nums` çš„ä¸€ä¸ªå­æ•°ç»„å¦‚æœæ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼Œé‚£ä¹ˆå®ƒæ˜¯ **ä¸é—´æ–­** çš„ï¼š

- `i`ï¼Œ`i + 1` ï¼Œ...ï¼Œ`j` è¡¨ç¤ºå­æ•°ç»„ä¸­çš„ä¸‹æ ‡ã€‚å¯¹äºæ‰€æœ‰æ»¡è¶³ `i <= i1, i2 <= j` çš„ä¸‹æ ‡å¯¹ï¼Œéƒ½æœ‰ `0 <= |nums[i1] - nums[i2]| <= 2` ã€‚

è¯·ä½ è¿”å› **ä¸é—´æ–­** å­æ•°ç»„çš„æ€»æ•°ç›®ã€‚

å­æ•°ç»„æ˜¯ä¸€ä¸ªæ•°ç»„ä¸­ä¸€æ®µè¿ç»­ **éç©º** çš„å…ƒç´ åºåˆ—ã€‚

**ç¤ºä¾‹ 1ï¼š**

> **è¾“å…¥ï¼š** nums = [5,4,2,4]
>
> **è¾“å‡ºï¼š** 8
>
> **è§£é‡Šï¼š**
>
> å¤§å°ä¸º 1 çš„ä¸é—´æ–­å­æ•°ç»„ï¼š[5], [4], [2], [4] ã€‚
>
> å¤§å°ä¸º 2 çš„ä¸é—´æ–­å­æ•°ç»„ï¼š[5,4], [4,2], [2,4] ã€‚
>
> å¤§å°ä¸º 3 çš„ä¸é—´æ–­å­æ•°ç»„ï¼š[4,2,4] ã€‚
>
> æ²¡æœ‰å¤§å°ä¸º 4 çš„ä¸é—´æ–­å­æ•°ç»„ã€‚
>
> ä¸é—´æ–­å­æ•°ç»„çš„æ€»æ•°ç›®ä¸º 4 + 3 + 1 = 8 ã€‚
>
> é™¤äº†è¿™äº›ä»¥å¤–ï¼Œæ²¡æœ‰åˆ«çš„ä¸é—´æ–­å­æ•°ç»„ã€‚

**ç¤ºä¾‹ 2ï¼š**

> **è¾“å…¥ï¼š** nums = [1,2,3]
>
> **è¾“å‡ºï¼š** 6
>
> **è§£é‡Šï¼š**
>
> å¤§å°ä¸º 1 çš„ä¸é—´æ–­å­æ•°ç»„ï¼š[1], [2], [3] ã€‚
>
> å¤§å°ä¸º 2 çš„ä¸é—´æ–­å­æ•°ç»„ï¼š[1,2], [2,3] ã€‚
>
> å¤§å°ä¸º 3 çš„ä¸é—´æ–­å­æ•°ç»„ï¼š[1,2,3] ã€‚
>
> ä¸é—´æ–­å­æ•°ç»„çš„æ€»æ•°ç›®ä¸º 3 + 2 + 1 = 6 ã€‚

**æç¤ºï¼š**

- `1 <= nums.length <= 10^5`
- `1 <= nums[i] <= 10^9`

## è§£é¢˜æ€è·¯

1. **æ»‘åŠ¨çª—å£**ï¼š

   - æœ¬é¢˜è¦æ±‚è®¡ç®—è¿ç»­å­æ•°ç»„ï¼Œä¸”å­æ•°ç»„éœ€è¦æ»¡è¶³ä¸€å®šçš„æ¡ä»¶ï¼Œæ»‘åŠ¨çª—å£æ˜¯ä¸€ä¸ªéå¸¸é€‚åˆè§£å†³æ­¤ç±»é—®é¢˜çš„æŠ€å·§ã€‚
   - æ»‘åŠ¨çª—å£çš„æ ¸å¿ƒåœ¨äºï¼Œé€šè¿‡ç§»åŠ¨çª—å£çš„è¾¹ç•Œï¼ˆèµ·ç‚¹ `i` å’Œç»ˆç‚¹ `j`ï¼‰åŠ¨æ€è°ƒæ•´çª—å£èŒƒå›´ï¼Œä»è€Œé«˜æ•ˆåœ°ç¡®å®šæ»¡è¶³æ¡ä»¶çš„å­æ•°ç»„ã€‚

2. **ä½¿ç”¨å“ˆå¸Œè¡¨è®°å½•çª—å£çŠ¶æ€**ï¼š

   - ä¸ºäº†é«˜æ•ˆåœ°åˆ¤æ–­çª—å£å†…å…ƒç´ æ˜¯å¦æ»¡è¶³æ¡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªå“ˆå¸Œè¡¨ `map` è®°å½•çª—å£å†…æ¯ä¸ªæ•°çš„é¢‘ç‡ã€‚

3. **çª—å£åˆæ³•æ€§æ£€æŸ¥**ï¼š

   - åˆ¤æ–­çª—å£æ˜¯å¦æ»¡è¶³æ¡ä»¶çš„æ–¹æ³•ï¼šçª—å£å†…çš„å…ƒç´ å¿…é¡»æ»¡è¶³ä»»æ„ä¸¤ä¸ªæ•° `nums[i]` å’Œ `nums[j]` çš„ç»å¯¹å·®å€¼ä¸è¶…è¿‡ 2ã€‚
   - å¯¹äºæ»‘åŠ¨çª—å£çš„æ¯ä¸ªä½ç½® `j`ï¼Œé€šè¿‡ä¸€ä¸ªè¾…åŠ©å‡½æ•° `getCount(num)`ï¼Œç»Ÿè®¡ `num` åŠå…¶ç›¸é‚»å€¼ `numÂ±1` å’Œ `numÂ±2` çš„å‡ºç°é¢‘æ¬¡ï¼Œä¸å½“å‰çª—å£é•¿åº¦ `(j - i + 1)` å¯¹æ¯”ï¼Œä»è€Œåˆ¤æ–­å½“å‰çª—å£æ˜¯å¦æ»¡è¶³æ¡ä»¶ã€‚
     - å¦‚æœ `getCount(num) == (j - i + 1)`ï¼Œè¯´æ˜çª—å£ä¸­æ‰€æœ‰æ•°çš„ç»å¯¹å·®å€¼éƒ½ä¸è¶…è¿‡ 2ï¼Œæ‰€æœ‰ä»¥ `j` ä¸ºå³è¾¹ç•Œçš„å­æ•°ç»„çš„ä¸ªæ•°ä¸º `(j - i + 1)`ï¼Œå°†å…¶åŠ å…¥å­æ•°ç»„æ€»æ•°ä¸­ã€‚
     - å¦‚æœ `getCount(num) < (j - i + 1)`ï¼Œè¯´æ˜çª—å£ä¸­å‡ºç°äº†ç»å¯¹å·®å€¼è¶…è¿‡ 2 çš„æ•°å­—ï¼Œé€æ­¥æ”¶ç¼©å·¦è¾¹ç•Œ `i`ï¼ŒåŒæ—¶æ›´æ–°å“ˆå¸Œè¡¨ `map`ã€‚

4. **éå†æ•°ç»„ `nums`**ï¼š

   - å°†å½“å‰å…ƒç´ åŠ å…¥çª—å£ï¼ˆæ›´æ–° `map`ï¼‰ã€‚
   - æ£€æŸ¥å½“å‰çª—å£æ˜¯å¦æ»¡è¶³æ¡ä»¶ã€‚å¦‚æœä¸æ»¡è¶³ï¼Œåˆ™æ”¶ç¼©çª—å£ï¼ˆè°ƒæ•´ `i` å¹¶æ›´æ–° `map`ï¼‰ã€‚
   - ç´¯åŠ ä»¥ `j` ä¸ºå³è¾¹ç•Œçš„å­æ•°ç»„æ•°ï¼š`total += (j - i + 1)`ã€‚

5. **è¿”å›ç»“æœ**ï¼š
   - è¿”å› `total` ä½œä¸ºç»“æœã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œéå†æ•°ç»„çš„æ—¶é—´å¤æ‚åº¦ä¸º `O(n)`ï¼Œå“ˆå¸Œè¡¨çš„æ’å…¥ã€åˆ é™¤ã€æŸ¥è¯¢æ“ä½œæ—¶é—´å¤æ‚åº¦ä¸º `O(1)`ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œä½¿ç”¨äº†ä¸€ä¸ªå“ˆå¸Œè¡¨ `map`ï¼Œå…¶å¤§å°å–å†³äºçª—å£ä¸­ä¸åŒæ•°å­—çš„æ•°é‡ï¼Œæœ€åæƒ…å†µä¸‹ï¼Œç©ºé—´å¤æ‚åº¦ä¸º `O(n)`ã€‚

## ä»£ç 

```javascript
/**
 * @param {number[]} nums
 * @return {number}
 */
var continuousSubarrays = function (nums) {
	const n = nums.length;
	let i = 0; // æ»‘åŠ¨çª—å£å·¦è¾¹ç•Œ
	let total = 0; // æ»¡è¶³æ¡ä»¶çš„å­æ•°ç»„æ€»æ•°
	let map = new Map(); // å“ˆå¸Œè¡¨è®°å½•çª—å£å†…æ•°å­—å‡ºç°çš„é¢‘ç‡

	// è¾…åŠ©å‡½æ•°ï¼šç»Ÿè®¡numåŠå…¶ç›¸é‚»æ•°å­—çš„æ€»é¢‘ç‡
	const getCount = (num) => {
		return (
			(map.get(num) || 0) +
			(map.get(num - 1) || 0) +
			(map.get(num - 2) || 0) +
			(map.get(num + 1) || 0) +
			(map.get(num + 2) || 0)
		);
	};

	// éå†æ•°ç»„
	for (let j = 0; j < n; j++) {
		// å°†å½“å‰å…ƒç´ åŠ å…¥çª—å£
		map.set(nums[j], (map.get(nums[j]) || 0) + 1);

		// è°ƒæ•´çª—å£çš„å·¦è¾¹ç•Œï¼Œç¡®ä¿çª—å£åˆæ³•
		while (j - i + 1 > getCount(nums[j])) {
			map.set(nums[i], map.get(nums[i]) - 1); // ç§»é™¤å·¦è¾¹ç•Œå…ƒç´ 
			i++; // æ”¶ç¼©å·¦è¾¹ç•Œ
		}

		// ç´¯åŠ ä»¥jä¸ºå³è¾¹ç•Œçš„å­æ•°ç»„æ•°
		total += j - i + 1;
	}

	return total;
};
```
