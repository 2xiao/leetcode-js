---
title: 1588. æ‰€æœ‰å¥‡æ•°é•¿åº¦å­æ•°ç»„çš„å’Œ
description: LeetCode 1588. æ‰€æœ‰å¥‡æ•°é•¿åº¦å­æ•°ç»„çš„å’Œé¢˜è§£ï¼ŒSum of All Odd Length Subarraysï¼ŒåŒ…å«è§£é¢˜æ€è·¯ã€å¤æ‚åº¦åˆ†æä»¥åŠå®Œæ•´çš„ JavaScript ä»£ç å®ç°ã€‚
keywords:
  - LeetCode
  - 1588. æ‰€æœ‰å¥‡æ•°é•¿åº¦å­æ•°ç»„çš„å’Œ
  - æ‰€æœ‰å¥‡æ•°é•¿åº¦å­æ•°ç»„çš„å’Œ
  - Sum of All Odd Length Subarrays
  - è§£é¢˜æ€è·¯
  - æ•°ç»„
  - æ•°å­¦
  - å‰ç¼€å’Œ
---

# 1588. æ‰€æœ‰å¥‡æ•°é•¿åº¦å­æ•°ç»„çš„å’Œ

ğŸŸ¢ <font color=#15bd66>Easy</font>&emsp; ğŸ”–&ensp; [`æ•°ç»„`](/tag/array.md) [`æ•°å­¦`](/tag/math.md) [`å‰ç¼€å’Œ`](/tag/prefix-sum.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/sum-of-all-odd-length-subarrays) [`LeetCode`](https://leetcode.com/problems/sum-of-all-odd-length-subarrays)

## é¢˜ç›®

Given an array of positive integers `arr`, return _the sum of all
possible**odd-length subarrays** of _`arr`.

A **subarray** is a contiguous subsequence of the array.

**Example 1:**

> Input: arr = [1,4,2,5,3]
>
> Output: 58
>
> Explanation: The odd-length subarrays of arr and their sums are:
> [1] = 1
> [4] = 4
> [2] = 2
> [5] = 5
> [3] = 3
> [1,4,2] = 7
> [4,2,5] = 11
> [2,5,3] = 10
> [1,4,2,5,3] = 15
>
> If we add all these together we get 1 + 4 + 2 + 5 + 3 + 7 + 11 + 10 + 15 = 58

**Example 2:**

> Input: arr = [1,2]
>
> Output: 3
>
> Explanation: There are only 2 subarrays of odd length, [1] and [2]. Their sum is 3.

**Example 3:**

> Input: arr = [10,11,12]
>
> Output: 66

**Constraints:**

- `1 <= arr.length <= 100`
- `1 <= arr[i] <= 1000`

**Follow up:**

Could you solve this problem in `O(n)` time complexity?

## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªæ­£æ•´æ•°æ•°ç»„ `arr` ï¼Œè¯·ä½ è®¡ç®—æ‰€æœ‰å¯èƒ½çš„å¥‡æ•°é•¿åº¦å­æ•°ç»„çš„å’Œã€‚

**å­æ•°ç»„** å®šä¹‰ä¸ºåŸæ•°ç»„ä¸­çš„ä¸€ä¸ªè¿ç»­å­åºåˆ—ã€‚

è¯·ä½ è¿”å› `arr` ä¸­ **æ‰€æœ‰å¥‡æ•°é•¿åº¦å­æ•°ç»„çš„å’Œ** ã€‚

**ç¤ºä¾‹ 1ï¼š**

> **è¾“å…¥ï¼š** arr = [1,4,2,5,3]
>
> **è¾“å‡ºï¼š** 58
>
> **è§£é‡Šï¼š** æ‰€æœ‰å¥‡æ•°é•¿åº¦å­æ•°ç»„å’Œå®ƒä»¬çš„å’Œä¸ºï¼š
> [1] = 1
> [4] = 4
> [2] = 2
> [5] = 5
> [3] = 3
> [1,4,2] = 7
> [4,2,5] = 11
> [2,5,3] = 10
> [1,4,2,5,3] = 15
>
> æˆ‘ä»¬å°†æ‰€æœ‰å€¼æ±‚å’Œå¾—åˆ° 1 + 4 + 2 + 5 + 3 + 7 + 11 + 10 + 15 = 58

**ç¤ºä¾‹ 2ï¼š**

> **è¾“å…¥ï¼š** arr = [1,2]
>
> **è¾“å‡ºï¼š** 3
>
> **è§£é‡Šï¼š** æ€»å…±åªæœ‰ 2 ä¸ªé•¿åº¦ä¸ºå¥‡æ•°çš„å­æ•°ç»„ï¼Œ[1] å’Œ [2]ã€‚å®ƒä»¬çš„å’Œä¸º 3 ã€‚

**ç¤ºä¾‹ 3ï¼š**

> **è¾“å…¥ï¼š** arr = [10,11,12]
>
> **è¾“å‡ºï¼š** 66

**æç¤ºï¼š**

- `1 <= arr.length <= 100`
- `1 <= arr[i] <= 1000`

**è¿›é˜¶ï¼š**

ä½ å¯ä»¥è®¾è®¡ä¸€ä¸ª `O(n)` æ—¶é—´å¤æ‚åº¦çš„ç®—æ³•è§£å†³æ­¤é—®é¢˜å—ï¼Ÿ

## è§£é¢˜æ€è·¯

æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¡ç®—æ¯ä¸ªå…ƒç´ åœ¨æ‰€æœ‰å¥‡æ•°é•¿åº¦å­æ•°ç»„ä¸­å‡ºç°çš„æ¬¡æ•°ï¼Œè€Œä¸æ˜¯ç›´æ¥æ‰¾åˆ°æ‰€æœ‰çš„å¥‡æ•°é•¿åº¦å­æ•°ç»„ã€‚

å‡è®¾ `arr[i]` å‡ºç°äº† `k` æ¬¡ï¼Œé‚£ä¹ˆå®ƒå¯¹æ€»å’Œçš„è´¡çŒ®å°±æ˜¯ `arr[i] * k`ã€‚

![](https://leetcode.com/problems/sum-of-all-odd-length-subarrays/Figures/1588/1588-2.png)

1. **å¦‚ä½•è®¡ç®—æ¯ä¸ªç´¢å¼•çš„å‡ºç°æ¬¡æ•°ï¼Ÿ**

   æ¯ä¸ªå¥‡æ•°é•¿åº¦çš„å­æ•°ç»„ä¸­ï¼Œå½“å‰ç´¢å¼• `arr[i]` æ‰€åœ¨çš„å­æ•°ç»„ï¼Œå¿…é¡»æ»¡è¶³å½“å‰ç´¢å¼•ä¸¤ä¾§çš„å…ƒç´ æ•°é‡ç›¸åŠ ä¸ºå¶æ•°ã€‚è¿™æ„å‘³ç€ï¼Œå½“å‰ç´¢å¼•å·¦ä¾§å’Œå³ä¾§çš„å…ƒç´ ä¸ªæ•°å¿…é¡» **éƒ½ä¸ºå¶æ•°** æˆ– **éƒ½ä¸ºå¥‡æ•°**ã€‚

   ![](https://leetcode.com/problems/sum-of-all-odd-length-subarrays/Figures/1588/1588-3.png)

2. **è®¡ç®—è§„å¾‹ï¼š**

   - æˆ‘ä»¬éœ€è¦è®¡ç®—ä»¥ä¸‹å››ç§æƒ…å†µï¼š
     - `odd_left`ï¼šä»å½“å‰ç´¢å¼•å·¦ä¾§ç»“æŸçš„å¥‡æ•°é•¿åº¦å­æ•°ç»„çš„æ•°é‡ã€‚
     - `odd_right`ï¼šä»å½“å‰ç´¢å¼•å³ä¾§å¼€å§‹çš„å¥‡æ•°é•¿åº¦å­æ•°ç»„çš„æ•°é‡ã€‚
     - `even_left`ï¼šä»å½“å‰ç´¢å¼•å·¦ä¾§ç»“æŸçš„å¶æ•°é•¿åº¦å­æ•°ç»„çš„æ•°é‡ã€‚
     - `even_right`ï¼šä»å½“å‰ç´¢å¼•å³ä¾§å¼€å§‹çš„å¶æ•°é•¿åº¦å­æ•°ç»„çš„æ•°é‡ã€‚
   - å…ƒç´  `arr[i]` åœ¨å¥‡æ•°é•¿åº¦å­æ•°ç»„ä¸­å‡ºç°çš„æ¬¡æ•°ä¸ºï¼š
     `odd_left * odd_right + even_left * even_right`

3. **è®¡ç®—å…¬å¼ï¼š**

   - åˆå§‹åŒ–ç­”æ¡ˆ `sum = 0`ã€‚
   - éå†æ•°ç»„ `arr`ï¼Œå¯¹äºæ¯ä¸ªç´¢å¼• `i`ï¼š
   - ä»å½“å‰ç´¢å¼• `i` å·¦ä¾§ç»“æŸçš„å­æ•°ç»„å…±æœ‰ `i + 1` ä¸ªï¼Œå…¶ä¸­ï¼š
     - å¥‡æ•°é•¿åº¦å­æ•°ç»„çš„æ•°é‡ä¸º `odd_left = (i + 1) / 2`ã€‚
     - å¶æ•°é•¿åº¦å­æ•°ç»„çš„æ•°é‡ä¸º `even_left = i / 2 + 1`ã€‚
   - ä»å½“å‰ç´¢å¼• `i` å³ä¾§å¼€å§‹çš„å­æ•°ç»„å…±æœ‰ `n - i` ä¸ªï¼Œå…¶ä¸­ï¼š

     - å¥‡æ•°é•¿åº¦å­æ•°ç»„çš„æ•°é‡ä¸º `odd_right = (n - i - 1) / 2 + 1`ã€‚
     - å¶æ•°é•¿åº¦å­æ•°ç»„çš„æ•°é‡ä¸º `even_right = (n - i) / 2`ã€‚

   - å°† `arr[i]` åœ¨å¥‡æ•°é•¿åº¦å­æ•°ç»„ä¸­å‡ºç°çš„æ¬¡æ•°ï¼Œç´¯åŠ åˆ°ç­”æ¡ˆä¸­ï¼š
     `sum += arr[i] * (odd_left * odd_right + even_left * even_right)`
   - éå†å®Œæ‰€æœ‰å…ƒç´ çš„è´¡çŒ®å€¼åè¿”å›æ€»å’Œã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œå…¶ä¸­ `n` æ˜¯æ•°ç»„é•¿åº¦ï¼Œä»…éå†æ•°ç»„ä¸€æ¬¡ï¼Œæ¯æ¬¡è®¡ç®—å¸¸æ•°æ¬¡æ•°å­¦å…¬å¼ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(1)`ï¼Œåªä½¿ç”¨äº†å¸¸æ•°çº§é¢å¤–ç©ºé—´ã€‚

## ä»£ç 

```javascript
/**
 * @param {number[]} arr
 * @return {number}
 */
var sumOddLengthSubarrays = function (arr) {
	const n = arr.length;
	let sum = 0;

	for (let i = 0; i < n; i++) {
		const left = i,
			right = n - i - 1;

		// è®¡ç®—å½“å‰å…ƒç´ å¯¹ç»“æœçš„è´¡çŒ®
		const oddCount = (Math.floor(left / 2) + 1) * (Math.floor(right / 2) + 1);
		const evenCount = Math.floor((left + 1) / 2) * Math.floor((right + 1) / 2);

		sum += arr[i] * (oddCount + evenCount);
	}

	return sum;
};
```

```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ | åŠ›æ‰£ |
| :------: | :------ | :------: | :------ | :------: | :------: |
| 2778 | ç‰¹æ®Šå…ƒç´ å¹³æ–¹å’Œ |  |  [`æ•°ç»„`](/tag/array.md) [`æšä¸¾`](/tag/enumeration.md) | ğŸŸ¢ | [ğŸ€„ï¸](https://leetcode.cn/problems/sum-of-squares-of-special-elements) [ğŸ”—](https://leetcode.com/problems/sum-of-squares-of-special-elements) |