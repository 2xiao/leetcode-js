---
title: 427. å»ºç«‹å››å‰æ ‘
description: LeetCode 427. å»ºç«‹å››å‰æ ‘é¢˜è§£ï¼ŒConstruct Quad Treeï¼ŒåŒ…å«è§£é¢˜æ€è·¯ã€å¤æ‚åº¦åˆ†æä»¥åŠå®Œæ•´çš„ JavaScript ä»£ç å®ç°ã€‚
keywords:
  - LeetCode
  - 427. å»ºç«‹å››å‰æ ‘
  - å»ºç«‹å››å‰æ ‘
  - Construct Quad Tree
  - è§£é¢˜æ€è·¯
  - æ ‘
  - æ•°ç»„
  - åˆ†æ²»
  - çŸ©é˜µ
---

# 427. å»ºç«‹å››å‰æ ‘

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ ‘`](/tag/tree.md) [`æ•°ç»„`](/tag/array.md) [`åˆ†æ²»`](/tag/divide-and-conquer.md) [`çŸ©é˜µ`](/tag/matrix.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/construct-quad-tree) [`LeetCode`](https://leetcode.com/problems/construct-quad-tree)

## é¢˜ç›®

Given a `n * n` matrix `grid` of `0's` and `1's` only. We want to represent
`grid` with a Quad-Tree.

Return _the root of the Quad-Tree representing_`grid`.

A Quad-Tree is a tree data structure in which each internal node has exactly
four children. Besides, each node has two attributes:

- `val`: True if the node represents a grid of 1's or False if the node represents a grid of 0's. Notice that you can assign the `val` to True or False when `isLeaf` is False, and both are accepted in the answer.
- `isLeaf`: True if the node is a leaf node on the tree or False if the node has four children.

```
class Node {
    public boolean val;
    public boolean isLeaf;
    public Node topLeft;
    public Node topRight;
    public Node bottomLeft;
    public Node bottomRight;
}
```

We can construct a Quad-Tree from a two-dimensional area using the following
steps:

1. If the current grid has the same value (i.e all `1's` or all `0's`) set `isLeaf` True and set `val` to the value of the grid and set the four children to Null and stop.
2. If the current grid has different values, set `isLeaf` to False and set `val` to any value and divide the current grid into four sub-grids as shown in the photo.
3. Recurse for each of the children with the proper sub-grid.

![](https://assets.leetcode.com/uploads/2020/02/11/new_top.png)

If you want to know more about the Quad-Tree, you can refer to the
[wiki](https://en.wikipedia.org/wiki/Quadtree).

**Quad-Tree format:**

You don't need to read this section for solving the problem. This is only if
you want to understand the output format here. The output represents the
serialized format of a Quad-Tree using level order traversal, where `null`
signifies a path terminator where no node exists below.

It is very similar to the serialization of the binary tree. The only
difference is that the node is represented as a list `[isLeaf, val]`.

If the value of `isLeaf` or `val` is True we represent it as **1** in the list
`[isLeaf, val]` and if the value of `isLeaf` or `val` is False we represent it
as **0**.

**Example 1:**

![](https://assets.leetcode.com/uploads/2020/02/11/grid1.png)

> Input: grid = [[0,1],[1,0]]
>
> Output: [[0,1],[1,0],[1,1],[1,1],[1,0]]
>
> Explanation: The explanation of this example is shown below:
>
> Notice that 0 represents False and 1 represents True in the photo representing the Quad-Tree.
>
> ![](https://assets.leetcode.com/uploads/2020/02/12/e1tree.png)

**Example 2:**

![](https://assets.leetcode.com/uploads/2020/02/12/e2mat.png)

> Input: grid = [[1,1,1,1,0,0,0,0],[1,1,1,1,0,0,0,0],[1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1],[1,1,1,1,0,0,0,0],[1,1,1,1,0,0,0,0],[1,1,1,1,0,0,0,0],[1,1,1,1,0,0,0,0]]
>
> Output: [[0,1],[1,1],[0,1],[1,1],[1,0],null,null,null,null,[1,0],[1,0],[1,1],[1,1]]
>
> Explanation: All values in the grid are not the same. We divide the grid into four sub-grids.
>
> The topLeft, bottomLeft and bottomRight each has the same value.
>
> The topRight have different values so we divide it into 4 sub-grids where each has the same value.
>
> Explanation is shown in the photo below:
>
> ![](https://assets.leetcode.com/uploads/2020/02/12/e2tree.png)

**Constraints:**

- `n == grid.length == grid[i].length`
- `n == 2^x` where `0 <= x <= 6`

## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ª `n * n` çŸ©é˜µ `grid` ï¼ŒçŸ©é˜µç”±è‹¥å¹² `0` å’Œ `1` ç»„æˆã€‚è¯·ä½ ç”¨å››å‰æ ‘è¡¨ç¤ºè¯¥çŸ©é˜µ `grid` ã€‚

ä½ éœ€è¦è¿”å›èƒ½è¡¨ç¤ºçŸ©é˜µ `grid` çš„ **å››å‰æ ‘** çš„æ ¹ç»“ç‚¹ã€‚

å››å‰æ ‘æ•°æ®ç»“æ„ä¸­ï¼Œæ¯ä¸ªå†…éƒ¨èŠ‚ç‚¹åªæœ‰å››ä¸ªå­èŠ‚ç‚¹ã€‚æ­¤å¤–ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸¤ä¸ªå±æ€§ï¼š

- `val`ï¼šå‚¨å­˜å¶å­ç»“ç‚¹æ‰€ä»£è¡¨çš„åŒºåŸŸçš„å€¼ã€‚`1` å¯¹åº” **True** ï¼Œ`0` å¯¹åº” **False** ã€‚æ³¨æ„ï¼Œå½“ `isLeaf` ä¸º **False** æ—¶ï¼Œä½ å¯ä»¥æŠŠ **True** æˆ–è€… **False** èµ‹å€¼ç»™èŠ‚ç‚¹ï¼Œä¸¤ç§å€¼éƒ½ä¼šè¢«åˆ¤é¢˜æœºåˆ¶ **æ¥å—** ã€‚
- `isLeaf`: å½“è¿™ä¸ªèŠ‚ç‚¹æ˜¯ä¸€ä¸ªå¶å­ç»“ç‚¹æ—¶ä¸º **True** ï¼Œå¦‚æœå®ƒæœ‰ `4` ä¸ªå­èŠ‚ç‚¹åˆ™ä¸º **False** ã€‚

```
class Node {
    public boolean val;
    public boolean isLeaf;
    public Node topLeft;
    public Node topRight;
    public Node bottomLeft;
    public Node bottomRight;
}
```

æˆ‘ä»¬å¯ä»¥æŒ‰ä»¥ä¸‹æ­¥éª¤ä¸ºäºŒç»´åŒºåŸŸæ„å»ºå››å‰æ ‘ï¼š

1. å¦‚æœå½“å‰ç½‘æ ¼çš„å€¼ç›¸åŒï¼ˆå³ï¼Œå…¨ä¸º `0` æˆ–è€…å…¨ä¸º `1`ï¼‰ï¼Œå°† `isLeaf` è®¾ä¸º True ï¼Œå°† `val` è®¾ä¸ºç½‘æ ¼ç›¸åº”çš„å€¼ï¼Œå¹¶å°†å››ä¸ªå­èŠ‚ç‚¹éƒ½è®¾ä¸º Null ç„¶ååœæ­¢ã€‚
2. å¦‚æœå½“å‰ç½‘æ ¼çš„å€¼ä¸åŒï¼Œå°† `isLeaf` è®¾ä¸º Falseï¼Œ å°† `val` è®¾ä¸ºä»»æ„å€¼ï¼Œç„¶åå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå°†å½“å‰ç½‘æ ¼åˆ’åˆ†ä¸ºå››ä¸ªå­ç½‘æ ¼ã€‚
3. ä½¿ç”¨é€‚å½“çš„å­ç½‘æ ¼é€’å½’æ¯ä¸ªå­èŠ‚ç‚¹ã€‚

![](https://assets.leetcode.com/uploads/2020/02/11/new_top.png)

å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºå››å‰æ ‘çš„å†…å®¹ï¼Œå¯ä»¥å‚è€ƒ [wiki](https://en.wikipedia.org/wiki/Quadtree) ã€‚

**å››å‰æ ‘æ ¼å¼ï¼š**

ä½ ä¸éœ€è¦é˜…è¯»æœ¬èŠ‚æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚åªæœ‰å½“ä½ æƒ³äº†è§£è¾“å‡ºæ ¼å¼æ—¶æ‰ä¼šè¿™æ ·åšã€‚è¾“å‡ºä¸ºä½¿ç”¨å±‚åºéå†åå››å‰æ ‘çš„åºåˆ—åŒ–å½¢å¼ï¼Œå…¶ä¸­ `null`
è¡¨ç¤ºè·¯å¾„ç»ˆæ­¢ç¬¦ï¼Œå…¶ä¸‹é¢ä¸å­˜åœ¨èŠ‚ç‚¹ã€‚

å®ƒä¸äºŒå‰æ ‘çš„åºåˆ—åŒ–éå¸¸ç›¸ä¼¼ã€‚å”¯ä¸€çš„åŒºåˆ«æ˜¯èŠ‚ç‚¹ä»¥åˆ—è¡¨å½¢å¼è¡¨ç¤º `[isLeaf, val]` ã€‚

å¦‚æœ `isLeaf` æˆ–è€… `val` çš„å€¼ä¸º True ï¼Œåˆ™è¡¨ç¤ºå®ƒåœ¨åˆ—è¡¨ `[isLeaf, val]` ä¸­çš„å€¼ä¸º **1** ï¼›å¦‚æœ `isLeaf`
æˆ–è€… `val` çš„å€¼ä¸º `False` ï¼Œåˆ™è¡¨ç¤ºå€¼ä¸º **0** ã€‚

**ç¤ºä¾‹ 1ï¼š**

![](https://assets.leetcode.com/uploads/2020/02/11/grid1.png)

> **è¾“å…¥ï¼š** grid = [[0,1],[1,0]]
>
> **è¾“å‡ºï¼š**[[0,1],[1,0],[1,1],[1,1],[1,0]]
>
> **è§£é‡Šï¼š** æ­¤ç¤ºä¾‹çš„è§£é‡Šå¦‚ä¸‹ï¼š
>
> è¯·æ³¨æ„ï¼Œåœ¨ä¸‹é¢å››å‰æ ‘çš„å›¾ç¤ºä¸­ï¼Œ0 è¡¨ç¤º falseï¼Œ1 è¡¨ç¤º True ã€‚
>
> ![](https://assets.leetcode.com/uploads/2020/02/12/e1tree.png)

**ç¤ºä¾‹ 2ï¼š**

![](https://assets.leetcode.com/uploads/2020/02/12/e2mat.png)

> **è¾“å…¥ï¼š** grid = [[1,1,1,1,0,0,0,0],[1,1,1,1,0,0,0,0],[1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1],[1,1,1,1,0,0,0,0],[1,1,1,1,0,0,0,0],[1,1,1,1,0,0,0,0],[1,1,1,1,0,0,0,0]]
>
> **è¾“å‡ºï¼š**[[0,1],[1,1],[0,1],[1,1],[1,0],null,null,null,null,[1,0],[1,0],[1,1],[1,1]]
>
> **è§£é‡Šï¼š** ç½‘æ ¼ä¸­çš„æ‰€æœ‰å€¼éƒ½ä¸ç›¸åŒã€‚æˆ‘ä»¬å°†ç½‘æ ¼åˆ’åˆ†ä¸ºå››ä¸ªå­ç½‘æ ¼ã€‚
>
> topLeftï¼ŒbottomLeft å’Œ bottomRight å‡å…·æœ‰ç›¸åŒçš„å€¼ã€‚
>
> topRight å…·æœ‰ä¸åŒçš„å€¼ï¼Œå› æ­¤æˆ‘ä»¬å°†å…¶å†åˆ†ä¸º 4 ä¸ªå­ç½‘æ ¼ï¼Œè¿™æ ·æ¯ä¸ªå­ç½‘æ ¼éƒ½å…·æœ‰ç›¸åŒçš„å€¼ã€‚
>
> è§£é‡Šå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
>
> ![](https://assets.leetcode.com/uploads/2020/02/12/e2tree.png)

**æç¤ºï¼š**

1. `n == grid.length == grid[i].length`
2. `n == 2^x` å…¶ä¸­ `0 <= x <= 6`

## è§£é¢˜æ€è·¯

è¿™ä¸ªé—®é¢˜æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª**é€’å½’åˆ’åˆ†é—®é¢˜**ï¼Œç±»ä¼¼äºåˆ†æ²»ç®—æ³•ã€‚éœ€è¦ä¸æ–­åœ°å°†ç½‘æ ¼åˆ’åˆ†ä¸ºå››ä¸ªå­ç½‘æ ¼ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªå¯ä»¥ç”¨å¶å­èŠ‚ç‚¹æ¥è¡¨ç¤ºçš„åŒºåŸŸã€‚

1. æ¯ä¸ªèŠ‚ç‚¹è¦ä¹ˆæ˜¯å¶å­èŠ‚ç‚¹ï¼Œè¦ä¹ˆæ˜¯å†…éƒ¨èŠ‚ç‚¹ï¼š

   - å¦‚æœæ˜¯å¶å­èŠ‚ç‚¹ï¼Œå®ƒå°†åŒ…å«å­ç½‘æ ¼çš„å•ä¸€å€¼ï¼ˆ`0` æˆ– `1`ï¼‰ï¼›
   - å¦‚æœæ˜¯å†…éƒ¨èŠ‚ç‚¹ï¼Œå®ƒå°†æœ‰å››ä¸ªæŒ‡é’ˆæŒ‡å‘å­èŠ‚ç‚¹ã€‚

2. é€’å½’åœ°æ„å»ºå››å‰æ ‘ï¼š

   - å¦‚æœå½“å‰ç½‘æ ¼æ˜¯åŒä¸€ä¸ªå€¼ï¼ˆå³æ‰€æœ‰å•å…ƒæ ¼éƒ½ä¸º `0` æˆ–éƒ½ä¸º `1`ï¼‰ï¼Œåˆ™æ„é€ ä¸€ä¸ªå¶å­èŠ‚ç‚¹ã€‚
   - å¦åˆ™ï¼Œå¯¹å½“å‰ç½‘æ ¼çš„å››ä¸ªå­åŒºåŸŸï¼ˆå·¦ä¸Šã€å³ä¸Šã€å·¦ä¸‹ã€å³ä¸‹ï¼‰åˆ†åˆ«é€’å½’æ„é€ å­èŠ‚ç‚¹ã€‚

3. ç»ˆæ­¢æ¡ä»¶ï¼š

   - å½“ç½‘æ ¼åŒºåŸŸç¼©å°åˆ°åªæœ‰ä¸€ä¸ªå•å…ƒæ ¼æ—¶ï¼Œç›´æ¥è¿”å›è¯¥å•å…ƒæ ¼çš„å€¼ä½œä¸ºå¶å­èŠ‚ç‚¹ã€‚
   - å½“æ‰€æœ‰å•å…ƒæ ¼çš„å€¼ç›¸åŒï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªå¶å­èŠ‚ç‚¹ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**: `O(n^2 * log n)`ï¼Œå…¶ä¸­ `n` æ˜¯ `grid` çš„è¾¹é•¿ã€‚éœ€è¦é€’å½’åœ°åˆ’åˆ†ç½‘æ ¼å¹¶æ£€æŸ¥æ¯ä¸ªå­ç½‘æ ¼çš„å€¼ã€‚ç”±äºç½‘æ ¼åˆ’åˆ†çš„æ–¹å¼ç±»ä¼¼äºå››å‰æ ‘ï¼Œæ¯æ¬¡é€’å½’å°†ç½‘æ ¼çš„å¤§å°å‡åŠã€‚
- **ç©ºé—´å¤æ‚åº¦**: `O(log n)`ï¼Œå› ä¸ºé€’å½’æ ˆçš„æ·±åº¦ä¸ç½‘æ ¼å¤§å°å‘ˆå¯¹æ•°å…³ç³»ã€‚

## ä»£ç 

```javascript
/**
 * // Definition for a QuadTree node.
 * function _Node(val,isLeaf,topLeft,topRight,bottomLeft,bottomRight) {
 *    this.val = val;
 *    this.isLeaf = isLeaf;
 *    this.topLeft = topLeft;
 *    this.topRight = topRight;
 *    this.bottomLeft = bottomLeft;
 *    this.bottomRight = bottomRight;
 * };
 */

/**
 * @param {number[][]} grid
 * @return {_Node}
 */
var construct = function (grid) {
	const buildTree = (rowStart, rowEnd, colStart, colEnd) => {
		let first = grid[rowStart][colStart],
			isLeaf = true;
		out: for (let i = rowStart; i < rowEnd; i++) {
			for (let j = colStart; j < colEnd; j++) {
				if (grid[i][j] !== first) {
					isLeaf = false;
					break out;
				}
			}
		}

		if (isLeaf) {
			return new Node(first == 1, true, null, null, null, null);
		} else {
			const rowMid = ((rowStart + rowEnd) / 2) | 0;
			const colMid = ((colStart + colEnd) / 2) | 0;
			return new Node(
				true,
				false,
				buildTree(rowStart, rowMid, colStart, colMid), // top-left
				buildTree(rowStart, rowMid, colMid, colEnd), // top-right
				buildTree(rowMid, rowEnd, colStart, colMid), // bottom-left
				buildTree(rowMid, rowEnd, colMid, colEnd) // bottom-right
			);
		}
	};
	const n = grid.length;
	return buildTree(0, n, 0, n);
};
```
