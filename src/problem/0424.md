---
title: 424. æ›¿æ¢åçš„æœ€é•¿é‡å¤å­—ç¬¦
description: LeetCode 424. æ›¿æ¢åçš„æœ€é•¿é‡å¤å­—ç¬¦é¢˜è§£ï¼ŒLongest Repeating Character Replacementï¼ŒåŒ…å«è§£é¢˜æ€è·¯ã€å¤æ‚åº¦åˆ†æä»¥åŠå®Œæ•´çš„ JavaScript ä»£ç å®ç°ã€‚
keywords:
  - LeetCode
  - 424. æ›¿æ¢åçš„æœ€é•¿é‡å¤å­—ç¬¦
  - æ›¿æ¢åçš„æœ€é•¿é‡å¤å­—ç¬¦
  - Longest Repeating Character Replacement
  - è§£é¢˜æ€è·¯
  - å“ˆå¸Œè¡¨
  - å­—ç¬¦ä¸²
  - æ»‘åŠ¨çª—å£
---

# 424. æ›¿æ¢åçš„æœ€é•¿é‡å¤å­—ç¬¦

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`å­—ç¬¦ä¸²`](/tag/string.md) [`æ»‘åŠ¨çª—å£`](/tag/sliding-window.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/longest-repeating-character-replacement) [`LeetCode`](https://leetcode.com/problems/longest-repeating-character-replacement)

## é¢˜ç›®

You are given a string `s` and an integer `k`. You can choose any character of
the string and change it to any other uppercase English character. You can
perform this operation at most `k` times.

Return _the length of the longest substring containing the same letter you can get after performing the above operations_.

**Example 1:**

> Input: s = "ABAB", k = 2
>
> Output: 4
>
> Explanation: Replace the two 'A's with two 'B's or vice versa.

**Example 2:**

> Input: s = "AABABBA", k = 1
>
> Output: 4
>
> Explanation: Replace the one 'A' in the middle with 'B' and form "AABBBBA".
>
> The substring "BBBB" has the longest repeating letters, which is 4.
>
> There may exists other ways to achieve this answer too.

**Constraints:**

- `1 <= s.length <= 10^5`
- `s` consists of only uppercase English letters.
- `0 <= k <= s.length`

## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² `s` å’Œä¸€ä¸ªæ•´æ•° `k` ã€‚ä½ å¯ä»¥é€‰æ‹©å­—ç¬¦ä¸²ä¸­çš„ä»»ä¸€å­—ç¬¦ï¼Œå¹¶å°†å…¶æ›´æ”¹ä¸ºä»»ä½•å…¶ä»–å¤§å†™è‹±æ–‡å­—ç¬¦ã€‚è¯¥æ“ä½œæœ€å¤šå¯æ‰§è¡Œ `k` æ¬¡ã€‚

åœ¨æ‰§è¡Œä¸Šè¿°æ“ä½œåï¼Œè¿”å› _åŒ…å«ç›¸åŒå­—æ¯çš„æœ€é•¿å­å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚_

**ç¤ºä¾‹ 1ï¼š**

> **è¾“å…¥ï¼š** s = "ABAB", k = 2
>
> **è¾“å‡ºï¼š** 4
>
> **è§£é‡Šï¼š** ç”¨ä¸¤ä¸ª'A'æ›¿æ¢ä¸ºä¸¤ä¸ª'B',åä¹‹äº¦ç„¶ã€‚

**ç¤ºä¾‹ 2ï¼š**

> **è¾“å…¥ï¼š** s = "AABABBA", k = 1
>
> **è¾“å‡ºï¼š** 4
>
> **è§£é‡Šï¼š**
>
> å°†ä¸­é—´çš„ä¸€ä¸ª'A'æ›¿æ¢ä¸º'B',å­—ç¬¦ä¸²å˜ä¸º "AABBBBA"ã€‚
>
> å­ä¸² "BBBB" æœ‰æœ€é•¿é‡å¤å­—æ¯, ç­”æ¡ˆä¸º 4ã€‚
>
> å¯èƒ½å­˜åœ¨å…¶ä»–çš„æ–¹æ³•æ¥å¾—åˆ°åŒæ ·çš„ç»“æœã€‚

**æç¤ºï¼š**

- `1 <= s.length <= 10^5`
- `s` ä»…ç”±å¤§å†™è‹±æ–‡å­—æ¯ç»„æˆ
- `0 <= k <= s.length`

## è§£é¢˜æ€è·¯

1. **ä½¿ç”¨æ»‘åŠ¨çª—å£**

   - ç»´æŠ¤ä¸€ä¸ªçª—å£ `[left, right]`ï¼Œè¡¨ç¤ºå½“å‰å­ä¸²ã€‚
   - è®¡ç®—çª—å£ä¸­å‡ºç°æœ€å¤šçš„å­—ç¬¦ `maxFreq`ã€‚
   - è®¡ç®—çª—å£å¤§å° `(right - left + 1)` ä¸ `maxFreq` çš„å·®å€¼ï¼Œåˆ¤æ–­æ˜¯å¦èƒ½é€šè¿‡ `k` æ¬¡æ›¿æ¢ä½¿æ•´ä¸ªçª—å£å˜æˆç›¸åŒå­—ç¬¦ã€‚

2. **çª—å£æ‰©å±•**

   - å³æŒ‡é’ˆ `right` å‘å³ç§»åŠ¨ï¼Œè®°å½•å­—ç¬¦å‡ºç°é¢‘æ¬¡ï¼Œå¹¶æ›´æ–° `maxFreq`ã€‚

3. **çª—å£æ”¶ç¼©**

   - å¦‚æœçª—å£å¤§å° `> maxFreq + k`ï¼Œè¡¨ç¤ºéœ€è¦æ›¿æ¢çš„å­—ç¬¦è¶…è¿‡ `k`ï¼Œå› æ­¤å·¦æŒ‡é’ˆ `left` å³ç§»æ”¶ç¼©çª—å£ã€‚

4. **æ›´æ–°æœ€å¤§å­ä¸²é•¿åº¦**
   - åœ¨çª—å£æ»¡è¶³æ¡ä»¶æ—¶ï¼Œæ›´æ–° `res = max(res, right - left + 1)`ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œå³æŒ‡é’ˆ `right` çº¿æ€§æ‰«æ `s`ï¼Œæ¯ä¸ªå­—ç¬¦æœ€å¤šè¢«å·¦æŒ‡é’ˆ `left` è®¿é—®ä¸€æ¬¡ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(1)`ï¼Œä»…ä½¿ç”¨ä¸€ä¸ª `Map` ç»Ÿè®¡å­—ç¬¦é¢‘æ¬¡ï¼Œæœ€å¤š 26 ä¸ªè‹±æ–‡å­—æ¯ã€‚

## ä»£ç 

```javascript
/**
 * @param {string} s
 * @param {number} k
 * @return {number}
 */
var characterReplacement = function (s, k) {
	let count = new Map();
	let maxFreq = (res = left = 0);

	// çª—å£æ‰©å±•
	for (let right = 0; right < s.length; right++) {
		const char = s[right];
		const freq = (count.get(char) || 0) + 1;
		count.set(char, freq);

		// è®¡ç®—çª—å£ä¸­å‡ºç°æœ€å¤šçš„å­—ç¬¦
		maxFreq = Math.max(freq, maxFreq);

		// çª—å£æ”¶ç¼©
		while (right - left + 1 - maxFreq > k) {
			count.set(s[left], count.get(s[left]) - 1);
			left++;
		}

		// æ›´æ–°æœ€å¤§å­ä¸²é•¿åº¦
		res = Math.max(res, right - left + 1);
	}
	return res;
};
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ | åŠ›æ‰£ |
| :------: | :------ | :------: | :------ | :------: | :------: |
| 340 | è‡³å¤šåŒ…å« K ä¸ªä¸åŒå­—ç¬¦çš„æœ€é•¿å­ä¸² ğŸ”’ |  |  [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`å­—ç¬¦ä¸²`](/tag/string.md) [`æ»‘åŠ¨çª—å£`](/tag/sliding-window.md) | ğŸŸ  | [ğŸ€„ï¸](https://leetcode.cn/problems/longest-substring-with-at-most-k-distinct-characters) [ğŸ”—](https://leetcode.com/problems/longest-substring-with-at-most-k-distinct-characters) |
| 1004 | æœ€å¤§è¿ç»­1çš„ä¸ªæ•° III | [[âœ“]](/problem/1004.md) |  [`æ•°ç»„`](/tag/array.md) [`äºŒåˆ†æŸ¥æ‰¾`](/tag/binary-search.md) [`å‰ç¼€å’Œ`](/tag/prefix-sum.md) `1+` | ğŸŸ  | [ğŸ€„ï¸](https://leetcode.cn/problems/max-consecutive-ones-iii) [ğŸ”—](https://leetcode.com/problems/max-consecutive-ones-iii) |
| 2009 | ä½¿æ•°ç»„è¿ç»­çš„æœ€å°‘æ“ä½œæ•° |  |  [`æ•°ç»„`](/tag/array.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`äºŒåˆ†æŸ¥æ‰¾`](/tag/binary-search.md) `1+` | ğŸ”´ | [ğŸ€„ï¸](https://leetcode.cn/problems/minimum-number-of-operations-to-make-array-continuous) [ğŸ”—](https://leetcode.com/problems/minimum-number-of-operations-to-make-array-continuous) |
| 2024 | è€ƒè¯•çš„æœ€å¤§å›°æ‰°åº¦ |  |  [`å­—ç¬¦ä¸²`](/tag/string.md) [`äºŒåˆ†æŸ¥æ‰¾`](/tag/binary-search.md) [`å‰ç¼€å’Œ`](/tag/prefix-sum.md) `1+` | ğŸŸ  | [ğŸ€„ï¸](https://leetcode.cn/problems/maximize-the-confusion-of-an-exam) [ğŸ”—](https://leetcode.com/problems/maximize-the-confusion-of-an-exam) |
| 2213 | ç”±å•ä¸ªå­—ç¬¦é‡å¤çš„æœ€é•¿å­å­—ç¬¦ä¸² |  |  [`çº¿æ®µæ ‘`](/tag/segment-tree.md) [`æ•°ç»„`](/tag/array.md) [`å­—ç¬¦ä¸²`](/tag/string.md) `1+` | ğŸ”´ | [ğŸ€„ï¸](https://leetcode.cn/problems/longest-substring-of-one-repeating-character) [ğŸ”—](https://leetcode.com/problems/longest-substring-of-one-repeating-character) |