# [1963. ä½¿å­—ç¬¦ä¸²å¹³è¡¡çš„æœ€å°äº¤æ¢æ¬¡æ•°](https://leetcode.com/problems/minimum-number-of-swaps-to-make-the-string-balanced)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ ˆ`](/outline/tag/stack.md) [`è´ªå¿ƒ`](/outline/tag/greedy.md) [`åŒæŒ‡é’ˆ`](/outline/tag/two-pointers.md) [`å­—ç¬¦ä¸²`](/outline/tag/string.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/minimum-number-of-swaps-to-make-the-string-balanced)

## é¢˜ç›®

You are given a **0-indexed** string `s` of **even** length `n`. The string
consists of **exactly** `n / 2` opening brackets `'['` and `n / 2` closing
brackets `']'`.

A string is called **balanced** if and only if:

- It is the empty string, or
- It can be written as `AB`, where both `A` and `B` are **balanced** strings, or
- It can be written as `[C]`, where `C` is a **balanced** string.

You may swap the brackets at **any** two indices **any** number of times.

Return _the**minimum** number of swaps to make_ `s` _**balanced**_.

**Example 1:**

> Input: s = `"][]["`
>
> Output: 1
>
> Explanation: You can make the string balanced by swapping index 0 with index 3.
>
> The resulting string is `"[[]]"`.

**Example 2:**

> Input: s = `"]]][[["`
>
> Output: 2
>
> Explanation: You can do the following to make the string balanced:
>
> - Swap index 0 with index 4. s = `"[]][]["`.
> - Swap index 1 with index 5. s = `"[[][]]"`.
>
> The resulting string is` "[[][]]"`.

**Example 3:**

> Input: s = `"[]"`
>
> Output: 0
>
> Explanation: The string is already balanced.

**Constraints:**

- `n == s.length`
- `2 <= n <= 10^6`
- `n` is even.
- `s[i]` is either `'[' `or `']'`.
- The number of opening brackets `'['` equals `n / 2`, and the number of closing brackets `']'` equals `n / 2`.

## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² `s` ï¼Œ**ä¸‹æ ‡ä» 0 å¼€å§‹** ï¼Œä¸”é•¿åº¦ä¸ºå¶æ•° `n` ã€‚å­—ç¬¦ä¸² **æ°å¥½** ç”± `n / 2` ä¸ªå¼€æ‹¬å· `'['` å’Œ `n / 2` ä¸ªé—­æ‹¬å· `']'` ç»„æˆã€‚

åªæœ‰èƒ½æ»¡è¶³ä¸‹è¿°æ‰€æœ‰æ¡ä»¶çš„å­—ç¬¦ä¸²æ‰èƒ½ç§°ä¸º **å¹³è¡¡å­—ç¬¦ä¸²** ï¼š

- å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œæˆ–è€…
- å­—ç¬¦ä¸²å¯ä»¥è®°ä½œ `AB` ï¼Œå…¶ä¸­ `A` å’Œ `B` éƒ½æ˜¯ **å¹³è¡¡å­—ç¬¦ä¸²** ï¼Œæˆ–è€…
- å­—ç¬¦ä¸²å¯ä»¥å†™æˆ `[C]` ï¼Œå…¶ä¸­ `C` æ˜¯ä¸€ä¸ª **å¹³è¡¡å­—ç¬¦ä¸²** ã€‚

ä½ å¯ä»¥äº¤æ¢ **ä»»æ„** ä¸¤ä¸ªä¸‹æ ‡æ‰€å¯¹åº”çš„æ‹¬å· **ä»»æ„** æ¬¡æ•°ã€‚

è¿”å›ä½¿ `s` å˜æˆ **å¹³è¡¡å­—ç¬¦ä¸²** æ‰€éœ€è¦çš„ **æœ€å°** äº¤æ¢æ¬¡æ•°ã€‚

**ç¤ºä¾‹ 1ï¼š**

> **è¾“å…¥ï¼š** s = `"][]["`
>
> **è¾“å‡ºï¼š** 1
>
> **è§£é‡Šï¼š** äº¤æ¢ä¸‹æ ‡ 0 å’Œä¸‹æ ‡ 3 å¯¹åº”çš„æ‹¬å·ï¼Œå¯ä»¥ä½¿å­—ç¬¦ä¸²å˜æˆå¹³è¡¡å­—ç¬¦ä¸²ã€‚
>
> æœ€ç»ˆå­—ç¬¦ä¸²å˜æˆ `"[[]]"` ã€‚

**ç¤ºä¾‹ 2ï¼š**

> **è¾“å…¥ï¼š** s = `"]]][[["`
>
> **è¾“å‡ºï¼š** 2
>
> **è§£é‡Šï¼š** æ‰§è¡Œä¸‹è¿°æ“ä½œå¯ä»¥ä½¿å­—ç¬¦ä¸²å˜æˆå¹³è¡¡å­—ç¬¦ä¸²ï¼š
>
> - äº¤æ¢ä¸‹æ ‡ 0 å’Œä¸‹æ ‡ 4 å¯¹åº”çš„æ‹¬å·ï¼Œs = `"[]][]["` ã€‚
> - äº¤æ¢ä¸‹æ ‡ 1 å’Œä¸‹æ ‡ 5 å¯¹åº”çš„æ‹¬å·ï¼Œs = `"[[][]]"` ã€‚
>
> æœ€ç»ˆå­—ç¬¦ä¸²å˜æˆ `"[[][]]"` ã€‚

**ç¤ºä¾‹ 3ï¼š**

> **è¾“å…¥ï¼š** s = `"[]"`
>
> **è¾“å‡ºï¼š** 0
>
> **è§£é‡Šï¼š** è¿™ä¸ªå­—ç¬¦ä¸²å·²ç»æ˜¯å¹³è¡¡å­—ç¬¦ä¸²ã€‚

**æç¤ºï¼š**

- `n == s.length`
- `2 <= n <= 10^6`
- `n` ä¸ºå¶æ•°
- `s[i]` ä¸º`'['` æˆ– `']'`
- å¼€æ‹¬å· `'['` çš„æ•°ç›®ä¸º `n / 2` ï¼Œé—­æ‹¬å· `']'` çš„æ•°ç›®ä¹Ÿæ˜¯ `n / 2`

## è§£é¢˜æ€è·¯

å½“éå†å­—ç¬¦ä¸²æ—¶ï¼Œå¦‚æœå‘ç°å³æ‹¬å· `]` çš„æ•°é‡æ¯”å·¦æ‹¬å· `[` çš„æ•°é‡å¤šï¼Œè¿™è¡¨ç¤ºå½“å‰å­—ç¬¦ä¸²å·²ç»ä¸å¹³è¡¡äº†ã€‚æ­¤æ—¶ï¼Œéœ€è¦è¿›è¡Œäº¤æ¢æ¥ä¿®å¤è¿™ç§ä¸å¹³è¡¡ã€‚

åœ¨éå†å­—ç¬¦ä¸²çš„è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥ç»´æŠ¤ä¸€ä¸ªå˜é‡ `imbalance` æ¥è·Ÿè¸ªå½“å‰ä¸å¹³è¡¡çš„å³æ‹¬å·æ•°é‡ã€‚

æ¯æ¬¡é‡åˆ°ä¸å¹³è¡¡çš„åœ°æ–¹æ—¶ï¼Œè¯´æ˜é‡åˆ°äº†å¤šä½™çš„å³æ‹¬ï¼Œéœ€è¦ä¸€ä¸ªä¹‹åçš„å·¦æ‹¬å·ä¸å³æ‹¬å·äº¤æ¢æ¥å‡å°‘ `imbalance`ã€‚æ¯æ¬¡äº¤æ¢å¯ä»¥å¹³è¡¡ä¸€å¯¹æ‹¬å·ï¼Œå› æ­¤æ€»å…±éœ€è¦çš„äº¤æ¢æ¬¡æ•°ï¼ˆå³ `imbalance` çš„æœ€å¤§å€¼ï¼‰å°±æ˜¯å­—ç¬¦ä¸²ä¸­çš„ä¸å¹³è¡¡å¯¹æ•°ã€‚

1. åˆå§‹åŒ– `imbalance` ä¸º 0ï¼Œç”¨äºè®°å½•å½“å‰ä¸å¹³è¡¡çš„å³æ‹¬å·æ•°é‡ã€‚
2. éå†å­—ç¬¦ä¸²ä¸­çš„æ¯ä¸ªå­—ç¬¦ï¼š
   - å¦‚æœæ˜¯å·¦æ‹¬å· `[`ï¼Œåˆ™å¹³è¡¡å¢åŠ ï¼Œ`imbalance` å‡å°‘ã€‚
   - å¦‚æœæ˜¯å³æ‹¬å· `]`ï¼Œåˆ™ä¸å¹³è¡¡å¢åŠ ï¼Œ`imbalance` å¢åŠ ã€‚
3. æ¯æ¬¡ `imbalance` é€’å¢æ—¶ï¼Œè¡¨ç¤ºå½“å‰å³æ‹¬å·è¿‡å¤šï¼Œéœ€è¦è¿›è¡Œä¸€æ¬¡äº¤æ¢ã€‚
4. éå†ç»“æŸåï¼Œäº¤æ¢æ¬¡æ•°å³ä¸ºéœ€è¦çš„æœ€å°äº¤æ¢æ¬¡æ•°ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œå…¶ä¸­ n æ˜¯å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚æˆ‘ä»¬åªéœ€éå†ä¸€æ¬¡å­—ç¬¦ä¸²ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(1)`ï¼Œåªéœ€è¦å¸¸æ•°ç©ºé—´æ¥å­˜å‚¨ `imbalance` å’Œ `maxImbalance`ã€‚

## ä»£ç 

```javascript
/**
 * @param {string} s
 * @return {number}
 */
var minSwaps = function (s) {
	let imbalance = 0,
		maxImbalance = 0;

	for (let char of s) {
		if (char === '[') {
			imbalance--;
		} else {
			imbalance++;
		}
		// è®°å½•æœ€å¤§ä¸å¹³è¡¡
		maxImbalance = Math.max(maxImbalance, imbalance);
	}

	// æœ€å°äº¤æ¢æ¬¡æ•°æ˜¯æœ€å¤§ä¸å¹³è¡¡çš„ä¸€åŠï¼Œå‘ä¸Šå–æ•´
	return Math.ceil(maxImbalance / 2);
};
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 301 | [åˆ é™¤æ— æ•ˆçš„æ‹¬å·](https://leetcode.com/problems/remove-invalid-parentheses) |  |  [`å¹¿åº¦ä¼˜å…ˆæœç´¢`](/outline/tag/breadth-first-search.md) [`å­—ç¬¦ä¸²`](/outline/tag/string.md) [`å›æº¯`](/outline/tag/backtracking.md) | <font color=#ff334b>Hard</font> |
| 921 | [ä½¿æ‹¬å·æœ‰æ•ˆçš„æœ€å°‘æ·»åŠ ](https://leetcode.com/problems/minimum-add-to-make-parentheses-valid) | [[âœ“]](/problem/0921) |  [`æ ˆ`](/outline/tag/stack.md) [`è´ªå¿ƒ`](/outline/tag/greedy.md) [`å­—ç¬¦ä¸²`](/outline/tag/string.md) | <font color=#ffb800>Medium</font> |
| 1249 | [ç§»é™¤æ— æ•ˆçš„æ‹¬å·](https://leetcode.com/problems/minimum-remove-to-make-valid-parentheses) |  |  [`æ ˆ`](/outline/tag/stack.md) [`å­—ç¬¦ä¸²`](/outline/tag/string.md) | <font color=#ffb800>Medium</font> |
| 1541 | [å¹³è¡¡æ‹¬å·å­—ç¬¦ä¸²çš„æœ€å°‘æ’å…¥æ¬¡æ•°](https://leetcode.com/problems/minimum-insertions-to-balance-a-parentheses-string) |  |  [`æ ˆ`](/outline/tag/stack.md) [`è´ªå¿ƒ`](/outline/tag/greedy.md) [`å­—ç¬¦ä¸²`](/outline/tag/string.md) | <font color=#ffb800>Medium</font> |

<style>
.blue {
    background-color: #096dd9;
    padding: 0.25rem 0.5rem;
    margin: 0;
    font-size: 0.85em;
    border-radius: 3px;
    color: white;
    font-weight: 500;
}
table th:first-of-type { width: 10%; }
table th:nth-of-type(2) { width: 35%; }
table th:nth-of-type(3) { width: 10%; }
table th:nth-of-type(4) { width: 35%; }
table th:nth-of-type(5) { width: 10%; }
</style>
