---
title: 177. ç¬¬Né«˜çš„è–ªæ°´
description: LeetCode 177. ç¬¬Né«˜çš„è–ªæ°´é¢˜è§£ï¼ŒNth Highest Salaryï¼ŒåŒ…å«è§£é¢˜æ€è·¯ã€å¤æ‚åº¦åˆ†æä»¥åŠå®Œæ•´çš„ JavaScript ä»£ç å®ç°ã€‚
keywords:
  - LeetCode
  - 177. ç¬¬Né«˜çš„è–ªæ°´
  - ç¬¬Né«˜çš„è–ªæ°´
  - Nth Highest Salary
  - è§£é¢˜æ€è·¯
  - æ•°æ®åº“
---

# 177. ç¬¬ N é«˜çš„è–ªæ°´

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/nth-highest-salary) [`LeetCode`](https://leetcode.com/problems/nth-highest-salary)

## é¢˜ç›®

Table: `Employee`

> ```
> +-------------+------+
> | Column Name | Type |
> +-------------+------+
> | id          | int  |
> | salary      | int  |
> +-------------+------+
> ```
>
> id is the primary key (column with unique values) for this table.
>
> Each row of this table contains information about the salary of an employee.

Write a solution to find the `nth` highest salary from the `Employee` table.
If there is no `nth` highest salary, return `null`.

The result format is in the following example.

**Example 1:**

> Input:
>
> Employee table:
>
> ```
> +----+--------+
> | id | salary |
> +----+--------+
> | 1  | 100    |
> | 2  | 200    |
> | 3  | 300    |
> +----+--------+
>
> n = 2
> ```
>
> Output:
>
> ```
> +------------------------+
> | getNthHighestSalary(2) |
> +------------------------+
> | 200                    |
> +------------------------+
> ```

**Example 2:**

> Input:
>
> Employee table:
>
> ```
> +----+--------+
> | id | salary |
> +----+--------+
> | 1  | 100    |
> +----+--------+
> n = 2
> ```
>
> Output:
>
> ```
> +------------------------+
> | getNthHighestSalary(2) |
> +------------------------+
> | null                   |
> +------------------------+
> ```

## é¢˜ç›®å¤§æ„

è¡¨: `Employee`

> ```
> +-------------+------+
> | Column Name | Type |
> +-------------+------+
> | id          | int  |
> | salary      | int  |
> +-------------+------+
> ```
>
> åœ¨ SQL ä¸­ï¼Œid æ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚
>
> è¯¥è¡¨çš„æ¯ä¸€è¡Œéƒ½åŒ…å«æœ‰å…³å‘˜å·¥å·¥èµ„çš„ä¿¡æ¯ã€‚

æŸ¥è¯¢ `Employee` è¡¨ä¸­ç¬¬ `n` é«˜çš„å·¥èµ„ã€‚å¦‚æœæ²¡æœ‰ç¬¬ `n` ä¸ªæœ€é«˜å·¥èµ„ï¼ŒæŸ¥è¯¢ç»“æœåº”è¯¥ä¸º `null` ã€‚

æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚

**ç¤ºä¾‹ 1:**

> **è¾“å…¥:**
>
> Employee è¡¨:
>
> ```
> +----+--------+
> | id | salary |
> +----+--------+
> | 1  | 100    |
> +----+--------+
> n = 2
> ```
>
> **è¾“å‡º:**
>
> ```
> +------------------------+
> | getNthHighestSalary(2) |
> +------------------------+
> | null                   |
> +------------------------+
> ```

**ç¤ºä¾‹ 2:**

> **è¾“å…¥:**
>
> Employee è¡¨:
>
> ```
> +----+--------+
> | id | salary |
> +----+--------+
> | 1  | 100    |
> +----+--------+
> n = 2
> ```
>
> **è¾“å‡º:**
>
> ```
> +------------------------+
> | getNthHighestSalary(2) |
> +------------------------+
> | null                   |
> +------------------------+
> ```

## è§£é¢˜æ€è·¯

- å»é‡æ’åºï¼šæå–å·¥èµ„åˆ—ï¼Œä½¿ç”¨ `drop_duplicates()` å»é‡ï¼Œå¹¶æŒ‰é™åºæ’åºã€‚
- æ£€æŸ¥ç´¢å¼•ï¼šæ ¹æ® `n` çš„å€¼å®šä½åˆ°æ’åºåå·¥èµ„åˆ—è¡¨çš„ç¬¬ `n` ä¸ªå…ƒç´ ã€‚å¦‚æœ `n` è¶…è¿‡å·¥èµ„åˆ—è¡¨é•¿åº¦ï¼Œè¿”å› `null`ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n log n)`
  - `drop_duplicates`ï¼š`O(n)`ï¼Œæå–å”¯ä¸€å·¥èµ„ã€‚
  - `sort_values`ï¼š`O(n log n)`ï¼Œå¯¹å·¥èµ„è¿›è¡Œæ’åºã€‚
  - æ€»ä½“å¤æ‚åº¦ä¸º `O(n log n)`ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`drop_duplicates` å’Œæ’åºæ“ä½œéœ€è¦é¢å¤–å­˜å‚¨å”¯ä¸€å·¥èµ„åˆ—è¡¨ï¼Œç©ºé—´å¤æ‚åº¦ä¸º `O(n)`ã€‚

## ä»£ç 

```python
import pandas as pd

def nth_highest_salary(employee: pd.DataFrame, N: int) -> pd.DataFrame:
    # æå–å”¯ä¸€å·¥èµ„å¹¶é™åºæ’åº
    sorted_salary = employee['salary'].drop_duplicates().sort_values(ascending=False)
    # è‹¥ n è¶…è¿‡èŒƒå›´åˆ™è¿”å› null
    if N > len(sorted_salary) or N <= 0:
        return pd.DataFrame({f'getNthHighestSalary({N})':[pd.NA]})
    # è¿”å›ç¬¬ n é«˜å·¥èµ„
    else:
        return pd.DataFrame({f'getNthHighestSalary({N})':[sorted_salary.iloc[N - 1]]})
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ | åŠ›æ‰£ |
| :------: | :------ | :------: | :------ | :------: | :------: |
| 2205 | æœ‰èµ„æ ¼äº«å—æŠ˜æ‰£çš„ç”¨æˆ·æ•°é‡ ğŸ”’ |  |  [`æ•°æ®åº“`](/tag/database.md) | ğŸŸ¢ | [ğŸ€„ï¸](https://leetcode.cn/problems/the-number-of-users-that-are-eligible-for-discount) [ğŸ”—](https://leetcode.com/problems/the-number-of-users-that-are-eligible-for-discount) |