---
title: 306. ç´¯åŠ æ•°
description: LeetCode 306. ç´¯åŠ æ•°é¢˜è§£ï¼ŒAdditive Numberï¼ŒåŒ…å«è§£é¢˜æ€è·¯ã€å¤æ‚åº¦åˆ†æä»¥åŠå®Œæ•´çš„ JavaScript ä»£ç å®ç°ã€‚
keywords:
  - LeetCode
  - 306. ç´¯åŠ æ•°
  - ç´¯åŠ æ•°
  - Additive Number
  - è§£é¢˜æ€è·¯
  - å­—ç¬¦ä¸²
  - å›æº¯
---

# 306. ç´¯åŠ æ•°

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`å­—ç¬¦ä¸²`](/tag/string.md) [`å›æº¯`](/tag/backtracking.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/additive-number) [`LeetCode`](https://leetcode.com/problems/additive-number)

## é¢˜ç›®

An **additive number** is a string whose digits can form an **additive sequence**.

A valid **additive sequence** should contain **at least** three numbers.
Except for the first two numbers, each subsequent number in the sequence must
be the sum of the preceding two.

Given a string containing only digits, return `true` if it is an **additive
number** or `false` otherwise.

**Note:** Numbers in the additive sequence **cannot** have leading zeros, so
sequence `1, 2, 03` or `1, 02, 3` is invalid.

**Example 1:**

> Input: "112358"
>
> Output: true
>
> Explanation:
>
> The digits can form an additive sequence: 1, 1, 2, 3, 5, 8.
>
> 1 + 1 = 2, 1 + 2 = 3, 2 + 3 = 5, 3 + 5 = 8

**Example 2:**

> Input: "199100199"
>
> Output: true
>
> Explanation:
>
> The additive sequence is: 1, 99, 100, 199.
>
> 1 + 99 = 100, 99 + 100 = 199

**Constraints:**

- `1 <= num.length <= 35`
- `num` consists only of digits.

**Follow up:** How would you handle overflow for very large input integers?

## é¢˜ç›®å¤§æ„

**ç´¯åŠ æ•°** æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç»„æˆå®ƒçš„æ•°å­—å¯ä»¥å½¢æˆç´¯åŠ åºåˆ—ã€‚

ä¸€ä¸ªæœ‰æ•ˆçš„ **ç´¯åŠ åºåˆ—** å¿…é¡»**è‡³å°‘** åŒ…å« 3 ä¸ªæ•°ã€‚é™¤äº†æœ€å¼€å§‹çš„ä¸¤ä¸ªæ•°ä»¥å¤–ï¼Œåºåˆ—ä¸­çš„æ¯ä¸ªåç»­æ•°å­—å¿…é¡»æ˜¯å®ƒä¹‹å‰ä¸¤ä¸ªæ•°å­—ä¹‹å’Œã€‚

ç»™ä½ ä¸€ä¸ªåªåŒ…å«æ•°å­— `'0'-'9'` çš„å­—ç¬¦ä¸²ï¼Œç¼–å†™ä¸€ä¸ªç®—æ³•æ¥åˆ¤æ–­ç»™å®šè¾“å…¥æ˜¯å¦æ˜¯ **ç´¯åŠ æ•°** ã€‚å¦‚æœæ˜¯ï¼Œè¿”å› `true` ï¼›å¦åˆ™ï¼Œè¿”å›
`false` ã€‚

**è¯´æ˜ï¼š** ç´¯åŠ åºåˆ—é‡Œçš„æ•°ï¼Œé™¤æ•°å­— 0 ä¹‹å¤–ï¼Œ**ä¸ä¼š** ä»¥ 0 å¼€å¤´ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç° `1, 2, 03` æˆ–è€… `1, 02, 3` çš„æƒ…å†µã€‚

**ç¤ºä¾‹ 1ï¼š**

> **è¾“å…¥ï¼š**"112358"
>
> **è¾“å‡ºï¼š** true
>
> **è§£é‡Šï¼š** ç´¯åŠ åºåˆ—ä¸º: 1, 1, 2, 3, 5, 8 ã€‚1 + 1 = 2, 1 + 2 = 3, 2 + 3 = 5, 3 + 5 = 8

**ç¤ºä¾‹ 2ï¼š**

> **è¾“å…¥ï¼š**"199100199"
>
> **è¾“å‡ºï¼š** true
>
> **è§£é‡Šï¼š** ç´¯åŠ åºåˆ—ä¸º: 1, 99, 100, 199ã€‚1 + 99 = 100, 99 + 100 = 199

**æç¤ºï¼š**

- `1 <= num.length <= 35`
- `num` ä»…ç”±æ•°å­—ï¼ˆ`0 - 9`ï¼‰ç»„æˆ

**è¿›é˜¶ï¼š** ä½ è®¡åˆ’å¦‚ä½•å¤„ç†ç”±è¿‡å¤§çš„æ•´æ•°è¾“å…¥å¯¼è‡´çš„æº¢å‡º?

## è§£é¢˜æ€è·¯

### æ€è·¯ä¸€ï¼šå›æº¯æ³•

1. å®šä¹‰ä¸€ä¸ªæ•°ç»„ `track`ï¼Œå­˜å‚¨å½“å‰é€‰å–çš„ç´¯åŠ æ•°åºåˆ—ã€‚
2. ä»å­—ç¬¦ä¸²çš„èµ·å§‹ä½ç½® `start` å¼€å§‹é€’å½’ï¼š
   - ç»ˆæ­¢æ¡ä»¶ï¼šå½“å­—ç¬¦ä¸²éå†å®Œä¸”ç´¯åŠ æ•°åºåˆ—é•¿åº¦ â‰¥ 3 æ—¶ï¼Œè¿”å› `true`ã€‚
   - æšä¸¾ä» `start` åˆ° `num.length` çš„æ‰€æœ‰å­ä¸²ï¼š
     1. å¦‚æœå­ä¸²æœ‰å‰å¯¼é›¶ä¸”é•¿åº¦å¤§äº 1ï¼Œåˆ™è·³è¿‡ã€‚
     2. å°†å­ä¸²è½¬æ¢ä¸ºæ•°å­— `next`ï¼Œåˆ¤æ–­æ˜¯å¦æ»¡è¶³ç´¯åŠ æ•°æ€§è´¨ï¼š
        - å¦‚æœæ»¡è¶³ï¼Œå°†å…¶åŠ å…¥ `track` å¹¶é€’å½’ã€‚
        - å¦‚æœé€’å½’æˆåŠŸï¼Œåˆ™ç›´æ¥è¿”å› `true`ã€‚
        - å¦åˆ™ï¼Œå›æº¯ï¼Œç§»é™¤å½“å‰æ•°å­—ã€‚
   - å‰ªæä¼˜åŒ–ï¼šå¦‚æœå½“å‰å­ä¸²çš„å€¼ä¸ç­‰äºå‰ä¸¤ä¸ªæ•°å­—ä¹‹å’Œï¼Œç›´æ¥è·³è¿‡å½“å‰åˆ†å‰²ã€‚
3. å¦‚æœæ‰€æœ‰åˆ†å‰²å‡ä¸æ»¡è¶³æ¡ä»¶ï¼Œè¿”å› `false`ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(2^n)`ï¼Œæ¯ä¸ªå­—ç¬¦éƒ½æœ‰ä¸¤ç§é€‰æ‹©ï¼ˆåŠ å…¥å½“å‰æ•°å­—æˆ–ä¸åŠ å…¥ï¼‰ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œé€’å½’æ ˆå’Œå­˜å‚¨è·¯å¾„çš„æ•°ç»„ã€‚

---

### æ€è·¯äºŒï¼šè¿­ä»£æ³•

1. ä½¿ç”¨ä¸¤å±‚å¾ªç¯æšä¸¾å‰ä¸¤ä¸ªæ•°å­—çš„åˆ†å‰²ä½ç½®ï¼Œç¡®å®šåˆå§‹çš„ä¸¤ä¸ªç´¯åŠ æ•°ï¼š
   - ç¬¬ä¸€å±‚å¾ªç¯ç¡®å®šç¬¬ä¸€ä¸ªæ•°å­—çš„é•¿åº¦ã€‚
   - ç¬¬äºŒå±‚å¾ªç¯ç¡®å®šç¬¬äºŒä¸ªæ•°å­—çš„é•¿åº¦ã€‚
2. ä»ç¬¬ä¸‰ä¸ªæ•°å­—å¼€å§‹ï¼Œé€æ­¥éªŒè¯å‰©ä½™éƒ¨åˆ†æ˜¯å¦æ»¡è¶³ç´¯åŠ æ•°æ€§è´¨ã€‚
3. éªŒè¯è¿‡ç¨‹ï¼š
   - åˆå§‹åŒ–ä¸¤ä¸ªç´¯åŠ æ•° `first` å’Œ `second`ã€‚
   - ä»å‰©ä½™å­—ç¬¦ä¸²ä¸­é€ä¸ªåŒ¹é…ç´¯åŠ å’Œï¼š
     - å¦‚æœåŒ¹é…æˆåŠŸï¼Œåˆ™æ›´æ–°ç´¯åŠ æ•°ï¼Œç»§ç»­éªŒè¯ä¸‹ä¸€ä¸ªæ•°å­—ã€‚
     - å¦‚æœä¸åŒ¹é…ï¼Œç«‹å³ç»ˆæ­¢å½“å‰åˆ†å‰²ã€‚
4. å¦‚æœæŸç§åˆ†å‰²æ–¹å¼æˆåŠŸåŒ¹é…å®Œæ•´ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ™è¿”å› `true`ï¼›å¦åˆ™ï¼Œè¿”å› `false`ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(2^n)`ï¼Œä¸¤å±‚å¾ªç¯æšä¸¾æ‰€æœ‰å¯èƒ½çš„åˆ†å‰²ç‚¹ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(1)`ï¼Œæ— éœ€é¢å¤–çš„é€’å½’æ ˆæˆ–è·¯å¾„å­˜å‚¨ã€‚

## ä»£ç 

::: code-tabs
@tab å›æº¯æ³•

```javascript
/**
 * @param {string} num
 * @return {boolean}
 */
var isAdditiveNumber = function (num) {
	let track = [];

	const backtrack = (start) => {
		if (start === num.length && track.length >= 3) return true;

		for (let i = start; i < num.length; i++) {
			if (num[start] === '0' && i > start) break; // å‰å¯¼é›¶
			const next = Number(num.slice(start, i + 1));

			if (
				track.length >= 2 &&
				track[track.length - 1] + track[track.length - 2] !== next
			) {
				continue;
			}

			track.push(next);
			if (backtrack(i + 1)) return true;
			track.pop();
		}
		return false;
	};

	return backtrack(0);
};
```

@tab è¿­ä»£æ³•

```javascript
/**
 * @param {string} num
 * @return {boolean}
 */
var isAdditiveNumber = function (num) {
	const n = num.length;

	const isValid = (first, second, start) => {
		while (start < n) {
			const sum = first + second;
			const sumStr = sum.toString();

			// å¦‚æœå‰©ä½™çš„å­—ç¬¦ä¸²ä¸ä»¥ sumStr å¼€å¤´ï¼Œç›´æ¥è¿”å› false
			if (!num.startsWith(sumStr, start)) return false;

			// ç§»åŠ¨åˆ°ä¸‹ä¸€æ®µ
			start += sumStr.length;

			// æ›´æ–° first å’Œ second
			[first, second] = [second, sum];
		}
		return true;
	};

	for (let i = 1; i < n; i++) {
		if (i > 1 && num[0] === '0') break; // ç¬¬ä¸€ä¸ªæ•°å­—ä¸èƒ½æœ‰å‰å¯¼é›¶
		const first = Number(num.slice(0, i));

		for (let j = i + 1; j < n; j++) {
			if (j > i + 1 && num[i] === '0') break; // ç¬¬äºŒä¸ªæ•°å­—ä¸èƒ½æœ‰å‰å¯¼é›¶
			const second = Number(num.slice(i, j));

			// æ£€æŸ¥ä» j å¼€å§‹çš„åºåˆ—æ˜¯å¦æ»¡è¶³ç´¯åŠ æ•°æ€§è´¨
			if (isValid(first, second, j)) return true;
		}
	}

	return false;
};
```

:::

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ | åŠ›æ‰£ |
| :------: | :------ | :------: | :------ | :------: | :------: |
| 842 | å°†æ•°ç»„æ‹†åˆ†æˆæ–æ³¢é‚£å¥‘åºåˆ— |  |  [`å­—ç¬¦ä¸²`](/tag/string.md) [`å›æº¯`](/tag/backtracking.md) | ğŸŸ  | [ğŸ€„ï¸](https://leetcode.cn/problems/split-array-into-fibonacci-sequence) [ğŸ”—](https://leetcode.com/problems/split-array-into-fibonacci-sequence) |