---
title: 2349. è®¾è®¡æ•°å­—å®¹å™¨ç³»ç»Ÿ
description: LeetCode 2349. è®¾è®¡æ•°å­—å®¹å™¨ç³»ç»Ÿé¢˜è§£ï¼ŒDesign a Number Container Systemï¼ŒåŒ…å«è§£é¢˜æ€è·¯ã€å¤æ‚åº¦åˆ†æä»¥åŠå®Œæ•´çš„ JavaScript ä»£ç å®ç°ã€‚
keywords:
  - LeetCode
  - 2349. è®¾è®¡æ•°å­—å®¹å™¨ç³»ç»Ÿ
  - è®¾è®¡æ•°å­—å®¹å™¨ç³»ç»Ÿ
  - Design a Number Container System
  - è§£é¢˜æ€è·¯
  - è®¾è®¡
  - å“ˆå¸Œè¡¨
  - æœ‰åºé›†åˆ
  - å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰
---

# 2349. è®¾è®¡æ•°å­—å®¹å™¨ç³»ç»Ÿ

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`è®¾è®¡`](/tag/design.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`æœ‰åºé›†åˆ`](/tag/ordered-set.md) [`å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰`](/tag/heap-priority-queue.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/design-a-number-container-system) [`LeetCode`](https://leetcode.com/problems/design-a-number-container-system)

## é¢˜ç›®

Design a number container system that can do the following:

- **Insert** or **Replace** a number at the given index in the system.
- **Return** the smallest index for the given number in the system.

Implement the `NumberContainers` class:

- `NumberContainers()` Initializes the number container system.
- `void change(int index, int number)` Fills the container at `index` with the `number`. If there is already a number at that `index`, replace it.
- `int find(int number)` Returns the smallest index for the given `number`, or `-1` if there is no index that is filled by `number` in the system.

**Example 1:**

> **Input**
>
> ["NumberContainers", "find", "change", "change", "change", "change", "find", "change", "find"]
>
> [[], [10], [2, 10], [1, 10], [3, 10], [5, 10], [10], [1, 20], [10]]
>
> **Output**
>
> [null, -1, null, null, null, null, 1, null, 2]
>
> **Explanation**
>
> ```js
> NumberContainers nc = new NumberContainers();
>
> nc.find(10); // There is no index that is filled with number 10. Therefore, we return -1.
>
> nc.change(2, 10); // Your container at index 2 will be filled with number 10.
>
> nc.change(1, 10); // Your container at index 1 will be filled with number 10.
>
> nc.change(3, 10); // Your container at index 3 will be filled with number 10.
>
> nc.change(5, 10); // Your container at index 5 will be filled with number 10.
>
> nc.find(10); // Number 10 is at the indices 1, 2, 3, and 5. Since the smallest index that is filled with 10 is 1, we return 1.
>
> nc.change(1, 20); // Your container at index 1 will be filled with number 20. Note that index 1 was filled with 10 and then replaced with 20.
>
> nc.find(10); // Number 10 is at the indices 2, 3, and 5. The smallest index that is filled with 10 is 2. Therefore, we return 2.
> ```

**Constraints:**

- `1 <= index, number <= 10^9`
- At most `10^5` calls will be made **in total** to `change` and `find`.

## é¢˜ç›®å¤§æ„

è®¾è®¡ä¸€ä¸ªæ•°å­—å®¹å™¨ç³»ç»Ÿï¼Œå¯ä»¥å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š

- åœ¨ç³»ç»Ÿä¸­ç»™å®šä¸‹æ ‡å¤„ **æ’å…¥** æˆ–è€… **æ›¿æ¢** ä¸€ä¸ªæ•°å­—ã€‚
- **è¿”å›** ç³»ç»Ÿä¸­ç»™å®šæ•°å­—çš„æœ€å°ä¸‹æ ‡ã€‚

è¯·ä½ å®ç°ä¸€ä¸ª `NumberContainers` ç±»ï¼š

- `NumberContainers()` åˆå§‹åŒ–æ•°å­—å®¹å™¨ç³»ç»Ÿã€‚
- `void change(int index, int number)` åœ¨ä¸‹æ ‡ `index` å¤„å¡«å…¥ `number` ã€‚å¦‚æœè¯¥ä¸‹æ ‡ `index` å¤„å·²ç»æœ‰æ•°å­—äº†ï¼Œé‚£ä¹ˆç”¨ `number` æ›¿æ¢è¯¥æ•°å­—ã€‚
- `int find(int number)` è¿”å›ç»™å®šæ•°å­— `number` åœ¨ç³»ç»Ÿä¸­çš„æœ€å°ä¸‹æ ‡ã€‚å¦‚æœç³»ç»Ÿä¸­æ²¡æœ‰ `number` ï¼Œé‚£ä¹ˆè¿”å› `-1` ã€‚

**ç¤ºä¾‹ï¼š**

> **è¾“å…¥ï¼š**
>
> ["NumberContainers", "find", "change", "change", "change", "change", "find", "change", "find"]
>
> [[], [10], [2, 10], [1, 10], [3, 10], [5, 10], [10], [1, 20], [10]]
>
> **è¾“å‡ºï¼š**
>
> [null, -1, null, null, null, null, 1, null, 2]
>
> **è§£é‡Šï¼š**
>
> ```js
> NumberContainers nc = new NumberContainers();
>
> nc.find(10); // æ²¡æœ‰æ•°å­— 10 ï¼Œæ‰€ä»¥è¿”å› -1 ã€‚
>
> nc.change(2, 10); // å®¹å™¨ä¸­ä¸‹æ ‡ä¸º 2 å¤„å¡«å…¥æ•°å­— 10 ã€‚
>
> nc.change(1, 10); // å®¹å™¨ä¸­ä¸‹æ ‡ä¸º 1 å¤„å¡«å…¥æ•°å­— 10 ã€‚
>
> nc.change(3, 10); // å®¹å™¨ä¸­ä¸‹æ ‡ä¸º 3 å¤„å¡«å…¥æ•°å­— 10 ã€‚
>
> nc.change(5, 10); // å®¹å™¨ä¸­ä¸‹æ ‡ä¸º 5 å¤„å¡«å…¥æ•°å­— 10 ã€‚
>
> nc.find(10); // æ•°å­— 10 æ‰€åœ¨çš„ä¸‹æ ‡ä¸º 1 ï¼Œ2 ï¼Œ3 å’Œ 5 ã€‚å› ä¸ºæœ€å°ä¸‹æ ‡ä¸º 1 ï¼Œæ‰€ä»¥è¿”å› 1 ã€‚
>
> nc.change(1, 20); // å®¹å™¨ä¸­ä¸‹æ ‡ä¸º 1 å¤„å¡«å…¥æ•°å­— 20 ã€‚æ³¨æ„ï¼Œä¸‹æ ‡ 1 å¤„ä¹‹å‰ä¸º 10 ï¼Œç°åœ¨è¢«æ›¿æ¢ä¸º 20 ã€‚
>
> nc.find(10); // æ•°å­— 10 æ‰€åœ¨ä¸‹æ ‡ä¸º 2 ï¼Œ3 å’Œ 5 ã€‚æœ€å°ä¸‹æ ‡ä¸º 2 ï¼Œæ‰€ä»¥è¿”å› 2 ã€‚
> ```

**æç¤ºï¼š**

- `1 <= index, number <= 10^9`
- è°ƒç”¨ `change` å’Œ `find` çš„ **æ€»æ¬¡æ•°** ä¸è¶…è¿‡ `10^5` æ¬¡ã€‚

## è§£é¢˜æ€è·¯

1. **åŒå‘æ˜ å°„å­˜å‚¨**

   - `indexMap`ï¼šç”¨äºè®°å½•æ¯ä¸ªç´¢å¼•å¯¹åº”çš„æ•°å€¼ã€‚
   - `numberMap`ï¼šæ¯ä¸ªæ•°å€¼ç»´æŠ¤ä¸€ä¸ªæœ€å°å †ï¼ˆ`MinHeap`ï¼‰ï¼Œå­˜å‚¨è¯¥æ•°å€¼å¯¹åº”çš„ç´¢å¼•ã€‚

2. **å †ç»´æŠ¤æœ€å°ç´¢å¼•**

   - ä½¿ç”¨ `MinHeap` æ¥é«˜æ•ˆç®¡ç†æ¯ä¸ªæ•°å€¼çš„ç´¢å¼•ï¼Œå¹¶æ”¯æŒå¿«é€Ÿè·å–æœ€å°ç´¢å¼•ã€‚

3. **å †æ¸…ç†ä¼˜åŒ–**

   - ç”±äºæ•°å€¼å˜åŒ–å¯èƒ½å¯¼è‡´å †ä¸­å­˜å‚¨çš„ç´¢å¼•æ— æ•ˆï¼Œéœ€è¦åœ¨ `find()` æ“ä½œä¸­åŠ¨æ€æ¸…ç†å †é¡¶æ— æ•ˆç´¢å¼•ã€‚

4. **ä»£ç é€»è¾‘è¯¦è§£**

- **`change(index, number)`**

  - è‹¥ç´¢å¼•çš„æ•°å€¼æœªå‘ç”Ÿå˜åŒ–ç›´æ¥è¿”å›ã€‚
  - å¦‚æœç´¢å¼•åŸæœ¬å­˜åœ¨æ—§å€¼ï¼Œå°†è¯¥æ—§å€¼çš„ç´¢å¼•æ ‡è®°ä¸ºæ— æ•ˆã€‚
  - å°†æ–°çš„æ•°å€¼æ’å…¥ `numberMap` ä¸­çš„å †ã€‚

- **`find(number)`**

  - è‹¥ `number` ä¸å­˜åœ¨æˆ–å…¶å †ä¸ºç©ºï¼Œè¿”å› `-1`ã€‚
  - æ¸…ç†å †ä¸­æ— æ•ˆçš„ç´¢å¼•ï¼Œç›´åˆ°å †é¡¶ä¸ºæœ‰æ•ˆç´¢å¼•æˆ–å †ä¸ºç©ºã€‚
  - è¿”å›æœ€å°æœ‰æ•ˆç´¢å¼•ã€‚

- **`MinHeap` å®ç°**
  - `insert()`ï¼šæ’å…¥æ–°ç´¢å¼•å¹¶ä¸Šæµ®è°ƒæ•´å †ã€‚
  - `pop()`ï¼šå¼¹å‡ºå †é¡¶å…ƒç´ å¹¶ä¸‹æ²‰è°ƒæ•´å †ã€‚
  - `top()`ï¼šè·å–å †é¡¶å…ƒç´ ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**
  - `change()`ï¼š`O(log n)`ï¼Œæ’å…¥æˆ–åˆ é™¤å †å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦ã€‚
  - `find()`ï¼šæœ€åæƒ…å†µä¸‹ `O(log n)`ï¼Œéœ€è¦æ¸…ç†æ— æ•ˆç´¢å¼•ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œå­˜å‚¨æ‰€æœ‰ç´¢å¼•åŠæ•°å€¼å¯¹åº”å…³ç³»çš„ç©ºé—´ã€‚

## ä»£ç 

```javascript
var NumberContainers = function () {
	this.indexMap = new Map();
	this.numberMap = new Map();
};

/**
 * @param {number} index
 * @param {number} number
 * @return {void}
 */
NumberContainers.prototype.change = function (index, number) {
	if (this.indexMap.get(index) == number) return;
	this.indexMap.set(index, number);
	if (!this.numberMap.has(number)) {
		this.numberMap.set(number, new MinHeap());
	}
	this.numberMap.get(number).insert(index);
};

/**
 * @param {number} number
 * @return {number}
 */
NumberContainers.prototype.find = function (number) {
	if (!this.numberMap.has(number) || this.numberMap.get(number).size() == 0) {
		return -1;
	}
	let heap = this.numberMap.get(number);
	while (heap.size() > 0 && this.indexMap.get(heap.top()) !== number) {
		heap.pop();
	}
	return heap.size() == 0 ? -1 : heap.top();
};

class MinHeap {
	constructor() {
		this.heap = [];
	}
	insert(num) {
		this.heap.push(num);
		this.heapifyUp(this.heap.length - 1);
	}
	pop() {
		if (this.heap.length == 0) return null;
		const top = this.heap[0];
		const last = this.heap.pop();
		if (this.heap.length) {
			this.heap[0] = last;
			this.heapifyDown(0);
		}
		return top;
	}
	top() {
		return this.heap[0];
	}
	size() {
		return this.heap.length;
	}
	heapifyUp(i) {
		while (i) {
			const parent = ((i - 1) / 2) | 0;
			if (this.heap[parent] > this.heap[i]) {
				[this.heap[i], this.heap[parent]] = [this.heap[parent], this.heap[i]];
				i = parent;
			} else {
				break;
			}
		}
	}
	heapifyDown(i) {
		let left = i * 2 + 1,
			right = i * 2 + 2,
			min = i;
		if (left < this.heap.length && this.heap[left] < this.heap[min]) {
			min = left;
		}
		if (right < this.heap.length && this.heap[right] < this.heap[min]) {
			min = right;
		}
		if (min !== i) {
			[this.heap[i], this.heap[min]] = [this.heap[min], this.heap[i]];
			this.heapifyDown(min);
		}
	}
}
/**
 * Your NumberContainers object will be instantiated and called as such:
 * var obj = new NumberContainers()
 * obj.change(index,number)
 * var param_2 = obj.find(number)
 */
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ | åŠ›æ‰£ |
| :------: | :------ | :------: | :------ | :------: | :------: |
| 1845 | åº§ä½é¢„çº¦ç®¡ç†ç³»ç»Ÿ |  |  [`è®¾è®¡`](/tag/design.md) [`å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰`](/tag/heap-priority-queue.md) | ğŸŸ  | [ğŸ€„ï¸](https://leetcode.cn/problems/seat-reservation-manager) [ğŸ”—](https://leetcode.com/problems/seat-reservation-manager) |
| 2353 | è®¾è®¡é£Ÿç‰©è¯„åˆ†ç³»ç»Ÿ |  |  [`è®¾è®¡`](/tag/design.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`æœ‰åºé›†åˆ`](/tag/ordered-set.md) `1+` | ğŸŸ  | [ğŸ€„ï¸](https://leetcode.cn/problems/design-a-food-rating-system) [ğŸ”—](https://leetcode.com/problems/design-a-food-rating-system) |