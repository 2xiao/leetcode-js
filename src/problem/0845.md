# [845. æ•°ç»„ä¸­çš„æœ€é•¿å±±è„‰](https://2xiao.github.io/leetcode-js/problem/0845.html)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°ç»„`](/tag/array.md) [`åŒæŒ‡é’ˆ`](/tag/two-pointers.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md) [`æšä¸¾`](/tag/enumeration.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/longest-mountain-in-array) [`LeetCode`](https://leetcode.com/problems/longest-mountain-in-array)

## é¢˜ç›®

You may recall that an array `arr` is a **mountain array** if and only if:

- `arr.length >= 3`
- There exists some index `i` (**0-indexed**) with `0 < i < arr.length - 1` such that:
  - `arr[0] < arr[1] < ... < arr[i - 1] < arr[i]`
  - `arr[i] > arr[i + 1] > ... > arr[arr.length - 1]`

Given an integer array `arr`, return _the length of the longest subarray,
which is a mountain_. Return `0` if there is no mountain subarray.

**Example 1:**

> Input: arr = [2,1,4,7,3,2,5]
>
> Output: 5
>
> Explanation: The largest mountain is [1,4,7,3,2] which has length 5.

**Example 2:**

> Input: arr = [2,2,2]
>
> Output: 0
>
> Explanation: There is no mountain.

**Constraints:**

- `1 <= arr.length <= 10^4`
- `0 <= arr[i] <= 10^4`

**Follow up:**

- Can you solve it using only one pass?
- Can you solve it in `O(1)` space?

## é¢˜ç›®å¤§æ„

æŠŠç¬¦åˆä¸‹åˆ—å±æ€§çš„æ•°ç»„ `arr` ç§°ä¸º **å±±è„‰æ•°ç»„** ï¼š

- `arr.length >= 3`
- å­˜åœ¨ä¸‹æ ‡ `i`ï¼ˆ`0 < i < arr.length - 1`ï¼‰ï¼Œæ»¡è¶³
  - `arr[0] < arr[1] < ... < arr[i - 1] < arr[i]`
  - `arr[i] > arr[i + 1] > ... > arr[arr.length - 1]`

ç»™å‡ºä¸€ä¸ªæ•´æ•°æ•°ç»„ `arr`ï¼Œè¿”å›æœ€é•¿å±±è„‰å­æ•°ç»„çš„é•¿åº¦ã€‚å¦‚æœä¸å­˜åœ¨å±±è„‰å­æ•°ç»„ï¼Œè¿”å› `0` ã€‚

**ç¤ºä¾‹ 1ï¼š**

> **è¾“å…¥ï¼š** arr = [2,1,4,7,3,2,5]
>
> **è¾“å‡ºï¼š** 5
>
> **è§£é‡Šï¼š** æœ€é•¿çš„å±±è„‰å­æ•°ç»„æ˜¯ [1,4,7,3,2]ï¼Œé•¿åº¦ä¸º 5ã€‚

**ç¤ºä¾‹ 2ï¼š**

> **è¾“å…¥ï¼š** arr = [2,2,2]
>
> **è¾“å‡ºï¼š** 0
>
> **è§£é‡Šï¼š** ä¸å­˜åœ¨å±±è„‰å­æ•°ç»„ã€‚

**æç¤ºï¼š**

- `1 <= arr.length <= 10^4`
- `0 <= arr[i] <= 10^4`

**è¿›é˜¶ï¼š**

- ä½ å¯ä»¥ä»…ç”¨ä¸€è¶Ÿæ‰«æè§£å†³æ­¤é—®é¢˜å—ï¼Ÿ
- ä½ å¯ä»¥ç”¨ `O(1)` ç©ºé—´è§£å†³æ­¤é—®é¢˜å—ï¼Ÿ

## è§£é¢˜æ€è·¯

è¦åœ¨ä¸€æ¬¡éå†ä¸­æ‰¾åˆ°æ•°ç»„ä¸­æœ€é•¿çš„å±±è„‰å­æ•°ç»„ï¼Œå¹¶ä¸”ä½¿ç”¨ O(1) çš„ç©ºé—´ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œï¼š

1. **åˆå§‹åŒ–**ï¼šè®¾ç½®å˜é‡æ¥è·Ÿè¸ªå½“å‰å±±è„‰çš„é•¿åº¦å’Œæ‰¾åˆ°çš„æœ€å¤§å±±è„‰é•¿åº¦ã€‚

2. **éå†æ•°ç»„**ï¼šä½¿ç”¨å¾ªç¯éå†æ•°ç»„ï¼Œæ£€æŸ¥æ¯ä¸ªå…ƒç´ æ˜¯å¦æ˜¯å±±è„‰çš„é¡¶ç‚¹ï¼š

   - å¯¹äºæ¯ä¸ªå…ƒç´ ï¼ˆé™¤äº†ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªï¼‰ï¼Œæ£€æŸ¥å®ƒæ˜¯å¦ä¸ºå³°å€¼ï¼ˆå¤§äºå…¶ç›¸é‚»çš„å…ƒç´ ï¼‰ã€‚
   - ä¸€æ—¦æ‰¾åˆ°å³°å€¼ï¼Œå°±å‘å·¦æ‰©å±•ä»¥è®¡æ•°ä¸Šå‡éƒ¨åˆ†çš„é•¿åº¦ï¼Œå†å‘å³æ‰©å±•ä»¥è®¡æ•°ä¸‹é™éƒ¨åˆ†çš„é•¿åº¦ã€‚

3. **æ›´æ–°æœ€å¤§é•¿åº¦**ï¼šæ‰¾åˆ°æœ‰æ•ˆçš„å±±è„‰åï¼Œå¦‚æœå½“å‰å±±è„‰çš„é•¿åº¦å¤§äºå·²çŸ¥çš„æœ€å¤§é•¿åº¦ï¼Œæ›´æ–°æœ€å¤§å±±è„‰é•¿åº¦ã€‚
4. **è·³è¿‡å·²å¤„ç†å…ƒç´ **ï¼šåœ¨å¤„ç†å®Œä¸€ä¸ªå±±è„‰åï¼Œæ›´æ–°ç´¢å¼• `i` ä¸ºå³ä¾§çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œä»¥è·³è¿‡å·²ç»è®¡æ•°çš„éƒ¨åˆ†ï¼Œä¼˜åŒ–éå†ã€‚
5. **è¿”å›ç»“æœ**ï¼šéå†ç»“æŸåï¼Œè¿”å›æ‰¾åˆ°çš„æœ€å¤§å±±è„‰é•¿åº¦ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°å±±è„‰ï¼Œåˆ™è¿”å› 0ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œå…¶ä¸­ `n` æ˜¯æ•°ç»„é•¿åº¦ï¼Œå› ä¸ºåªéå†æ•°ç»„ä¸€æ¬¡ï¼Œå¹¶åœ¨é‡åˆ°å±±è„‰æ—¶è·³è¿‡å·²ç»å¤„ç†çš„å…ƒç´ ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(1)`ï¼Œåªä½¿ç”¨å¸¸æ•°çº§çš„ç©ºé—´æ¥å­˜å‚¨å˜é‡ï¼Œè€Œä¸éšè¾“å…¥è§„æ¨¡è€Œå˜åŒ–ã€‚

## ä»£ç 

```javascript
/**
 * @param {number[]} arr
 * @return {number}
 */
var longestMountain = function (arr) {
	const n = arr.length;
	if (n < 3) return 0;

	let maxMountain = 0;

	for (let i = 1; i < n - 1; i++) {
		// æ£€æŸ¥ arr[i] æ˜¯å¦ä¸ºå³°å€¼
		if (arr[i] > arr[i - 1] && arr[i] > arr[i + 1]) {
			let left = i - 1,
				right = i + 1;
			// è®¡ç®—é€’å¢éƒ¨åˆ†çš„é•¿åº¦
			while (left > 0 && arr[left] > arr[left - 1]) {
				left--;
			}
			// è®¡ç®—é€’å‡éƒ¨åˆ†çš„é•¿åº¦
			while (right < n - 1 && arr[right] > arr[right + 1]) {
				right++;
			}
			// æ›´æ–°æœ€é•¿å±±è„‰å­æ•°ç»„çš„é•¿åº¦
			maxMountain = Math.max(maxMountain, right - left + 1);
			// è·³è¿‡å±±è„‰æ•°ç»„ä¸­çš„å…ƒç´ 
			i = right;
		}
	}
	return maxMountain;
};
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 1671 | [å¾—åˆ°å±±å½¢æ•°ç»„çš„æœ€å°‘åˆ é™¤æ¬¡æ•°](https://leetcode.com/problems/minimum-number-of-removals-to-make-mountain-array) | [[âœ“]](/problem/1671.md) |  [`è´ªå¿ƒ`](/tag/greedy.md) [`æ•°ç»„`](/tag/array.md) [`äºŒåˆ†æŸ¥æ‰¾`](/tag/binary-search.md) `1+` | <font color=#ff334b>Hard</font> |
| 2100 | [é€‚åˆé‡ç‚Šçš„æ—¥å­](https://leetcode.com/problems/find-good-days-to-rob-the-bank) |  |  [`æ•°ç»„`](/tag/array.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md) [`å‰ç¼€å’Œ`](/tag/prefix-sum.md) | <font color=#ffb800>Medium</font> |