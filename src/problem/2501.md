# [2501. æ•°ç»„ä¸­æœ€é•¿çš„æ–¹æ³¢](https://2xiao.github.io/leetcode-js/problem/2501.html)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°ç»„`](/tag/array.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`äºŒåˆ†æŸ¥æ‰¾`](/tag/binary-search.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md) [`æ’åº`](/tag/sorting.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/longest-square-streak-in-an-array) [`LeetCode`](https://leetcode.com/problems/longest-square-streak-in-an-array)

## é¢˜ç›®

You are given an integer array `nums`. A subsequence of `nums` is called a
**square streak** if:

- The length of the subsequence is at least `2`, and
- **after** sorting the subsequence, each element (except the first element) is the **square** of the previous number.

Return _the length of the**longest square streak** in_ `nums` _, or return_ `-1` _if there is no **square streak**._

A **subsequence** is an array that can be derived from another array by
deleting some or no elements without changing the order of the remaining
elements.

**Example 1:**

> Input: nums = [4,3,6,16,8,2]
>
> Output: 3
>
> Explanation: Choose the subsequence [4,16,2]. After sorting it, it becomes [2,4,16].
>
> - 4 = 2 \* 2.
> - 16 = 4 \* 4.
>
> Therefore, [4,16,2] is a square streak.
>
> It can be shown that every subsequence of length 4 is not a square streak.

**Example 2:**

> Input: nums = [2,3,5,6,7]
>
> Output: -1
>
> Explanation: There is no square streak in nums so return -1.

**Constraints:**

- `2 <= nums.length <= 10^5`
- `2 <= nums[i] <= 10^5`

## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums` ã€‚å¦‚æœ `nums` çš„å­åºåˆ—æ»¡è¶³ä¸‹è¿°æ¡ä»¶ï¼Œåˆ™è®¤ä¸ºè¯¥å­åºåˆ—æ˜¯ä¸€ä¸ª **æ–¹æ³¢** ï¼š

- å­åºåˆ—çš„é•¿åº¦è‡³å°‘ä¸º `2` ï¼Œå¹¶ä¸”
- å°†å­åºåˆ—ä»å°åˆ°å¤§æ’åº **ä¹‹å** ï¼Œé™¤ç¬¬ä¸€ä¸ªå…ƒç´ å¤–ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æ˜¯å‰ä¸€ä¸ªå…ƒç´ çš„ **å¹³æ–¹** ã€‚

è¿”å› **`nums` ** ä¸­ **æœ€é•¿æ–¹æ³¢** çš„é•¿åº¦ï¼Œå¦‚æœä¸å­˜åœ¨ **æ–¹æ³¢** ** åˆ™è¿”å› **`-1` ã€‚

**å­åºåˆ—** ä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå¯ä»¥ç”±å¦ä¸€ä¸ªæ•°ç»„åˆ é™¤ä¸€äº›æˆ–ä¸åˆ é™¤å…ƒç´ ä¸”ä¸æ”¹å˜å‰©ä½™å…ƒç´ çš„é¡ºåºå¾—åˆ°ã€‚

**ç¤ºä¾‹ 1 ï¼š**

> **è¾“å…¥ï¼š** nums = [4,3,6,16,8,2]
>
> **è¾“å‡ºï¼š** 3
>
> **è§£é‡Šï¼š** é€‰å‡ºå­åºåˆ— [4,16,2] ã€‚æ’åºåï¼Œå¾—åˆ° [2,4,16] ã€‚
>
> - 4 = 2 \* 2.
> - 16 = 4 \* 4.
>
> å› æ­¤ï¼Œ[4,16,2] æ˜¯ä¸€ä¸ªæ–¹æ³¢.
>
> å¯ä»¥è¯æ˜é•¿åº¦ä¸º 4 çš„å­åºåˆ—éƒ½ä¸æ˜¯æ–¹æ³¢ã€‚

**ç¤ºä¾‹ 2 ï¼š**

> **è¾“å…¥ï¼š** nums = [2,3,5,6,7]
>
> **è¾“å‡ºï¼š** -1
>
> **è§£é‡Šï¼š** nums ä¸å­˜åœ¨æ–¹æ³¢ï¼Œæ‰€ä»¥è¿”å› -1 ã€‚

**æç¤ºï¼š**

- `2 <= nums.length <= 10^5`
- `2 <= nums[i] <= 10^5`

## è§£é¢˜æ€è·¯

è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥åˆ©ç”¨é›†åˆæ¥å¿«é€ŸæŸ¥æ‰¾å¹³æ–¹æ•°ï¼ŒåŒæ—¶é€šè¿‡å¯¹è¾“å…¥æ•°ç»„è¿›è¡Œæ’åºæ¥æ–¹ä¾¿æ„é€ å¹³æ–¹åºåˆ—ã€‚

1. å°†æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ å­˜å…¥ä¸€ä¸ªé›†åˆä¸­ï¼Œä»¥ä¾¿å¿«é€ŸæŸ¥æ‰¾å¹³æ–¹å€¼ã€‚
2. å¯¹è¾“å…¥æ•°ç»„ `nums` è¿›è¡Œå»é‡å’Œæ’åºï¼Œä»¥ä¾¿åç»­æ„å»ºå¹³æ–¹åºåˆ—æ—¶ï¼Œèƒ½å¤Ÿä¿è¯å…ƒç´ çš„é¡ºåºã€‚
3. æ„å»ºå¹³æ–¹åºåˆ—ï¼š

   - éå†å·²æ’åºçš„æ•°ç»„ï¼Œé’ˆå¯¹æ¯ä¸ªå…ƒç´  `num`ï¼Œæ£€æŸ¥æ˜¯å¦å¯ä»¥å½¢æˆå¹³æ–¹åºåˆ—ï¼š
     - å¦‚æœ `num` æ˜¯ `1`ï¼Œè·³è¿‡ï¼Œå› ä¸º `1` çš„å¹³æ–¹æ˜¯ `1`ï¼Œä¸ä¼šå½¢æˆæœ‰æ•ˆçš„å¹³æ–¹åºåˆ—ã€‚
     - ä»å½“å‰å…ƒç´ å¼€å§‹ï¼Œå°è¯•æŸ¥æ‰¾ä¸‹ä¸€ä¸ªå¹³æ–¹æ•°ï¼Œå³ `num * num`ã€‚
     - å¦‚æœæ‰¾åˆ°äº†ï¼Œå°±å°†å¹³æ–¹åºåˆ—é•¿åº¦åŠ ä¸€ï¼Œå¹¶ä»é›†åˆä¸­åˆ é™¤å½“å‰å¹³æ–¹æ•°ï¼Œé˜²æ­¢é‡å¤è®¡ç®—ï¼Œå¹¶æ›´æ–°å½“å‰å…ƒç´ ä¸ºä¸‹ä¸€ä¸ªå¹³æ–¹æ•°ã€‚
     - é‡å¤è¿™ä¸€è¿‡ç¨‹ç›´åˆ°æ‰¾ä¸åˆ°ä¸‹ä¸€ä¸ªå¹³æ–¹æ•°ä¸ºæ­¢ï¼Œå¹¶è®°å½•å½“å‰çš„å¹³æ–¹åºåˆ—é•¿åº¦ã€‚

4. åœ¨æ¯æ¬¡æ„å»ºå¹³æ–¹åºåˆ—æ—¶ï¼Œæ£€æŸ¥é•¿åº¦æ˜¯å¦å¤§äºå½“å‰è®°å½•çš„æœ€é•¿å¹³æ–¹åºåˆ—é•¿åº¦ï¼Œå¹¶è¿›è¡Œæ›´æ–°ã€‚

5. å¦‚æœæ‰¾åˆ°çš„æœ€é•¿å¹³æ–¹åºåˆ—é•¿åº¦å¤§äºç­‰äº 2ï¼Œåˆ™è¿”å›è¯¥é•¿åº¦ï¼›å¦åˆ™è¿”å› -1ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n log n)`ï¼Œå…¶ä¸­ `n` æ˜¯æ•°ç»„çš„é•¿åº¦ï¼Œå¯¹æ•°ç»„è¿›è¡Œäº†æ’åºã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œä½¿ç”¨é¢å¤–çš„é›†åˆå­˜å‚¨å…ƒç´ ã€‚

## ä»£ç 

```javascript
/**
 * @param {number[]} nums
 * @return {number}
 */
var longestSquareStreak = function (nums) {
	// ç”¨äºå¿«é€ŸæŸ¥æ‰¾
	let numsSet = new Set(nums),
		res = 1;
	// å»é‡å¹¶æ’åº
	nums = [...numsSet].sort((a, b) => a - b);
	for (let num of nums) {
		// è·³è¿‡ 1
		if (num == 1) {
			continue;
		}
		let len = 1,
			square = num * num;
		while (numsSet.has(square)) {
			len++;
			numsSet.delete(square);
			square *= square;
		}
		res = Math.max(res, len);
	}
	return res == 1 ? -1 : res;
};
```
