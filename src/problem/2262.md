---
title: 2262. å­—ç¬¦ä¸²çš„æ€»å¼•åŠ›
description: LeetCode,2262. å­—ç¬¦ä¸²çš„æ€»å¼•åŠ›,å­—ç¬¦ä¸²çš„æ€»å¼•åŠ›,Total Appeal of A String,è§£é¢˜æ€è·¯,å“ˆå¸Œè¡¨,å­—ç¬¦ä¸²,åŠ¨æ€è§„åˆ’
keywords:
  - LeetCode
  - 2262. å­—ç¬¦ä¸²çš„æ€»å¼•åŠ›
  - å­—ç¬¦ä¸²çš„æ€»å¼•åŠ›
  - Total Appeal of A String
  - è§£é¢˜æ€è·¯
  - å“ˆå¸Œè¡¨
  - å­—ç¬¦ä¸²
  - åŠ¨æ€è§„åˆ’
---

# 2262. å­—ç¬¦ä¸²çš„æ€»å¼•åŠ›

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`å­—ç¬¦ä¸²`](/tag/string.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/total-appeal-of-a-string) [`LeetCode`](https://leetcode.com/problems/total-appeal-of-a-string)

## é¢˜ç›®

The **appeal** of a string is the number of **distinct** characters found in
the string.

- For example, the appeal of `"abbca"` is `3` because it has `3` distinct characters: `'a'`, `'b'`, and `'c'`.

Given a string `s`, return _the **total appeal of all of its
**substrings**.**_

A **substring** is a contiguous sequence of characters within a string.

**Example 1:**

> Input: s = "abbca"
>
> Output: 28
>
> Explanation: The following are the substrings of "abbca":
>
> - Substrings of length 1: "a", "b", "b", "c", "a" have an appeal of 1, 1, 1, 1, and 1 respectively. The sum is 5.
> - Substrings of length 2: "ab", "bb", "bc", "ca" have an appeal of 2, 1, 2, and 2 respectively. The sum is 7.
> - Substrings of length 3: "abb", "bbc", "bca" have an appeal of 2, 2, and 3 respectively. The sum is 7.
> - Substrings of length 4: "abbc", "bbca" have an appeal of 3 and 3 respectively. The sum is 6.
> - Substrings of length 5: "abbca" has an appeal of 3. The sum is 3.
>
> The total sum is 5 + 7 + 7 + 6 + 3 = 28.

**Example 2:**

> Input: s = "code"
>
> Output: 20
>
> Explanation: The following are the substrings of "code":
>
> - Substrings of length 1: "c", "o", "d", "e" have an appeal of 1, 1, 1, and 1 respectively. The sum is 4.
> - Substrings of length 2: "co", "od", "de" have an appeal of 2, 2, and 2 respectively. The sum is 6.
> - Substrings of length 3: "cod", "ode" have an appeal of 3 and 3 respectively. The sum is 6.
> - Substrings of length 4: "code" has an appeal of 4. The sum is 4.
>
> The total sum is 4 + 6 + 6 + 4 = 20.

**Constraints:**

- `1 <= s.length <= 10^5`
- `s` consists of lowercase English letters.

## é¢˜ç›®å¤§æ„

å­—ç¬¦ä¸²çš„ **å¼•åŠ›** å®šä¹‰ä¸ºï¼šå­—ç¬¦ä¸²ä¸­ **ä¸åŒ** å­—ç¬¦çš„æ•°é‡ã€‚

ä¾‹å¦‚ï¼Œ`"abbca"` çš„å¼•åŠ›ä¸º `3` ï¼Œå› ä¸ºå…¶ä¸­æœ‰ `3` ä¸ªä¸åŒå­—ç¬¦ `'a'`ã€`'b'` å’Œ `'c'` ã€‚
ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² `s` ï¼Œè¿”å› **å…¶æ‰€æœ‰å­å­—ç¬¦ä¸²çš„æ€»å¼•åŠ›** ã€‚

**å­å­—ç¬¦ä¸²** å®šä¹‰ä¸ºï¼šå­—ç¬¦ä¸²ä¸­çš„ä¸€ä¸ªè¿ç»­å­—ç¬¦åºåˆ—ã€‚

## è§£é¢˜æ€è·¯

å¯¹äºæ¯ä¸ªå­—ç¬¦ï¼Œå®ƒä¼šå‡ºç°åœ¨æŸäº›å­å­—ç¬¦ä¸²ä¸­ï¼Œå¹¶å¯¹è¿™äº›å­å­—ç¬¦ä¸²çš„å¸å¼•åŠ›æœ‰è´¡çŒ®ã€‚å¯ä»¥è·Ÿè¸ªæ¯ä¸ªå­—ç¬¦æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¹¶è®¡ç®—ä»è¯¥å­—ç¬¦çš„æœ€åå‡ºç°ä½ç½®åˆ°å½“å‰å­—ç¬¦ä¹‹é—´çš„å­å­—ç¬¦ä¸²çš„å¸å¼•åŠ›å˜åŒ–ã€‚

ä¸ºäº†é¿å…éå†æ‰€æœ‰å­å­—ç¬¦ä¸²ï¼Œå¯ä»¥ä½¿ç”¨åŠ¨æ€æ›´æ–°çš„æ–¹å¼è®¡ç®—æŸä¸ªå­—ç¬¦å¯¹å½“å‰å­å­—ç¬¦ä¸²çš„è´¡çŒ®ã€‚é€šè¿‡è®°å½•æ¯ä¸ªå­—ç¬¦æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¯ä»¥å¿«é€Ÿè®¡ç®—è¯¥å­—ç¬¦çš„è´¡çŒ®ã€‚

1. **åˆå§‹åŒ–**ï¼š

   - ä½¿ç”¨æ•°ç»„ `lastIndex` æ¥è®°å½•æ¯ä¸ªå­—ç¬¦çš„æœ€åä¸€æ¬¡å‡ºç°ä½ç½®ï¼Œåˆå§‹å€¼è®¾ä¸º `-1`ï¼Œè¡¨ç¤ºè¿˜æ²¡æœ‰å‡ºç°è¿‡ã€‚
   - å˜é‡ `dp` ç”¨æ¥è·Ÿè¸ªä»ç¬¬ä¸€ä¸ªå­—ç¬¦åˆ°å½“å‰å­—ç¬¦çš„æ‰€æœ‰å­å­—ç¬¦ä¸²çš„æ€»å¸å¼•åŠ›ã€‚
   - å˜é‡ `res` ç”¨æ¥å­˜å‚¨æ‰€æœ‰å­å­—ç¬¦ä¸²çš„å¸å¼•åŠ›æ€»å’Œã€‚

2. **éå†å­—ç¬¦ä¸²**ï¼š

   - å¯¹äºå­—ç¬¦ä¸²ä¸­çš„æ¯ä¸ªå­—ç¬¦ï¼Œé¦–å…ˆé€šè¿‡ `lastIndex` æ‰¾åˆ°è¯¥å­—ç¬¦ä¸Šä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚å¦‚æœå½“å‰å­—ç¬¦ä¸Šä¸€æ¬¡å‡ºç°åœ¨ä½ç½® `j`ï¼Œé‚£ä¹ˆä» `j+1` åˆ° `i` çš„æ‰€æœ‰å­å­—ç¬¦ä¸²éƒ½ä¼šåŒ…å«å½“å‰å­—ç¬¦ï¼Œå› æ­¤å½“å‰å­—ç¬¦å¯¹è¿™äº›å­å­—ç¬¦ä¸²çš„å¸å¼•åŠ›éƒ½æœ‰è´¡çŒ®ã€‚
   - è®¡ç®—å½“å‰å­—ç¬¦çš„è´¡çŒ®å¹¶æ›´æ–° `dp` å’Œ `res`ã€‚

3. **æ›´æ–°ç´¢å¼•**ï¼š
   - æ¯æ¬¡å¤„ç†å®Œå½“å‰å­—ç¬¦åï¼Œå°†å…¶æœ€åå‡ºç°çš„ä½ç½®æ›´æ–°ä¸ºå½“å‰ç´¢å¼• `i`ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š `O(n)`ï¼Œå› ä¸ºåªéå†äº†ä¸€éå­—ç¬¦ä¸²ï¼Œä¸”æ¯ä¸ªå­—ç¬¦çš„æ“ä½œéƒ½æ˜¯å¸¸æ•°æ—¶é—´ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š `O(1)`ï¼ˆè€ƒè™‘å­—ç¬¦é›†å¤§å°ä¸º 26 ä¸ªå­—æ¯ï¼‰ã€‚

é€šè¿‡è®°å½•æ¯ä¸ªå­—ç¬¦çš„æœ€åå‡ºç°ä½ç½®ï¼Œå¯ä»¥é«˜æ•ˆåœ°è®¡ç®—å‡ºæ¯ä¸ªå­—ç¬¦å¯¹æ€»å¸å¼•åŠ›çš„è´¡çŒ®ï¼Œé¿å…äº†æš´åŠ›éå†æ‰€æœ‰å­å­—ç¬¦ä¸²çš„å¤æ‚åº¦ï¼Œä»è€Œè¾¾åˆ°äº†çº¿æ€§æ—¶é—´çš„å¤æ‚åº¦ã€‚

## ä»£ç 

```javascript
/**
 * @param {string} s
 * @return {number}
 */
var appealSum = function (s) {
	let res = 0,
		dp = 0;
	// ç”¨äºè®°å½•æ¯ä¸ªå­—ç¬¦æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®
	let lastIndex = new Array(26).fill(-1);
	for (let i = 0; i < s.length; i++) {
		// å°†å­—ç¬¦è½¬æ¢ä¸ºæ•°ç»„ç´¢å¼•
		let charIndex = s[i].charCodeAt() - 'a'.charCodeAt();
		// æ›´æ–°å½“å‰å­ä¸²çš„æ€»å¸å¼•åŠ›
		dp += i - lastIndex[charIndex];
		// ç´¯åŠ åˆ°æ€»å¸å¼•åŠ›
		res += dp;
		// æ›´æ–°å­—ç¬¦çš„æœ€åå‡ºç°ä½ç½®
		lastIndex[charIndex] = i;
	}
	return res;
};
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ | åŠ›æ‰£ |
| :------: | :------ | :------: | :------ | :------: | :------: |
| 828 | ç»Ÿè®¡å­ä¸²ä¸­çš„å”¯ä¸€å­—ç¬¦ |  |  [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`å­—ç¬¦ä¸²`](/tag/string.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md) | ğŸ”´ | [ğŸ€„ï¸](https://leetcode.cn/problems/count-unique-characters-of-all-substrings-of-a-given-string) [ğŸ”—](https://leetcode.com/problems/count-unique-characters-of-all-substrings-of-a-given-string) |
| 2062 | ç»Ÿè®¡å­—ç¬¦ä¸²ä¸­çš„å…ƒéŸ³å­å­—ç¬¦ä¸² |  |  [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`å­—ç¬¦ä¸²`](/tag/string.md) | ğŸŸ¢ | [ğŸ€„ï¸](https://leetcode.cn/problems/count-vowel-substrings-of-a-string) [ğŸ”—](https://leetcode.com/problems/count-vowel-substrings-of-a-string) |
| 2063 | æ‰€æœ‰å­å­—ç¬¦ä¸²ä¸­çš„å…ƒéŸ³ |  |  [`æ•°å­¦`](/tag/math.md) [`å­—ç¬¦ä¸²`](/tag/string.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md) `1+` | ğŸŸ  | [ğŸ€„ï¸](https://leetcode.cn/problems/vowels-of-all-substrings) [ğŸ”—](https://leetcode.com/problems/vowels-of-all-substrings) |
| 3134 | æ‰¾å‡ºå”¯ä¸€æ€§æ•°ç»„çš„ä¸­ä½æ•° |  |  [`æ•°ç»„`](/tag/array.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`äºŒåˆ†æŸ¥æ‰¾`](/tag/binary-search.md) `1+` | ğŸ”´ | [ğŸ€„ï¸](https://leetcode.cn/problems/find-the-median-of-the-uniqueness-array) [ğŸ”—](https://leetcode.com/problems/find-the-median-of-the-uniqueness-array) |