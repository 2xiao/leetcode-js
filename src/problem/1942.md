# [1942. æœ€å°æœªè¢«å æ®æ¤…å­çš„ç¼–å·](https://leetcode.com/problems/the-number-of-the-smallest-unoccupied-chair)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°ç»„`](/tag/array.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰`](/tag/heap-priority-queue.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/the-number-of-the-smallest-unoccupied-chair)

## é¢˜ç›®

There is a party where `n` friends numbered from `0` to `n - 1` are attending.
There is an **infinite** number of chairs in this party that are numbered from
`0` to `infinity`. When a friend arrives at the party, they sit on the
unoccupied chair with the **smallest number**.

- For example, if chairs `0`, `1`, and `5` are occupied when a friend comes, they will sit on chair number `2`.

When a friend leaves the party, their chair becomes unoccupied at the moment
they leave. If another friend arrives at that same moment, they can sit in
that chair.

You are given a **0-indexed** 2D integer array `times` where `times[i] =
[arrivali, leavingi]`, indicating the arrival and leaving times of the `ith`
friend respectively, and an integer `targetFriend`. All arrival times are
**distinct**.

Return _the**chair number** that the friend numbered _`targetFriend` _will sit
on_.

**Example 1:**

> Input: times = [[1,4],[2,3],[4,6]], targetFriend = 1
>
> Output: 1
>
> Explanation:
>
> - Friend 0 arrives at time 1 and sits on chair 0.
> - Friend 1 arrives at time 2 and sits on chair 1.
> - Friend 1 leaves at time 3 and chair 1 becomes empty.
> - Friend 0 leaves at time 4 and chair 0 becomes empty.
> - Friend 2 arrives at time 4 and sits on chair 0.
>
> Since friend 1 sat on chair 1, we return 1.

**Example 2:**

> Input: times = [[3,10],[1,5],[2,6]], targetFriend = 0
>
> Output: 2
>
> Explanation:
>
> - Friend 1 arrives at time 1 and sits on chair 0.
> - Friend 2 arrives at time 2 and sits on chair 1.
> - Friend 0 arrives at time 3 and sits on chair 2.
> - Friend 1 leaves at time 5 and chair 0 becomes empty.
> - Friend 2 leaves at time 6 and chair 1 becomes empty.
> - Friend 0 leaves at time 10 and chair 2 becomes empty.
>
> Since friend 0 sat on chair 2, we return 2.

**Constraints:**

- `n == times.length`
- `2 <= n <= 10^4`
- `times[i].length == 2`
- `1 <= arrivali < leavingi <= 10^5`
- `0 <= targetFriend <= n - 1`
- Each `arrivali` time is **distinct**.

## é¢˜ç›®å¤§æ„

æœ‰ `n` ä¸ªæœ‹å‹åœ¨ä¸¾åŠä¸€ä¸ªæ´¾å¯¹ï¼Œè¿™äº›æœ‹å‹ä» `0` åˆ° `n - 1` ç¼–å·ã€‚æ´¾å¯¹é‡Œæœ‰ **æ— æ•°** å¼ æ¤…å­ï¼Œç¼–å·ä¸º `0` åˆ° `infinity`
ã€‚å½“ä¸€ä¸ªæœ‹å‹åˆ°è¾¾æ´¾å¯¹æ—¶ï¼Œä»–ä¼šå æ® **ç¼–å·æœ€å°** ä¸”æœªè¢«å æ®çš„æ¤…å­ã€‚

- æ¯”æ–¹è¯´ï¼Œå½“ä¸€ä¸ªæœ‹å‹åˆ°è¾¾æ—¶ï¼Œå¦‚æœæ¤…å­ `0` ï¼Œ`1` å’Œ `5` è¢«å æ®äº†ï¼Œé‚£ä¹ˆä»–ä¼šå æ® `2` å·æ¤…å­ã€‚

å½“ä¸€ä¸ªæœ‹å‹ç¦»å¼€æ´¾å¯¹æ—¶ï¼Œä»–çš„æ¤…å­ä¼šç«‹åˆ»å˜æˆæœªå æ®çŠ¶æ€ã€‚å¦‚æœåŒä¸€æ—¶åˆ»æœ‰å¦ä¸€ä¸ªæœ‹å‹åˆ°è¾¾ï¼Œå¯ä»¥ç«‹å³å æ®è¿™å¼ æ¤…å­ã€‚

ç»™ä½ ä¸€ä¸ªä¸‹æ ‡ä» **0** å¼€å§‹çš„äºŒç»´æ•´æ•°æ•°ç»„ `times` ï¼Œå…¶ä¸­ `times[i] = [arrivali, leavingi]` è¡¨ç¤ºç¬¬ `i`
ä¸ªæœ‹å‹åˆ°è¾¾å’Œç¦»å¼€çš„æ—¶åˆ»ï¼ŒåŒæ—¶ç»™ä½ ä¸€ä¸ªæ•´æ•° `targetFriend` ã€‚æ‰€æœ‰åˆ°è¾¾æ—¶é—´ **äº’ä¸ç›¸åŒ** ã€‚

è¯·ä½ è¿”å›ç¼–å·ä¸º `targetFriend` çš„æœ‹å‹å æ®çš„ **æ¤…å­ç¼–å·** ã€‚

**ç¤ºä¾‹ 1ï¼š**

> **è¾“å…¥ï¼š** times = [[1,4],[2,3],[4,6]], targetFriend = 1
>
> **è¾“å‡ºï¼š** 1
>
> **è§£é‡Šï¼š**
>
> - æœ‹å‹ 0 æ—¶åˆ» 1 åˆ°è¾¾ï¼Œå æ®æ¤…å­ 0 ã€‚
> - æœ‹å‹ 1 æ—¶åˆ» 2 åˆ°è¾¾ï¼Œå æ®æ¤…å­ 1 ã€‚
> - æœ‹å‹ 1 æ—¶åˆ» 3 ç¦»å¼€ï¼Œæ¤…å­ 1 å˜æˆæœªå æ®ã€‚
> - æœ‹å‹ 0 æ—¶åˆ» 4 ç¦»å¼€ï¼Œæ¤…å­ 0 å˜æˆæœªå æ®ã€‚
> - æœ‹å‹ 2 æ—¶åˆ» 4 åˆ°è¾¾ï¼Œå æ®æ¤…å­ 0 ã€‚
>
> æœ‹å‹ 1 å æ®æ¤…å­ 1 ï¼Œæ‰€ä»¥è¿”å› 1 ã€‚

**ç¤ºä¾‹ 2ï¼š**

> **è¾“å…¥ï¼š** times = [[3,10],[1,5],[2,6]], targetFriend = 0
>
> **è¾“å‡ºï¼š** 2
>
> **è§£é‡Šï¼š**
>
> - æœ‹å‹ 1 æ—¶åˆ» 1 åˆ°è¾¾ï¼Œå æ®æ¤…å­ 0 ã€‚
> - æœ‹å‹ 2 æ—¶åˆ» 2 åˆ°è¾¾ï¼Œå æ®æ¤…å­ 1 ã€‚
> - æœ‹å‹ 0 æ—¶åˆ» 3 åˆ°è¾¾ï¼Œå æ®æ¤…å­ 2 ã€‚
> - æœ‹å‹ 1 æ—¶åˆ» 5 ç¦»å¼€ï¼Œæ¤…å­ 0 å˜æˆæœªå æ®ã€‚
> - æœ‹å‹ 2 æ—¶åˆ» 6 ç¦»å¼€ï¼Œæ¤…å­ 1 å˜æˆæœªå æ®ã€‚
> - æœ‹å‹ 0 æ—¶åˆ» 10 ç¦»å¼€ï¼Œæ¤…å­ 2 å˜æˆæœªå æ®ã€‚
>
> æœ‹å‹ 0 å æ®æ¤…å­ 2 ï¼Œæ‰€ä»¥è¿”å› 2 ã€‚

**æç¤ºï¼š**

- `n == times.length`
- `2 <= n <= 10^4`
- `times[i].length == 2`
- `1 <= arrivali < leavingi <= 10^5`
- `0 <= targetFriend <= n - 1`
- æ¯ä¸ª `arrivali` æ—¶åˆ» **äº’ä¸ç›¸åŒ** ã€‚

## è§£é¢˜æ€è·¯

### æ€è·¯ä¸€ï¼šä¼˜å…ˆé˜Ÿåˆ—

è¿™ä¸ªé—®é¢˜å¯ä»¥ç”¨äº‹ä»¶é©±åŠ¨çš„æ–¹å¼è§£å†³ã€‚å°†æ¯ä¸ªäººçš„åˆ°è¾¾å’Œç¦»å¼€äº‹ä»¶éƒ½çœ‹ä½œä¸€ä¸ªäº‹ä»¶ï¼Œå¹¶æŒ‰ç…§æ—¶é—´é¡ºåºè¿›è¡Œå¤„ç†ã€‚

å¯ä»¥ä½¿ç”¨ä¸€ä¸ªä¼˜å…ˆé˜Ÿåˆ—ï¼ˆæœ€å°å †ï¼‰æ¥å­˜å‚¨æ¯ä¸ªæ¤…å­çš„çŠ¶æ€ï¼Œè¿™æ ·å¯ä»¥éšæ—¶æ‰¾åˆ°æœ€å°ç¼–å·çš„ç©ºæ¤…å­ã€‚

- é¦–å…ˆå°†æ‰€æœ‰åˆ°è¾¾å’Œç¦»å¼€çš„æ—¶é—´æŒ‰äº‹ä»¶æ’åºã€‚
- å¯¹æ¯ä¸€ä¸ªåˆ°è¾¾äº‹ä»¶ï¼Œä»ä¼˜å…ˆé˜Ÿåˆ—ä¸­å–å‡ºæœ€å°çš„ç©ºæ¤…å­ç¼–å·ï¼Œåˆ†é…ç»™å½“å‰äººã€‚
- å¯¹äºæ¯ä¸€ä¸ªç¦»å¼€äº‹ä»¶ï¼Œå°†è¯¥äººåçš„æ¤…å­å½’è¿˜åˆ°ä¼˜å…ˆé˜Ÿåˆ—ã€‚
- å½“å¤„ç†åˆ° `targetFriend` æ—¶ï¼Œè®°å½•ä¸‹ä»–åçš„æ¤…å­ç¼–å·å¹¶è¿”å›ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n log n)`ï¼Œå…¶ä¸­ `n` æ˜¯å‚åŠ èšä¼šçš„æ€»äººæ•°ã€‚
  - **äº‹ä»¶å­˜å‚¨**å’Œ**éå†äº‹ä»¶**çš„å¤æ‚åº¦ä¸º `O(n)`ã€‚
  - **æ’åºäº‹ä»¶**çš„å¤æ‚åº¦ä¸º `O(n log n)`ï¼Œå…¶ä¸­ `n` æ˜¯äº‹ä»¶çš„æ•°é‡ã€‚
  - **å †æ“ä½œ**ï¼ˆæ’å…¥å’Œåˆ é™¤ï¼‰åœ¨æ¯æ¬¡åˆ°è¾¾å’Œç¦»å¼€äº‹ä»¶æ—¶æ“ä½œæœ€å°å †çš„å¤æ‚åº¦ä¸º `O(log n)`ã€‚å› æ­¤ï¼Œå¯¹äº `2n` ä¸ªäº‹ä»¶ï¼Œå †æ“ä½œçš„æ€»å¤æ‚åº¦ä¸º `O(n log n)`ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œä¸»è¦ç”¨äºå­˜å‚¨åˆ°è¾¾å’Œç¦»å¼€çš„äº‹ä»¶ï¼Œä»¥åŠä¼˜å…ˆé˜Ÿåˆ—ã€‚
  - `events` æ•°ç»„å­˜å‚¨ `2n` ä¸ªäº‹ä»¶ï¼Œå› æ­¤ç©ºé—´å¤æ‚åº¦ä¸º `O(n)`ã€‚
  - `occupied` Map å­˜å‚¨æœ€å¤š `n` ä¸ªæˆå‘˜çš„ä¿¡æ¯ï¼Œå› æ­¤ä¹Ÿæ˜¯ `O(n)`ã€‚
  - `chairs` æœ€å°å †å­˜å‚¨ `n` æŠŠæ¤…å­ï¼Œå› æ­¤ä¸º `O(n)`ã€‚

### æ€è·¯äºŒï¼šæ•°ç»„æ¨¡æ‹Ÿä¼˜å…ˆé˜Ÿåˆ— + æ€§èƒ½ä¼˜åŒ–

å¦‚æœè§‰å¾—ä¼˜å…ˆé˜Ÿåˆ—ç±»çš„å®šä¹‰è¾ƒä¸ºç¹çï¼Œä¹Ÿå¯ä»¥ç”¨æ•°ç»„æ¥æ¨¡æ‹Ÿä¼˜å…ˆé˜Ÿåˆ—ï¼Œä½¿ç”¨ `sort()` æ–¹æ³•å¯¹æ¯æ¬¡ç¦»å¼€äº‹ä»¶åé‡Šæ”¾çš„æ¤…å­è¿›è¡Œæ’åºã€‚

ä½†æ˜¯ç”±äº `sort()` æ–¹æ³•çš„å¤æ‚åº¦ä¸º `O(n log n)`ï¼Œä¸”æ¯æ¬¡éƒ½è¦é‡æ–°æ’åºï¼Œè¿™æ„å‘³ç€ä»£ç æ•´ä½“çš„æ—¶é—´å¤æ‚åº¦å°†å˜ä¸º `O(n^2 log n)`ï¼Œå› ä¸ºå¯¹ `n` ä¸ªäº‹ä»¶æ’åº `n` æ¬¡éƒ½ä¼šè°ƒç”¨ `sort()`ã€‚

ä¸ºäº†é¿å…è¶…æ—¶ï¼Œè¦åŠ å…¥äº†ä¸€äº›ä¼˜åŒ–å¤„ç†ï¼Œå¦‚ï¼š

- `events` ä¸­åªå­˜å‚¨åœ¨ `targetFriend` åˆ°è¾¾ä¹‹å‰å‘ç”Ÿçš„åˆ°è¾¾å’Œç¦»å¼€äº‹ä»¶ï¼Œä¹‹åçš„äº‹ä»¶ä¸éœ€è¦å…³å¿ƒï¼›
- è®°å½• `targetFriend` åˆ°è¾¾ä¹‹å‰éœ€è¦çš„æ¤…å­æ•°é‡ï¼Œåªå¯¹éœ€è¦çš„æ¤…å­è¿›è¡Œæ’åºï¼Œé¿å…æ¤…å­é‡Šæ”¾å›ä¼˜å…ˆé˜Ÿåˆ—æ—¶è¶…æ—¶ï¼›

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n^2 log n)`ï¼Œå…¶ä¸­ `n` æ˜¯å‚åŠ èšä¼šçš„æ€»äººæ•°
  - **äº‹ä»¶å­˜å‚¨**å’Œ**éå†äº‹ä»¶**çš„å¤æ‚åº¦ä¸º `O(n)`ã€‚
  - **events æ’åº**çš„å¤æ‚åº¦ä¸º `O(n log n)`ï¼Œå…¶ä¸­ `n` æ˜¯äº‹ä»¶çš„æ•°é‡ã€‚
  - **chairs æ’åº**çš„å¤æ‚åº¦ä¸º `O(n log n)`ã€‚å› æ­¤ï¼Œå¯¹äº `2n` ä¸ªäº‹ä»¶æ’åºçš„æ€»å¤æ‚åº¦ä¸º `O(n^2 log n)`ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œä¸»è¦ç”¨äºå­˜å‚¨åˆ°è¾¾å’Œç¦»å¼€çš„äº‹ä»¶ï¼Œä»¥åŠ `chairs` æ•°ç»„ã€‚

## ä»£ç 

:::: code-tabs
@tab ä¼˜å…ˆé˜Ÿåˆ—

```javascript
/**
 * @param {number[][]} times
 * @param {number} targetFriend
 * @return {number}
 */
var smallestChair = function (times, targetFriend) {
	const targetArrive = times[targetFriend][0];
	let events = [];

	// æŠŠæ‰€æœ‰åˆ°è¾¾å’Œç¦»å¼€çš„æ—¶é—´ä½œä¸ºäº‹ä»¶å­˜å‚¨
	for (let i = 0; i < times.length; i++) {
		events.push([times[i][0], 'arrive', i]);
		events.push([times[i][1], 'leave', i]);
	}

	// æŒ‰æ—¶é—´æ’åºï¼Œå¦‚æœæ—¶é—´ç›¸åŒï¼Œç¦»å¼€äº‹ä»¶å…ˆå¤„ç†
	events.sort((a, b) =>
		a[0] == b[0] ? (a[1] === 'leave' ? -1 : 1) : a[0] - b[0]
	);

	let chairs = new MinHeap(); // ä½¿ç”¨æœ€å°å †æ¥æ¨¡æ‹Ÿæ¤…å­çš„ç¼–å·é¡ºåº
	let occupied = new Map(); // å­˜å‚¨å½“å‰å ç”¨æ¤…å­çš„æƒ…å†µ
	for (let i = 0; i < times.length; i++) {
		chairs.push(i); // åˆå§‹åŒ–æ¤…å­çš„ç¼–å· 0 åˆ° n-1
	}

	// éå†äº‹ä»¶
	for (let [time, type, idx] of events) {
		if (type == 'arrive') {
			let chair = chairs.pop(); // æ‹¿åˆ°æœ€å°ç¼–å·çš„ç©ºæ¤…å­
			occupied.set(idx, chair); // æ ‡è®°è¿™ä¸ªäººå ç”¨çš„æ¤…å­

			if (idx == targetFriend) {
				return chair; // å¦‚æœæ˜¯ç›®æ ‡äººï¼Œç›´æ¥è¿”å›æ¤…å­ç¼–å·
			}
		} else {
			let chair = occupied.get(idx); // æ‰¾åˆ°ç¦»å¼€çš„äººå¯¹åº”çš„æ¤…å­
			chairs.push(chair); // æ¤…å­é‡Šæ”¾ï¼Œæ”¾å›æœ€å°å †
		}
	}
};

class MinHeap {
	constructor() {
		this.heap = [];
	}

	// æ’å…¥å…ƒç´ 
	push(val) {
		this.heap.push(val);
		this.heapifyUp(this.heap.length - 1);
	}

	// å¼¹å‡ºå †é¡¶å…ƒç´ 
	pop() {
		if (this.size() === 1) return this.heap.pop();
		const top = this.heap[0];
		this.heap[0] = this.heap.pop();
		this.heapifyDown(0);
		return top;
	}

	// è¿”å›å †é¡¶å…ƒç´ 
	peek() {
		return this.heap[0];
	}

	// å †å¤§å°
	size() {
		return this.heap.length;
	}

	// ä¸Šæµ®æ“ä½œ
	heapifyUp(index) {
		while (index > 0) {
			let parentIndex = Math.floor((index - 1) / 2);
			if (this.heap[parentIndex] <= this.heap[index]) break;
			[this.heap[parentIndex], this.heap[index]] = [
				this.heap[index],
				this.heap[parentIndex]
			];
			index = parentIndex;
		}
	}

	// ä¸‹æ²‰æ“ä½œ
	heapifyDown(index) {
		const length = this.heap.length;
		while (true) {
			let leftIndex = 2 * index + 1;
			let rightIndex = 2 * index + 2;
			let smallestIndex = index;

			if (
				leftIndex < length &&
				this.heap[leftIndex] < this.heap[smallestIndex]
			) {
				smallestIndex = leftIndex;
			}
			if (
				rightIndex < length &&
				this.heap[rightIndex] < this.heap[smallestIndex]
			) {
				smallestIndex = rightIndex;
			}
			if (smallestIndex === index) break;
			[this.heap[smallestIndex], this.heap[index]] = [
				this.heap[index],
				this.heap[smallestIndex]
			];
			index = smallestIndex;
		}
	}
}
```

@tab æ•°ç»„æ¨¡æ‹Ÿä¼˜å…ˆé˜Ÿåˆ— + æ€§èƒ½ä¼˜åŒ–

```javascript
/**
 * @param {number[][]} times
 * @param {number} targetFriend
 * @return {number}
 */
var smallestChair = function (times, targetFriend) {
	const targetArrive = times[targetFriend][0];
	let events = [],
		chairCount = 0; // è®°å½• targetFriend åˆ°è¾¾ä¹‹å‰éœ€è¦çš„æ¤…å­æ•°ï¼Œé¿å…æ’åºè¶…æ—¶

	// æŠŠæ‰€æœ‰åˆ°è¾¾å’Œç¦»å¼€çš„æ—¶é—´ä½œä¸ºäº‹ä»¶å­˜å‚¨
	// æ³¨æ„åªå­˜å‚¨åœ¨ targetFriend åˆ°è¾¾ä¹‹å‰å‘ç”Ÿçš„åˆ°è¾¾å’Œç¦»å¼€äº‹ä»¶ï¼Œé¿å…æ’åºè¶…æ—¶
	for (let i = 0; i < times.length; i++) {
		if (times[i][0] <= targetArrive) {
			chairCount++;
			events.push([times[i][0], 'arrive', i]);
			if (times[i][1] <= targetArrive) {
				events.push([times[i][1], 'leave', i]);
				chairCount--;
			}
		}
	}

	// æŒ‰æ—¶é—´æ’åºï¼Œå¦‚æœæ—¶é—´ç›¸åŒï¼Œç¦»å¼€äº‹ä»¶å…ˆå¤„ç†
	events.sort((a, b) =>
		a[0] == b[0] ? (a[1] === 'leave' ? -1 : 1) : a[0] - b[0]
	);

	let chairs = [...Array(chairCount).keys()]; // ç”Ÿæˆä» 0 åˆ° chairCount - 1 çš„æ¤…å­ç¼–å·

	let occupied = new Map(); // å­˜å‚¨å½“å‰å ç”¨æ¤…å­çš„æƒ…å†µ
	for (let [time, type, idx] of events) {
		if (type == 'arrive') {
			let chair = chairs.shift(); // æ‹¿åˆ°æœ€å°ç¼–å·çš„ç©ºæ¤…å­
			occupied.set(idx, chair); // æ ‡è®°è¿™ä¸ªäººå ç”¨çš„æ¤…å­

			if (idx == targetFriend) {
				return chair; // å¦‚æœæ˜¯ç›®æ ‡äººï¼Œç›´æ¥è¿”å›æ¤…å­ç¼–å·
			}
		} else {
			let chair = occupied.get(idx); // æ‰¾åˆ°ç¦»å¼€çš„äººå¯¹åº”çš„æ¤…å­
			chairs.push(chair); // æ¤…å­é‡Šæ”¾ï¼Œæ”¾å›ä¼˜å…ˆé˜Ÿåˆ—
			chairs.sort((a, b) => a - b); // ä¿æŒæ¤…å­ç¼–å·çš„é¡ºåº
		}
	}
};
```

::::
