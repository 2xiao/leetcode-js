# [85. æœ€å¤§çŸ©å½¢](https://leetcode.com/problems/maximal-rectangle)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ ˆ`](/leetcode/outline/tag/stack.md) [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`åŠ¨æ€è§„åˆ’`](/leetcode/outline/tag/dynamic-programming.md) [`çŸ©é˜µ`](/leetcode/outline/tag/matrix.md) [`å•è°ƒæ ˆ`](/leetcode/outline/tag/monotonic-stack.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/maximal-rectangle/)

## é¢˜ç›®

Given a `rows x cols` binary `matrix` filled with `0`'s and `1`'s, find the
largest rectangle containing only `1`'s and return _its area_.

**Example 1:**

![](https://assets.leetcode.com/uploads/2020/09/14/maximal.jpg)

> Input: matrix = [["1","0","1","0","0"],["1","0","1","1","1"],["1","1","1","1","1"],["1","0","0","1","0"]]
>
> Output: 6
>
> Explanation: The maximal rectangle is shown in the above picture.

**Example 2:**

> Input: matrix = [["0"]]
>
> Output: 0

**Example 3:**

> Input: matrix = [["1"]]
>
> Output: 1

**Constraints:**

- `rows == matrix.length`
- `cols == matrix[i].length`
- `1 <= row, cols <= 200`
- `matrix[i][j]` is `'0'` or `'1'`.

## é¢˜ç›®å¤§æ„

## è§£é¢˜æ€è·¯

LeetCode ç¬¬ 85 é¢˜ **"æœ€å¤§çŸ©å½¢"** è¦æ±‚åœ¨ä¸€ä¸ªç”± `1` å’Œ `0` ç»„æˆçš„äºŒç»´çŸ©é˜µä¸­æ‰¾åˆ°åªåŒ…å« `1` çš„æœ€å¤§çŸ©å½¢çš„é¢ç§¯ã€‚è¿™ä¸ªé—®é¢˜å¯ä»¥é€šè¿‡åŠ¨æ€è§„åˆ’å’Œå•è°ƒæ ˆçš„ç»“åˆæ¥é«˜æ•ˆè§£å†³ã€‚

### è§£é¢˜æ€è·¯

- æ£€æŸ¥çŸ©é˜µæ˜¯å¦ä¸ºç©ºã€‚
- åˆå§‹åŒ–ä¸€ä¸ªæ•°ç»„ `heights`ï¼Œç”¨äºå­˜å‚¨å½“å‰è¡Œçš„é«˜åº¦ã€‚
- å°†æ¯ä¸€è¡Œè§†ä¸ºåŸºäºä¸Šæ–¹è¿ç»­ `1` çš„é«˜åº¦ã€‚å¦‚æœå½“å‰å…ƒç´ æ˜¯ `1`ï¼Œåˆ™å…¶é«˜åº¦ç­‰äºå½“å‰è¡Œçš„ `1` çš„æ•°é‡ï¼›å¦‚æœæ˜¯ `0`ï¼Œåˆ™é«˜åº¦ä¸º `0`ã€‚

  - ä¾‹å¦‚ï¼Œç»™å®šçŸ©é˜µï¼š
    ```
    [
      ["1", "0", "1", "0", "0"],
      ["1", "0", "1", "1", "1"],
      ["1", "1", "1", "1", "1"],
      ["1", "0", "0", "1", "0"]
    ]
    ```
    å¯¹åº”çš„é«˜åº¦çŸ©é˜µä¸ºï¼š
    ```
    [
      [1, 0, 1, 0, 0],
      [2, 0, 2, 1, 1],
      [3, 1, 3, 2, 2],
      [4, 0, 0, 3, 0]
    ]
    ```

- éå†æ¯ä¸€è¡Œï¼Œæ›´æ–° `heights` æ•°ç»„ã€‚
- å¯¹æ¯ä¸€è¡Œè°ƒç”¨ `largestRectangleArea` å‡½æ•°è®¡ç®—æœ€å¤§çŸ©å½¢é¢ç§¯ã€‚

  - å¯¹äºæ¯ä¸€è¡Œçš„é«˜åº¦æ•°ç»„ï¼Œå¯ä»¥ä½¿ç”¨å•è°ƒæ ˆæ¥è®¡ç®—æœ€å¤§çŸ©å½¢é¢ç§¯ã€‚
  - ä½¿ç”¨æ ˆæ¥ç»´æŠ¤é«˜åº¦çš„ç´¢å¼•ï¼Œç¡®ä¿æ ˆä¸­çš„é«˜åº¦æ˜¯å•è°ƒé€’å¢çš„ã€‚éå†é«˜åº¦æ•°ç»„ï¼Œå¦‚æœå½“å‰é«˜åº¦å°äºæ ˆé¡¶å…ƒç´ ï¼Œè®¡ç®—ä»¥æ ˆé¡¶é«˜åº¦ä¸ºæœ€å°é«˜åº¦çš„çŸ©å½¢é¢ç§¯ï¼Œå¹¶æ›´æ–°æœ€å¤§é¢ç§¯ã€‚
  - é€šè¿‡éå†é«˜åº¦æ•°ç»„ï¼Œè®¡ç®—ä»¥æ¯ä¸ªé«˜åº¦ä¸ºæœ€å°é«˜åº¦çš„çŸ©å½¢é¢ç§¯ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(m * n)`ï¼Œå…¶ä¸­ `m` æ˜¯çŸ©é˜µçš„è¡Œæ•°ï¼Œ`n` æ˜¯åˆ—æ•°ã€‚æ¯è¡Œçš„æœ€å¤§çŸ©å½¢è®¡ç®—æ˜¯ `O(n)`ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œç”¨äºå­˜å‚¨é«˜åº¦æ•°ç»„å’Œæ ˆã€‚

## ä»£ç 

```javascript
/**
 * @param {character[][]} matrix
 * @return {number}
 */
var maximalRectangle = function (matrix) {
	if (!matrix.length || !matrix[0].length) return 0;

	const heights = new Array(matrix[0].length).fill(0);
	let maxArea = 0;

	for (let i = 0; i < matrix.length; i++) {
		for (let j = 0; j < matrix[0].length; j++) {
			// æ›´æ–°å½“å‰è¡Œçš„é«˜åº¦
			heights[j] = matrix[i][j] === '1' ? heights[j] + 1 : 0;
		}

		maxArea = Math.max(maxArea, largestRectangleArea(heights));
	}

	return maxArea;
};

var largestRectangleArea = function (heights) {
	const stack = [];
	let maxArea = 0;
	heights.push(0); // åœ¨æ•°ç»„æœ«å°¾æ·»åŠ 0ä»¥æ¸…ç©ºæ ˆ

	for (let i = 0; i < heights.length; i++) {
		while (stack.length && heights[i] < heights[stack[stack.length - 1]]) {
			const h = heights[stack.pop()];
			const w = stack.length ? i - stack[stack.length - 1] - 1 : i;
			maxArea = Math.max(maxArea, h * w);
		}
		stack.push(i);
	}

	return maxArea;
};
```

## ç›¸å…³é¢˜ç›®

| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 84 | [æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢](https://leetcode.com/problems/largest-rectangle-in-histogram) |  |  [`æ ˆ`](/leetcode/outline/tag/stack.md) [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`å•è°ƒæ ˆ`](/leetcode/outline/tag/monotonic-stack.md) | <font color=#ff334b>Hard</font> |
| 221 | [æœ€å¤§æ­£æ–¹å½¢](https://leetcode.com/problems/maximal-square) | [[âœ“]](https://2xiao.github.io/leetcode-js/leetcode/problem/0221) |  [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`åŠ¨æ€è§„åˆ’`](/leetcode/outline/tag/dynamic-programming.md) [`çŸ©é˜µ`](/leetcode/outline/tag/matrix.md) | <font color=#ffb800>Medium</font> |

<style>
.blue {
    background-color: #096dd9;
    padding: 0.25rem 0.5rem;
    margin: 0;
    font-size: 0.85em;
    border-radius: 3px;
    color: white;
    font-weight: 500;
}
table th:first-of-type { width: 10%; }
table th:nth-of-type(2) { width: 35%; }
table th:nth-of-type(3) { width: 10%; }
table th:nth-of-type(4) { width: 35%; }
table th:nth-of-type(5) { width: 10%; }
</style>
