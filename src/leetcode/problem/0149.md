# [149. ç›´çº¿ä¸Šæœ€å¤šçš„ç‚¹æ•°](https://leetcode.com/problems/max-points-on-a-line)

ðŸ”´ <font color=#ff334b>Hard</font>&emsp; ðŸ”–&ensp; [`å‡ ä½•`](/leetcode/outline/tag/geometry.md) [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`å“ˆå¸Œè¡¨`](/leetcode/outline/tag/hash-table.md) [`æ•°å­¦`](/leetcode/outline/tag/mathematics.md)&emsp; ðŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/max-points-on-a-line/)

## é¢˜ç›®

Given an array of `points` where `points[i] = [xi, yi]` represents a point on
the **X-Y** plane, return _the maximum number of points that lie on the same
straight line_.

**Example 1:**

![](https://assets.leetcode.com/uploads/2021/02/25/plane1.jpg)

> Input: points = [[1,1],[2,2],[3,3]]
>
> Output: 3

**Example 2:**

![](https://assets.leetcode.com/uploads/2021/02/25/plane2.jpg)

> Input: points = [[1,1],[3,2],[5,3],[4,1],[2,3],[1,4]]
>
> Output: 4

**Constraints:**

- `1 <= points.length <= 300`
- `points[i].length == 2`
- `-10^4 <= xi, yi <= 10^4`
- All the `points` are **unique**.

## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªæ•°ç»„ `points` ï¼Œå…¶ä¸­ `points[i] = [xi, yi]` è¡¨ç¤º `X-Y` å¹³é¢ä¸Šçš„ä¸€ä¸ªç‚¹ã€‚æ±‚æœ€å¤šæœ‰å¤šå°‘ä¸ªç‚¹åœ¨åŒä¸€æ¡ç›´çº¿ä¸Šã€‚

`points` ä¸­çš„æ‰€æœ‰ç‚¹ **äº’ä¸ç›¸åŒ**ã€‚

## è§£é¢˜æ€è·¯

é—®é¢˜çš„è§£å†³å…³é”®åœ¨äºŽå¦‚ä½•æœ‰æ•ˆåœ°è®¡ç®—å’Œæ¯”è¾ƒæ–œçŽ‡ï¼Œå¯ä»¥é€šè¿‡è§„èŒƒåŒ–æ–œçŽ‡å’Œä½¿ç”¨å“ˆå¸Œè¡¨æ¥è®°å½•ç‚¹çš„åˆ†å¸ƒï¼Œæ¥æ‰¾å‡ºæœ€å¤šå…±çº¿çš„ç‚¹ã€‚

1. **æ–œçŽ‡è®¡ç®—**ï¼š

   - å¯¹æ¯ä¸ªç‚¹ `points[i]`ï¼Œè®¡ç®—ä¸Žå…¶ä»–ç‚¹çš„æ–œçŽ‡å¹¶å­˜å…¥å“ˆå¸Œè¡¨ `obj`ã€‚
   - æ–œçŽ‡çš„è®¡ç®—å¯ä»¥é€šè¿‡ `(y2 - y1) / (x2 - x1)` å¾—åˆ°ï¼Œä½†ä¸ºäº†é¿å…æµ®ç‚¹æ•°è®¡ç®—å¸¦æ¥çš„ç²¾åº¦é—®é¢˜ï¼Œé€šå¸¸ä½¿ç”¨æ•´æ•°è¡¨ç¤ºæ–œçŽ‡ï¼Œå³ä½¿ç”¨ `(dy, dx)` å½¢å¼ï¼Œå…¶ä¸­ `dy = y2 - y1`ï¼Œ`dx = x2 - x1`ã€‚
   - å¯¹äºŽåž‚ç›´çº¿çš„æƒ…å†µè¦ç‰¹æ®Šå¤„ç†ã€‚

2. **æ ‡å‡†åŒ–æ–œçŽ‡**ï¼š

   - æ–œçŽ‡åº”å½“è¢«æ ‡å‡†åŒ–ä¸ºæœ€ç®€åˆ†æ•°å½¢å¼ï¼Œä»¥ç¡®ä¿ç›¸åŒæ–œçŽ‡çš„ç‚¹å¯ä»¥è¢«æ­£ç¡®è¯†åˆ«ã€‚
   - ä½¿ç”¨æœ€å¤§å…¬çº¦æ•° (GCD) æ¥ç®€åŒ–æ–œçŽ‡ã€‚

3. **ä½¿ç”¨å“ˆå¸Œè¡¨ç»Ÿè®¡**ï¼š

   - ä½¿ç”¨ä¸€ä¸ªå“ˆå¸Œè¡¨æ¥è®°å½•æ¯ä¸ªç‚¹çš„æ–œçŽ‡å¯¹åº”çš„ç‚¹çš„æ•°é‡ã€‚
   - éåŽ†æ¯ä¸ªç‚¹ï¼Œå°†å…¶ä»–ç‚¹çš„æ–œçŽ‡å­˜å…¥å“ˆå¸Œè¡¨ï¼Œå¹¶æ›´æ–°æœ€å¤šçš„ç‚¹æ•°ã€‚

4. **å¤„ç†é‡å¤ç‚¹**ï¼š

   - å¯¹äºŽé‡å¤çš„ç‚¹ï¼Œåº”å½“å•ç‹¬å¤„ç†ï¼Œç¡®ä¿å®ƒä»¬è¢«æ­£ç¡®è®¡å…¥å…±çº¿ç‚¹çš„æ€»æ•°ã€‚

5. **æ›´æ–°å…¨å±€æœ€å¤§å€¼**ï¼š
   - åœ¨æ¯ä¸ªç‚¹çš„è®¡ç®—ä¸­ï¼Œç®—å‡ºæœ€å¤šå…±çº¿çš„ç‚¹æ•° `max`ï¼ŒåŒ…æ‹¬å½“å‰ã€é‡å¤ç‚¹ä»¥åŠæ–œçŽ‡ç›¸åŒçš„ç‚¹ï¼Œæ›´æ–°å…¨å±€æœ€å¤§å€¼ `res`ã€‚

#### å¤æ‚åº¦åˆ†æž

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n^2)`ï¼Œæ¯ä¸ªç‚¹éƒ½ä¸Žå…¶ä»–ç‚¹è¿›è¡Œæ¯”è¾ƒã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œç”¨äºŽå­˜å‚¨æ–œçŽ‡çš„å“ˆå¸Œè¡¨ã€‚

## ä»£ç 

```javascript
/**
 * @param {number[][]} points
 * @return {number}
 */
var maxPoints = function (points) {
	const gcd = (a, b) => {
		if (b === 0) return a;
		return gcd(b, a % b);
	};

	let n = points.length,
		res = 0;

	if (n <= 2) return n;

	for (let i = 0; i < n; i++) {
		let obj = {},
			overlap = 0,
			max = 0,
			vertical = 0;
		for (let j = i + 1; j < n; j++) {
			let dx = points[i][0] - points[j][0],
				dy = points[i][1] - points[j][1];

			// é‡å¤ç‚¹
			if (dx == 0 && dy == 0) {
				overlap++;
				continue;
			}

			// åž‚ç›´çº¿
			if (dx == 0) {
				vertical++;
				continue;
			}

			// è§„èŒƒåŒ–æ–œçŽ‡
			const g = gcd(dy, dx);
			const slope = `${dy / g}/${dx / g}`;

			obj[slope] = (obj[slope] || 0) + 1;
			max = Math.max(max, obj[slope]);
		}
		// åŠ ä¸Šåž‚ç›´çº¿çš„æƒ…å†µ
		max = Math.max(max, vertical);

		// åŠ ä¸Šå½“å‰ç‚¹å’Œé‡å¤ç‚¹
		res = Math.max(res, max + overlap + 1);
	}
	return res;
};
```

## ç›¸å…³é¢˜ç›®

:::: md-demo ç›¸å…³é¢˜ç›®
- [356. ç›´çº¿é•œåƒ](https://leetcode.com/problems/line-reflection)
- [2152. ç©¿è¿‡æ‰€æœ‰ç‚¹çš„æ‰€éœ€æœ€å°‘ç›´çº¿æ•°é‡](https://leetcode.com/problems/minimum-number-of-lines-to-cover-points)
- [2280. è¡¨ç¤ºä¸€ä¸ªæŠ˜çº¿å›¾çš„æœ€å°‘çº¿æ®µæ•°](https://leetcode.com/problems/minimum-lines-to-represent-a-line-chart)

::::
