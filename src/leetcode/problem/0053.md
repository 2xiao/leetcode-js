# [53. Maximum Subarray](https://leetcode.com/problems/maximum-subarray/)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`åˆ†æ²»`](/leetcode/outline/tag/divide-and-conquer.md) [`åŠ¨æ€è§„åˆ’`](/leetcode/outline/tag/dynamic-programming.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/maximum-subarray/)

## é¢˜ç›®

Given an integer array `nums`, find the subarray with the largest sum, and
return _its sum_.

**Example 1:**

> Input: nums = [-2,1,-3,4,-1,2,1,-5,4]
>
> Output: 6
>
> Explanation: The subarray [4,-1,2,1] has the largest sum 6.

**Example 2:**

> Input: nums = [1]
>
> Output: 1
>
> Explanation: The subarray [1] has the largest sum 1.

**Example 3:**

> Input: nums = [5,4,-1,7,8]
>
> Output: 23
>
> Explanation: The subarray [5,4,-1,7,8] has the largest sum 23.

**Constraints:**

- `1 <= nums.length <= 10^5`
- `-10^4 <= nums[i] <= 10^4`

**Follow up:** If you have figured out the `O(n)` solution, try coding another
solution using the **divide and conquer** approach, which is more subtle.

## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums` ï¼Œè¯·ä½ æ‰¾å‡ºä¸€ä¸ªå…·æœ‰æœ€å¤§å’Œçš„è¿ç»­å­æ•°ç»„ï¼ˆå­æ•°ç»„æœ€å°‘åŒ…å«ä¸€ä¸ªå…ƒç´ ï¼‰ï¼Œè¿”å›å…¶æœ€å¤§å’Œã€‚

**å­æ•°ç»„** æ˜¯æ•°ç»„ä¸­çš„ä¸€ä¸ªè¿ç»­éƒ¨åˆ†ã€‚

**è¿›é˜¶**ï¼šå¦‚æœä½ å·²ç»å®ç°å¤æ‚åº¦ä¸º `O(n)` çš„è§£æ³•ï¼Œå°è¯•ä½¿ç”¨æ›´ä¸ºç²¾å¦™çš„ **åˆ†æ²»æ³•** æ±‚è§£ã€‚

## è§£é¢˜æ€è·¯

### æ€è·¯ä¸€ï¼šåŠ¨æ€è§„åˆ’

- è®¾ `dp[i]` è¡¨ç¤ºä»¥ç¬¬ `i` ä¸ªå…ƒç´ ç»“å°¾çš„æœ€å¤§å­åºå’Œ
- çŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¸ºï¼š`dp[i] = max(dp[i-1] + nums[i], nums[i])`
  - å¦‚æœ `dp[i-1]` ä¸ºæ­£æ•°ï¼Œè¡¨ç¤ºå‰é¢çš„å­åºå’Œå¯¹å½“å‰å…ƒç´ æœ‰ç§¯æçš„è´¡çŒ®ï¼Œå¯ä»¥ç»§ç»­ç´¯åŠ ï¼›
  - å¦‚æœ `dp[i-1]` ä¸ºè´Ÿæ•°ï¼Œè¡¨ç¤ºå‰é¢çš„å­åºå’Œå¯¹å½“å‰å…ƒç´ æ— ç§¯æçš„è´¡çŒ®ï¼Œå› æ­¤å½“å‰å…ƒç´ æˆä¸ºæ–°çš„èµ·ç‚¹ã€‚
- æœ€ç»ˆï¼Œæœ€å¤§å­åºå’Œå³ä¸ºæ‰€æœ‰ `dp[i]` ä¸­çš„æœ€å¤§å€¼ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œéå†ä¸€æ¬¡æ•°ç»„ã€‚

- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œä½¿ç”¨é•¿åº¦ä¸º `n` çš„æ•°ç»„è®°å½•å­é—®é¢˜çŠ¶æ€ã€‚

### æ€è·¯äºŒï¼šå‹ç¼©çŠ¶æ€çš„åŠ¨æ€è§„åˆ’

æ³¨æ„åˆ° `dp[i]` ä»…ä»…å’Œ `dp[i-1]` çš„çŠ¶æ€æœ‰å…³ï¼Œé‚£ä¹ˆå¯ä»¥è¿›è¡ŒçŠ¶æ€å‹ç¼©ï¼Œè¿›ä¸€æ­¥ä¼˜åŒ–ç©ºé—´å¤æ‚åº¦ï¼š

- ç”¨ `pre` å’Œ `cur` åˆ†åˆ«è¡¨ç¤ºä»¥ç¬¬ `i - 1` ä¸ªå’Œç¬¬ `i` ä¸ªå…ƒç´ ç»“å°¾çš„æœ€å¤§å­åºå’Œï¼›ç”¨ `res` è¡¨ç¤ºæœ€ç»ˆæ±‚å¾—çš„æœ€å¤§å€¼ï¼›
- çŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¸ºï¼š`cur = max(pre + nums[i], nums[i])`
- å¹¶æ›´æ–° `pre` å’Œ `res` ä¸¤ä¸ªå‚æ•°ï¼š
  - `pre = cur`;
  - `res = Math.max(res, cur)`;
- æœ€ç»ˆï¼Œæœ€å¤§å­åºå’Œå³ä¸º `res`ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œéå†ä¸€æ¬¡æ•°ç»„ã€‚

- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(1)`ï¼Œä½¿ç”¨å¸¸æ•°ä¸ªé¢å¤–å˜é‡ã€‚

### æ€è·¯ä¸‰ï¼šåˆ†æ²»

ä½¿ç”¨åˆ†æ²»æ³•è§£å†³æœ€å¤§å­åºå’Œé—®é¢˜ï¼Œå¯ä»¥å°†é—®é¢˜åˆ’åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼šå·¦åŠéƒ¨åˆ†çš„æœ€å¤§å­åºå’Œã€å³åŠéƒ¨åˆ†çš„æœ€å¤§å­åºå’Œä»¥åŠè·¨è¶Šä¸­ç‚¹çš„æœ€å¤§å­åºå’Œã€‚

1. **é€’å½’çš„ç»ˆæ­¢æ¡ä»¶ï¼š**

   - å½“åˆ’åˆ†åˆ°åªæœ‰ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œæœ€å¤§å­åºå’Œå°±æ˜¯è¿™ä¸ªå…ƒç´ æœ¬èº«ã€‚

2. **å·¦åŠéƒ¨åˆ†çš„æœ€å¤§å­åºå’Œï¼ˆé€’å½’è®¡ç®—ï¼‰ï¼š**

   - é€’å½’è®¡ç®—å·¦åŠéƒ¨åˆ†çš„æœ€å¤§å­åºå’Œï¼Œå³è°ƒç”¨ `maxSubArray(nums, low, mid)`ã€‚

3. **å³åŠéƒ¨åˆ†çš„æœ€å¤§å­åºå’Œï¼ˆé€’å½’è®¡ç®—ï¼‰ï¼š**

   - é€’å½’è®¡ç®—å³åŠéƒ¨åˆ†çš„æœ€å¤§å­åºå’Œï¼Œå³è°ƒç”¨ `maxSubArray(nums, mid+1, high)`ã€‚

4. **è·¨è¶Šä¸­ç‚¹çš„æœ€å¤§å­åºå’Œï¼š**

   - ä»ä¸­ç‚¹å‘å·¦ã€å‘å³åˆ†åˆ«è®¡ç®—æœ€å¤§å­åºå’Œï¼Œç„¶åç›¸åŠ ã€‚
   - ä»ä¸­ç‚¹å‘å·¦è®¡ç®—æ—¶ï¼Œä» `mid` å¼€å§‹å‘å·¦ç´¯åŠ ï¼Œå–ç´¯åŠ å’Œçš„æœ€å¤§å€¼ã€‚
   - ä»ä¸­ç‚¹å‘å³è®¡ç®—æ—¶ï¼Œä» `mid+1` å¼€å§‹å‘å³ç´¯åŠ ï¼Œå–ç´¯åŠ å’Œçš„æœ€å¤§å€¼ã€‚

5. **è¿”å›æœ€å¤§å€¼ï¼š**
   - æœ€ç»ˆï¼Œå–å·¦åŠéƒ¨åˆ†æœ€å¤§å­åºå’Œã€å³åŠéƒ¨åˆ†æœ€å¤§å­åºå’Œå’Œè·¨è¶Šä¸­ç‚¹çš„æœ€å¤§å­åºå’Œä¸­çš„æœ€å¤§å€¼ä½œä¸ºæ•´ä¸ªæ•°ç»„çš„æœ€å¤§å­åºå’Œã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n log n)`ï¼Œé€’å½’è°ƒç”¨çš„æ¬¡æ•°æ˜¯å¯¹æ•°çº§åˆ«ã€‚

- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(log n)`ï¼Œé€’å½’è°ƒç”¨çš„æ·±åº¦ã€‚

## ä»£ç 

::: code-tabs

@tab åŠ¨æ€è§„åˆ’

```javascript
/**
 * @param {number[]} nums
 * @return {number}
 */
var maxSubArray = function (nums) {
	let dp = new Array(nums.length);
	dp[0] = nums[0];
	for (let i = 1; i < nums.length; i++) {
		dp[i] = Math.max(nums[i], nums[i] + dp[i - 1]);
	}
	return Math.max(...dp);
};
```

@tab å‹ç¼©çŠ¶æ€çš„åŠ¨æ€è§„åˆ’

```javascript
/**
 * @param {number[]} nums
 * @return {number}
 */
var maxSubArray = function (nums) {
	let pre = nums[0];
	let cur = pre;
	let res = pre;
	for (let i = 1; i < nums.length; i++) {
		cur = Math.max(pre + nums[i], nums[i]);
		pre = cur;
		res = Math.max(res, cur);
	}
	return res;
};
```

@tab åˆ†æ²»

```javascript
/**
 * @param {number[]} nums
 * @return {number}
 */
var maxSubArray = function (nums) {
	if (!nums || nums.length === 0) {
		return 0;
	}

	return divideAndConquer(nums, 0, nums.length - 1);
};

function divideAndConquer(nums, low, high) {
	// é€’å½’ç»ˆæ­¢æ¡ä»¶
	if (low === high) {
		return nums[low];
	}

	// è®¡ç®—ä¸­ç‚¹
	const mid = Math.floor((low + high) / 2);

	// é€’å½’è®¡ç®—å·¦åŠéƒ¨åˆ†çš„æœ€å¤§å­åºå’Œ
	const maxLeft = divideAndConquer(nums, low, mid);

	// é€’å½’è®¡ç®—å³åŠéƒ¨åˆ†çš„æœ€å¤§å­åºå’Œ
	const maxRight = divideAndConquer(nums, mid + 1, high);

	// è®¡ç®—è·¨è¶Šä¸­ç‚¹çš„æœ€å¤§å­åºå’Œ
	const maxCross = maxCrossingSum(nums, low, mid, high);

	// è¿”å›ä¸‰è€…ä¸­çš„æœ€å¤§å€¼
	return Math.max(maxLeft, maxRight, maxCross);
}

function maxCrossingSum(nums, low, mid, high) {
	let leftSum = Number.NEGATIVE_INFINITY;
	let sum = 0;

	// ä»ä¸­ç‚¹å‘å·¦è®¡ç®—æœ€å¤§å­åºå’Œ
	for (let i = mid; i >= low; i--) {
		sum += nums[i];
		leftSum = Math.max(leftSum, sum);
	}

	let rightSum = Number.NEGATIVE_INFINITY;
	sum = 0;

	// ä»ä¸­ç‚¹å‘å³è®¡ç®—æœ€å¤§å­åºå’Œ
	for (let i = mid + 1; i <= high; i++) {
		sum += nums[i];
		rightSum = Math.max(rightSum, sum);
	}

	// è¿”å›è·¨è¶Šä¸­ç‚¹çš„æœ€å¤§å­åºå’Œ
	return leftSum + rightSum;
}
```

:::

## ç›¸å…³é¢˜ç›®

:::: md-demo ç›¸å…³é¢˜ç›®

- [121. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº](https://leetcode.com/problems/best-time-to-buy-and-sell-stock)
- [152. ä¹˜ç§¯æœ€å¤§å­æ•°ç»„](./0152.md)
- [697. æ•°ç»„çš„åº¦](https://leetcode.com/problems/degree-of-an-array)
- [978. æœ€é•¿æ¹æµå­æ•°ç»„](https://leetcode.com/problems/longest-turbulent-subarray)
- [2321. æ‹¼æ¥æ•°ç»„çš„æœ€å¤§åˆ†æ•°](https://leetcode.com/problems/maximum-score-of-spliced-array)
- [1749. ä»»æ„å­æ•°ç»„å’Œçš„ç»å¯¹å€¼çš„æœ€å¤§å€¼](https://leetcode.com/problems/maximum-absolute-sum-of-any-subarray)
- [ğŸ”’ Maximum Subarray Sum After One Operation](https://leetcode.com/problems/maximum-subarray-sum-after-one-operation)
- [2272. æœ€å¤§æ³¢åŠ¨çš„å­å­—ç¬¦ä¸²](https://leetcode.com/problems/substring-with-largest-variance)
- [2302. ç»Ÿè®¡å¾—åˆ†å°äº K çš„å­æ•°ç»„æ•°ç›®](https://leetcode.com/problems/count-subarrays-with-score-less-than-k)
- [2496. æ•°ç»„ä¸­å­—ç¬¦ä¸²çš„æœ€å¤§å€¼](https://leetcode.com/problems/maximum-value-of-a-string-in-an-array)
- [2606. æ‰¾åˆ°æœ€å¤§å¼€é”€çš„å­å­—ç¬¦ä¸²](https://leetcode.com/problems/find-the-substring-with-maximum-cost)
- [2600. K ä»¶ç‰©å“çš„æœ€å¤§å’Œ](https://leetcode.com/problems/k-items-with-the-maximum-sum)

::::
