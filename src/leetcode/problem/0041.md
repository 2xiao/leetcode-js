# [41. First Missing Positive](https://leetcode.com/problems/first-missing-positive/)

ðŸ”´ <font color=#ff334b>Hard</font>&emsp; ðŸ”–&ensp; [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`å“ˆå¸Œè¡¨`](/leetcode/outline/tag/hash-table.md)&emsp; ðŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/first-missing-positive/)

## é¢˜ç›®

Given an unsorted integer array `nums`, return the smallest missing positive
integer.

You must implement an algorithm that runs in `O(n)` time and uses `O(1)`
auxiliary space.

**Example 1:**

> Input: nums = [1,2,0]
>
> Output: 3
>
> Explanation: The numbers in the range [1,2] are all in the array.

**Example 2:**

> Input: nums = [3,4,-1,1]
>
> Output: 2
>
> Explanation: 1 is in the array but 2 is missing.

**Example 3:**

> Input: nums = [7,8,9,11,12]
>
> Output: 1
>
> Explanation: The smallest positive integer 1 is missing.

**Constraints:**

- `1 <= nums.length <= 10^5`
- `-2^31 <= nums[i] <= 2^31 - 1`

## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªæœªæŽ’åºçš„æ•´æ•°æ•°ç»„ `nums` ï¼Œè¯·ä½ æ‰¾å‡ºå…¶ä¸­æ²¡æœ‰å‡ºçŽ°çš„æœ€å°çš„æ­£æ•´æ•°ã€‚

è¯·ä½ å®žçŽ°æ—¶é—´å¤æ‚åº¦ä¸º `O(n)` å¹¶ä¸”åªä½¿ç”¨å¸¸æ•°çº§åˆ«é¢å¤–ç©ºé—´çš„è§£å†³æ–¹æ¡ˆã€‚

## è§£é¢˜æ€è·¯

### æ€è·¯ä¸€ï¼šå“ˆå¸Œè¡¨

ä¸ºäº†å‡å°‘æ—¶é—´å¤æ‚åº¦ï¼Œå¯ä»¥æŠŠ `input` æ•°ç»„éƒ½è£…åˆ° `map` ä¸­ï¼Œç„¶åŽ `i` å¾ªçŽ¯ä»Ž `1` å¼€å§‹ï¼Œä¾æ¬¡æ¯”å¯¹ `map` ä¸­æ˜¯å¦å­˜åœ¨ `i`ï¼Œåªè¦ä¸å­˜åœ¨ `i` å°±ç«‹å³è¿”å›žç»“æžœï¼Œå³æ‰€æ±‚ã€‚ä½†æ˜¯è¿™ç§æ–¹æ³•çš„ç©ºé—´å¤æ‚åº¦ä¸º `O(n)`ï¼Œä¸æ»¡è¶³é¢˜æ„ã€‚

#### å¤æ‚åº¦åˆ†æž

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œéœ€è¦éåŽ†æ•°ç»„ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œéœ€è¦ä¸€ä¸ªå¤§å°ä¸º `n` çš„å“ˆå¸Œè¡¨å­˜å‚¨æ•°æ®ã€‚

### æ€è·¯äºŒï¼šåŽŸåœ°å“ˆå¸Œ

åŽŸåœ°å“ˆå¸Œçš„æ„æ€æ˜¯åˆ©ç”¨æ•°ç»„çš„ç´¢å¼•æ¥å­˜å‚¨å…ƒç´ çš„å­˜åœ¨æ€§ã€‚å…·ä½“æ¥è¯´ï¼Œå°†æ¯ä¸ªå€¼ `x` æ”¾åˆ°æ•°ç»„çš„ç´¢å¼• `x-1` å¤„ï¼ˆå³ `nums[x-1]`ï¼‰ï¼Œå¦‚æžœ `x` çš„å€¼åœ¨ `[1, n]` èŒƒå›´å†…ã€‚è¿™æ ·åšçš„å‰ææ˜¯ï¼Œæ•°ç»„ä¸­åªæœ‰æ­£æ•´æ•°ã€‚

- **éåŽ†æ•°ç»„**ï¼š

  - é¦–å…ˆéåŽ†æ•°ç»„ï¼Œå°†æ¯ä¸ªæœ‰æ•ˆçš„æ­£æ•´æ•°æ”¾åˆ°æ­£ç¡®çš„ä½ç½®ï¼ˆå³å°† `x` æ”¾åˆ° `nums[x-1]`ï¼‰ã€‚
  - å¯¹äºŽæ¯ä¸ªå€¼ `x`ï¼Œå¦‚æžœ `1 â‰¤ x â‰¤ n`ï¼Œå¹¶ä¸” `nums[x-1]` ä¸æ˜¯ `x`ï¼Œåˆ™äº¤æ¢ `nums[i]` å’Œ `nums[x-1]`ï¼Œç›´åˆ° `nums[i]` åœ¨æ­£ç¡®çš„ä½ç½®ã€‚

- **ç¬¬äºŒæ¬¡éåŽ†**ï¼š

  - å†æ¬¡éåŽ†æ•°ç»„ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªä½ç½® `i`ï¼Œä½¿å¾— `nums[i]` ä¸ç­‰äºŽ `i + 1`ï¼Œé‚£ä¹ˆ `i + 1` å°±æ˜¯ç¼ºå¤±çš„æ­£æ•´æ•°ã€‚

- **è¾¹ç•Œæƒ…å†µ**ï¼š
  - å¦‚æžœæ‰€æœ‰ä½ç½®éƒ½æ»¡è¶³ `nums[i] = i + 1`ï¼Œé‚£ä¹ˆç¼ºå¤±çš„ç¬¬ä¸€ä¸ªæ­£æ•´æ•°å°±æ˜¯ `n + 1`ã€‚

#### å¤æ‚åº¦åˆ†æž

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œæ•°ç»„åªéåŽ†äº†ä¸¤æ¬¡ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(1)`ï¼Œåªä½¿ç”¨äº†å¸¸é‡çº§åˆ«çš„é¢å¤–ç©ºé—´ã€‚

## ä»£ç 

:::: code-tabs

@tab å“ˆå¸Œè¡¨

```javascript
/**
 * @param {number[]} nums
 * @return {number}
 */
var firstMissingPositive = function (nums) {
	let map = new Map();
	for (let i of nums) {
		map.set(i, true);
	}
	let i = 1;
	while (true) {
		if (map.has(i)) i++;
		else return i;
	}
};
```

@tab åŽŸåœ°å“ˆå¸Œ

```javascript
/**
 * @param {number[]} nums
 * @return {number}
 */
var firstMissingPositive = function (nums) {
	const n = nums.length;

	// 1. å°†æ¯ä¸ªæ•°æ”¾åˆ°å¯¹åº”çš„ä½ç½®
	for (let i = 0; i < n; i++) {
		while (nums[i] > 0 && nums[i] <= n && nums[nums[i] - 1] !== nums[i]) {
			// äº¤æ¢ nums[i] å’Œ nums[nums[i] - 1]
			const temp = nums[i];
			nums[i] = nums[temp - 1];
			nums[temp - 1] = temp;
		}
	}

	// 2. æŸ¥æ‰¾ç¬¬ä¸€ä¸ªç¼ºå¤±çš„æ­£æ•´æ•°
	for (let i = 0; i < n; i++) {
		if (nums[i] !== i + 1) {
			return i + 1; // æ‰¾åˆ°ç¬¬ä¸€ä¸ªç¼ºå¤±çš„æ­£æ•´æ•°
		}
	}

	return n + 1; // å¦‚æžœ 1 åˆ° n çš„æ­£æ•´æ•°éƒ½åœ¨
};
```

::::

## ç›¸å…³é¢˜ç›®

:::: md-demo ç›¸å…³é¢˜ç›®

- [268. ä¸¢å¤±çš„æ•°å­—](https://leetcode.com/problems/missing-number)
- [287. å¯»æ‰¾é‡å¤æ•°](https://leetcode.com/problems/find-the-duplicate-number)
- [448. æ‰¾åˆ°æ‰€æœ‰æ•°ç»„ä¸­æ¶ˆå¤±çš„æ•°å­—](https://leetcode.com/problems/find-all-numbers-disappeared-in-an-array)
- [765. æƒ…ä¾£ç‰µæ‰‹](https://leetcode.com/problems/couples-holding-hands)
- [2336. æ— é™é›†ä¸­çš„æœ€å°æ•°å­—](https://leetcode.com/problems/smallest-number-in-infinite-set)
- [2554. ä»Žä¸€ä¸ªèŒƒå›´å†…é€‰æ‹©æœ€å¤šæ•´æ•° I](https://leetcode.com/problems/maximum-number-of-integers-to-choose-from-a-range-i)
- [2598. æ‰§è¡Œæ“ä½œåŽçš„æœ€å¤§ MEX](https://leetcode.com/problems/smallest-missing-non-negative-integer-after-operations)
- [ðŸ”’ Maximum Number of Integers to Choose From a Range II](https://leetcode.com/problems/maximum-number-of-integers-to-choose-from-a-range-ii)

::::
