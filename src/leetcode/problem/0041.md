# [41. ç¼ºå¤±çš„ç¬¬ä¸€ä¸ªæ­£æ•°](https://leetcode.com/problems/first-missing-positive)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`å“ˆå¸Œè¡¨`](/leetcode/outline/tag/hash-table.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/first-missing-positive/)

## é¢˜ç›®

Given an unsorted integer array `nums`, return the smallest missing positive
integer.

You must implement an algorithm that runs in `O(n)` time and uses `O(1)`
auxiliary space.

**Example 1:**

> Input: nums = [1,2,0]
>
> Output: 3
>
> Explanation: The numbers in the range [1,2] are all in the array.

**Example 2:**

> Input: nums = [3,4,-1,1]
>
> Output: 2
>
> Explanation: 1 is in the array but 2 is missing.

**Example 3:**

> Input: nums = [7,8,9,11,12]
>
> Output: 1
>
> Explanation: The smallest positive integer 1 is missing.

**Constraints:**

- `1 <= nums.length <= 10^5`
- `-2^31 <= nums[i] <= 2^31 - 1`

## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªæœªæ’åºçš„æ•´æ•°æ•°ç»„ `nums` ï¼Œè¯·ä½ æ‰¾å‡ºå…¶ä¸­æ²¡æœ‰å‡ºç°çš„æœ€å°çš„æ­£æ•´æ•°ã€‚

è¯·ä½ å®ç°æ—¶é—´å¤æ‚åº¦ä¸º `O(n)` å¹¶ä¸”åªä½¿ç”¨å¸¸æ•°çº§åˆ«é¢å¤–ç©ºé—´çš„è§£å†³æ–¹æ¡ˆã€‚

## è§£é¢˜æ€è·¯

### æ€è·¯ä¸€ï¼šå“ˆå¸Œè¡¨

ä¸ºäº†å‡å°‘æ—¶é—´å¤æ‚åº¦ï¼Œå¯ä»¥æŠŠ `input` æ•°ç»„éƒ½è£…åˆ° `map` ä¸­ï¼Œç„¶å `i` å¾ªç¯ä» `1` å¼€å§‹ï¼Œä¾æ¬¡æ¯”å¯¹ `map` ä¸­æ˜¯å¦å­˜åœ¨ `i`ï¼Œåªè¦ä¸å­˜åœ¨ `i` å°±ç«‹å³è¿”å›ç»“æœï¼Œå³æ‰€æ±‚ã€‚ä½†æ˜¯è¿™ç§æ–¹æ³•çš„ç©ºé—´å¤æ‚åº¦ä¸º `O(n)`ï¼Œä¸æ»¡è¶³é¢˜æ„ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œéœ€è¦éå†æ•°ç»„ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œéœ€è¦ä¸€ä¸ªå¤§å°ä¸º `n` çš„å“ˆå¸Œè¡¨å­˜å‚¨æ•°æ®ã€‚

---

### æ€è·¯äºŒï¼šåŸåœ°å“ˆå¸Œ

åŸåœ°å“ˆå¸Œçš„æ„æ€æ˜¯åˆ©ç”¨æ•°ç»„çš„ç´¢å¼•æ¥å­˜å‚¨å…ƒç´ çš„å­˜åœ¨æ€§ã€‚å…·ä½“æ¥è¯´ï¼Œå°†æ¯ä¸ªå€¼ `x` æ”¾åˆ°æ•°ç»„çš„ç´¢å¼• `x-1` å¤„ï¼ˆå³ `nums[x-1]`ï¼‰ï¼Œå¦‚æœ `x` çš„å€¼åœ¨ `[1, n]` èŒƒå›´å†…ã€‚è¿™æ ·åšçš„å‰ææ˜¯ï¼Œæ•°ç»„ä¸­åªæœ‰æ­£æ•´æ•°ã€‚

- **éå†æ•°ç»„**ï¼š

  - é¦–å…ˆéå†æ•°ç»„ï¼Œå°†æ¯ä¸ªæœ‰æ•ˆçš„æ­£æ•´æ•°æ”¾åˆ°æ­£ç¡®çš„ä½ç½®ï¼ˆå³å°† `x` æ”¾åˆ° `nums[x-1]`ï¼‰ã€‚
  - å¯¹äºæ¯ä¸ªå€¼ `x`ï¼Œå¦‚æœ `1 â‰¤ x â‰¤ n`ï¼Œå¹¶ä¸” `nums[x-1]` ä¸æ˜¯ `x`ï¼Œåˆ™äº¤æ¢ `nums[i]` å’Œ `nums[x-1]`ï¼Œç›´åˆ° `nums[i]` åœ¨æ­£ç¡®çš„ä½ç½®ã€‚

- **ç¬¬äºŒæ¬¡éå†**ï¼š

  - å†æ¬¡éå†æ•°ç»„ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªä½ç½® `i`ï¼Œä½¿å¾— `nums[i]` ä¸ç­‰äº `i + 1`ï¼Œé‚£ä¹ˆ `i + 1` å°±æ˜¯ç¼ºå¤±çš„æ­£æ•´æ•°ã€‚

- **è¾¹ç•Œæƒ…å†µ**ï¼š
  - å¦‚æœæ‰€æœ‰ä½ç½®éƒ½æ»¡è¶³ `nums[i] = i + 1`ï¼Œé‚£ä¹ˆç¼ºå¤±çš„ç¬¬ä¸€ä¸ªæ­£æ•´æ•°å°±æ˜¯ `n + 1`ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œæ•°ç»„åªéå†äº†ä¸¤æ¬¡ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(1)`ï¼Œåªä½¿ç”¨äº†å¸¸é‡çº§åˆ«çš„é¢å¤–ç©ºé—´ã€‚

## ä»£ç 

:::: code-tabs

@tab å“ˆå¸Œè¡¨

```javascript
/**
 * @param {number[]} nums
 * @return {number}
 */
var firstMissingPositive = function (nums) {
	let map = new Map();
	for (let i of nums) {
		map.set(i, true);
	}
	let i = 1;
	while (true) {
		if (map.has(i)) i++;
		else return i;
	}
};
```

@tab åŸåœ°å“ˆå¸Œ

```javascript
/**
 * @param {number[]} nums
 * @return {number}
 */
var firstMissingPositive = function (nums) {
	const n = nums.length;

	// 1. å°†æ¯ä¸ªæ•°æ”¾åˆ°å¯¹åº”çš„ä½ç½®
	for (let i = 0; i < n; i++) {
		while (nums[i] > 0 && nums[i] <= n && nums[nums[i] - 1] !== nums[i]) {
			// äº¤æ¢ nums[i] å’Œ nums[nums[i] - 1]
			const temp = nums[i];
			nums[i] = nums[temp - 1];
			nums[temp - 1] = temp;
		}
	}

	// 2. æŸ¥æ‰¾ç¬¬ä¸€ä¸ªç¼ºå¤±çš„æ­£æ•´æ•°
	for (let i = 0; i < n; i++) {
		if (nums[i] !== i + 1) {
			return i + 1; // æ‰¾åˆ°ç¬¬ä¸€ä¸ªç¼ºå¤±çš„æ­£æ•´æ•°
		}
	}

	return n + 1; // å¦‚æœ 1 åˆ° n çš„æ­£æ•´æ•°éƒ½åœ¨
};
```

::::

## ç›¸å…³é¢˜ç›®

| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 268 | [ä¸¢å¤±çš„æ•°å­—](https://leetcode.com/problems/missing-number) | [[âœ“]](https://2xiao.github.io/leetcode-js/leetcode/problem/0268) |  [`ä½è¿ç®—`](/leetcode/outline/tag/bit-manipulation.md) [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`å“ˆå¸Œè¡¨`](/leetcode/outline/tag/hash-table.md) `3+` | <font color=#15bd66>Easy</font> |
| 287 | [å¯»æ‰¾é‡å¤æ•°](https://leetcode.com/problems/find-the-duplicate-number) |  |  [`ä½è¿ç®—`](/leetcode/outline/tag/bit-manipulation.md) [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`åŒæŒ‡é’ˆ`](/leetcode/outline/tag/two-pointers.md) `1+` | <font color=#ffb800>Medium</font> |
| 448 | [æ‰¾åˆ°æ‰€æœ‰æ•°ç»„ä¸­æ¶ˆå¤±çš„æ•°å­—](https://leetcode.com/problems/find-all-numbers-disappeared-in-an-array) |  |  [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`å“ˆå¸Œè¡¨`](/leetcode/outline/tag/hash-table.md) | <font color=#15bd66>Easy</font> |
| 765 | [æƒ…ä¾£ç‰µæ‰‹](https://leetcode.com/problems/couples-holding-hands) |  |  [`è´ªå¿ƒ`](/leetcode/outline/tag/greedy.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/leetcode/outline/tag/depth-first-search.md) [`å¹¿åº¦ä¼˜å…ˆæœç´¢`](/leetcode/outline/tag/breadth-first-search.md) `2+` | <font color=#ff334b>Hard</font> |
| 2336 | [æ— é™é›†ä¸­çš„æœ€å°æ•°å­—](https://leetcode.com/problems/smallest-number-in-infinite-set) |  |  [`è®¾è®¡`](/leetcode/outline/tag/design.md) [`å“ˆå¸Œè¡¨`](/leetcode/outline/tag/hash-table.md) [`æœ‰åºé›†åˆ`](/leetcode/outline/tag/ordered-set.md) `1+` | <font color=#ffb800>Medium</font> |
| 2554 | [ä»ä¸€ä¸ªèŒƒå›´å†…é€‰æ‹©æœ€å¤šæ•´æ•° I](https://leetcode.com/problems/maximum-number-of-integers-to-choose-from-a-range-i) |  |  [`è´ªå¿ƒ`](/leetcode/outline/tag/greedy.md) [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`å“ˆå¸Œè¡¨`](/leetcode/outline/tag/hash-table.md) `2+` | <font color=#ffb800>Medium</font> |
| 2557 | [ä»ä¸€ä¸ªèŒƒå›´å†…é€‰æ‹©æœ€å¤šæ•´æ•° II](https://leetcode.com/problems/maximum-number-of-integers-to-choose-from-a-range-ii) |  |  [`è´ªå¿ƒ`](/leetcode/outline/tag/greedy.md) [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`äºŒåˆ†æŸ¥æ‰¾`](/leetcode/outline/tag/binary-search.md) `1+` | <font color=#ffb800>Medium</font> |
| 2598 | [æ‰§è¡Œæ“ä½œåçš„æœ€å¤§ MEX](https://leetcode.com/problems/smallest-missing-non-negative-integer-after-operations) |  |  [`è´ªå¿ƒ`](/leetcode/outline/tag/greedy.md) [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`å“ˆå¸Œè¡¨`](/leetcode/outline/tag/hash-table.md) `1+` | <font color=#ffb800>Medium</font> |
| 2996 | [å¤§äºç­‰äºé¡ºåºå‰ç¼€å’Œçš„æœ€å°ç¼ºå¤±æ•´æ•°](https://leetcode.com/problems/smallest-missing-integer-greater-than-sequential-prefix-sum) |  |  [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`å“ˆå¸Œè¡¨`](/leetcode/outline/tag/hash-table.md) [`æ’åº`](/leetcode/outline/tag/sorting.md) | <font color=#15bd66>Easy</font> |

<style>
.blue {
    background-color: #096dd9;
    padding: 0.25rem 0.5rem;
    margin: 0;
    font-size: 0.85em;
    border-radius: 3px;
    color: white;
    font-weight: 500;
}
table th:first-of-type { width: 10%; }
table th:nth-of-type(2) { width: 35%; }
table th:nth-of-type(3) { width: 10%; }
table th:nth-of-type(4) { width: 35%; }
table th:nth-of-type(5) { width: 10%; }
</style>
