# [1590. ä½¿æ•°ç»„å’Œèƒ½è¢« P æ•´é™¤](https://leetcode.com/problems/make-sum-divisible-by-p)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`å“ˆå¸Œè¡¨`](/leetcode/outline/tag/hash-table.md) [`å‰ç¼€å’Œ`](/leetcode/outline/tag/prefix-sum.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/make-sum-divisible-by-p)

## é¢˜ç›®

Given an array of positive integers `nums`, remove the **smallest** subarray
(possibly **empty** ) such that the **sum** of the remaining elements is
divisible by `p`. It is **not** allowed to remove the whole array.

Return _the length of the smallest subarray that you need to remove, or_`-1`
_if it 's impossible_.

A **subarray** is defined as a contiguous block of elements in the array.

**Example 1:**

> Input: nums = [3,1,4,2], p = 6
>
> Output: 1
>
> Explanation: The sum of the elements in nums is 10, which is not divisible by 6. We can remove the subarray [4], and the sum of the remaining elements is 6, which is divisible by 6.

**Example 2:**

> Input: nums = [6,3,5,2], p = 9
>
> Output: 2
>
> Explanation: We cannot remove a single element to get a sum divisible by 9. The best way is to remove the subarray [5,2], leaving us with [6,3] with sum 9.

**Example 3:**

> Input: nums = [1,2,3], p = 3
>
> Output: 0
>
> Explanation: Here the sum is 6. which is already divisible by 3. Thus we do not need to remove anything.

**Constraints:**

- `1 <= nums.length <= 10^5`
- `1 <= nums[i] <= 10^9`
- `1 <= p <= 10^9`

## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªæ­£æ•´æ•°æ•°ç»„ `nums`ï¼Œè¯·ä½ ç§»é™¤ **æœ€çŸ­** å­æ•°ç»„ï¼ˆå¯ä»¥ä¸º **ç©º**ï¼‰ï¼Œä½¿å¾—å‰©ä½™å…ƒç´ çš„ **å’Œ** èƒ½è¢« `p` æ•´é™¤ã€‚ **ä¸å…è®¸** å°†æ•´ä¸ªæ•°ç»„éƒ½ç§»é™¤ã€‚

è¯·ä½ è¿”å›ä½ éœ€è¦ç§»é™¤çš„æœ€çŸ­å­æ•°ç»„çš„é•¿åº¦ï¼Œå¦‚æœæ— æ³•æ»¡è¶³é¢˜ç›®è¦æ±‚ï¼Œè¿”å› `-1` ã€‚

**å­æ•°ç»„** å®šä¹‰ä¸ºåŸæ•°ç»„ä¸­è¿ç»­çš„ä¸€ç»„å…ƒç´ ã€‚

## è§£é¢˜æ€è·¯

1. **è®¡ç®—æ€»å’Œ**ï¼š

   - ä½¿ç”¨ `reduce` æ–¹æ³•è®¡ç®—æ•°ç»„ `nums` çš„æ€»å’Œï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨å˜é‡ `sum` ä¸­ã€‚

2. **ç¡®å®šæ€»ä½™æ•°**ï¼š

   - è®¡ç®— `totalRemainder` ä¸º `sum % p`ã€‚å¦‚æœ `totalRemainder` ä¸º `0`ï¼Œè¯´æ˜æ•´ä¸ªæ•°ç»„çš„å’Œå·²ç»å¯ä»¥è¢« `p` æ•´é™¤ï¼Œå› æ­¤ç›´æ¥è¿”å› `0`ï¼Œå› ä¸ºä¸éœ€è¦ç§»é™¤ä»»ä½•å…ƒç´ ã€‚

3. **åˆå§‹åŒ–å˜é‡**ï¼š

   - åˆ›å»ºä¸€ä¸ªå“ˆå¸Œè¡¨ `map`ï¼Œç”¨äºå­˜å‚¨é‡åˆ°çš„ä½™æ•°åŠå…¶å¯¹åº”çš„ç´¢å¼•ã€‚åˆå§‹åŒ–æ—¶å°† `{0: -1}` æ”¾å…¥å…¶ä¸­ï¼Œä»¥å¤„ç†å¯èƒ½éœ€è¦ä»æ•°ç»„å¼€å¤´ç§»é™¤å…ƒç´ çš„æƒ…å†µã€‚
   - åˆå§‹åŒ– `curRemainder` ä¸º `0`ï¼Œç”¨äºåœ¨éå†æ•°ç»„æ—¶å­˜å‚¨å½“å‰ç´¯ç§¯å’Œçš„ä½™æ•°ã€‚
   - å°† `res` è®¾ç½®ä¸ºæ•°ç»„çš„é•¿åº¦ (`nums.length`)ï¼Œç”¨äºè·Ÿè¸ªéœ€è¦ç§»é™¤çš„æœ€å°å­æ•°ç»„é•¿åº¦ã€‚

4. **éå†æ•°ç»„**ï¼š

   - éå†æ•°ç»„ï¼Œæ›´æ–°å½“å‰å’Œçš„ä½™æ•°ã€‚å¯¹äºæ¯ä¸ªå…ƒç´ ï¼Œæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ªä»¥å‰çš„ä½™æ•°ï¼Œä½¿å¾— `curRemainder - totalRemainder` å¯ä»¥è¢« `p` æ•´é™¤ã€‚
   - å¦‚æœæ‰¾åˆ°ï¼Œè®¡ç®—éœ€è¦ç§»é™¤çš„å­æ•°ç»„çš„é•¿åº¦ï¼Œå¹¶æ›´æ–°æœ€å°é•¿åº¦ã€‚
   - å°†å½“å‰çš„ `curRemainder` å’Œå…¶ç´¢å¼• `i` å­˜å…¥å“ˆå¸Œè¡¨ï¼Œä»¥ä¾¿åç»­ä½¿ç”¨ã€‚

5. **è¿”å›ç»“æœ**ï¼š
   - éå†ç»“æŸåï¼Œæ£€æŸ¥ `res` æ˜¯å¦ä»ç­‰äºæ•°ç»„çš„é•¿åº¦ã€‚å¦‚æœæ˜¯ï¼Œè¿”å› `-1`ï¼Œè¡¨ç¤ºæ— æ³•æ‰¾åˆ°åˆé€‚çš„å­æ•°ç»„ï¼›å¦åˆ™ï¼Œè¿”å› `res` çš„å€¼ï¼Œè¡¨ç¤ºéœ€è¦ç§»é™¤çš„æœ€å°å­æ•°ç»„é•¿åº¦ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œéœ€è¦éå†æ•°ç»„ä¸€æ¬¡ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œç”¨äºå­˜å‚¨å“ˆå¸Œè¡¨ã€‚

## ä»£ç 

```javascript
/**
 * @param {number[]} nums
 * @param {number} p
 * @return {number}
 */
var minSubarray = function (nums, p) {
	const sum = nums.reduce((a, b) => a + b, 0);
	const totalRemainder = sum % p;
	// å¦‚æœæ€»å’Œå·²ç»å¯ä»¥è¢« p æ•´é™¤ï¼Œç›´æ¥è¿”å› 0
	if (totalRemainder == 0) return 0;

	let map = new Map(),
		curRemainder = 0,
		res = nums.length;

	// å¤„ç†è¾¹ç•Œæƒ…å†µ
	map.set(0, -1);

	for (let i = 0; i < nums.length; i++) {
		// è®¡ç®—å½“å‰çš„ä½™æ•°
		curRemainder = (curRemainder + nums[i]) % p;
		// è®¡ç®—éœ€è¦çš„ä½™æ•°
		const targetRemainder = (curRemainder - totalRemainder + p) % p;
		// å¦‚æœå­˜åœ¨è¿™æ ·çš„ä½™æ•°
		if (map.has(targetRemainder)) {
			res = Math.min(res, i - map.get(targetRemainder));
		}
		// è®°å½•å½“å‰ä½™æ•°åŠå…¶ç´¢å¼•
		map.set(curRemainder, i);
	}
	// å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œè¿”å› -1
	return res == nums.length ? -1 : res;
};
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 974 | [å’Œå¯è¢« K æ•´é™¤çš„å­æ•°ç»„](https://leetcode.com/problems/subarray-sums-divisible-by-k) |  |  [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`å“ˆå¸Œè¡¨`](/leetcode/outline/tag/hash-table.md) [`å‰ç¼€å’Œ`](/leetcode/outline/tag/prefix-sum.md) | <font color=#ffb800>Medium</font> |
| 2575 | [æ‰¾å‡ºå­—ç¬¦ä¸²çš„å¯æ•´é™¤æ•°ç»„](https://leetcode.com/problems/find-the-divisibility-array-of-a-string) |  |  [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`æ•°å­¦`](/leetcode/outline/tag/math.md) [`å­—ç¬¦ä¸²`](/leetcode/outline/tag/string.md) | <font color=#ffb800>Medium</font> |

<style>
.blue {
    background-color: #096dd9;
    padding: 0.25rem 0.5rem;
    margin: 0;
    font-size: 0.85em;
    border-radius: 3px;
    color: white;
    font-weight: 500;
}
table th:first-of-type { width: 10%; }
table th:nth-of-type(2) { width: 35%; }
table th:nth-of-type(3) { width: 10%; }
table th:nth-of-type(4) { width: 35%; }
table th:nth-of-type(5) { width: 10%; }
</style>
