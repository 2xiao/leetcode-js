# [47. å…¨æŽ’åˆ— II](https://leetcode.com/problems/permutations-ii)

ðŸŸ  <font color=#ffb800>Medium</font>&emsp; ðŸ”–&ensp; [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`å›žæº¯`](/leetcode/outline/tag/backtracking.md)&emsp; ðŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/permutations-ii/)

## é¢˜ç›®

Given a collection of numbers, `nums`, that might contain duplicates, return
_all possible unique permutations **in any order**._

**Example 1:**

> Input: nums = [1,1,2]
>
> Output:
>
> [[1,1,2],
>
> [1,2,1],
>
> [2,1,1]]

**Example 2:**

> Input: nums = [1,2,3]
>
> Output: [[1,2,3],[1,3,2],[2,1,3],[2,3,1],[3,1,2],[3,2,1]]

**Constraints:**

- `1 <= nums.length <= 8`
- `-10 <= nums[i] <= 10`

## é¢˜ç›®å¤§æ„

ç»™å®šä¸€ä¸ªå¯åŒ…å«é‡å¤æ•°å­—çš„åºåˆ— `nums` ï¼Œ**æŒ‰ä»»æ„é¡ºåº** è¿”å›žæ‰€æœ‰ä¸é‡å¤çš„å…¨æŽ’åˆ—ã€‚

## è§£é¢˜æ€è·¯

å¯ä»¥ä½¿ç”¨å›žæº¯ç®—æ³•ç”Ÿæˆå…¨æŽ’åˆ—ï¼ŒåŒæ—¶å¤„ç†æ•°ç»„ä¸­å¯èƒ½å­˜åœ¨é‡å¤å…ƒç´ çš„æƒ…å†µï¼š

1. å®šä¹‰ä¸€ä¸ªç»“æžœæ•°ç»„ `res`ï¼Œä¸€ä¸ªè·¯å¾„æ•°ç»„ `track` ç”¨äºŽè®°å½•å½“å‰æŽ’åˆ—çš„è·¯å¾„ï¼Œä»¥åŠä¸€ä¸ªå¸ƒå°”æ•°ç»„ `used` ç”¨äºŽæ ‡è®°æŸä¸ªå…ƒç´ æ˜¯å¦å·²ç»è¢«ä½¿ç”¨è¿‡ã€‚
2. å¯¹è¾“å…¥æ•°ç»„ `nums` è¿›è¡Œå‡åºæŽ’åºï¼Œä»¥æ–¹ä¾¿åœ¨åŽç»­åŽ»é‡çš„è¿‡ç¨‹ä¸­åˆ¤æ–­ç›¸é‚»å…ƒç´ æ˜¯å¦ç›¸åŒã€‚
3. åˆ›å»ºä¸€ä¸ªåä¸º `backtrack` çš„é€’å½’å‡½æ•°ï¼Œè¯¥å‡½æ•°ç”¨äºŽç”Ÿæˆå…¨æŽ’åˆ—ã€‚å‡½æ•°æ²¡æœ‰å‚æ•°ï¼Œé€šè¿‡æ•°ç»„ `track` å’Œå¸ƒå°”æ•°ç»„ `used` è®°å½•å½“å‰çš„è·¯å¾„å’ŒçŠ¶æ€ã€‚
4. åœ¨ `backtrack` å‡½æ•°ä¸­ï¼Œé¦–å…ˆæ£€æŸ¥å½“å‰è·¯å¾„çš„é•¿åº¦æ˜¯å¦ç­‰äºŽè¾“å…¥æ•°ç»„ `nums` çš„é•¿åº¦ï¼Œå¦‚æžœæ˜¯ï¼Œåˆ™è¯´æ˜Žå·²ç»ç”Ÿæˆäº†ä¸€ä¸ªå®Œæ•´çš„æŽ’åˆ—ï¼Œå°†å½“å‰è·¯å¾„åŠ å…¥åˆ°ç»“æžœæ•°ç»„ `res` ä¸­ï¼Œå¹¶ç›´æŽ¥è¿”å›žã€‚
5. ç„¶åŽï¼Œä»Žå¤´å¼€å§‹éåŽ†æŽ’åºåŽçš„æ•°ç»„ `nums`ï¼Œå¯¹äºŽæ¯ä¸ªå…ƒç´ ï¼š
   - å¦‚æžœè¯¥å…ƒç´ å·²ç»è¢«ä½¿ç”¨è¿‡ (`used[i]` ä¸º `true`)ï¼Œåˆ™è·³è¿‡å½“å‰å…ƒç´ ã€‚
   - å¦‚æžœè¯¥å…ƒç´ å’Œå‰ä¸€ä¸ªå…ƒç´ ç›¸åŒï¼Œä¸”å‰ä¸€ä¸ªå…ƒç´ æ²¡æœ‰è¢«ä½¿ç”¨è¿‡ (`!used[i - 1]`)ï¼Œåˆ™è·³è¿‡å½“å‰å…ƒç´ ã€‚è¿™æ˜¯ä¸ºäº†é¿å…ç”Ÿæˆé‡å¤çš„æŽ’åˆ—ï¼Œç¡®ä¿ç›¸åŒå…ƒç´ åªåœ¨åŒä¸€å±‚é€’å½’ä¸­å‡ºçŽ°ä¸€æ¬¡ã€‚
   - å¦åˆ™ï¼Œå°†å½“å‰å…ƒç´ åŠ å…¥åˆ°è·¯å¾„ `track` ä¸­ï¼Œæ ‡è®°è¯¥å…ƒç´ ä¸ºå·²ä½¿ç”¨ï¼Œé€’å½’è°ƒç”¨ `backtrack` å‡½æ•°ï¼Œè¿›å…¥ä¸‹ä¸€å±‚ï¼Œå¹¶åœ¨é€’å½’è°ƒç”¨ç»“æŸåŽï¼Œå°†å½“å‰å…ƒç´ ä»Žè·¯å¾„ä¸­å¼¹å‡ºï¼Œæ ‡è®°ä¸ºæœªä½¿ç”¨ï¼Œä»¥ä¾¿å›žæº¯åˆ°ä¸Šä¸€å±‚ï¼Œç»§ç»­éåŽ†å…¶ä»–å…ƒç´ ã€‚
6. æœ€åŽï¼Œè¿”å›žç»“æžœæ•°ç»„ `res`ï¼Œå…¶ä¸­åŒ…å«äº†æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„å…¨æŽ’åˆ—ã€‚

æ ‡å‡†å…¨æŽ’åˆ—ç®—æ³•ä¹‹æ‰€ä»¥å‡ºçŽ°é‡å¤ï¼Œæ˜¯å› ä¸ºæŠŠç›¸åŒå…ƒç´ å½¢æˆçš„æŽ’åˆ—åºåˆ—è§†ä¸ºä¸åŒçš„åºåˆ—ï¼Œä½†å®žé™…ä¸Šå®ƒä»¬åº”è¯¥æ˜¯ç›¸åŒçš„ï¼›è€Œå¦‚æžœå›ºå®šç›¸åŒå…ƒç´ å½¢æˆçš„åºåˆ—é¡ºåºï¼Œä¿è¯ç›¸åŒå…ƒç´ åœ¨æŽ’åˆ—ä¸­çš„ç›¸å¯¹ä½ç½®ä¿æŒä¸å˜ï¼Œå°±é¿å…äº†é‡å¤ã€‚

## ä»£ç 

```javascript
/**
 * @param {number[]} nums
 * @return {number[][]}
 */
var permuteUnique = function (nums) {
	let res = [];
	let track = [];
	let used = new Array(nums.length).fill(false);

	// å…ˆæŽ’åºï¼Œè®©ç›¸åŒçš„å…ƒç´ é åœ¨ä¸€èµ·
	nums.sort((a, b) => a - b);

	const backtrack = () => {
		if (track.length == nums.length) {
			res.push([...track]);
			return;
		}
		for (let i = 0; i < nums.length; i++) {
			// æ–°æ·»åŠ çš„å‰ªæžé€»è¾‘ï¼Œå›ºå®šç›¸åŒçš„å…ƒç´ åœ¨æŽ’åˆ—ä¸­çš„ç›¸å¯¹ä½ç½®
			if (used[i] || (i > 0 && nums[i] == nums[i - 1] && !used[i - 1])) {
				continue;
			}
			track.push(nums[i]);
			used[i] = true;
			backtrack(i + 1);
			track.pop();
			used[i] = false;
		}
	};

	backtrack();
	return res;
};
```

## ç›¸å…³é¢˜ç›®

:::: md-demo ç›¸å…³é¢˜ç›®
- [ä¸‹ä¸€ä¸ªæŽ’åˆ—](https://leetcode.com/problems/next-permutation)
- [å…¨æŽ’åˆ—](https://leetcode.com/problems/permutations)
- [å›žæ–‡æŽ’åˆ— II](https://leetcode.com/problems/palindrome-permutation-ii)
- [å¹³æ–¹æ•°ç»„çš„æ•°ç›®](https://leetcode.com/problems/number-of-squareful-arrays)

::::
