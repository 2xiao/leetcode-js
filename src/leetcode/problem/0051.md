# [51. N çš‡å](https://leetcode.com/problems/n-queens)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`å›æº¯`](/leetcode/outline/tag/backtracking.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/n-queens/)

## é¢˜ç›®

The **n-queens** puzzle is the problem of placing `n` queens on an `n x n`
chessboard such that no two queens attack each other.

Given an integer `n`, return _all distinct solutions to the **n-queens
puzzle**_. You may return the answer in **any order**.

Each solution contains a distinct board configuration of the n-queens'
placement, where `'Q'` and `'.'` both indicate a queen and an empty space,
respectively.

**Example 1:**

![](https://assets.leetcode.com/uploads/2020/11/13/queens.jpg)

> Input: n = 4
>
> Output: [[".Q..","...Q","Q...","..Q."],["..Q.","Q...","...Q",".Q.."]]
>
> Explanation: There exist two distinct solutions to the 4-queens puzzle as shown above

**Example 2:**

> Input: n = 1
>
> Output: [["Q"]]

**Constraints:**

- `1 <= n <= 9`

## é¢˜ç›®å¤§æ„

æŒ‰ç…§å›½é™…è±¡æ£‹çš„è§„åˆ™ï¼Œçš‡åå¯ä»¥æ”»å‡»ä¸ä¹‹å¤„åœ¨åŒä¸€è¡Œæˆ–åŒä¸€åˆ—æˆ–åŒä¸€æ–œçº¿ä¸Šçš„æ£‹å­ã€‚

**n çš‡åé—®é¢˜** ç ”ç©¶çš„æ˜¯å¦‚ä½•å°† `n` ä¸ªçš‡åæ”¾ç½®åœ¨ `nÃ—n` çš„æ£‹ç›˜ä¸Šï¼Œå¹¶ä¸”ä½¿çš‡åå½¼æ­¤ä¹‹é—´ä¸èƒ½ç›¸äº’æ”»å‡»ã€‚

ç»™ä½ ä¸€ä¸ªæ•´æ•° `n` ï¼Œè¿”å›æ‰€æœ‰ä¸åŒçš„ **n çš‡åé—®é¢˜** çš„è§£å†³æ–¹æ¡ˆã€‚

æ¯ä¸€ç§è§£æ³•åŒ…å«ä¸€ä¸ªä¸åŒçš„ **n çš‡åé—®é¢˜** çš„æ£‹å­æ”¾ç½®æ–¹æ¡ˆï¼Œè¯¥æ–¹æ¡ˆä¸­ `'Q'` å’Œ `'.'` åˆ†åˆ«ä»£è¡¨äº†çš‡åå’Œç©ºä½ã€‚

## è§£é¢˜æ€è·¯

å¯ä»¥é‡‡ç”¨é€’å½’å’Œå›æº¯æ¥è§£å†³ï¼Œé€šè¿‡æ£€æŸ¥æ¯ä¸€è¡Œã€æ¯ä¸€åˆ—å’Œæ¯ä¸€å¯¹è§’çº¿ä¸Šæ˜¯å¦å­˜åœ¨å…¶ä»–çš‡åï¼Œæ¥ä¿è¯ N çš‡åçš„é—®é¢˜å¾—åˆ°è§£ã€‚æœ€åï¼Œå°†ç¬¦åˆæ¡ä»¶çš„ç»“æœè¿›è¡Œæ ¼å¼åŒ–ï¼Œè¿”å›æœ€ç»ˆçš„ç­”æ¡ˆã€‚

1. ä½¿ç”¨ä¸€ä¸ªä¸€ç»´æ•°ç»„ `queens` æ¥è¡¨ç¤ºæ¯ä¸€è¡Œçš‡åæ‰€åœ¨çš„åˆ—ä½ç½®ã€‚å…¶ä¸­ `queens[i]` è¡¨ç¤ºç¬¬ `i` è¡Œçš„çš‡åæ‰€åœ¨çš„åˆ—ã€‚
2. ä½¿ç”¨å›æº¯æ³•ï¼Œé€è¡Œæ”¾ç½®çš‡åã€‚åœ¨æ¯ä¸€è¡Œï¼Œå°è¯•å°†çš‡åæ”¾åœ¨è¯¥è¡Œçš„æ¯ä¸€åˆ—ï¼Œæ£€æŸ¥åœ¨å½“å‰ä½ç½® `(row, col)` æ”¾ç½®çš‡åæ˜¯å¦æ»¡è¶³ä¸äº’ç›¸æ”»å‡»çš„æ¡ä»¶ï¼š

   - `queens[i] === col`ï¼šæ£€æŸ¥åŒä¸€åˆ—ä¸Šæ˜¯å¦æœ‰å…¶ä»–çš‡åï¼›
   - `queens[i] - i === col - row`ï¼šé€šè¿‡æ£€æŸ¥æ¨ªåæ ‡å‡å»çºµåæ ‡çš„å·®æ˜¯å¦ç›¸ç­‰ï¼Œæ£€æŸ¥åœ¨å·¦ä¸Šè‡³å³ä¸‹çš„å¯¹è§’çº¿ä¸Šæ˜¯å¦æœ‰å…¶ä»–çš‡åï¼›
   - `queens[i] + i === col + row`ï¼šé€šè¿‡æ£€æŸ¥æ¨ªåæ ‡åŠ ä¸Šçºµåæ ‡çš„å’Œæ˜¯å¦ç›¸ç­‰ï¼Œæ£€æŸ¥åœ¨å·¦ä¸‹è‡³å³ä¸Šçš„å¯¹è§’çº¿ä¸Šæ˜¯å¦æœ‰å…¶ä»–çš‡åï¼›
   - å¦‚æœä»¥ä¸Šä¸‰ä¸ªæ¡ä»¶éƒ½ä¸æ»¡è¶³ï¼Œè¯´æ˜å½“å‰ä½ç½®æ˜¯å®‰å…¨çš„ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªåˆé€‚çš„ä½ç½®ã€‚

3. å¦‚æœæ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„ä½ç½®ï¼Œå°†è¯¥ä½ç½®çš„åˆ—åæ ‡å­˜å…¥ `queens` æ•°ç»„ä¸­ï¼Œå¹¶é€’å½’è°ƒç”¨ä¸‹ä¸€è¡Œçš„æ”¾ç½®çš‡åæ“ä½œã€‚
4. å¦‚æœåœ¨æŸä¸€è¡Œæ— æ³•æ‰¾åˆ°åˆé€‚çš„ä½ç½®ï¼Œåˆ™éœ€è¦å›æº¯ï¼Œå³å›åˆ°ä¸Šä¸€è¡Œï¼Œå°è¯•åœ¨ä¸Šä¸€è¡Œçš„å…¶ä»–åˆ—æ”¾ç½®çš‡åï¼Œç»§ç»­é€’å½’æœç´¢ã€‚
5. å½“æˆåŠŸæ”¾ç½® N ä¸ªçš‡åæ—¶ï¼Œå°†å½“å‰ `queens` æ•°ç»„çš„æ‹·è´åŠ å…¥ç»“æœæ•°ç»„ä¸­ã€‚
6. æœ€åï¼Œå°†ç¬¦åˆæ¡ä»¶çš„ç»“æœè¿›è¡Œæ ¼å¼åŒ–ï¼Œè¿”å›æœ€ç»ˆçš„ç­”æ¡ˆã€‚

## ä»£ç 

```javascript
/**
 * @param {number} n
 * @return {string[][]}
 */
var solveNQueens = function (n) {
	let res = [];
	let queens = new Array(n).fill(-1);

	const valid = (row, col) => {
		for (let i = 0; i < row; i++) {
			if (
				// æ£€æŸ¥åŒä¸€åˆ—ä¸Šæ˜¯å¦æœ‰å…¶ä»–çš‡å
				queens[i] == col ||
				// æ£€æŸ¥åœ¨å·¦ä¸Šè‡³å³ä¸‹çš„å¯¹è§’çº¿ä¸Šæ˜¯å¦æœ‰å…¶ä»–çš‡å
				queens[i] - i == col - row ||
				// æ£€æŸ¥åœ¨å·¦ä¸‹è‡³å³ä¸Šçš„å¯¹è§’çº¿ä¸Šæ˜¯å¦æœ‰å…¶ä»–çš‡å
				queens[i] + i == col + row
			) {
				return false;
			}
		}
		return true;
	};

	const backtrack = (row) => {
		if (row == n) {
			// æ‰¾åˆ°ä¸€ä¸ªæˆåŠŸè§£
			res.push([...queens]);
			return;
		}

		for (let col = 0; col < n; col++) {
			if (valid(row, col)) {
				// åœ¨å½“å‰ä½ç½®æ”¾ç½®çš‡å
				queens[row] = col;
				// ç»§ç»­å°è¯•ä¸‹ä¸€è¡Œ
				backtrack(row + 1);
				// å›æº¯ï¼Œæ¸…ç©ºå½“å‰è¡ŒçŠ¶æ€
				queens[row] = -1;
			}
		}
	};

	backtrack(0);
	return res.map((arr) =>
		arr.map((col) => '.'.repeat(col) + 'Q' + '.'.repeat(n - col - 1))
	);
};
```

## ç›¸å…³é¢˜ç›®

:::: md-demo ç›¸å…³é¢˜ç›®

- [52. N çš‡å II](https://leetcode.com/problems/n-queens-ii)
- [1001. ç½‘æ ¼ç…§æ˜](https://leetcode.com/problems/grid-illumination)

::::
