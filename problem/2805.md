---
title: 2805. è‡ªå®šä¹‰é—´éš” ğŸ”’
description: LeetCode 2805. è‡ªå®šä¹‰é—´éš” ğŸ”’é¢˜è§£ï¼ŒCustom Intervalï¼ŒåŒ…å«è§£é¢˜æ€è·¯ã€å¤æ‚åº¦åˆ†æä»¥åŠå®Œæ•´çš„ JavaScript ä»£ç å®ç°ã€‚
keywords:
  - LeetCode
  - 2805. è‡ªå®šä¹‰é—´éš” ğŸ”’
  - è‡ªå®šä¹‰é—´éš”
  - Custom Interval
  - è§£é¢˜æ€è·¯
---

# 2805. è‡ªå®šä¹‰é—´éš” ğŸ”’

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/custom-interval) [`LeetCode`](https://leetcode.com/problems/custom-interval)

## é¢˜ç›®

**Function** `customInterval`

Given a function `fn`, a number `delay` and a number `period`, return a number
`id`.

`customInterval` is a function that should execute the provided function `fn`
at intervals based on a linear pattern defined by the formula `delay + period * count`.

The `count` in the formula represents the number of times the interval has
been executed starting from an initial value of `0`.

**Function** `customClearInterval`

Given the `id`. `id` is the returned value from the function `customInterval`.

`customClearInterval` should stop executing provided function `fn` at
intervals.

**Note:** The `setTimeout` and `setInterval` functions in Node.js return an
object, not a number.

**Example 1:**

> Input: delay = 50, period = 20, cancelTime = 225
>
> Output: [50,120,210]
>
> Explanation:
>
> ```js
> const t = performance.now();
> const result = [];
> const fn = () => {
> 	result.push(Math.floor(performance.now() - t));
> };
>
> const id = customInterval(fn, delay, period);
>
> setTimeout(() => {
> 	customClearInterval(id);
> }, 225);
> ```
>
> 50 + 20 \* 0 = 50 // 50ms - 1st function call
>
> 50 + 20 \* 1 = 70 // 50ms + 70ms = 120ms - 2nd function call
>
> 50 + 20 \* 2 = 90 // 50ms + 70ms + 90ms = 210ms - 3rd function call

**Example 2:**

> Input: delay = 20, period = 20, cancelTime = 150
>
> Output: [20,60,120]
>
> Explanation:
>
> 20 + 20 \* 0 = 20 // 20ms - 1st function call
>
> 20 + 20 \* 1 = 40 // 20ms + 40ms = 60ms - 2nd function call
>
> 20 + 20 \* 2 = 60 // 20ms + 40ms + 60ms = 120ms - 3rd function call

**Example 3:**

> Input: delay = 100, period = 200, cancelTime = 500
>
> Output: [100,400]
>
> Explanation:
>
> 100 + 200 \* 0 = 100 // 100ms - 1st function call
>
> 100 + 200 \* 1 = 300 // 100ms + 300ms = 400ms - 2nd function call

**Constraints:**

- `20 <= delay, period <= 250`
- `20 <= cancelTime <= 1000`

## é¢˜ç›®å¤§æ„

**å‡½æ•°** `customInterval`

ç»™å®šä¸€ä¸ªå‡½æ•° `fn`ã€ä¸€ä¸ªæ•°å­— `delay` å’Œä¸€ä¸ªæ•°å­— `period`ï¼Œè¿”å›ä¸€ä¸ªæ•°å­— `id`ã€‚`customInterval`
æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒåº”è¯¥æ ¹æ®å…¬å¼ `delay + period * count` åœ¨é—´éš”ä¸­æ‰§è¡Œæä¾›çš„å‡½æ•° `fn`ï¼Œå…¬å¼ä¸­çš„ `count` è¡¨ç¤ºä»åˆå§‹å€¼
`0` å¼€å§‹æ‰§è¡Œé—´éš”çš„æ¬¡æ•°ã€‚

**å‡½æ•°** `customClearInterval`

ç»™å®š `id`ã€‚`id` æ˜¯ä»å‡½æ•° `customInterval` è¿”å›çš„å€¼ã€‚`customClearInterval` åº”è¯¥åœæ­¢åœ¨é—´éš”ä¸­æ‰§è¡Œæä¾›çš„å‡½æ•°
`fn`ã€‚

**æ³¨æ„ï¼š** åœ¨ Node.js ä¸­ï¼Œ`setTimeout` å’Œ `setInterval` å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªæ•°å­—ã€‚

**ç¤ºä¾‹ 1ï¼š**

> **è¾“å…¥ï¼š** delay = 50, period = 20, stopTime = 225
>
> **è¾“å‡ºï¼š**[50,120,210]
>
> **è§£é‡Šï¼š**
>
> ```js
> const t = performance.now();
> const result = [];
> const fn = () => {
> 	result.push(Math.floor(performance.now() - t));
> };
>
> const id = customInterval(fn, delay, period);
>
> setTimeout(() => {
> 	customClearInterval(id);
> }, 225);
> ```
>
> 50 + 20 \* 0 = 50 // 50ms - ç¬¬ä¸€ä¸ªå‡½æ•°è°ƒç”¨
>
> 50 + 20 \* 1 = 70 // 50ms + 70ms = 120ms - ç¬¬äºŒä¸ªå‡½æ•°è°ƒç”¨
>
> 50 + 20 \* 2 = 90 // 50ms + 70ms + 90ms = 210ms - ç¬¬ä¸‰ä¸ªå‡½æ•°è°ƒç”¨

**ç¤ºä¾‹ 2ï¼š**

> **è¾“å…¥ï¼š** delay = 20, period = 20, stopTime = 150
>
> **è¾“å‡ºï¼š**[20,60,120]
>
> **è§£é‡Šï¼š**
>
> 20 + 20 \* 0 = 20 // 20ms - ç¬¬ä¸€ä¸ªå‡½æ•°è°ƒç”¨
>
> 20 + 20 \* 1 = 40 // 20ms + 40ms = 60ms - ç¬¬äºŒä¸ªå‡½æ•°è°ƒç”¨
>
> 20 + 20 \* 2 = 60 // 20ms + 40ms + 60ms = 120ms - ç¬¬ä¸‰ä¸ªå‡½æ•°è°ƒç”¨

**ç¤ºä¾‹ 3ï¼š**

> **è¾“å…¥ï¼š** delay = 100, period = 200, stopTime = 500
>
> **è¾“å‡ºï¼š**[100,400]
>
> **è§£é‡Šï¼š**
>
> 100 + 200 \* 0 = 100 // 100ms - ç¬¬ä¸€ä¸ªå‡½æ•°è°ƒç”¨
>
> 100 + 200 \* 1 = 300 // 100ms + 300ms = 400ms - ç¬¬äºŒä¸ªå‡½æ•°è°ƒç”¨

**æç¤ºï¼š**

- `20 <= delay, period <= 250`
- `20 <= stopTime <= 1000`

## è§£é¢˜æ€è·¯

1. **è‡ªå®šä¹‰å®šæ—¶å‡½æ•° `customInterval`**:

   - `customInterval` æ¥å— `fn`ã€`delay` å’Œ `period`ã€‚
   - åˆå§‹åŒ–ä¸€ä¸ª `count` å˜é‡ä¸º 0ï¼Œç”¨æ¥è®°å½•è°ƒç”¨æ¬¡æ•°ã€‚
   - ä½¿ç”¨ `setTimeout` è®¾ç½®åˆå§‹å»¶è¿Ÿä¸º `delay` æ¯«ç§’ã€‚
   - åœ¨æ¯æ¬¡è°ƒç”¨æ—¶ï¼Œè®¡ç®—ä¸‹æ¬¡å»¶è¿Ÿæ—¶é—´ `delay + period * count`ã€‚
   - ç»§ç»­é€’å½’è°ƒç”¨ `setTimeout`ï¼Œå¹¶æ›´æ–° `count`ã€‚
   - å°† `setTimeout` è¿”å›çš„ ID ç”¨å“ˆå¸Œè¡¨å­˜å‚¨èµ·æ¥ï¼Œä»¥ä¾¿åç»­å¯ä»¥æ¸…é™¤è¯¥å®šæ—¶å™¨ã€‚
   - è¿”å›ç”¨äºåœæ­¢è°ƒç”¨çš„å”¯ä¸€æ ‡è¯†ç¬¦ `id`ï¼Œè®© `customClearInterval` å¯ä»¥æ ¹æ®è¿™ä¸ª ID åœæ­¢å®šæ—¶å™¨ã€‚

2. **åœæ­¢å®šæ—¶å™¨ `customClearInterval`**:

   - `customClearInterval` ä½¿ç”¨ `clearTimeout` æ¸…é™¤ç›¸åº”çš„å®šæ—¶å™¨ï¼Œä»è€Œåœæ­¢è°ƒç”¨ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œå…¶ä¸­ `n` æ˜¯è°ƒç”¨æ¬¡æ•°ï¼Œå–å†³äº `stopTime` å’Œ `period`ï¼Œæ¯æ¬¡é€’å½’è°ƒç”¨éƒ½ä¼šæ‰§è¡Œ `setTimeout`ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œæ¯æ¬¡é€’å½’è°ƒç”¨å“ˆå¸Œè¡¨ä¸­éƒ½éœ€è¦å­˜å‚¨å®šæ—¶å™¨ IDã€‚

## ä»£ç 

```javascript
const idMap = new Map();

/**
 * @param {Function} fn
 * @param {number} delay
 * @param {number} period
 * @return {number}
 */
var customClearInterval = function (fn, delay, period) {
	let count = 0;
	const next = () => {
		const curDelay = delay + period * count;
		idMap.set(
			id,
			setTimeout(() => {
				fn();
				count++;
				next();
			}, curDelay)
		);
	};
	const id = Data.now();
	next();
	return id;
};

/**
 * @param {number} id
 * @return {null}
 */
var customClearInterval = function (id) {
	if (idMap.has(id)) {
		clearTimeout(idMap.get(id));
		idMap.delete(id);
	}
};
```
