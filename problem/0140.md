---
title: 140. å•è¯æ‹†åˆ† II
description: LeetCode 140. å•è¯æ‹†åˆ† IIé¢˜è§£ï¼ŒWord Break IIï¼ŒåŒ…å«è§£é¢˜æ€è·¯ã€å¤æ‚åº¦åˆ†æä»¥åŠå®Œæ•´çš„ JavaScript ä»£ç å®ç°ã€‚
keywords:
  - LeetCode
  - 140. å•è¯æ‹†åˆ† II
  - å•è¯æ‹†åˆ† II
  - Word Break II
  - è§£é¢˜æ€è·¯
  - å­—å…¸æ ‘
  - è®°å¿†åŒ–æœç´¢
  - æ•°ç»„
  - å“ˆå¸Œè¡¨
  - å­—ç¬¦ä¸²
  - åŠ¨æ€è§„åˆ’
  - å›æº¯
---

# 140. å•è¯æ‹†åˆ† II

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`å­—å…¸æ ‘`](/tag/trie.md) [`è®°å¿†åŒ–æœç´¢`](/tag/memoization.md) [`æ•°ç»„`](/tag/array.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`å­—ç¬¦ä¸²`](/tag/string.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md) [`å›æº¯`](/tag/backtracking.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/word-break-ii) [`LeetCode`](https://leetcode.com/problems/word-break-ii)

## é¢˜ç›®

Given a string `s` and a dictionary of strings `wordDict`, add spaces in `s`
to construct a sentence where each word is a valid dictionary word. Return all
such possible sentences in **any order**.

**Note** that the same word in the dictionary may be reused multiple times in
the segmentation.

**Example 1:**

> Input: s = "catsanddog", wordDict = ["cat","cats","and","sand","dog"]
>
> Output: ["cats and dog","cat sand dog"]

**Example 2:**

> Input: s = "pineapplepenapple", wordDict = ["apple","pen","applepen","pine","pineapple"]
>
> Output: ["pine apple pen apple","pineapple pen apple","pine applepen apple"]
>
> Explanation: Note that you are allowed to reuse a dictionary word.

**Example 3:**

> Input: s = "catsandog", wordDict = ["cats","dog","sand","and","cat"]
>
> Output: []

**Constraints:**

- `1 <= s.length <= 20`
- `1 <= wordDict.length <= 1000`
- `1 <= wordDict[i].length <= 10`
- `s` and `wordDict[i]` consist of only lowercase English letters.
- All the strings of `wordDict` are **unique**.
- Input is generated in a way that the length of the answer doesn't exceed 105.

## é¢˜ç›®å¤§æ„

ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² `s` å’Œä¸€ä¸ªå­—ç¬¦ä¸²å­—å…¸ `wordDict` ï¼Œåœ¨å­—ç¬¦ä¸² `s`
ä¸­å¢åŠ ç©ºæ ¼æ¥æ„å»ºä¸€ä¸ªå¥å­ï¼Œä½¿å¾—å¥å­ä¸­æ‰€æœ‰çš„å•è¯éƒ½åœ¨è¯å…¸ä¸­ã€‚**ä»¥ä»»æ„é¡ºåº** è¿”å›æ‰€æœ‰è¿™äº›å¯èƒ½çš„å¥å­ã€‚

**æ³¨æ„ï¼š** è¯å…¸ä¸­çš„åŒä¸€ä¸ªå•è¯å¯èƒ½åœ¨åˆ†æ®µä¸­è¢«é‡å¤ä½¿ç”¨å¤šæ¬¡ã€‚

**ç¤ºä¾‹ 1ï¼š**

> **è¾“å…¥:** s = "catsanddog", wordDict = ["cat","cats","and","sand","dog"]
>
> **è¾“å‡º:**["cats and dog","cat sand dog"]

**ç¤ºä¾‹ 2ï¼š**

> **è¾“å…¥:** s = "pineapplepenapple", wordDict = ["apple","pen","applepen","pine","pineapple"]
>
> **è¾“å‡º:**["pine apple pen apple","pineapple pen apple","pine applepen apple"]
>
> **è§£é‡Š:** æ³¨æ„ä½ å¯ä»¥é‡å¤ä½¿ç”¨å­—å…¸ä¸­çš„å•è¯ã€‚

**ç¤ºä¾‹ 3ï¼š**

> **è¾“å…¥:** s = "catsandog", wordDict = ["cats","dog","sand","and","cat"]
>
> **è¾“å‡º:**[]

**æç¤ºï¼š**

- `1 <= s.length <= 20`
- `1 <= wordDict.length <= 1000`
- `1 <= wordDict[i].length <= 10`
- `s` å’Œ `wordDict[i]` ä»…æœ‰å°å†™è‹±æ–‡å­—æ¯ç»„æˆ
- `wordDict` ä¸­æ‰€æœ‰å­—ç¬¦ä¸²éƒ½ **ä¸åŒ**

## è§£é¢˜æ€è·¯

å¯ä»¥ä½¿ç”¨ **åŠ¨æ€è§„åˆ’ï¼ˆDynamic Programmingï¼‰** æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

1. **å®šä¹‰çŠ¶æ€ï¼š**

   - å®šä¹‰ä¸€ä¸ªæ•°ç»„ `dp[i]`ï¼Œè¡¨ç¤ºå­—ç¬¦ä¸² `s[0:i]` çš„æ‰€æœ‰å¯èƒ½çš„æœ‰æ•ˆåˆ†å‰²ç»“æœã€‚
   - ä¾‹å¦‚ï¼š`dp[5]` è¡¨ç¤º `s[0:5]` çš„æ‰€æœ‰æœ‰æ•ˆåˆ†å‰²ç»“æœã€‚

2. **è½¬ç§»æ–¹ç¨‹ï¼š**

   - éå†å­—ç¬¦ä¸²çš„æ¯ä¸€ä¸ªå³è¾¹ç•Œ `right`ï¼Œå°è¯•ç”¨ `left` åˆ†å‰²æˆä¸¤éƒ¨åˆ†ï¼š
     - å·¦éƒ¨åˆ† `s[0:left]` çš„åˆ†å‰²ç»“æœä¿å­˜åœ¨ `dp[left]` ä¸­ã€‚
     - å³éƒ¨åˆ† `s[left:right]`ï¼ˆç§°ä¸º `suffix`ï¼‰æ˜¯å¦åœ¨ `wordDict` ä¸­ã€‚
   - å¦‚æœ `suffix` æ˜¯å­—å…¸ä¸­çš„å•è¯ï¼Œå°†å®ƒä¸ `dp[left]` ä¸­çš„æ¯ä¸€ä¸ªåˆ†å‰²ç»“æœæ‹¼æ¥èµ·æ¥ï¼Œæ„æˆæ–°çš„åˆ†å‰²ç»“æœï¼Œå­˜å…¥ `dp[right]`ã€‚

3. **åˆå§‹åŒ–ï¼š**

   - `dp[0] = ['']`ï¼Œè¡¨ç¤ºç©ºå­—ç¬¦ä¸²çš„åˆ†å‰²ç»“æœã€‚

4. **æœ€ç»ˆç­”æ¡ˆï¼š**
   - `dp[n]`ï¼Œå³å­—ç¬¦ä¸² `s[0:n]` çš„æ‰€æœ‰åˆ†å‰²ç»“æœã€‚

å…·ä½“ç®—æ³•å¦‚ä¸‹ï¼š

1. å°† `wordDict` è½¬æ¢æˆä¸€ä¸ª `Set`ï¼Œä¾¿äºå¿«é€Ÿåˆ¤æ–­å•è¯æ˜¯å¦åœ¨å­—å…¸ä¸­ã€‚
2. åˆå§‹åŒ–ä¸€ä¸ªé•¿åº¦ä¸º `n+1` çš„äºŒç»´æ•°ç»„ `dp`ï¼Œæ¯ä¸ªä½ç½®å­˜å‚¨è¯¥å­å­—ç¬¦ä¸²çš„æ‰€æœ‰å¯èƒ½åˆ†å‰²ç»“æœã€‚
3. éå† `right` ä» 1 åˆ° `n`ï¼Œå¯¹äºæ¯ä¸ª `right`ï¼š
   - éå† `left` ä» 0 åˆ° `right`ï¼Œè®¡ç®—å­ä¸² `s[left:right]`ï¼›
   - å¦‚æœ `s[left:right]` åœ¨å­—å…¸ä¸­ï¼Œå–å‡º `dp[left]` çš„æ‰€æœ‰åˆ†å‰²ç»“æœï¼Œå¹¶å°†å…¶ä¸å½“å‰å­ä¸²æ‹¼æ¥ï¼Œå­˜å…¥ `dp[right]`ã€‚
4. æœ€åè¿”å› `dp[n]`ï¼Œå³å®Œæ•´å­—ç¬¦ä¸²çš„æ‰€æœ‰å¯èƒ½åˆ†å‰²ç»“æœã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦ï¼š** `O(n^2 + m * L)`

  - éå†æ‰€æœ‰å­ä¸²ï¼šå¤–å±‚å¾ªç¯ `O(n)`ï¼Œå†…å±‚å¾ªç¯ `O(n)`ï¼Œå­ä¸²åˆ¤æ–­ `O(1)`ã€‚
  - æ‹¼æ¥å­—ç¬¦ä¸²ç»“æœï¼šå‡è®¾æœ€ç»ˆæœ‰ `m` ä¸ªæœ‰æ•ˆåˆ†å‰²ï¼Œæ¯æ¬¡æ‹¼æ¥ä»£ä»·ä¸º `O(L)`ï¼ˆå¹³å‡å•è¯é•¿åº¦ä¸º `L`ï¼‰ã€‚
  - ç»¼åˆæ—¶é—´å¤æ‚åº¦ä¸ºï¼š`O(n^2 + m * L)`ã€‚

- **ç©ºé—´å¤æ‚åº¦ï¼š** `O(n * m + k)`
  - åŠ¨æ€è§„åˆ’æ•°ç»„ `dp` éœ€è¦å­˜å‚¨ç»“æœï¼Œæœ€åæƒ…å†µä¸‹å­˜å‚¨æ‰€æœ‰åˆ†å‰²ç»“æœï¼Œç©ºé—´å¤æ‚åº¦ä¸º `O(n * m)`ã€‚
  - å­—å…¸ `wordSet` çš„ç©ºé—´ä¸º `O(k)`ï¼Œå…¶ä¸­ `k` ä¸ºå­—å…¸å•è¯æ€»æ•°ã€‚

## ä»£ç 

```javascript
/**
 * @param {string} s
 * @param {string[]} wordDict
 * @return {string[]}
 */
var wordBreak = function (s, wordDict) {
	const n = s.length; // å­—ç¬¦ä¸²é•¿åº¦
	const wordSet = new Set(wordDict); // ç”¨ Set å­˜å‚¨å­—å…¸ï¼Œæ–¹ä¾¿å¿«é€ŸæŸ¥æ‰¾

	// åˆå§‹åŒ– dp æ•°ç»„ï¼Œdp[i] è¡¨ç¤º s[0:i] çš„æ‰€æœ‰åˆ†å‰²ç»“æœ
	let dp = new Array(n + 1).fill().map(() => []);
	dp[0] = ['']; // ç©ºå­—ç¬¦ä¸²çš„åˆ†å‰²ç»“æœæ˜¯ä¸€ä¸ªç©ºå­—ç¬¦ä¸²

	// éå†å­—ç¬¦ä¸²çš„å³è¾¹ç•Œ
	for (let right = 1; right <= n; right++) {
		let temp = []; // å­˜å‚¨ dp[right] çš„åˆ†å‰²ç»“æœ

		// éå†å·¦è¾¹ç•Œï¼Œå¯»æ‰¾æœ‰æ•ˆçš„åˆ†å‰²ç‚¹
		for (let left = 0; left < right; left++) {
			const suffix = s.slice(left, right); // å­ä¸² s[left:right]

			// å¦‚æœåç¼€æ˜¯å­—å…¸ä¸­çš„å•è¯
			if (wordSet.has(suffix)) {
				// å°† dp[left] ä¸­çš„æ¯ä¸ªåˆ†å‰²ç»“æœæ‹¼æ¥åç¼€
				for (let substring of dp[left]) {
					temp.push(`${substring}${substring ? ' ' : ''}${suffix}`);
				}
			}
		}

		dp[right] = temp; // æ›´æ–° dp[right]
	}

	return dp[n]; // è¿”å› s[0:n] çš„æ‰€æœ‰åˆ†å‰²ç»“æœ
};
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ | åŠ›æ‰£ |
| :------: | :------ | :------: | :------ | :------: | :------: |
| 139 | å•è¯æ‹†åˆ† | [[âœ“]](/problem/0139.md) |  [`å­—å…¸æ ‘`](/tag/trie.md) [`è®°å¿†åŒ–æœç´¢`](/tag/memoization.md) [`æ•°ç»„`](/tag/array.md) `3+` | ğŸŸ  | [ğŸ€„ï¸](https://leetcode.cn/problems/word-break) [ğŸ”—](https://leetcode.com/problems/word-break) |
| 472 | è¿æ¥è¯ |  |  [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/tag/depth-first-search.md) [`å­—å…¸æ ‘`](/tag/trie.md) [`æ•°ç»„`](/tag/array.md) `2+` | ğŸ”´ | [ğŸ€„ï¸](https://leetcode.cn/problems/concatenated-words) [ğŸ”—](https://leetcode.com/problems/concatenated-words) |