---
title: 2563. ç»Ÿè®¡å…¬å¹³æ•°å¯¹çš„æ•°ç›®
description: LeetCode 2563. ç»Ÿè®¡å…¬å¹³æ•°å¯¹çš„æ•°ç›®é¢˜è§£ï¼ŒCount the Number of Fair Pairsï¼ŒåŒ…å«è§£é¢˜æ€è·¯ã€å¤æ‚åº¦åˆ†æä»¥åŠå®Œæ•´çš„ JavaScript ä»£ç å®ç°ã€‚
keywords:
  - LeetCode
  - 2563. ç»Ÿè®¡å…¬å¹³æ•°å¯¹çš„æ•°ç›®
  - ç»Ÿè®¡å…¬å¹³æ•°å¯¹çš„æ•°ç›®
  - Count the Number of Fair Pairs
  - è§£é¢˜æ€è·¯
  - æ•°ç»„
  - åŒæŒ‡é’ˆ
  - äºŒåˆ†æŸ¥æ‰¾
  - æ’åº
---

# 2563. ç»Ÿè®¡å…¬å¹³æ•°å¯¹çš„æ•°ç›®

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°ç»„`](/tag/array.md) [`åŒæŒ‡é’ˆ`](/tag/two-pointers.md) [`äºŒåˆ†æŸ¥æ‰¾`](/tag/binary-search.md) [`æ’åº`](/tag/sorting.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/count-the-number-of-fair-pairs) [`LeetCode`](https://leetcode.com/problems/count-the-number-of-fair-pairs)

## é¢˜ç›®

Given a **0-indexed** integer array `nums` of size `n` and two integers
`lower` and `upper`, return _the number of fair pairs_.

A pair `(i, j)` is **fair** if:

- `0 <= i < j < n`, and
- `lower <= nums[i] + nums[j] <= upper`

**Example 1:**

> Input: nums = [0,1,7,4,4,5], lower = 3, upper = 6
>
> Output: 6
>
> Explanation: There are 6 fair pairs: (0,3), (0,4), (0,5), (1,3), (1,4), and (1,5).

**Example 2:**

> Input: nums = [1,7,9,2,5], lower = 11, upper = 11
>
> Output: 1
>
> Explanation: There is a single fair pair: (2,3).

**Constraints:**

- `1 <= nums.length <= 10^5`
- `nums.length == n`
- `-10^9 <= nums[i] <= 10^9`
- `-10^9 <= lower <= upper <= 10^9`

## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªä¸‹æ ‡ä» **0** å¼€å§‹ã€é•¿åº¦ä¸º `n` çš„æ•´æ•°æ•°ç»„ `nums` ï¼Œå’Œä¸¤ä¸ªæ•´æ•° `lower` å’Œ `upper` ï¼Œè¿”å› **å…¬å¹³æ•°å¯¹çš„æ•°ç›®**ã€‚

å¦‚æœ `(i, j)` æ•°å¯¹æ»¡è¶³ä»¥ä¸‹æƒ…å†µï¼Œåˆ™è®¤ä¸ºå®ƒæ˜¯ä¸€ä¸ª **å…¬å¹³æ•°å¯¹** ï¼š

- `0 <= i < j < n`ï¼Œä¸”
- `lower <= nums[i] + nums[j] <= upper`

**ç¤ºä¾‹ 1ï¼š**

> **è¾“å…¥ï¼š** nums = [0,1,7,4,4,5], lower = 3, upper = 6
>
> **è¾“å‡ºï¼š** 6
>
> **è§£é‡Šï¼š** å…±è®¡ 6 ä¸ªå…¬å¹³æ•°å¯¹ï¼š(0,3)ã€(0,4)ã€(0,5)ã€(1,3)ã€(1,4) å’Œ (1,5) ã€‚

**ç¤ºä¾‹ 2ï¼š**

> **è¾“å…¥ï¼š** nums = [1,7,9,2,5], lower = 11, upper = 11
>
> **è¾“å‡ºï¼š** 1
>
> **è§£é‡Šï¼š** åªæœ‰å•ä¸ªå…¬å¹³æ•°å¯¹ï¼š(2,3) ã€‚

**æç¤ºï¼š**

- `1 <= nums.length <= 10^5`
- `nums.length == n`
- `-10^9 <= nums[i] <= 10^9`
- `-10^9 <= lower <= upper <= 10^9`

## è§£é¢˜æ€è·¯

1. **æ’åºæ•°ç»„**: é¦–å…ˆå¯¹æ•°ç»„ `nums` è¿›è¡Œæ’åºï¼Œæ’åºåçš„æ•°ç»„å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ä¸€æ®µè¿ç»­åŒºåŸŸå†…åˆ©ç”¨äºŒåˆ†æŸ¥æ‰¾å¿«é€Ÿæ‰¾åˆ°æ»¡è¶³ç‰¹å®šå’Œçš„æ•°å¯¹ã€‚

2. **åŒæŒ‡é’ˆéå†æ•°ç»„**: éå†æ’åºåçš„æ•°ç»„ï¼Œå¯¹æ¯ä¸ª `nums[i]`ï¼Œå¸Œæœ›æ‰¾åˆ° `nums[j]`ï¼Œæ»¡è¶³ `lower - nums[i] <= nums[j] <= upper - nums[i]`ã€‚

3. **ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾å®šä½èŒƒå›´**:

   - å¯¹äºæ¯ä¸ª `i`ï¼š
     - ä½¿ç”¨ `lowerBound` å‡½æ•°åœ¨ `i+1` åˆ°æœ«å°¾çš„èŒƒå›´å†…æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³ `nums[j] >= lower - nums[i]` çš„ä½ç½®ã€‚
     - ä½¿ç”¨ `upperBound` å‡½æ•°åœ¨ `i+1` åˆ°æœ«å°¾çš„èŒƒå›´å†…æ‰¾åˆ°ç¬¬ä¸€ä¸ªä¸æ»¡è¶³ `nums[j] <= upper - nums[i]` çš„ä½ç½®ã€‚
   - `lowerBound` è¿”å›çš„ç´¢å¼•ä¸ºç¬¦åˆæ¡ä»¶çš„ `j` å€¼çš„èµ·å§‹ä½ç½®ï¼Œè€Œ `upperBound` è¿”å›çš„æ˜¯ç»“æŸä½ç½®ï¼ˆä¸åŒ…å«åœ¨èŒƒå›´å†…ï¼‰ã€‚
   - ä¸¤ä¸ªç´¢å¼•çš„å·®å€¼ `up - low` å³ä¸ºå½“å‰ `i` ä¸‹æ»¡è¶³æ¡ä»¶çš„ `j` æ•°é‡ã€‚

4. **ç»“æœç´¯åŠ **: å¯¹äºæ¯ä¸ª `i`ï¼Œç´¯åŠ  `up - low` åˆ°ç»“æœ `res` ä¸­ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n log n)`ã€‚
  - æ’åºçš„æ—¶é—´å¤æ‚åº¦æ˜¯ `O(n log n)`ã€‚
  - å¤–å±‚å¾ªç¯éå† `nums` éœ€è¦ `O(n)` æ¬¡ï¼Œæ¯æ¬¡è°ƒç”¨ `lowerBound` å’Œ `upperBound` éƒ½æ˜¯ `O(log n)` çš„æ—¶é—´å¤æ‚åº¦ï¼Œå› æ­¤åŒæŒ‡é’ˆçš„å¤æ‚åº¦æ˜¯ `O(n log n)`ã€‚
  - æ€»ä½“æ—¶é—´å¤æ‚åº¦ä¸º `O(n log n)`ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(1)`ï¼Œåªç”¨äº†å¸¸æ•°çº§é¢å¤–ç©ºé—´ï¼ˆä¸è€ƒè™‘æ’åºç©ºé—´å¼€é”€ï¼‰ã€‚

## ä»£ç 

```javascript
/**
 * @param {number[]} nums
 * @param {number} lower
 * @param {number} upper
 * @return {number}
 */
var countFairPairs = function (nums, lower, upper) {
	// 1. å¯¹ nums è¿›è¡Œæ’åº
	nums.sort((a, b) => a - b);

	let res = 0;
	// 2. éå† numsï¼Œå°† nums ä¸­çš„æ¯ä¸ªå…ƒç´ ä½œä¸ºèµ·å§‹ç‚¹
	for (let i = 0; i < nums.length - 1; i++) {
		// 3. ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾æ»¡è¶³æ¡ä»¶çš„èµ·å§‹ä½ç½®å’Œç»“æŸä½ç½®ï¼ˆä¸åŒ…å«åœ¨èŒƒå›´å†…ï¼‰
		const low = lowerBound(nums, lower - nums[i], i + 1);
		const up = upperBound(nums, upper - nums[i], i + 1);

		// 4. å°†æ»¡è¶³æ¡ä»¶çš„å…¬å¹³æ•°å¯¹æ•°é‡åŠ å…¥ res ä¸­
		res += up - low;
	}
	return res;
};

// è¾…åŠ©å‡½æ•°ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªä½¿å¾— nums[index] >= target çš„ index
var lowerBound = function (nums, target, start) {
	let end = nums.length;
	while (start < end) {
		let mid = ((start + end) / 2) | 0;
		if (nums[mid] >= target) {
			end = mid;
		} else {
			start = mid + 1;
		}
	}
	return start;
};

// è¾…åŠ©å‡½æ•°ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªä½¿å¾— nums[index] > target çš„ index
var upperBound = function (nums, target, start) {
	let end = nums.length;
	while (start < end) {
		let mid = ((start + end) / 2) | 0;
		if (nums[mid] > target) {
			end = mid;
		} else {
			start = mid + 1;
		}
	}
	return start;
};
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ | åŠ›æ‰£ |
| :------: | :------ | :------: | :------ | :------: | :------: |
| 327 | åŒºé—´å’Œçš„ä¸ªæ•° |  |  [`æ ‘çŠ¶æ•°ç»„`](/tag/binary-indexed-tree.md) [`çº¿æ®µæ ‘`](/tag/segment-tree.md) [`æ•°ç»„`](/tag/array.md) `4+` | ğŸ”´ | [ğŸ€„ï¸](https://leetcode.cn/problems/count-of-range-sum) [ğŸ”—](https://leetcode.com/problems/count-of-range-sum) |
| 1865 | æ‰¾å‡ºå’Œä¸ºæŒ‡å®šå€¼çš„ä¸‹æ ‡å¯¹ |  |  [`è®¾è®¡`](/tag/design.md) [`æ•°ç»„`](/tag/array.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) | ğŸŸ  | [ğŸ€„ï¸](https://leetcode.cn/problems/finding-pairs-with-a-certain-sum) [ğŸ”—](https://leetcode.com/problems/finding-pairs-with-a-certain-sum) |
| 2006 | å·®çš„ç»å¯¹å€¼ä¸º K çš„æ•°å¯¹æ•°ç›® |  |  [`æ•°ç»„`](/tag/array.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`è®¡æ•°`](/tag/counting.md) | ğŸŸ¢ | [ğŸ€„ï¸](https://leetcode.cn/problems/count-number-of-pairs-with-absolute-difference-k) [ğŸ”—](https://leetcode.com/problems/count-number-of-pairs-with-absolute-difference-k) |
| 2824 | ç»Ÿè®¡å’Œå°äºç›®æ ‡çš„ä¸‹æ ‡å¯¹æ•°ç›® |  |  [`æ•°ç»„`](/tag/array.md) [`åŒæŒ‡é’ˆ`](/tag/two-pointers.md) [`äºŒåˆ†æŸ¥æ‰¾`](/tag/binary-search.md) `1+` | ğŸŸ¢ | [ğŸ€„ï¸](https://leetcode.cn/problems/count-pairs-whose-sum-is-less-than-target) [ğŸ”—](https://leetcode.com/problems/count-pairs-whose-sum-is-less-than-target) |