---
title: 40. ç»„åˆæ€»å’Œ II
description: LeetCode,40. ç»„åˆæ€»å’Œ II,ç»„åˆæ€»å’Œ II,Combination Sum II,è§£é¢˜æ€è·¯,æ•°ç»„,å›æº¯
keywords:
  - LeetCode
  - 40. ç»„åˆæ€»å’Œ II
  - ç»„åˆæ€»å’Œ II
  - Combination Sum II
  - è§£é¢˜æ€è·¯
  - æ•°ç»„
  - å›æº¯
---

# 40. ç»„åˆæ€»å’Œ II

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°ç»„`](/tag/array.md) [`å›æº¯`](/tag/backtracking.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/combination-sum-ii) [`LeetCode`](https://leetcode.com/problems/combination-sum-ii)

## é¢˜ç›®

Given a collection of candidate numbers (`candidates`) and a target number
(`target`), find all unique combinations in `candidates` where the candidate
numbers sum to `target`.

Each number in `candidates` may only be used **once** in the combination.

**Note:** The solution set must not contain duplicate combinations.

**Example 1:**

> Input: candidates = [10,1,2,7,6,1,5], target = 8
>
> Output: [[1,1,6], [1,2,5], [1,7], [2,6]]

**Example 2:**

> Input: candidates = [2,5,2,1,2], target = 5
>
> Output: [[1,2,2], [5]]

**Constraints:**

- `1 <= candidates.length <= 100`
- `1 <= candidates[i] <= 50`
- `1 <= target <= 30`

## é¢˜ç›®å¤§æ„

ç»™å®šä¸€ä¸ªå€™é€‰äººç¼–å·çš„é›†åˆ `candidates` å’Œä¸€ä¸ªç›®æ ‡æ•° `target` ï¼Œæ‰¾å‡º `candidates` ä¸­æ‰€æœ‰å¯ä»¥ä½¿æ•°å­—å’Œä¸º `target` çš„ç»„åˆã€‚

`candidates` ä¸­çš„æ¯ä¸ªæ•°å­—åœ¨æ¯ä¸ªç»„åˆä¸­åªèƒ½ä½¿ç”¨ **ä¸€æ¬¡** ã€‚

æ³¨æ„ï¼šè§£é›†ä¸èƒ½åŒ…å«é‡å¤çš„ç»„åˆã€‚

## è§£é¢˜æ€è·¯

å¯ä»¥ä½¿ç”¨å›æº¯ç®—æ³•ï¼Œé€šè¿‡é€’å½’æœç´¢æ‰€æœ‰å¯èƒ½çš„ç»„åˆï¼Œæ»¡è¶³ç»„åˆçš„å…ƒç´ å’Œç­‰äºç›®æ ‡å€¼ `target`ï¼š

1. å¯¹è¾“å…¥çš„æ•°ç»„ `candidates` è¿›è¡Œæ’åºï¼Œä»¥ä¾¿åœ¨åç»­çš„å»é‡æ­¥éª¤ä¸­æ–¹ä¾¿æ¯”è¾ƒç›¸é‚»çš„å…ƒç´ ã€‚
2. å®šä¹‰ä¸€ä¸ªç©ºæ•°ç»„ `res` ç”¨äºå­˜å‚¨æœ€ç»ˆçš„ç»“æœï¼Œä»¥åŠä¸€ä¸ªç©ºæ•°ç»„ `track` ç”¨äºå›æº¯è¿‡ç¨‹ä¸­è®°å½•å½“å‰çš„è·¯å¾„ã€‚
3. å®šä¹‰ä¸€ä¸ªå˜é‡ `sum` ç”¨äºè®°å½•å½“å‰è·¯å¾„ä¸­å…ƒç´ çš„å’Œã€‚
4. åˆ›å»ºä¸€ä¸ªåä¸º `backtrack` çš„é€’å½’å‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥å—ä¸€ä¸ªå‚æ•° `start` è¡¨ç¤ºå½“å‰éå†çš„èµ·å§‹ä½ç½®ã€‚
5. åœ¨ `backtrack` å‡½æ•°ä¸­ï¼Œé¦–å…ˆæ£€æŸ¥å½“å‰è·¯å¾„çš„å’Œæ˜¯å¦ç­‰äºç›®æ ‡å€¼ `target`ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™å°†å½“å‰è·¯å¾„ `track` åŠ å…¥åˆ°ç»“æœæ•°ç»„ `res` ä¸­ã€‚
6. ç„¶åä» `start` å¼€å§‹éå†æ•°ç»„ `candidates`ï¼Œå¯¹äºæ¯ä¸ªå…ƒç´ ï¼š
   - å¦‚æœå½“å‰å…ƒç´ åŠ ä¸Šå½“å‰è·¯å¾„çš„å’Œè¶…è¿‡ç›®æ ‡å€¼ `target`ï¼Œåˆ™ç»“æŸå½“å‰å¾ªç¯ï¼Œå› ä¸ºåç»­å…ƒç´ åªä¼šä½¿å’Œæ›´å¤§ã€‚
   - å¦‚æœå½“å‰å…ƒç´ ä¸å‰ä¸€ä¸ªå…ƒç´ ç›¸åŒï¼ˆå³å‡ºç°äº†é‡å¤å…ƒç´ ï¼‰ï¼Œå¹¶ä¸”å½“å‰å…ƒç´ ä¸æ˜¯èµ·å§‹ä½ç½®çš„å…ƒç´ ï¼Œåˆ™è·³è¿‡å½“å‰å…ƒç´ ï¼Œä»¥é¿å…é‡å¤ç”Ÿæˆç›¸åŒçš„ç»„åˆã€‚
   - å¦åˆ™ï¼Œå°†å½“å‰å…ƒç´ åŠ å…¥åˆ°è·¯å¾„ `track` ä¸­ï¼Œæ›´æ–°å½“å‰è·¯å¾„çš„å’Œ `sum`ï¼Œé€’å½’è°ƒç”¨ `backtrack` å‡½æ•°ï¼Œå¹¶ä¼ å…¥ä¸‹ä¸€ä¸ªä½ç½® `i + 1` ä½œä¸ºå‚æ•°ï¼Œä»¥ç»§ç»­ç”Ÿæˆä¸‹ä¸€ä¸ªå…ƒç´ çš„ç»„åˆã€‚
   - åœ¨é€’å½’è°ƒç”¨ç»“æŸåï¼Œéœ€è¦å°†å½“å‰å…ƒç´ ä»è·¯å¾„ `track` ä¸­å¼¹å‡ºï¼Œä»¥ä¾¿å›æº¯åˆ°ä¸Šä¸€å±‚ç»§ç»­éå†å…¶ä»–å…ƒç´ ï¼Œå¹¶æ¢å¤å½“å‰è·¯å¾„çš„å’Œ `sum`ã€‚
7. æœ€åè¿”å›ç»“æœæ•°ç»„ `res`ï¼Œå…¶ä¸­åŒ…å«æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„ç»„åˆã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(nlog n + 2^n)`ï¼Œ`n` ä¸º `candidates` é•¿åº¦ã€‚
  - å¯¹ `candidates` è¿›è¡Œæ’åºçš„æ—¶é—´å¤æ‚åº¦ä¸º `O(nlog n)`ï¼›
  - åœ¨é€’å½’è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªæ•°å­—åœ¨è·¯å¾„ä¸­åªèƒ½ä½¿ç”¨ä¸€æ¬¡ï¼Œåœ¨æœ€åçš„æƒ…å†µä¸‹ï¼Œæ¯ä¸ªå€™é€‰æ•°éƒ½å¯ä»¥è¢«åŠ å…¥åˆ°ç»„åˆä¸­ï¼Œè€Œæ¯ä¸ªæ•°æœ‰é€‰æ‹©å’Œä¸é€‰æ‹©ä¸¤ç§å¯èƒ½ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º `O(n^2)`ï¼›
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(t)`ï¼Œ`t = target / æœ€å°å€™é€‰æ•°`ï¼Œä¸»è¦ç”±é€’å½’æ·±åº¦å†³å®šï¼Œé€’å½’æ ‘çš„æ·±åº¦å¯èƒ½è¾¾åˆ° `target / æœ€å°å€™é€‰æ•°`ã€‚

## ä»£ç 

```javascript
/**
 * @param {number[]} candidates
 * @param {number} target
 * @return {number[][]}
 */
var combinationSum2 = function (candidates, target) {
	let res = [];
	let track = [];
	let sum = 0;
	candidates.sort((a, b) => a - b);

	const backtrack = (start) => {
		if (sum == target) {
			res.push([...track]);
		}
		// å‰ªæä¸€ï¼šä» start å¼€å§‹éå†ï¼Œé¿å…é‡å¤é€‰æ‹©åŒä¸€å…ƒç´ ï¼Œé¿å…ç”Ÿæˆé‡å¤å­é›†
		for (let i = start; i < candidates.length; i++) {
			// å‰ªæäºŒï¼šè‹¥å­é›†å’Œè¶…è¿‡ target ï¼Œåˆ™ç›´æ¥ç»“æŸå¾ªç¯
			// è¿™æ˜¯å› ä¸ºæ•°ç»„å·²æ’åºï¼Œåè¾¹å…ƒç´ æ›´å¤§ï¼Œå­é›†å’Œä¸€å®šè¶…è¿‡ target
			if (target - sum - candidates[i] < 0) {
				break;
			}
			// å‰ªæä¸‰ï¼šå¦‚æœè¯¥å…ƒç´ ä¸å·¦è¾¹å…ƒç´ ç›¸ç­‰ï¼Œè¯´æ˜è¯¥æœç´¢åˆ†æ”¯é‡å¤ï¼Œç›´æ¥è·³è¿‡
			if (i > start && candidates[i] == candidates[i - 1]) {
				continue;
			}
			track.push(candidates[i]);
			sum += candidates[i];
			backtrack(i + 1);
			track.pop();
			sum -= candidates[i];
		}
	};

	backtrack(0);
	return res;
};
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ | åŠ›æ‰£ |
| :------: | :------ | :------: | :------ | :------ | :------: |
| 39 | ç»„åˆæ€»å’Œ | [[âœ“]](/problem/0039.md) |  [`æ•°ç»„`](/tag/array.md) [`å›æº¯`](/tag/backtracking.md) | <font color=#ffb800>Medium</font> | [ğŸ€„ï¸](https://leetcode.cn/problems/combination-sum) [ğŸ”—](https://leetcode.com/problems/combination-sum) |