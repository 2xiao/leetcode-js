---
title: 2891. æ–¹æ³•é“¾
description: LeetCode 2891. æ–¹æ³•é“¾é¢˜è§£ï¼ŒMethod Chainingï¼ŒåŒ…å«è§£é¢˜æ€è·¯ã€å¤æ‚åº¦åˆ†æä»¥åŠå®Œæ•´çš„ JavaScript ä»£ç å®ç°ã€‚
keywords:
  - LeetCode
  - 2891. æ–¹æ³•é“¾
  - æ–¹æ³•é“¾
  - Method Chaining
  - è§£é¢˜æ€è·¯
---

# 2891. æ–¹æ³•é“¾

ğŸŸ¢ <font color=#15bd66>Easy</font>&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/method-chaining) [`LeetCode`](https://leetcode.com/problems/method-chaining)

## é¢˜ç›®

> DataFrame animals
>
> ```
> +-------------+--------+
> | Column Name | Type   |
> +-------------+--------+
> | name        | object |
> | species     | object |
> | age         | int    |
> | weight      | int    |
> +-------------+--------+
> ```

Write a solution to list the names of animals that weigh **strictly more
than** `100` kilograms.

Return the animals sorted by weight in **descending order**.

The result format is in the following example.

**Example 1:**

> Input:
>
> DataFrame animals:
>
> ```
> +----------+---------+-----+--------+
> | name     | species | age | weight |
> +----------+---------+-----+--------+
> | Tatiana  | Snake   | 98  | 464    |
> | Khaled   | Giraffe | 50  | 41     |
> | Alex     | Leopard | 6   | 328    |
> | Jonathan | Monkey  | 45  | 463    |
> | Stefan   | Bear    | 100 | 50     |
> | Tommy    | Panda   | 26  | 349    |
> +----------+---------+-----+--------+
> ```
>
> Output:
>
> ```
> +----------+
> | name     |
> +----------+
> | Tatiana  |
> | Jonathan |
> | Tommy    |
> | Alex     |
> +----------+
> ```
>
> Explanation:
>
> All animals weighing more than 100 should be included in the results table.
>
> Tatiana's weight is 464, Jonathan's weight is 463, Tommy's weight is 349, and Alex's weight is 328.
>
> The results should be sorted in descending order of weight.

In Pandas, **method chaining** enables us to perform operations on a DataFrame
without breaking up each operation into a separate line or creating multiple
temporary variables.

Can you complete this task in just **one line** of code using method chaining?

## é¢˜ç›®å¤§æ„

> DataFrame animals
>
> ```
> +-------------+--------+
> | Column Name | Type   |
> +-------------+--------+
> | name        | object |
> | species     | object |
> | age         | int    |
> | weight      | int    |
> +-------------+--------+
> ```

ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ¥åˆ—å‡ºä½“é‡ **ä¸¥æ ¼è¶…è¿‡** `100` åƒå…‹çš„åŠ¨ç‰©çš„åç§°ã€‚

æŒ‰ä½“é‡ **é™åº** è¿”å›åŠ¨ç‰©ã€‚

è¿”å›ç»“æœæ ¼å¼å¦‚ä¸‹ç¤ºä¾‹æ‰€ç¤ºã€‚

**ç¤ºä¾‹ 1:**

> **è¾“å…¥ï¼š**
>
> DataFrame animals:
>
> ```
> +----------+---------+-----+--------+
> | name     | species | age | weight |
> +----------+---------+-----+--------+
> | Tatiana  | Snake   | 98  | 464    |
> | Khaled   | Giraffe | 50  | 41     |
> | Alex     | Leopard | 6   | 328    |
> | Jonathan | Monkey  | 45  | 463    |
> | Stefan   | Bear    | 100 | 50     |
> | Tommy    | Panda   | 26  | 349    |
> +----------+---------+-----+--------+
> ```
>
> **è¾“å‡ºï¼š**
>
> ```
> +----------+
> | name     |
> +----------+
> | Tatiana  |
> | Jonathan |
> | Tommy    |
> | Alex     |
> +----------+
> ```
>
> **è§£é‡Šï¼š**
>
> æ‰€æœ‰ä½“é‡è¶…è¿‡ 100 çš„åŠ¨ç‰©éƒ½åº”åŒ…å«åœ¨ç»“æœè¡¨ä¸­ã€‚
>
> Tatiana çš„ä½“é‡ä¸º 464ï¼ŒJonathan çš„ä½“é‡ä¸º 463ï¼ŒTommy çš„ä½“é‡ä¸º 349ï¼ŒAlex çš„ä½“é‡ä¸º 328ã€‚
>
> ç»“æœåº”æŒ‰ä½“é‡é™åºæ’åºã€‚

åœ¨ Pandas ä¸­ï¼Œ**æ–¹æ³•é“¾** å…è®¸æˆ‘ä»¬åœ¨ DataFrame ä¸Šæ‰§è¡Œæ“ä½œï¼Œè€Œæ— éœ€å°†æ¯ä¸ªæ“ä½œæ‹†åˆ†æˆå•ç‹¬çš„è¡Œæˆ–åˆ›å»ºå¤šä¸ªä¸´æ—¶å˜é‡ã€‚

ä½ èƒ½ç”¨ **ä¸€è¡Œ** ä»£ç çš„æ–¹æ³•é“¾å®Œæˆè¿™ä¸ªä»»åŠ¡å—ï¼Ÿ

## è§£é¢˜æ€è·¯

1. **ç­›é€‰æ¡ä»¶**ï¼š

   - ä½¿ç”¨ `animals['weight'] > 100` ç­›é€‰å‡ºæ»¡è¶³ä½“é‡å¤§äº 100 çš„åŠ¨ç‰©ã€‚
   - é€šè¿‡ `animals[condition]` è¿”å›æ»¡è¶³æ¡ä»¶çš„è¡Œã€‚

2. **æ’åºæ“ä½œ**ï¼š

   - ä½¿ç”¨ `sort_values(['weight'], ascending=False)` æŒ‰ç…§ä½“é‡åˆ— `weight` è¿›è¡Œé™åºæ’åºã€‚
   - `ascending=False` è¡¨ç¤ºä»å¤§åˆ°å°æ’åºã€‚

3. **åˆ—é€‰æ‹©**ï¼š

   - ä½¿ç”¨ `[["name"]]` é€‰æ‹©éœ€è¦è¿”å›çš„åˆ—ï¼Œä»…ä¿ç•™åŠ¨ç‰©çš„åå­— `name`ã€‚

4. **è¿”å›ç»“æœ**ï¼š
   - è¿”å›ä¸€ä¸ªæ–°çš„ DataFrameï¼Œå…¶ä¸­åŒ…å«ä½“é‡å¤§äº 100 çš„åŠ¨ç‰©åå­—ï¼ŒæŒ‰ä½“é‡é™åºæ’åˆ—ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š `O(n log n)`

  - ç­›é€‰æ“ä½œçš„å¤æ‚åº¦ä¸º `O(n)`ï¼Œå…¶ä¸­ `n` æ˜¯è¡¨çš„è¡Œæ•°ã€‚
  - æ’åºæ“ä½œçš„å¤æ‚åº¦ä¸º `O(n log n)`ï¼Œå…¶ä¸­ `n` æ˜¯ç­›é€‰åä¿ç•™çš„è¡Œæ•°ã€‚
  - åˆ—é€‰æ‹©çš„å¤æ‚åº¦ä¸º `O(1)`ï¼Œå› ä¸ºåªæ“ä½œåˆ—ç´¢å¼•ã€‚
  - ç»¼åˆæ—¶é—´å¤æ‚åº¦ä¸º `O(n log n)`ï¼ˆæ’åºå ä¸»å¯¼ï¼‰ã€‚

- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(k)`ï¼Œå…¶ä¸­ `k` æ˜¯ç­›é€‰åçš„è¡Œæ•°ï¼Œç­›é€‰å’Œæ’åºä¼šè¿”å›æ–°çš„ DataFrameã€‚

## ä»£ç 

```python
import pandas as pd

def findHeavyAnimals(animals: pd.DataFrame) -> pd.DataFrame:
  return animals[animals['weight'] > 100].sort_values(['weight'], ascending=False)[['name']]
```
