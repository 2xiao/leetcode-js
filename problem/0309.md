# [309. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºå«å†·å†»æœŸ](https://leetcode.com/problems/best-time-to-buy-and-sell-stock-with-cooldown)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°ç»„`](/tag/array.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/best-time-to-buy-and-sell-stock-with-cooldown)

## é¢˜ç›®

<p>ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„<meta charset="UTF-8" /><code>prices</code>ï¼Œå…¶ä¸­ç¬¬&nbsp;<em>&nbsp;</em><code>prices[i]</code>&nbsp;è¡¨ç¤ºç¬¬&nbsp;<code><em>i</em></code>&nbsp;å¤©çš„è‚¡ç¥¨ä»·æ ¼ ã€‚â€‹</p>

<p>è®¾è®¡ä¸€ä¸ªç®—æ³•è®¡ç®—å‡ºæœ€å¤§åˆ©æ¶¦ã€‚åœ¨æ»¡è¶³ä»¥ä¸‹çº¦æŸæ¡ä»¶ä¸‹ï¼Œä½ å¯ä»¥å°½å¯èƒ½åœ°å®Œæˆæ›´å¤šçš„äº¤æ˜“ï¼ˆå¤šæ¬¡ä¹°å–ä¸€æ”¯è‚¡ç¥¨ï¼‰:</p>

<ul>
	<li>å–å‡ºè‚¡ç¥¨åï¼Œä½ æ— æ³•åœ¨ç¬¬äºŒå¤©ä¹°å…¥è‚¡ç¥¨ (å³å†·å†»æœŸä¸º 1 å¤©)ã€‚</li>
</ul>

<p><strong>æ³¨æ„ï¼š</strong>ä½ ä¸èƒ½åŒæ—¶å‚ä¸å¤šç¬”äº¤æ˜“ï¼ˆä½ å¿…é¡»åœ¨å†æ¬¡è´­ä¹°å‰å‡ºå”®æ‰ä¹‹å‰çš„è‚¡ç¥¨ï¼‰ã€‚</p>

<p>&nbsp;</p>

<p><strong>ç¤ºä¾‹ 1:</strong></p>

<pre>
<strong>è¾“å…¥:</strong> prices = [1,2,3,0,2]
<strong>è¾“å‡º: </strong>3 
<strong>è§£é‡Š:</strong> å¯¹åº”çš„äº¤æ˜“çŠ¶æ€ä¸º: [ä¹°å…¥, å–å‡º, å†·å†»æœŸ, ä¹°å…¥, å–å‡º]</pre>

<p><strong>ç¤ºä¾‹ 2:</strong></p>

<pre>
<strong>è¾“å…¥:</strong> prices = [1]
<strong>è¾“å‡º:</strong> 0
</pre>

<p>&nbsp;</p>

<p><strong>æç¤ºï¼š</strong></p>

<ul>
	<li><code>1 &lt;= prices.length &lt;= 5000</code></li>
	<li><code>0 &lt;= prices[i] &lt;= 1000</code></li>
</ul>


## è§£é¢˜æ€è·¯

1. **åŠ¨æ€è§„åˆ’ï¼š** å®šä¹‰ä¸€ä¸ªäºŒç»´æ•°ç»„ `dp`ï¼Œå…¶ä¸­ `dp[i][0]` è¡¨ç¤ºç¬¬ `i` å¤©ä¸æŒæœ‰è‚¡ç¥¨æ—¶çš„æœ€å¤§åˆ©æ¶¦ï¼Œ `dp[i][1]` è¡¨ç¤ºç¬¬ `i` å¤©æŒæœ‰è‚¡ç¥¨æ—¶çš„æœ€å¤§åˆ©æ¶¦ã€‚
2. **çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š**

   - `dp[i][0] = max(dp[i-1][0], dp[i-1][1] + prices[i])`ï¼Œè¡¨ç¤ºåœ¨ç¬¬ `i` å¤©ï¼Œä¸æŒæœ‰è‚¡ç¥¨çš„æœ€å¤§åˆ©æ¶¦ç­‰äºå‰ä¸€å¤©ä¸æŒæœ‰è‚¡ç¥¨çš„æœ€å¤§åˆ©æ¶¦ï¼Œæˆ–è€…å‰ä¸€å¤©æŒæœ‰è‚¡ç¥¨çš„æœ€å¤§åˆ©æ¶¦åŠ ä¸Šä»Šå¤©å–å‡ºçš„åˆ©æ¶¦çš„æœ€å¤§å€¼ã€‚
   - `dp[i][1] = max(dp[i-1][1], dp[i-2][0] - prices[i])`ï¼Œè¡¨ç¤ºåœ¨ç¬¬ `i` å¤©ï¼ŒæŒæœ‰è‚¡ç¥¨çš„æœ€å¤§åˆ©æ¶¦ç­‰äºå‰ä¸€å¤©æŒæœ‰è‚¡ç¥¨çš„æœ€å¤§åˆ©æ¶¦ï¼Œæˆ–è€…ä¹‹å‰ä¸¤å¤©ä¸æŒæœ‰è‚¡ç¥¨çš„æœ€å¤§åˆ©æ¶¦å‡å»ä»Šå¤©ä¹°å…¥çš„åˆ©æ¶¦çš„æœ€å¤§å€¼ã€‚å› ä¸ºæœ‰å†·å†»æœŸï¼Œä»Šå¤©èƒ½ä¹°å…¥çš„å‰ææ˜¯æ˜¨å¤©æ²¡æœ‰å–å‡ºï¼Œå³å‰å¤©æ²¡æœ‰æŒæœ‰è‚¡ç¥¨ã€‚

3. **è¾¹ç•Œæ¡ä»¶ï¼š**
   - ç¬¬ä¸€å¤©ï¼ˆ`i == 0`ï¼‰æ—¶ï¼Œ`dp[0][0] = 0`ï¼Œ`dp[0][1] = -prices[0]`ã€‚
   - ç¬¬äºŒå¤©ï¼ˆ`i == 1`ï¼‰æ—¶ï¼Œ`dp[1][0] = Math.max(0, prices[1] - prices[0])`ï¼Œ`dp[1][1] = Math.max(-prices[0], -prices[1])`ã€‚
4. **åˆå§‹åŒ–ï¼š** åˆå§‹åŒ–åˆ©æ¶¦ä¸º 0ã€‚
5. **è¿”å›æœ€å¤§åˆ©æ¶¦ï¼š** æœ€åè¿”å› `dp[n - 1][0]`ï¼Œå³æœ€åä¸€å¤©ä¸æŒæœ‰è‚¡ç¥¨çš„æœ€å¤§åˆ©æ¶¦ï¼Œå› ä¸ºè‹¥æœ€åä¸€å¤©è¿˜æŒæœ‰è‚¡ç¥¨æ²¡æœ‰å–å‡ºï¼Œæ”¶ç›Šè‚¯å®šå°äºåšäº†ä¸€æ¬¡äº¤æ˜“çš„æƒ…å†µã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**: `O(n)`ï¼Œéå†æ•´ä¸ªäºŒç»´æ•°ç»„ï¼Œå…¶ä¸­ n æ˜¯è‚¡ç¥¨ä»·æ ¼æ•°ç»„çš„é•¿åº¦ã€‚
- **ç©ºé—´å¤æ‚åº¦**: `O(n)`ï¼Œä½¿ç”¨äº†ä¸€ä¸ª `2 * n` çš„äºŒç»´æ•°ç»„æ¥å­˜å‚¨ä¸­é—´çŠ¶æ€ã€‚

## ä»£ç 

```javascript
/**
 * @param {number[]} prices
 * @return {number}
 */
var maxProfit = function (prices) {
	const n = prices.length;
	const dp = new Array(n).fill(0).map(() => new Array(2).fill(0));
	for (let i in prices) {
		if (i == 0) {
			dp[0][0] = 0;
			dp[0][1] = -prices[0];
			continue;
		}
		if (i == 1) {
			dp[1][0] = Math.max(0, prices[1] - prices[0]);
			dp[1][1] = Math.max(-prices[0], -prices[1]);
			continue;
		}
		dp[i][0] = Math.max(dp[i - 1][0], dp[i - 1][1] + prices[i]);
		dp[i][1] = Math.max(dp[i - 1][1], dp[i - 2][0] - prices[i]);
	}
	return dp[n - 1][0];
};
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 121 | [ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº](https://leetcode.com/problems/best-time-to-buy-and-sell-stock) | [[âœ“]](/problem/0121.md) |  [`æ•°ç»„`](/tag/array.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md) | <font color=#15bd66>Easy</font> |
| 122 | [ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº II](https://leetcode.com/problems/best-time-to-buy-and-sell-stock-ii) | [[âœ“]](/problem/0122.md) |  [`è´ªå¿ƒ`](/tag/greedy.md) [`æ•°ç»„`](/tag/array.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md) | <font color=#ffb800>Medium</font> |