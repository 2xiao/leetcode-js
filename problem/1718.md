---
title: 1718. æ„å»ºå­—å…¸åºæœ€å¤§çš„å¯è¡Œåºåˆ—
description: LeetCode 1718. æ„å»ºå­—å…¸åºæœ€å¤§çš„å¯è¡Œåºåˆ—é¢˜è§£ï¼ŒConstruct the Lexicographically Largest Valid Sequenceï¼ŒåŒ…å«è§£é¢˜æ€è·¯ã€å¤æ‚åº¦åˆ†æä»¥åŠå®Œæ•´çš„ JavaScript ä»£ç å®ç°ã€‚
keywords:
  - LeetCode
  - 1718. æ„å»ºå­—å…¸åºæœ€å¤§çš„å¯è¡Œåºåˆ—
  - æ„å»ºå­—å…¸åºæœ€å¤§çš„å¯è¡Œåºåˆ—
  - Construct the Lexicographically Largest Valid Sequence
  - è§£é¢˜æ€è·¯
  - æ•°ç»„
  - å›æº¯
---

# 1718. æ„å»ºå­—å…¸åºæœ€å¤§çš„å¯è¡Œåºåˆ—

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°ç»„`](/tag/array.md) [`å›æº¯`](/tag/backtracking.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/construct-the-lexicographically-largest-valid-sequence) [`LeetCode`](https://leetcode.com/problems/construct-the-lexicographically-largest-valid-sequence)

## é¢˜ç›®

Given an integer `n`, find a sequence that satisfies all of the following:

- The integer `1` occurs once in the sequence.
- Each integer between `2` and `n` occurs twice in the sequence.
- For every integer `i` between `2` and `n`, the **distance** between the two occurrences of `i` is exactly `i`.

The **distance** between two numbers on the sequence, `a[i]` and `a[j]`, is
the absolute difference of their indices, `|j - i|`.

Return _the**lexicographically largest** sequence_ _. It is guaranteed that
under the given constraints, there is always a solution._

A sequence `a` is lexicographically larger than a sequence `b` (of the same
length) if in the first position where `a` and `b` differ, sequence `a` has a
number greater than the corresponding number in `b`. For example, `[0,1,9,0]`
is lexicographically larger than `[0,1,5,6]` because the first position they
differ is at the third number, and `9` is greater than `5`.

**Example 1:**

> Input: n = 3
>
> Output: [3,1,2,3,2]
>
> Explanation: [2,3,2,1,3] is also a valid sequence, but [3,1,2,3,2] is the lexicographically largest valid sequence.

**Example 2:**

> Input: n = 5
>
> Output: [5,3,1,4,3,5,2,4,2]

**Constraints:**

- `1 <= n <= 20`

## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªæ•´æ•° `n` ï¼Œè¯·ä½ æ‰¾åˆ°æ»¡è¶³ä¸‹é¢æ¡ä»¶çš„ä¸€ä¸ªåºåˆ—ï¼š

- æ•´æ•° `1` åœ¨åºåˆ—ä¸­åªå‡ºç°ä¸€æ¬¡ã€‚
- `2` åˆ° `n` ä¹‹é—´æ¯ä¸ªæ•´æ•°éƒ½æ°å¥½å‡ºç°ä¸¤æ¬¡ã€‚
- å¯¹äºæ¯ä¸ª `2` åˆ° `n` ä¹‹é—´çš„æ•´æ•° `i` ï¼Œä¸¤ä¸ª `i` ä¹‹é—´å‡ºç°çš„è·ç¦»æ°å¥½ä¸º `i` ã€‚

åºåˆ—é‡Œé¢ä¸¤ä¸ªæ•° `a[i]` å’Œ `a[j]` ä¹‹é—´çš„ **è·ç¦»** ï¼Œæˆ‘ä»¬å®šä¹‰ä¸ºå®ƒä»¬ä¸‹æ ‡ç»å¯¹å€¼ä¹‹å·® `|j - i|` ã€‚

è¯·ä½ è¿”å›æ»¡è¶³ä¸Šè¿°æ¡ä»¶ä¸­ **å­—å…¸åºæœ€å¤§** çš„åºåˆ—ã€‚é¢˜ç›®ä¿è¯åœ¨ç»™å®šé™åˆ¶æ¡ä»¶ä¸‹ï¼Œä¸€å®šå­˜åœ¨è§£ã€‚

ä¸€ä¸ªåºåˆ— `a` è¢«è®¤ä¸ºæ¯”åºåˆ— `b` ï¼ˆä¸¤è€…é•¿åº¦ç›¸åŒï¼‰å­—å…¸åºæ›´å¤§çš„æ¡ä»¶æ˜¯ï¼š `a` å’Œ `b` ä¸­ç¬¬ä¸€ä¸ªä¸ä¸€æ ·çš„æ•°å­—å¤„ï¼Œ`a` åºåˆ—çš„æ•°å­—æ¯” `b`
åºåˆ—çš„æ•°å­—å¤§ã€‚æ¯”æ–¹è¯´ï¼Œ`[0,1,9,0]` æ¯” `[0,1,5,6]` å­—å…¸åºæ›´å¤§ï¼Œå› ä¸ºç¬¬ä¸€ä¸ªä¸åŒçš„ä½ç½®æ˜¯ç¬¬ä¸‰ä¸ªæ•°å­—ï¼Œä¸” `9` æ¯” `5` å¤§ã€‚

**ç¤ºä¾‹ 1ï¼š**

> **è¾“å…¥ï¼š** n = 3
>
> **è¾“å‡ºï¼š**[3,1,2,3,2]
>
> **è§£é‡Šï¼š**[2,3,2,1,3] ä¹Ÿæ˜¯ä¸€ä¸ªå¯è¡Œçš„åºåˆ—ï¼Œä½†æ˜¯ [3,1,2,3,2] æ˜¯å­—å…¸åºæœ€å¤§çš„åºåˆ—ã€‚

**ç¤ºä¾‹ 2ï¼š**

> **è¾“å…¥ï¼š** n = 5
>
> **è¾“å‡ºï¼š**[5,3,1,4,3,5,2,4,2]

**æç¤ºï¼š**

- `1 <= n <= 20`

## è§£é¢˜æ€è·¯

ç”±äº `res` çš„ä½ç½®éœ€è¦æ»¡è¶³ä¸€å®šçš„é—´éš”å…³ç³»ï¼Œå› æ­¤å¯ä»¥é‡‡ç”¨**å›æº¯ï¼ˆBacktrackingï¼‰+ å‰ªæ**çš„ç­–ç•¥æ¥æ„é€ æ•°ç»„ã€‚

1. **å›æº¯æ¡†æ¶**

ä½¿ç”¨é€’å½’æ–¹æ³• `backtrack(idx)`ï¼Œä»ç´¢å¼• `idx = 0` å¼€å§‹ï¼Œå°è¯•åœ¨ `res` ä¸­å¡«å…¥ `n` åˆ° `1`ï¼Œç›´åˆ°æ•°ç»„å¡«æ»¡ã€‚

2. **å›æº¯ç»†èŠ‚**

åœ¨ `idx` ä½ç½®å°è¯•æ”¾ç½®æ•°å­— `num`ï¼ˆä» `n` é€’å‡åˆ° `1`ï¼‰ï¼š

- **è·³è¿‡å·²å¡«å……çš„ä½ç½®**ï¼šå¦‚æœ `res[idx]` å·²æœ‰å€¼ï¼Œç›´æ¥é€’å½’åˆ°ä¸‹ä¸€ä¸ªç´¢å¼•ã€‚
- **æ£€æŸ¥ `num` æ˜¯å¦å¯ä»¥æ”¾ç½®**ï¼š
  - `num` éœ€è¦å æ® `idx` å’Œ `idx + num` ä¸¤ä¸ªä½ç½®ã€‚
  - `idx + num` ä¸èƒ½è¶…å‡º `res` æ•°ç»„èŒƒå›´ã€‚
  - `idx + num` ä½ç½®å¿…é¡»æ˜¯ç©ºçš„ã€‚
  - **ç‰¹æ®Šæƒ…å†µ**ï¼š`num == 1` åªå æ®ä¸€ä¸ªä½ç½®ã€‚
- **æ”¾ç½® `num`ï¼Œç„¶åé€’å½’ç»§ç»­**ï¼š
  - æ ‡è®° `used[num] = true`ï¼Œå¡«å…… `res[idx] = res[idx + num] = num`ã€‚
  - é€’å½’è°ƒç”¨ `backtrack(idx + 1)`ã€‚
  - å¦‚æœæ‰¾åˆ°è§£ï¼Œè¿”å› `true`ã€‚
  - **å›æº¯ï¼ˆæ’¤é”€é€‰æ‹©ï¼‰**ï¼šå¦‚æœé€’å½’å¤±è´¥ï¼Œåˆ™æ’¤é”€å¡«å……ï¼Œå¹¶ç»§ç»­å°è¯•æ›´å°çš„ `num`ã€‚

3. **å‰ªæä¼˜åŒ–**

- **æŒ‰ `n â†’ 1` é€’å‡æ”¾ç½®**ï¼šä¼˜å…ˆå°è¯•è¾ƒå¤§çš„ `num`ï¼Œä¿è¯å­—å…¸åºæœ€å¤§ã€‚
- **è·³è¿‡å·²å¡«å……çš„ä½ç½®**ï¼š`if (res[idx] !== 0) backtrack(idx + 1)` é¿å…é‡å¤è®¡ç®—ã€‚
- **æå‰ç»ˆæ­¢æ— æ•ˆè·¯å¾„**ï¼š

  - `if (used[num]) continue`ï¼šé¿å…é‡å¤æ”¾ç½® `num`ã€‚
  - `if (next >= len || res[next] !== 0) continue`ï¼šé¿å…è¶…å‡ºèŒƒå›´æˆ–è¦†ç›–å·²å¡«å……ä½ç½®ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n * n!)`

  - ç”±äº `res` é•¿åº¦ä¸º `2n - 1`ï¼Œç†è®ºä¸Šæˆ‘ä»¬å¯èƒ½å°è¯• `O(n!)` ç§æ’åˆ—æ–¹å¼ã€‚
  - ä½†ç”±äº**å‰ªæä¼˜åŒ–**ï¼Œå®é™…æƒ…å†µè¿œä½äº `O(n!)`ã€‚
  - è¿‘ä¼¼æ—¶é—´å¤æ‚åº¦å¯ä»¥è®¤ä¸ºæ˜¯ `O(n * n!)` çº§åˆ«ã€‚

- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(n)`ã€‚
  - ä¸»è¦ç”± `res`ï¼ˆ`O(2n-1) â‰ˆ O(n)`ï¼‰å’Œ `used`ï¼ˆ`O(n)`ï¼‰æ•°ç»„ç»„æˆï¼Œå…± `O(n)` é¢å¤–ç©ºé—´ã€‚
  - é€’å½’è°ƒç”¨æ ˆæœ€æ·± `O(n)`
  - å› æ­¤**æ€»ç©ºé—´å¤æ‚åº¦ä¸º `O(n)`**ã€‚

## ä»£ç 

```javascript
/**
 * @param {number} n
 * @return {number[]}
 */
var constructDistancedSequence = function (n) {
	const len = 2 * n - 1;
	let res = new Array(len).fill(0);
	let used = new Array(n + 1).fill(false);
	const backtrack = (idx) => {
		if (idx == len) {
			return true;
		}
		if (res[idx] !== 0) {
			return backtrack(idx + 1);
		}

		// å°è¯•åœ¨ res ä¸­å¡«å…¥ n åˆ° 1
		for (let num = n; num > 0; num--) {
			// å‰ªæ
			if (used[num]) {
				continue;
			}
			const next = num == 1 ? idx : num + idx;
			if (next >= len || res[next] !== 0) {
				continue;
			}

			// æ”¾ç½® num
			res[idx] = res[next] = num;
			used[num] = true;

			// é€’å½’
			if (backtrack(idx + 1)) {
				return true;
			}

			// å›æº¯
			res[idx] = res[next] = 0;
			used[num] = false;
		}
		return false;
	};
	backtrack(0);
	return res;
};
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ | åŠ›æ‰£ |
| :------: | :------ | :------: | :------ | :------: | :------: |
| 2597 | ç¾ä¸½å­é›†çš„æ•°ç›® |  |  [`æ•°ç»„`](/tag/array.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`æ•°å­¦`](/tag/math.md) `4+` | ğŸŸ  | [ğŸ€„ï¸](https://leetcode.cn/problems/the-number-of-beautiful-subsets) [ğŸ”—](https://leetcode.com/problems/the-number-of-beautiful-subsets) |