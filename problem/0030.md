---
title: 30. ä¸²è”æ‰€æœ‰å•è¯çš„å­ä¸²
description: LeetCode 30. ä¸²è”æ‰€æœ‰å•è¯çš„å­ä¸²é¢˜è§£ï¼ŒSubstring with Concatenation of All Wordsï¼ŒåŒ…å«è§£é¢˜æ€è·¯ã€å¤æ‚åº¦åˆ†æä»¥åŠå®Œæ•´çš„ JavaScript ä»£ç å®ç°ã€‚
keywords:
  - LeetCode
  - 30. ä¸²è”æ‰€æœ‰å•è¯çš„å­ä¸²
  - ä¸²è”æ‰€æœ‰å•è¯çš„å­ä¸²
  - Substring with Concatenation of All Words
  - è§£é¢˜æ€è·¯
  - å“ˆå¸Œè¡¨
  - å­—ç¬¦ä¸²
  - æ»‘åŠ¨çª—å£
---

# 30. ä¸²è”æ‰€æœ‰å•è¯çš„å­ä¸²

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`å­—ç¬¦ä¸²`](/tag/string.md) [`æ»‘åŠ¨çª—å£`](/tag/sliding-window.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/substring-with-concatenation-of-all-words) [`LeetCode`](https://leetcode.com/problems/substring-with-concatenation-of-all-words)

## é¢˜ç›®

You are given a string `s` and an array of strings `words`. All the strings of
`words` are of **the same length**.

A **concatenated substring** in `s` is a substring that contains all the
strings of any permutation of `words` concatenated.

- For example, if `words = ["ab","cd","ef"]`, then `"abcdef"`, `"abefcd"`, `"cdabef"`, `"cdefab"`, `"efabcd"`, and `"efcdab"` are all concatenated strings. `"acdbef"` is not a concatenated substring because it is not the concatenation of any permutation of `words`.

Return _the starting indices of all the concatenated substrings in_`s`. You
can return the answer in **any order**.

**Example 1:**

> Input: s = "barfoothefoobarman", words = ["foo","bar"]
>
> Output: [0,9]
>
> Explanation: Since words.length == 2 and words[i].length == 3, the concatenated substring has to be of length 6.
>
> The substring starting at 0 is "barfoo". It is the concatenation of ["bar","foo"] which is a permutation of words.
>
> The substring starting at 9 is "foobar". It is the concatenation of ["foo","bar"] which is a permutation of words.
>
> The output order does not matter. Returning [9,0] is fine too.

**Example 2:**

> Input: s = "wordgoodgoodgoodbestword", words = ["word","good","best","word"]
>
> Output: []
>
> Explanation: Since words.length == 4 and words[i].length == 4, the concatenated substring has to be of length 16.
>
> There is no substring of length 16 in s that is equal to the concatenation of any permutation of words.
>
> We return an empty array.

**Example 3:**

> Input: s = "barfoofoobarthefoobarman", words = ["bar","foo","the"]
>
> Output: [6,9,12]
>
> Explanation: Since words.length == 3 and words[i].length == 3, the concatenated substring has to be of length 9.
>
> The substring starting at 6 is "foobarthe". It is the concatenation of ["foo","bar","the"] which is a permutation of words.
>
> The substring starting at 9 is "barthefoo". It is the concatenation of ["bar","the","foo"] which is a permutation of words.
>
> The substring starting at 12 is "thefoobar". It is the concatenation of ["the","foo","bar"] which is a permutation of words.

**Constraints:**

- `1 <= s.length <= 10^4`
- `1 <= words.length <= 5000`
- `1 <= words[i].length <= 30`
- `s` and `words[i]` consist of lowercase English letters.

## é¢˜ç›®å¤§æ„

ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² `s` å’Œä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ `words`ã€‚ `words` ä¸­æ‰€æœ‰å­—ç¬¦ä¸² é•¿åº¦ç›¸åŒã€‚

- s ä¸­çš„ **ä¸²è”å­ä¸²** æ˜¯æŒ‡ä¸€ä¸ªåŒ…å« `words` ä¸­æ‰€æœ‰å­—ç¬¦ä¸²ä»¥ä»»æ„é¡ºåºæ’åˆ—è¿æ¥èµ·æ¥çš„å­ä¸²ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœ `words = ["ab","cd","ef"]`ï¼Œ é‚£ä¹ˆ `"abcdef"`ï¼Œ `"abefcd"`ï¼Œ`"cdabef"`ï¼Œ `"cdefab"`ï¼Œ`"efabcd"`ï¼Œ å’Œ `"efcdab"` éƒ½æ˜¯ä¸²è”å­ä¸²ã€‚ `"acdbef"` ä¸æ˜¯ä¸²è”å­ä¸²ï¼Œå› ä¸ºä»–ä¸æ˜¯ä»»ä½• `words` æ’åˆ—çš„è¿æ¥ã€‚
è¿”å›æ‰€æœ‰ä¸²è”å­ä¸²åœ¨ `s` ä¸­çš„å¼€å§‹ç´¢å¼•ã€‚ä½ å¯ä»¥ä»¥ **ä»»æ„é¡ºåº** è¿”å›ç­”æ¡ˆã€‚

## è§£é¢˜æ€è·¯

æ­¤é¢˜æ˜¯ [ç¬¬ 438 é¢˜ æ‰¾åˆ°å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—æ¯å¼‚ä½è¯](./0438.md) çš„è¿›é˜¶ç‰ˆã€‚ä¸åŒçš„æ˜¯ç¬¬ 438 é¢˜çš„å…ƒç´ æ˜¯å­—æ¯ï¼Œè€Œæ­¤é¢˜çš„å…ƒç´ æ˜¯å•è¯ï¼Œå¯ä»¥ç”¨ç±»ä¼¼çš„æ»‘åŠ¨çª—å£æ–¹æ³•æ¥è§£æ­¤é¢˜ã€‚

- **çª—å£å¤§å°å›ºå®š**ï¼šæ¯æ¬¡çª—å£å¤§å°ç­‰äº `words.length * words[0].length`ã€‚
- **ä½¿ç”¨å“ˆå¸Œè¡¨ç»Ÿè®¡ `words` ä¸­æ¯ä¸ªå•è¯çš„å‡ºç°æ¬¡æ•°**ã€‚
- **æ»‘åŠ¨çª—å£éå† `s`ï¼Œæ¯æ¬¡å–å‡ºçª—å£å†…çš„å­ä¸²ï¼Œæ£€æŸ¥æ˜¯å¦åŒ¹é… `words`**ã€‚

1. çŠ¶æ€å®šä¹‰

   - è®¾ `need` è®°å½• `words` ä¸­å•è¯å‡ºç°çš„æ¬¡æ•°ã€‚
   - è®¾ `window` è®°å½•å½“å‰çª—å£å†…çš„å•è¯æ˜¯å¦åŒ¹é… `need`ã€‚

2. **ç§»åŠ¨ `right` æŒ‡é’ˆ** æ‰©å¤§çª—å£ï¼Œæ¯æ¬¡åŠ  `words[0].length` ä¸ªå­—ç¬¦ã€‚
3. **å½“çª—å£å¤§å°è¶…è¿‡ `words.length * words[0].length`** æ—¶ï¼Œ`left` æŒ‡é’ˆå³ç§»æ”¶ç¼©çª—å£ã€‚
4. **åˆ¤æ–­çª—å£å†…çš„å­ä¸²æ˜¯å¦åŒ¹é… `words`**ï¼š
   - ä½¿ç”¨ `need` ç»Ÿè®¡ `words` è¯é¢‘ã€‚
   - ä½¿ç”¨ `window` ç»Ÿè®¡çª—å£å†…å•è¯çš„è¯é¢‘ã€‚
   - è‹¥ `window === need`ï¼Œè®°å½• `left` ä½ç½®ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**: `O(n * wordLen)`ï¼Œ`n` ä¸º `s` é•¿åº¦ï¼Œæ¯ä¸ª `i` éå† `O(n / wordLen)`ã€‚
- **ç©ºé—´å¤æ‚åº¦**: `O(words.length)`ï¼Œå­˜å‚¨ `words` è¯é¢‘å’Œ `window` è¯é¢‘ã€‚

## ä»£ç 

```javascript
/**
 * @param {string} s
 * @param {string[]} words
 * @return {number[]}
 */
var findSubstring = function (s, words) {
	let res = [];
	let wordLen = words[0].length;
	let totalLen = words.length * wordLen;
	let need = {};

	// ç»Ÿè®¡ words ä¸­æ¯ä¸ªå•è¯å‡ºç°çš„æ¬¡æ•°
	for (let word of words) {
		need[word] = (need[word] || 0) + 1;
	}

	// æšä¸¾ wordLen ä¸ªä¸åŒçš„èµ·ç‚¹
	for (let i = 0; i < wordLen; i++) {
		let left = i,
			right = i;
		let window = {};
		let count = 0;

		while (right + wordLen <= s.length) {
			let word = s.slice(right, right + wordLen);
			right += wordLen;

			if (need[word]) {
				window[word] = (window[word] || 0) + 1;
				count++;

				while (window[word] > need[word]) {
					let removeWord = s.slice(left, left + wordLen);
					window[removeWord]--;
					count--;
					left += wordLen;
				}

				if (count === words.length) res.push(left);
			} else {
				window = {};
				count = 0;
				left = right;
			}
		}
	}
	return res;
};
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ | åŠ›æ‰£ |
| :------: | :------ | :------: | :------ | :------: | :------: |
| 76 | æœ€å°è¦†ç›–å­ä¸² | [[âœ“]](/problem/0076.md) |  [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`å­—ç¬¦ä¸²`](/tag/string.md) [`æ»‘åŠ¨çª—å£`](/tag/sliding-window.md) | ğŸ”´ | [ğŸ€„ï¸](https://leetcode.cn/problems/minimum-window-substring) [ğŸ”—](https://leetcode.com/problems/minimum-window-substring) |