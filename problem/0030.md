# [30. ä¸²è”æ‰€æœ‰å•è¯çš„å­ä¸²](https://leetcode.com/problems/substring-with-concatenation-of-all-words)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`å­—ç¬¦ä¸²`](/tag/string.md) [`æ»‘åŠ¨çª—å£`](/tag/sliding-window.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/substring-with-concatenation-of-all-words)

## é¢˜ç›®

<p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²&nbsp;<code>s</code><strong>&nbsp;</strong>å’Œä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„&nbsp;<code>words</code><strong>ã€‚</strong>&nbsp;<code>words</code>&nbsp;ä¸­æ‰€æœ‰å­—ç¬¦ä¸² <strong>é•¿åº¦ç›¸åŒ</strong>ã€‚</p>

<p>&nbsp;<code>s</code><strong>&nbsp;</strong>ä¸­çš„ <strong>ä¸²è”å­ä¸²</strong> æ˜¯æŒ‡ä¸€ä¸ªåŒ…å«&nbsp;&nbsp;<code>words</code>&nbsp;ä¸­æ‰€æœ‰å­—ç¬¦ä¸²ä»¥ä»»æ„é¡ºåºæ’åˆ—è¿æ¥èµ·æ¥çš„å­ä¸²ã€‚</p>

<ul>
	<li>ä¾‹å¦‚ï¼Œå¦‚æœ&nbsp;<code>words = ["ab","cd","ef"]</code>ï¼Œ é‚£ä¹ˆ&nbsp;<code>"abcdef"</code>ï¼Œ&nbsp;<code>"abefcd"</code>ï¼Œ<code>"cdabef"</code>ï¼Œ&nbsp;<code>"cdefab"</code>ï¼Œ<code>"efabcd"</code>ï¼Œ å’Œ&nbsp;<code>"efcdab"</code> éƒ½æ˜¯ä¸²è”å­ä¸²ã€‚&nbsp;<code>"acdbef"</code> ä¸æ˜¯ä¸²è”å­ä¸²ï¼Œå› ä¸ºä»–ä¸æ˜¯ä»»ä½•&nbsp;<code>words</code>&nbsp;æ’åˆ—çš„è¿æ¥ã€‚</li>
</ul>

<p>è¿”å›æ‰€æœ‰ä¸²è”å­ä¸²åœ¨&nbsp;<code>s</code><strong>&nbsp;</strong>ä¸­çš„å¼€å§‹ç´¢å¼•ã€‚ä½ å¯ä»¥ä»¥ <strong>ä»»æ„é¡ºåº</strong> è¿”å›ç­”æ¡ˆã€‚</p>

<p>&nbsp;</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>s = "barfoothefoobarman", words = ["foo","bar"]
<strong>è¾“å‡ºï¼š</strong><code>[0,9]</code>
<strong>è§£é‡Šï¼š</strong>å› ä¸º words.length == 2 åŒæ—¶ words[i].length == 3ï¼Œè¿æ¥çš„å­å­—ç¬¦ä¸²çš„é•¿åº¦å¿…é¡»ä¸º 6ã€‚
å­ä¸² "barfoo" å¼€å§‹ä½ç½®æ˜¯ 0ã€‚å®ƒæ˜¯ words ä¸­ä»¥ ["bar","foo"] é¡ºåºæ’åˆ—çš„è¿æ¥ã€‚
å­ä¸² "foobar" å¼€å§‹ä½ç½®æ˜¯ 9ã€‚å®ƒæ˜¯ words ä¸­ä»¥ ["foo","bar"] é¡ºåºæ’åˆ—çš„è¿æ¥ã€‚
è¾“å‡ºé¡ºåºæ— å…³ç´§è¦ã€‚è¿”å› [9,0] ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚
</pre>

<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>s = "wordgoodgoodgoodbestword", words = ["word","good","best","word"]
<code><strong>è¾“å‡ºï¼š</strong>[]</code>
<strong>è§£é‡Šï¼š</strong>å› ä¸º<strong> </strong>words.length == 4 å¹¶ä¸” words[i].length == 4ï¼Œæ‰€ä»¥ä¸²è”å­ä¸²çš„é•¿åº¦å¿…é¡»ä¸º 16ã€‚
s ä¸­æ²¡æœ‰å­ä¸²é•¿åº¦ä¸º 16 å¹¶ä¸”ç­‰äº words çš„ä»»ä½•é¡ºåºæ’åˆ—çš„è¿æ¥ã€‚
æ‰€ä»¥æˆ‘ä»¬è¿”å›ä¸€ä¸ªç©ºæ•°ç»„ã€‚
</pre>

<p><strong>ç¤ºä¾‹ 3ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>s = "barfoofoobarthefoobarman", words = ["bar","foo","the"]
<strong>è¾“å‡ºï¼š</strong>[6,9,12]
<strong>è§£é‡Šï¼š</strong>å› ä¸º words.length == 3 å¹¶ä¸” words[i].length == 3ï¼Œæ‰€ä»¥ä¸²è”å­ä¸²çš„é•¿åº¦å¿…é¡»ä¸º 9ã€‚
å­ä¸² "foobarthe" å¼€å§‹ä½ç½®æ˜¯ 6ã€‚å®ƒæ˜¯ words ä¸­ä»¥ ["foo","bar","the"] é¡ºåºæ’åˆ—çš„è¿æ¥ã€‚
å­ä¸² "barthefoo" å¼€å§‹ä½ç½®æ˜¯ 9ã€‚å®ƒæ˜¯ words ä¸­ä»¥ ["bar","the","foo"] é¡ºåºæ’åˆ—çš„è¿æ¥ã€‚
å­ä¸² "thefoobar" å¼€å§‹ä½ç½®æ˜¯ 12ã€‚å®ƒæ˜¯ words ä¸­ä»¥ ["the","foo","bar"] é¡ºåºæ’åˆ—çš„è¿æ¥ã€‚</pre>

<p>&nbsp;</p>

<p><strong>æç¤ºï¼š</strong></p>

<ul>
	<li><code>1 &lt;= s.length &lt;= 10<sup>4</sup></code></li>
	<li><code>1 &lt;= words.length &lt;= 5000</code></li>
	<li><code>1 &lt;= words[i].length &lt;= 30</code></li>
	<li><code>words[i]</code>&nbsp;å’Œ&nbsp;<code>s</code> ç”±å°å†™è‹±æ–‡å­—æ¯ç»„æˆ</li>
</ul>


## è§£é¢˜æ€è·¯

æ­¤é¢˜æ˜¯ [ç¬¬ 438 é¢˜ æ‰¾åˆ°å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—æ¯å¼‚ä½è¯](./0438.md) çš„è¿›é˜¶ç‰ˆã€‚ä¸åŒçš„æ˜¯ç¬¬ 438 é¢˜çš„å…ƒç´ æ˜¯å­—æ¯ï¼Œè€Œæ­¤é¢˜çš„å…ƒç´ æ˜¯å•è¯ï¼Œå¯ä»¥ç”¨ç±»ä¼¼çš„æ»‘åŠ¨çª—å£æ–¹æ³•æ¥è§£æ­¤é¢˜ã€‚

1. ä½¿ç”¨åŒæŒ‡é’ˆä¸­çš„å·¦å³æŒ‡é’ˆï¼Œåˆå§‹åŒ– `left = right = 0`ï¼ŒæŠŠç´¢å¼•å·¦é—­å³å¼€åŒºé—´ `[left, right)` ç§°ä¸ºä¸€ä¸ªã€Œçª—å£ã€ï¼›
2. ä¸æ–­åœ°å¢åŠ  `right` æŒ‡é’ˆæ‰©å¤§çª—å£ `[left, right)`ï¼Œç›´åˆ°çª—å£ä¸­çš„å­—ç¬¦ä¸²ç¬¦åˆè¦æ±‚ï¼ˆåŒ…å«äº† `words.length * words[0].length` ä¸ªå­—ç¬¦ï¼‰ï¼›
3. åœæ­¢å¢åŠ  `right`ï¼Œè½¬è€Œä¸æ–­å¢åŠ  `left` æŒ‡é’ˆç¼©å°çª—å£ `[left, right)`ï¼Œç›´åˆ°çª—å£ä¸­çš„å­—ç¬¦ä¸²ä¸å†ç¬¦åˆè¦æ±‚ï¼›
4. æ¯æ¬¡çª—å£ä¸­çš„å­—ç¬¦ä¸²é•¿åº¦ç¬¦åˆè¦æ±‚æ—¶ï¼Œéƒ½è¦é€šè¿‡`isConcatenatedString`å‡½æ•°ï¼Œåˆ¤æ–­çª—å£ä¸­çš„å­—ç¬¦ä¸²æ˜¯å¦ç¬¦åˆé¢˜ç›®è¦æ±‚ï¼Œå¹¶æ›´æ–°ä¸€è½®ç»“æœï¼›
5. é‡å¤ç¬¬ 2 å’Œç¬¬ 3 æ­¥ï¼Œç›´åˆ° `right` åˆ°è¾¾å­—ç¬¦ä¸² `s2` çš„å°½å¤´ï¼›

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(lÃ—n)`ï¼Œå…¶ä¸­ `l` æ˜¯è¾“å…¥ `s` çš„é•¿åº¦ï¼Œ`n` æ˜¯ `words` ä¸­æ¯ä¸ªå•è¯çš„é•¿åº¦ã€‚éœ€è¦åš `n` æ¬¡æ»‘åŠ¨çª—å£ï¼Œæ¯æ¬¡éœ€è¦éå†ä¸€æ¬¡ `s`ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(mÃ—n)`ï¼Œå…¶ä¸­ `m` æ˜¯ `words` çš„å•è¯æ•°ï¼Œ`n` æ˜¯ `words` ä¸­æ¯ä¸ªå•è¯çš„é•¿åº¦ã€‚æ¯æ¬¡æ»‘åŠ¨çª—å£æ—¶ï¼Œéœ€è¦ç”¨ä¸€ä¸ªå“ˆå¸Œè¡¨ä¿å­˜å•è¯é¢‘æ¬¡ã€‚

## ä»£ç 

```javascript
/**
 * @param {string} s
 * @param {string[]} words
 * @return {number[]}
 */
var findSubstring = function (s, words) {
	let window = '',
		need = {};
	for (let i of words) {
		need[i] = (need[i] || 0) + 1;
	}

	const len = words.length * words[0].length;

	let left = 0,
		right = 0,
		// è®°å½•ç»“æœ
		res = [];

	while (right < s.length) {
		// è¿›è¡Œçª—å£å†…æ•°æ®çš„ä¸€ç³»åˆ—æ›´æ–°
		window += s[right];
		right++;

		// åˆ¤æ–­å·¦ä¾§çª—å£æ˜¯å¦è¦æ”¶ç¼©
		while (window.length > len) {
			left++;
			// è¿›è¡Œçª—å£å†…æ•°æ®çš„ä¸€ç³»åˆ—æ›´æ–°
			window = window.substring(1, window.length);
		}

		// å½“çª—å£ç¬¦åˆæ¡ä»¶æ—¶ï¼ŒæŠŠèµ·å§‹ç´¢å¼•åŠ å…¥ res
		if (isConcatenatedString(window, words, need)) {
			res.push(left);
		}
	}
	return res;
};

// åˆ¤æ–­ str æ˜¯å¦ä¸º words çš„ä¸²è”å­ä¸²
var isConcatenatedString = function (str, words, need) {
	let obj = {},
		valid = 0;

	const n = words[0].length,
		m = words.length;
	if (str.length !== m * n) return false;

	for (let i = 0; i < m; i++) {
		let word = str.slice(i * n, (i + 1) * n);
		if (need[word]) {
			obj[word] = (obj[word] || 0) + 1;
			if (obj[word] == need[word]) {
				valid += 1;
			}
		}
	}

	return valid == Object.keys(need).length;
};
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 76 | [æœ€å°è¦†ç›–å­ä¸²](https://leetcode.com/problems/minimum-window-substring) | [[âœ“]](/problem/0076.md) |  [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`å­—ç¬¦ä¸²`](/tag/string.md) [`æ»‘åŠ¨çª—å£`](/tag/sliding-window.md) | <font color=#ff334b>Hard</font> |