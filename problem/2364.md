---
title: 2364. ç»Ÿè®¡åæ•°å¯¹çš„æ•°ç›®
description: LeetCode 2364. ç»Ÿè®¡åæ•°å¯¹çš„æ•°ç›®é¢˜è§£ï¼ŒCount Number of Bad Pairsï¼ŒåŒ…å«è§£é¢˜æ€è·¯ã€å¤æ‚åº¦åˆ†æä»¥åŠå®Œæ•´çš„ JavaScript ä»£ç å®ç°ã€‚
keywords:
  - LeetCode
  - 2364. ç»Ÿè®¡åæ•°å¯¹çš„æ•°ç›®
  - ç»Ÿè®¡åæ•°å¯¹çš„æ•°ç›®
  - Count Number of Bad Pairs
  - è§£é¢˜æ€è·¯
  - æ•°ç»„
  - å“ˆå¸Œè¡¨
  - æ•°å­¦
  - è®¡æ•°
---

# 2364. ç»Ÿè®¡åæ•°å¯¹çš„æ•°ç›®

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°ç»„`](/tag/array.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`æ•°å­¦`](/tag/math.md) [`è®¡æ•°`](/tag/counting.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/count-number-of-bad-pairs) [`LeetCode`](https://leetcode.com/problems/count-number-of-bad-pairs)

## é¢˜ç›®

You are given a **0-indexed** integer array `nums`. A pair of indices `(i, j)`
is a **bad pair** if `i < j` and `j - i != nums[j] - nums[i]`.

Return _the total number of**bad pairs** in _`nums`.

**Example 1:**

> Input: nums = [4,1,3,3]
>
> Output: 5
>
> Explanation: The pair (0, 1) is a bad pair since 1 - 0 != 1 - 4.
>
> The pair (0, 2) is a bad pair since 2 - 0 != 3 - 4, 2 != -1.
>
> The pair (0, 3) is a bad pair since 3 - 0 != 3 - 4, 3 != -1.
>
> The pair (1, 2) is a bad pair since 2 - 1 != 3 - 1, 1 != 2.
>
> The pair (2, 3) is a bad pair since 3 - 2 != 3 - 3, 1 != 0.
>
> There are a total of 5 bad pairs, so we return 5.

**Example 2:**

> Input: nums = [1,2,3,4,5]
>
> Output: 0
>
> Explanation: There are no bad pairs.

**Constraints:**

- `1 <= nums.length <= 10^5`
- `1 <= nums[i] <= 10^9`

## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªä¸‹æ ‡ä»** 0** å¼€å§‹çš„æ•´æ•°æ•°ç»„ `nums` ã€‚å¦‚æœ `i < j` ä¸” `j - i != nums[j] - nums[i]`
ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç§° `(i, j)` æ˜¯ä¸€ä¸ª **å**æ•°å¯¹ã€‚

è¯·ä½ è¿”å› `nums` ä¸­ **åæ•°å¯¹** çš„æ€»æ•°ç›®ã€‚

**ç¤ºä¾‹ 1ï¼š**

> **è¾“å…¥ï¼š** nums = [4,1,3,3]
>
> **è¾“å‡ºï¼š** 5
>
> **è§£é‡Šï¼š** æ•°å¯¹ (0, 1) æ˜¯åæ•°å¯¹ï¼Œå› ä¸º 1 - 0 != 1 - 4 ã€‚
>
> æ•°å¯¹ (0, 2) æ˜¯åæ•°å¯¹ï¼Œå› ä¸º 2 - 0 != 3 - 4, 2 != -1 ã€‚
>
> æ•°å¯¹ (0, 3) æ˜¯åæ•°å¯¹ï¼Œå› ä¸º 3 - 0 != 3 - 4, 3 != -1 ã€‚
>
> æ•°å¯¹ (1, 2) æ˜¯åæ•°å¯¹ï¼Œå› ä¸º 2 - 1 != 3 - 1, 1 != 2 ã€‚
>
> æ•°å¯¹ (2, 3) æ˜¯åæ•°å¯¹ï¼Œå› ä¸º 3 - 2 != 3 - 3, 1 != 0 ã€‚
>
> æ€»å…±æœ‰ 5 ä¸ªåæ•°å¯¹ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿”å› 5 ã€‚

**ç¤ºä¾‹ 2ï¼š**

> **è¾“å…¥ï¼š** nums = [1,2,3,4,5]
>
> **è¾“å‡ºï¼š** 0
>
> **è§£é‡Šï¼š** æ²¡æœ‰åæ•°å¯¹ã€‚

**æç¤ºï¼š**

- `1 <= nums.length <= 10^5`
- `1 <= nums[i] <= 10^9`

## è§£é¢˜æ€è·¯

1. **æ€»æ•°å¯¹æ•°é‡è®¡ç®—**

   - æ•°ç»„é•¿åº¦ä¸º `n`ï¼Œæ€»æ•°å¯¹çš„æ•°é‡ä¸º `total = n * (n - 1) / 2`ã€‚

2. **è½¬æ¢ä¸ºå·®å€¼é—®é¢˜**

   - ç”±äºåˆ¤æ–­æ¡ä»¶æ˜¯ `nums[j] - nums[i] â‰  j - i`ï¼Œå¯ä»¥ç­‰ä»·è½¬åŒ–ä¸ºï¼š`nums[j] - j â‰  nums[i] - i`
   - å®šä¹‰ `diff[i] = nums[i] - i`ï¼Œæˆ‘ä»¬åªéœ€è¦ç»Ÿè®¡å·®å€¼ç›¸ç­‰çš„æ•°å¯¹ï¼Œå³å¥½æ•°å¯¹ã€‚

3. **å“ˆå¸Œè®¡æ•°**

   - ä½¿ç”¨ `Map` è®°å½• `diff` çš„é¢‘æ¬¡ç»Ÿè®¡ã€‚
   - å¯¹æ¯ä¸ªç›¸åŒçš„ `diff` å€¼ `value`ï¼Œèƒ½å½¢æˆçš„å¥½æ•°å¯¹æ•°é‡ä¸º `success = value * (value - 1) / 2`ã€‚

4. **è¿”å›ç»“æœ**
   - åæ•°å¯¹çš„æ€»æ•°ç›®å³æ€»æ•°å¯¹å‡å»å¥½æ•°å¯¹çš„å€¼ï¼š`total - success`

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œéå†æ•°ç»„å¹¶ç»Ÿè®¡é¢‘æ¬¡ï¼Œå“ˆå¸ŒæŸ¥æ‰¾å’Œæ›´æ–°ä¸ºå¸¸æ•°æ—¶é—´å¤æ‚åº¦ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œéœ€è¦é¢å¤–çš„å“ˆå¸Œè¡¨ç©ºé—´ã€‚

## ä»£ç 

```javascript
/**
 * @param {number[]} nums
 * @return {number}
 */
var countBadPairs = function (nums) {
	const n = nums.length;
	const total = (n * (n - 1)) / 2;
	let success = 0;

	let count = new Map();
	for (let i = 0; i < n; i++) {
		const diff = nums[i] - i;
		count.set(diff, (count.get(diff) || 0) + 1);
	}
	for (let value of count.values()) {
		success += (value * (value - 1)) / 2;
	}
	return total - success;
};
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ | åŠ›æ‰£ |
| :------: | :------ | :------: | :------ | :------: | :------: |
| 532 | æ•°ç»„ä¸­çš„ k-diff æ•°å¯¹ |  |  [`æ•°ç»„`](/tag/array.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`åŒæŒ‡é’ˆ`](/tag/two-pointers.md) `2+` | ğŸŸ  | [ğŸ€„ï¸](https://leetcode.cn/problems/k-diff-pairs-in-an-array) [ğŸ”—](https://leetcode.com/problems/k-diff-pairs-in-an-array) |
| 974 | å’Œå¯è¢« K æ•´é™¤çš„å­æ•°ç»„ |  |  [`æ•°ç»„`](/tag/array.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`å‰ç¼€å’Œ`](/tag/prefix-sum.md) | ğŸŸ  | [ğŸ€„ï¸](https://leetcode.cn/problems/subarray-sums-divisible-by-k) [ğŸ”—](https://leetcode.com/problems/subarray-sums-divisible-by-k) |
| 1814 | ç»Ÿè®¡ä¸€ä¸ªæ•°ç»„ä¸­å¥½å¯¹å­çš„æ•°ç›® |  |  [`æ•°ç»„`](/tag/array.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`æ•°å­¦`](/tag/math.md) `1+` | ğŸŸ  | [ğŸ€„ï¸](https://leetcode.cn/problems/count-nice-pairs-in-an-array) [ğŸ”—](https://leetcode.com/problems/count-nice-pairs-in-an-array) |
| 2006 | å·®çš„ç»å¯¹å€¼ä¸º K çš„æ•°å¯¹æ•°ç›® | [[âœ“]](/problem/2006.md) |  [`æ•°ç»„`](/tag/array.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`è®¡æ•°`](/tag/counting.md) | ğŸŸ¢ | [ğŸ€„ï¸](https://leetcode.cn/problems/count-number-of-pairs-with-absolute-difference-k) [ğŸ”—](https://leetcode.com/problems/count-number-of-pairs-with-absolute-difference-k) |
| 2176 | ç»Ÿè®¡æ•°ç»„ä¸­ç›¸ç­‰ä¸”å¯ä»¥è¢«æ•´é™¤çš„æ•°å¯¹ | [[âœ“]](/problem/2176.md) |  [`æ•°ç»„`](/tag/array.md) | ğŸŸ¢ | [ğŸ€„ï¸](https://leetcode.cn/problems/count-equal-and-divisible-pairs-in-an-array) [ğŸ”—](https://leetcode.com/problems/count-equal-and-divisible-pairs-in-an-array) |
| 2426 | æ»¡è¶³ä¸ç­‰å¼çš„æ•°å¯¹æ•°ç›® |  |  [`æ ‘çŠ¶æ•°ç»„`](/tag/binary-indexed-tree.md) [`çº¿æ®µæ ‘`](/tag/segment-tree.md) [`æ•°ç»„`](/tag/array.md) `4+` | ğŸ”´ | [ğŸ€„ï¸](https://leetcode.cn/problems/number-of-pairs-satisfying-inequality) [ğŸ”—](https://leetcode.com/problems/number-of-pairs-satisfying-inequality) |