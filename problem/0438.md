---
title: 438. æ‰¾åˆ°å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—æ¯å¼‚ä½è¯
description: LeetCode,438. æ‰¾åˆ°å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—æ¯å¼‚ä½è¯,æ‰¾åˆ°å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—æ¯å¼‚ä½è¯,Find All Anagrams in a String,è§£é¢˜æ€è·¯,å“ˆå¸Œè¡¨,å­—ç¬¦ä¸²,æ»‘åŠ¨çª—å£
keywords:
  - LeetCode
  - 438. æ‰¾åˆ°å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—æ¯å¼‚ä½è¯
  - æ‰¾åˆ°å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—æ¯å¼‚ä½è¯
  - Find All Anagrams in a String
  - è§£é¢˜æ€è·¯
  - å“ˆå¸Œè¡¨
  - å­—ç¬¦ä¸²
  - æ»‘åŠ¨çª—å£
---

# 438. æ‰¾åˆ°å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—æ¯å¼‚ä½è¯

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`å­—ç¬¦ä¸²`](/tag/string.md) [`æ»‘åŠ¨çª—å£`](/tag/sliding-window.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/find-all-anagrams-in-a-string) [`LeetCode`](https://leetcode.com/problems/find-all-anagrams-in-a-string)

## é¢˜ç›®

Given two strings `s` and `p`, return _an array of all the start indices
of_`p` _' s anagrams in _`s`. You may return the answer in **any order**.

An **Anagram** is a word or phrase formed by rearranging the letters of a
different word or phrase, typically using all the original letters exactly
once.

**Example 1:**

> Input: s = "cbaebabacd", p = "abc"
>
> Output: [0,6]
>
> Explanation:
>
> The substring with start index = 0 is "cba", which is an anagram of "abc".
>
> The substring with start index = 6 is "bac", which is an anagram of "abc".

**Example 2:**

> Input: s = "abab", p = "ab"
>
> Output: [0,1,2]
>
> Explanation:
>
> The substring with start index = 0 is "ab", which is an anagram of "ab".
>
> The substring with start index = 1 is "ba", which is an anagram of "ab".
>
> The substring with start index = 2 is "ab", which is an anagram of "ab".

**Constraints:**

- `1 <= s.length, p.length <= 3 * 10^4`
- `s` and `p` consist of lowercase English letters.

## é¢˜ç›®å¤§æ„

ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸² `s` å’Œ `p`ï¼Œæ‰¾åˆ° `s` ä¸­æ‰€æœ‰ `p` çš„ **å¼‚ä½è¯** çš„å­ä¸²ï¼Œè¿”å›è¿™äº›å­ä¸²çš„èµ·å§‹ç´¢å¼•ã€‚ä¸è€ƒè™‘ç­”æ¡ˆè¾“å‡ºçš„é¡ºåºã€‚

**å¼‚ä½è¯** æŒ‡ç”±ç›¸åŒå­—æ¯é‡æ’åˆ—å½¢æˆçš„å­—ç¬¦ä¸²ï¼ˆåŒ…æ‹¬ç›¸åŒçš„å­—ç¬¦ä¸²ï¼‰ã€‚

## è§£é¢˜æ€è·¯

ä½¿ç”¨æ»‘åŠ¨çª—å£ç®—æ³•ï¼Œæ€è·¯å¦‚ä¸‹ï¼š

1. ä½¿ç”¨åŒæŒ‡é’ˆä¸­çš„å·¦å³æŒ‡é’ˆï¼Œåˆå§‹åŒ– `left = right = 0`ï¼ŒæŠŠç´¢å¼•å·¦é—­å³å¼€åŒºé—´ `[left, right)` ç§°ä¸ºä¸€ä¸ªã€Œçª—å£ã€ï¼›
2. ä¸æ–­åœ°å¢åŠ  `right` æŒ‡é’ˆæ‰©å¤§çª—å£ `[left, right)`ï¼Œç›´åˆ°çª—å£ä¸­çš„å­—ç¬¦ä¸²ç¬¦åˆè¦æ±‚ï¼ˆåŒ…å«äº† `s1.length` ä¸ªå­—ç¬¦ï¼‰ï¼›
3. åœæ­¢å¢åŠ  `right`ï¼Œè½¬è€Œä¸æ–­å¢åŠ  `left` æŒ‡é’ˆç¼©å°çª—å£ `[left, right)`ï¼Œç›´åˆ°çª—å£ä¸­çš„å­—ç¬¦ä¸²ä¸å†ç¬¦åˆè¦æ±‚ï¼ˆä¸åŒ…å« `s1.length` ä¸ªå­—ç¬¦äº†ï¼‰ï¼›åŒæ—¶ï¼Œæ¯æ¬¡å¢åŠ  `left`ï¼Œéƒ½è¦æ›´æ–°ä¸€è½®ç»“æœï¼›
4. é‡å¤ç¬¬ 2 å’Œç¬¬ 3 æ­¥ï¼Œç›´åˆ° `right` åˆ°è¾¾å­—ç¬¦ä¸² `s2` çš„å°½å¤´ï¼›

è¯¦ç»†çš„æ»‘åŠ¨çª—å£ç­”é¢˜æ¡†æ¶è®²è§£ï¼Œå¯é˜…è¯» [ã€Š3.11 æ»‘åŠ¨çª—å£ã€‹](../book/slide_window.md)ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š `O(n + m)`ï¼Œå…¶ä¸­ `n` æ˜¯ `s2` çš„é•¿åº¦ï¼Œ`m` æ˜¯ `s1` çš„é•¿åº¦ã€‚
  - åˆå§‹åŒ– `need` å­—å…¸éœ€è¦éå†å­—ç¬¦ä¸² `s1`ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯ `O(m)`ï¼›
  - æ»‘åŠ¨çª—å£éå† `s`ï¼Œå¤–å±‚çš„ `while` å¾ªç¯éå†å­—ç¬¦ä¸² `s`ï¼Œæœ€å¤šéå† `n` æ¬¡ï¼›
  - å†…å±‚ `if` è¯­å¥ä¹Ÿåªæ˜¯åœ¨çª—å£è¾¾åˆ° `p.length` æ—¶è§¦å‘ï¼Œçª—å£çš„å¤§å°å›ºå®šä¸º `p.length`ï¼Œæ¯æ¬¡ç§»åŠ¨å·¦æŒ‡é’ˆæ—¶ä¹Ÿæ˜¯å¸¸æ•°æ—¶é—´æ“ä½œã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š `O(n)`
  - ç»“æœæ•°ç»„ `res` æœ€å¤šå­˜å‚¨ `O(n)` ä¸ªç»“æœï¼ˆæ¯ä¸ªå¯èƒ½çš„èµ·å§‹ç´¢å¼•ï¼‰ï¼Œåœ¨æœ€åæƒ…å†µä¸‹ï¼Œ`res` æ•°ç»„å¯èƒ½ä¼šå­˜å‚¨æ‰€æœ‰å¯èƒ½çš„èµ·å§‹ç´¢å¼•ï¼Œå¯¼è‡´ç©ºé—´å¤æ‚åº¦ä¸º `O(n)`ã€‚
  - `need` å’Œ `window` å­—å…¸çš„å¤§å°æœ€å¤šæ˜¯è‹±æ–‡å­—æ¯çš„æ•°é‡ï¼ˆ26 ä¸ªå­—æ¯ï¼‰ï¼Œæ‰€ä»¥å®ƒä»¬çš„ç©ºé—´å¤æ‚åº¦æ˜¯ `O(1)`ï¼Œå…¶ä»–å˜é‡çš„å­˜å‚¨æ˜¯å¸¸æ•°ç©ºé—´ã€‚

## ä»£ç 

```javascript
/**
 * @param {string} s
 * @param {string} p
 * @return {number[]}
 */
var findAnagrams = function (s, p) {
	let window = {},
		need = {};
	for (let i of p) {
		need[i] = (need[i] || 0) + 1;
	}

	let left = 0,
		right = 0,
		valid = 0,
		// è®°å½•ç»“æœ
		res = [];

	while (right < s.length) {
		let c = s[right];
		right++;

		// è¿›è¡Œçª—å£å†…æ•°æ®çš„ä¸€ç³»åˆ—æ›´æ–°
		if (need[c]) {
			window[c] = (window[c] || 0) + 1;
			if (window[c] == need[c]) {
				valid++;
			}
		}

		// åˆ¤æ–­å·¦ä¾§çª—å£æ˜¯å¦è¦æ”¶ç¼©
		if (right - left == p.length) {
			// å½“çª—å£ç¬¦åˆæ¡ä»¶æ—¶ï¼ŒæŠŠèµ·å§‹ç´¢å¼•åŠ å…¥ res
			if (valid == Object.keys(need).length) {
				res.push(left);
			}

			let d = s[left];
			left++;

			// è¿›è¡Œçª—å£å†…æ•°æ®çš„ä¸€ç³»åˆ—æ›´æ–°
			if (need[d]) {
				if (window[d] == need[d]) {
					valid--;
				}
				window[d]--;
			}
		}
	}
	return res;
};
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ | åŠ›æ‰£ |
| :------: | :------ | :------: | :------ | :------ | :------: |
| 242 | æœ‰æ•ˆçš„å­—æ¯å¼‚ä½è¯ | [[âœ“]](/problem/0242.md) |  [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`å­—ç¬¦ä¸²`](/tag/string.md) [`æ’åº`](/tag/sorting.md) | ğŸŸ¢ | [ğŸ€„ï¸](https://leetcode.cn/problems/valid-anagram) [ğŸ”—](https://leetcode.com/problems/valid-anagram) |
| 567 | å­—ç¬¦ä¸²çš„æ’åˆ— | [[âœ“]](/problem/0567.md) |  [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`åŒæŒ‡é’ˆ`](/tag/two-pointers.md) [`å­—ç¬¦ä¸²`](/tag/string.md) `1+` | ğŸŸ  | [ğŸ€„ï¸](https://leetcode.cn/problems/permutation-in-string) [ğŸ”—](https://leetcode.com/problems/permutation-in-string) |