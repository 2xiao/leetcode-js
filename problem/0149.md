# [149. ç›´çº¿ä¸Šæœ€å¤šçš„ç‚¹æ•°](https://leetcode.com/problems/max-points-on-a-line)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`å‡ ä½•`](/tag/geometry.md) [`æ•°ç»„`](/tag/array.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`æ•°å­¦`](/tag/math.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/max-points-on-a-line)

## é¢˜ç›®

<p>ç»™ä½ ä¸€ä¸ªæ•°ç»„ <code>points</code> ï¼Œå…¶ä¸­ <code>points[i] = [x<sub>i</sub>, y<sub>i</sub>]</code> è¡¨ç¤º <strong>X-Y</strong> å¹³é¢ä¸Šçš„ä¸€ä¸ªç‚¹ã€‚æ±‚æœ€å¤šæœ‰å¤šå°‘ä¸ªç‚¹åœ¨åŒä¸€æ¡ç›´çº¿ä¸Šã€‚</p>

<p>Â </p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<img alt="" src="https://assets.leetcode.com/uploads/2021/02/25/plane1.jpg" style="width: 300px; height: 294px;" />
<pre>
<strong>è¾“å…¥ï¼š</strong>points = [[1,1],[2,2],[3,3]]
<strong>è¾“å‡ºï¼š</strong>3
</pre>

<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>
<img alt="" src="https://assets.leetcode.com/uploads/2021/02/25/plane2.jpg" style="width: 300px; height: 294px;" />
<pre>
<strong>è¾“å…¥ï¼š</strong>points = [[1,1],[3,2],[5,3],[4,1],[2,3],[1,4]]
<strong>è¾“å‡ºï¼š</strong>4
</pre>

<p>Â </p>

<p><strong>æç¤ºï¼š</strong></p>

<ul>
	<li><code>1 &lt;= points.length &lt;= 300</code></li>
	<li><code>points[i].length == 2</code></li>
	<li><code>-10<sup>4</sup> &lt;= x<sub>i</sub>, y<sub>i</sub> &lt;= 10<sup>4</sup></code></li>
	<li><code>points</code> ä¸­çš„æ‰€æœ‰ç‚¹ <strong>äº’ä¸ç›¸åŒ</strong></li>
</ul>


## è§£é¢˜æ€è·¯

é—®é¢˜çš„è§£å†³å…³é”®åœ¨äºå¦‚ä½•æœ‰æ•ˆåœ°è®¡ç®—å’Œæ¯”è¾ƒæ–œç‡ï¼Œå¯ä»¥é€šè¿‡è§„èŒƒåŒ–æ–œç‡å’Œä½¿ç”¨å“ˆå¸Œè¡¨æ¥è®°å½•ç‚¹çš„åˆ†å¸ƒï¼Œæ¥æ‰¾å‡ºæœ€å¤šå…±çº¿çš„ç‚¹ã€‚

1. **æ–œç‡è®¡ç®—**ï¼š

   - å¯¹æ¯ä¸ªç‚¹ `points[i]`ï¼Œè®¡ç®—ä¸å…¶ä»–ç‚¹çš„æ–œç‡å¹¶å­˜å…¥å“ˆå¸Œè¡¨ `obj`ã€‚
   - æ–œç‡çš„è®¡ç®—å¯ä»¥é€šè¿‡ `(y2 - y1) / (x2 - x1)` å¾—åˆ°ï¼Œä½†ä¸ºäº†é¿å…æµ®ç‚¹æ•°è®¡ç®—å¸¦æ¥çš„ç²¾åº¦é—®é¢˜ï¼Œé€šå¸¸ä½¿ç”¨æ•´æ•°è¡¨ç¤ºæ–œç‡ï¼Œå³ä½¿ç”¨ `(dy, dx)` å½¢å¼ï¼Œå…¶ä¸­ `dy = y2 - y1`ï¼Œ`dx = x2 - x1`ã€‚
   - å¯¹äºå‚ç›´çº¿çš„æƒ…å†µè¦ç‰¹æ®Šå¤„ç†ã€‚

2. **æ ‡å‡†åŒ–æ–œç‡**ï¼š

   - æ–œç‡åº”å½“è¢«æ ‡å‡†åŒ–ä¸ºæœ€ç®€åˆ†æ•°å½¢å¼ï¼Œä»¥ç¡®ä¿ç›¸åŒæ–œç‡çš„ç‚¹å¯ä»¥è¢«æ­£ç¡®è¯†åˆ«ã€‚
   - ä½¿ç”¨æœ€å¤§å…¬çº¦æ•° (GCD) æ¥ç®€åŒ–æ–œç‡ã€‚

3. **ä½¿ç”¨å“ˆå¸Œè¡¨ç»Ÿè®¡**ï¼š

   - ä½¿ç”¨ä¸€ä¸ªå“ˆå¸Œè¡¨æ¥è®°å½•æ¯ä¸ªç‚¹çš„æ–œç‡å¯¹åº”çš„ç‚¹çš„æ•°é‡ã€‚
   - éå†æ¯ä¸ªç‚¹ï¼Œå°†å…¶ä»–ç‚¹çš„æ–œç‡å­˜å…¥å“ˆå¸Œè¡¨ï¼Œå¹¶æ›´æ–°æœ€å¤šçš„ç‚¹æ•°ã€‚

4. **å¤„ç†é‡å¤ç‚¹**ï¼š

   - å¯¹äºé‡å¤çš„ç‚¹ï¼Œåº”å½“å•ç‹¬å¤„ç†ï¼Œç¡®ä¿å®ƒä»¬è¢«æ­£ç¡®è®¡å…¥å…±çº¿ç‚¹çš„æ€»æ•°ã€‚

5. **æ›´æ–°å…¨å±€æœ€å¤§å€¼**ï¼š
   - åœ¨æ¯ä¸ªç‚¹çš„è®¡ç®—ä¸­ï¼Œç®—å‡ºæœ€å¤šå…±çº¿çš„ç‚¹æ•° `max`ï¼ŒåŒ…æ‹¬å½“å‰ã€é‡å¤ç‚¹ä»¥åŠæ–œç‡ç›¸åŒçš„ç‚¹ï¼Œæ›´æ–°å…¨å±€æœ€å¤§å€¼ `res`ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n^2)`ï¼Œæ¯ä¸ªç‚¹éƒ½ä¸å…¶ä»–ç‚¹è¿›è¡Œæ¯”è¾ƒã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œç”¨äºå­˜å‚¨æ–œç‡çš„å“ˆå¸Œè¡¨ã€‚

## ä»£ç 

```javascript
/**
 * @param {number[][]} points
 * @return {number}
 */
var maxPoints = function (points) {
	const gcd = (a, b) => {
		if (b === 0) return a;
		return gcd(b, a % b);
	};

	let n = points.length,
		res = 0;

	if (n <= 2) return n;

	for (let i = 0; i < n; i++) {
		let obj = {},
			overlap = 0,
			max = 0,
			vertical = 0;
		for (let j = i + 1; j < n; j++) {
			let dx = points[i][0] - points[j][0],
				dy = points[i][1] - points[j][1];

			// é‡å¤ç‚¹
			if (dx == 0 && dy == 0) {
				overlap++;
				continue;
			}

			// å‚ç›´çº¿
			if (dx == 0) {
				vertical++;
				continue;
			}

			// è§„èŒƒåŒ–æ–œç‡
			const g = gcd(dy, dx);
			const slope = `${dy / g}/${dx / g}`;

			obj[slope] = (obj[slope] || 0) + 1;
			max = Math.max(max, obj[slope]);
		}
		// åŠ ä¸Šå‚ç›´çº¿çš„æƒ…å†µ
		max = Math.max(max, vertical);

		// åŠ ä¸Šå½“å‰ç‚¹å’Œé‡å¤ç‚¹
		res = Math.max(res, max + overlap + 1);
	}
	return res;
};
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 356 | [ç›´çº¿é•œåƒ](https://leetcode.com/problems/line-reflection) |  |  [`æ•°ç»„`](/tag/array.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`æ•°å­¦`](/tag/math.md) | <font color=#ffb800>Medium</font> |
| 2152 | [ç©¿è¿‡æ‰€æœ‰ç‚¹çš„æ‰€éœ€æœ€å°‘ç›´çº¿æ•°é‡](https://leetcode.com/problems/minimum-number-of-lines-to-cover-points) |  |  [`ä½è¿ç®—`](/tag/bit-manipulation.md) [`å‡ ä½•`](/tag/geometry.md) [`æ•°ç»„`](/tag/array.md) `5+` | <font color=#ffb800>Medium</font> |
| 2280 | [è¡¨ç¤ºä¸€ä¸ªæŠ˜çº¿å›¾çš„æœ€å°‘çº¿æ®µæ•°](https://leetcode.com/problems/minimum-lines-to-represent-a-line-chart) |  |  [`å‡ ä½•`](/tag/geometry.md) [`æ•°ç»„`](/tag/array.md) [`æ•°å­¦`](/tag/math.md) `2+` | <font color=#ffb800>Medium</font> |