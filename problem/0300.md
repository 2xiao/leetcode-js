# [300. æœ€é•¿é€’å¢å­åºåˆ—](https://2xiao.github.io/leetcode-js/problem/0300.html)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°ç»„`](/tag/array.md) [`äºŒåˆ†æŸ¥æ‰¾`](/tag/binary-search.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/longest-increasing-subsequence) [`LeetCode`](https://leetcode.com/problems/longest-increasing-subsequence)

## é¢˜ç›®

Given an integer array `nums`, return _the length of the longest **strictly
increasing**_ _ **subsequence**_.

**Example 1:**

> Input: nums = [10,9,2,5,3,7,101,18]
>
> Output: 4
>
> Explanation: The longest increasing subsequence is [2,3,7,101], therefore the length is 4.

**Example 2:**

> Input: nums = [0,1,0,3,2,3]
>
> Output: 4

**Example 3:**

> Input: nums = [7,7,7,7,7,7,7]
>
> Output: 1

**Constraints:**

- `1 <= nums.length <= 2500`
- `-10^4 <= nums[i] <= 10^4`

**Follow up:** Can you come up with an algorithm that runs in `O(n log(n))`
time complexity?

## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums` ï¼Œæ‰¾åˆ°å…¶ä¸­æœ€é•¿ä¸¥æ ¼é€’å¢å­åºåˆ—çš„é•¿åº¦ã€‚

**å­åºåˆ—** æ˜¯ç”±æ•°ç»„æ´¾ç”Ÿè€Œæ¥çš„åºåˆ—ï¼Œåˆ é™¤ï¼ˆæˆ–ä¸åˆ é™¤ï¼‰æ•°ç»„ä¸­çš„å…ƒç´ è€Œä¸æ”¹å˜å…¶ä½™å…ƒç´ çš„é¡ºåºã€‚ä¾‹å¦‚ï¼Œ`[3,6,2,7]` æ˜¯æ•°ç»„ `[0,3,1,6,2,2,7]` çš„å­åºåˆ—ã€‚

**è¿›é˜¶ï¼š**

ä½ èƒ½å°†ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦é™ä½åˆ° `O(n logn)` å—?

## è§£é¢˜æ€è·¯

### æ€è·¯ä¸€ï¼šåŠ¨æ€è§„åˆ’

å¯ä»¥ä½¿ç”¨åŠ¨æ€è§„åˆ’æ¥è§£å†³:

- åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º `n` çš„æ•°ç»„ `dp`ï¼Œå…¶ä¸­ `dp[i]` è¡¨ç¤ºä»¥ç¬¬ `i` ä¸ªå…ƒç´ ä¸ºç»“å°¾çš„æœ€é•¿é€’å¢å­åºåˆ—çš„é•¿åº¦ã€‚
- åˆå§‹åŒ– `dp` æ•°ç»„çš„æ‰€æœ‰å…ƒç´ ä¸º 1ï¼Œå› ä¸ºæ¯ä¸ªå…ƒç´ è‡ªèº«ä¹Ÿæ˜¯ä¸€ä¸ªé•¿åº¦ä¸º 1 çš„é€’å¢å­åºåˆ—ã€‚
- å¯¹äºæ¯ä¸ªä½ç½® `i`ï¼Œéå† `0` åˆ° `i-1` çš„æ‰€æœ‰ä½ç½®ï¼Œå¦‚æœ `nums[i] > nums[j]`ï¼Œè¯´æ˜ `nums[i]` å¯ä»¥æ¥åœ¨ `nums[j]` åé¢æ„æˆä¸€ä¸ªæ›´é•¿çš„é€’å¢å­åºåˆ—ï¼Œæ›´æ–° `dp[i] = Math.max(dp[i], dp[j] + 1)`ã€‚
- æœ€ç»ˆï¼Œ`dp` æ•°ç»„ä¸­çš„æœ€å¤§å€¼å³ä¸ºæ‰€æ±‚çš„æœ€é•¿é€’å¢å­åºåˆ—çš„é•¿åº¦ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**: `O(n^2)` ï¼Œå…¶ä¸­ `n` æ˜¯æ•°ç»„ `nums` çš„é•¿åº¦ã€‚ä¸»è¦çš„æ—¶é—´å¤æ‚åº¦æ¥è‡ªäºä¸¤å±‚åµŒå¥—çš„å¾ªç¯ï¼Œå¤–å±‚å¾ªç¯éå†æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œè€Œå†…å±‚å¾ªç¯åœ¨æ¯æ¬¡å¤–å±‚å¾ªç¯ä¸­éƒ½éå†äº†ä¹‹å‰çš„æ‰€æœ‰å…ƒç´ ã€‚
- **ç©ºé—´å¤æ‚åº¦**: `O(n)`ï¼Œä½¿ç”¨äº†ä¸€ä¸ªé•¿åº¦ä¸º `n` çš„æ•°ç»„æ¥å­˜å‚¨ä¸­é—´çŠ¶æ€ã€‚

---

### æ€è·¯äºŒï¼šäºŒåˆ†æŸ¥æ‰¾

ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾ä¼˜åŒ–æœ€é•¿é€’å¢å­åºåˆ—é—®é¢˜ï¼Œä¸»è¦åˆ©ç”¨äº†ä¸€ä¸ªè¾…åŠ©æ•°ç»„ `tails`ã€‚è¿™ä¸ªæ•°ç»„åœ¨éå†è¿‡ç¨‹ä¸­ï¼Œå§‹ç»ˆä¿æŒé€’å¢çš„çŠ¶æ€ã€‚è¾…åŠ©æ•°ç»„ `tails` çš„é•¿åº¦ `len` è¡¨ç¤ºå½“å‰å·²ç»æ‰¾åˆ°çš„æœ€é•¿é€’å¢å­åºåˆ—çš„é•¿åº¦ã€‚äºŒåˆ†æŸ¥æ‰¾çš„è¿‡ç¨‹å¦‚ä¸‹ï¼š

1. **åˆå§‹åŒ–å·¦å³æŒ‡é’ˆï¼š**

   - åˆå§‹æ—¶ï¼Œ`left` æŒ‡å‘ 0ï¼Œ`right` æŒ‡å‘ `len`ã€‚

2. **å¼€å§‹äºŒåˆ†æŸ¥æ‰¾ï¼š**

   - åœ¨å½“å‰çš„è¾…åŠ©æ•°ç»„ `tails` ä¸­è¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äºç­‰äº `nums[i]` çš„ä½ç½®ã€‚ç”¨ `mid` è¡¨ç¤ºäºŒåˆ†æŸ¥æ‰¾ä¸­é—´ä½ç½®ã€‚
   - å¦‚æœ `tails[mid] < nums[i]`ï¼Œè¯´æ˜å½“å‰çš„é€’å¢å­åºåˆ—å¯ä»¥ç»§ç»­å»¶é•¿ï¼Œå› æ­¤æ›´æ–° `left = mid + 1`ã€‚
   - å¦åˆ™ï¼Œè¯´æ˜å½“å‰é€’å¢å­åºåˆ—éœ€è¦è¿›è¡Œè°ƒæ•´ï¼Œå› æ­¤æ›´æ–° `right = mid`ã€‚

3. **æ›´æ–°è¾…åŠ©æ•°ç»„ï¼š**

   - å¦‚æœ `left === len`ï¼Œè¯´æ˜ `nums[i]` å¤§äºå½“å‰é€’å¢å­åºåˆ—çš„æ‰€æœ‰å…ƒç´ ï¼Œå°† `nums[i]` æ·»åŠ åˆ°è¾…åŠ©æ•°ç»„çš„æœ«å°¾ï¼Œå¹¶ä¸”é€’å¢å­åºåˆ—çš„é•¿åº¦ `len++`ã€‚
   - å¦åˆ™ï¼Œå°† `nums[i]` æ›¿æ¢æ‰è¾…åŠ©æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªå¤§äºç­‰äº `nums[i]` çš„å…ƒç´ ã€‚

4. **è¿­ä»£ä¸‹ä¸€ä¸ªå…ƒç´ ï¼š**

   - é‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œç›´åˆ°éå†å®Œæ•´ä¸ªæ•°ç»„ `nums`ã€‚

5. **æœ€ç»ˆç»“æœï¼š**
   - è¾…åŠ©æ•°ç»„çš„é•¿åº¦ `len` å³ä¸ºæœ€é•¿é€’å¢å­åºåˆ—çš„é•¿åº¦ã€‚

ä¸¾ä¸€ä¸ªå…·ä½“çš„ç¤ºä¾‹æ¥è¯´æ˜ï¼š

å‡è®¾ `nums = [10, 9, 2, 5, 3, 7, 101, 18]`ã€‚

- åˆå§‹åŒ–æ—¶ï¼Œè¾…åŠ©æ•°ç»„ `tails` ä¸ºç©ºï¼Œ`len = 0`ã€‚
- å½“å¤„ç†å…ƒç´  `nums[0] = 10` æ—¶ï¼Œ`tails` ä¸ºç©ºï¼Œå°† `10` åŠ å…¥åˆ° `tails`ï¼Œ`len` å˜ä¸º `1`ã€‚
- å½“å¤„ç†å…ƒç´  `nums[1] = 9` æ—¶ï¼Œé€šè¿‡äºŒåˆ†æŸ¥æ‰¾åœ¨ `tails` ä¸­æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äºç­‰äº `9` çš„ä½ç½®ï¼Œå°† `tails[0]` æ›¿æ¢ä¸º `9`ã€‚
- ä¾æ­¤ç±»æ¨ï¼Œå¤„ç†å®Œæ•´ä¸ªæ•°ç»„åï¼Œ`tails` ä¸º `[2, 3, 7, 18]`ï¼Œ`len = 4`ï¼Œæœ€ç»ˆç»“æœä¸º `4`ã€‚

è¿™ç§æ–¹æ³•çš„æ ¸å¿ƒåœ¨äºé€šè¿‡äºŒåˆ†æŸ¥æ‰¾ï¼Œé«˜æ•ˆåœ°ç»´æŠ¤äº†ä¸€ä¸ªé€’å¢çš„è¾…åŠ©æ•°ç»„ï¼Œä»è€Œåœ¨ä¿è¯æ­£ç¡®æ€§çš„åŒæ—¶é™ä½æ—¶é—´å¤æ‚åº¦åˆ° `O(n logn)`ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**: `O(n logn)` ï¼Œå…¶ä¸­ `n` æ˜¯æ•°ç»„ `nums` çš„é•¿åº¦ã€‚
- **ç©ºé—´å¤æ‚åº¦**: `O(len)`ï¼Œå…¶ä¸­ `len` æ˜¯æœ€é•¿é€’å¢å­åºåˆ—çš„é•¿åº¦ï¼Œä½¿ç”¨äº†ä¸€ä¸ªé•¿åº¦æœ€é•¿ä¸º `len` çš„è¾…åŠ©æ•°ç»„ã€‚

## ä»£ç 

::: code-tabs

@tab åŠ¨æ€è§„åˆ’

```javascript
/**
 * @param {number[]} nums
 * @return {number}
 */
var lengthOfLIS = function (nums) {
	let dp = new Array(nums.length).fill(1);
	for (let i = 0; i < nums.length; i++) {
		for (let j = 0; j < i; j++) {
			if (nums[i] > nums[j]) {
				dp[i] = Math.max(dp[i], dp[j] + 1);
			}
		}
	}

	return Math.max(...dp);
};
```

@tab äºŒåˆ†æŸ¥æ‰¾

```javascript
/**
 * @param {number[]} nums
 * @return {number}
 */
function lengthOfLIS(nums) {
	if (!nums || nums.length === 0) {
		return 0;
	}

	const n = nums.length;
	const tails = [];
	let len = 0;

	for (let i = 0; i < n; i++) {
		let left = 0;
		let right = len;

		while (left < right) {
			const mid = Math.floor((left + right) / 2);
			if (tails[mid] < nums[i]) {
				left = mid + 1;
			} else {
				right = mid;
			}
		}

		if (left === len) {
			tails[len++] = nums[i];
		} else {
			tails[left] = nums[i];
		}
	}

	return len;
}
```

:::

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 334 | [é€’å¢çš„ä¸‰å…ƒå­åºåˆ—](https://leetcode.com/problems/increasing-triplet-subsequence) | [[âœ“]](/problem/0334.md) |  [`è´ªå¿ƒ`](/tag/greedy.md) [`æ•°ç»„`](/tag/array.md) | <font color=#ffb800>Medium</font> |
| 354 | [ä¿„ç½—æ–¯å¥—å¨ƒä¿¡å°é—®é¢˜](https://leetcode.com/problems/russian-doll-envelopes) | [[âœ“]](/problem/0354.md) |  [`æ•°ç»„`](/tag/array.md) [`äºŒåˆ†æŸ¥æ‰¾`](/tag/binary-search.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md) `1+` | <font color=#ff334b>Hard</font> |
| 646 | [æœ€é•¿æ•°å¯¹é“¾](https://leetcode.com/problems/maximum-length-of-pair-chain) |  |  [`è´ªå¿ƒ`](/tag/greedy.md) [`æ•°ç»„`](/tag/array.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md) `1+` | <font color=#ffb800>Medium</font> |
| 673 | [æœ€é•¿é€’å¢å­åºåˆ—çš„ä¸ªæ•°](https://leetcode.com/problems/number-of-longest-increasing-subsequence) |  |  [`æ ‘çŠ¶æ•°ç»„`](/tag/binary-indexed-tree.md) [`çº¿æ®µæ ‘`](/tag/segment-tree.md) [`æ•°ç»„`](/tag/array.md) `1+` | <font color=#ffb800>Medium</font> |
| 712 | [ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æœ€å°ASCIIåˆ é™¤å’Œ](https://leetcode.com/problems/minimum-ascii-delete-sum-for-two-strings) | [[âœ“]](/problem/0712.md) |  [`å­—ç¬¦ä¸²`](/tag/string.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md) | <font color=#ffb800>Medium</font> |
| 1671 | [å¾—åˆ°å±±å½¢æ•°ç»„çš„æœ€å°‘åˆ é™¤æ¬¡æ•°](https://leetcode.com/problems/minimum-number-of-removals-to-make-mountain-array) | [[âœ“]](/problem/1671.md) |  [`è´ªå¿ƒ`](/tag/greedy.md) [`æ•°ç»„`](/tag/array.md) [`äºŒåˆ†æŸ¥æ‰¾`](/tag/binary-search.md) `1+` | <font color=#ff334b>Hard</font> |
| 1964 | [æ‰¾å‡ºåˆ°æ¯ä¸ªä½ç½®ä¸ºæ­¢æœ€é•¿çš„æœ‰æ•ˆéšœç¢èµ›è·‘è·¯çº¿](https://leetcode.com/problems/find-the-longest-valid-obstacle-course-at-each-position) |  |  [`æ ‘çŠ¶æ•°ç»„`](/tag/binary-indexed-tree.md) [`æ•°ç»„`](/tag/array.md) [`äºŒåˆ†æŸ¥æ‰¾`](/tag/binary-search.md) | <font color=#ff334b>Hard</font> |
| 2111 | [ä½¿æ•°ç»„ K é€’å¢çš„æœ€å°‘æ“ä½œæ¬¡æ•°](https://leetcode.com/problems/minimum-operations-to-make-the-array-k-increasing) |  |  [`æ•°ç»„`](/tag/array.md) [`äºŒåˆ†æŸ¥æ‰¾`](/tag/binary-search.md) | <font color=#ff334b>Hard</font> |
| 2355 | [ä½ èƒ½æ‹¿èµ°çš„æœ€å¤§å›¾ä¹¦æ•°é‡ ğŸ”’](https://leetcode.com/problems/maximum-number-of-books-you-can-take) |  |  [`æ ˆ`](/tag/stack.md) [`æ•°ç»„`](/tag/array.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md) `1+` | <font color=#ff334b>Hard</font> |
| 2370 | [æœ€é•¿ç†æƒ³å­åºåˆ—](https://leetcode.com/problems/longest-ideal-subsequence) |  |  [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`å­—ç¬¦ä¸²`](/tag/string.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md) | <font color=#ffb800>Medium</font> |
| 2407 | [æœ€é•¿é€’å¢å­åºåˆ— II](https://leetcode.com/problems/longest-increasing-subsequence-ii) |  |  [`æ ‘çŠ¶æ•°ç»„`](/tag/binary-indexed-tree.md) [`çº¿æ®µæ ‘`](/tag/segment-tree.md) [`é˜Ÿåˆ—`](/tag/queue.md) `4+` | <font color=#ff334b>Hard</font> |
| 3176 | [æ±‚å‡ºæœ€é•¿å¥½å­åºåˆ— I](https://leetcode.com/problems/find-the-maximum-length-of-a-good-subsequence-i) |  |  [`æ•°ç»„`](/tag/array.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md) | <font color=#ffb800>Medium</font> |
| 3177 | [æ±‚å‡ºæœ€é•¿å¥½å­åºåˆ— II](https://leetcode.com/problems/find-the-maximum-length-of-a-good-subsequence-ii) |  |  [`æ•°ç»„`](/tag/array.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md) | <font color=#ff334b>Hard</font> |
| 3201 | [æ‰¾å‡ºæœ‰æ•ˆå­åºåˆ—çš„æœ€å¤§é•¿åº¦ I](https://leetcode.com/problems/find-the-maximum-length-of-valid-subsequence-i) |  |  [`æ•°ç»„`](/tag/array.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md) | <font color=#ffb800>Medium</font> |
| 3202 | [æ‰¾å‡ºæœ‰æ•ˆå­åºåˆ—çš„æœ€å¤§é•¿åº¦ II](https://leetcode.com/problems/find-the-maximum-length-of-valid-subsequence-ii) |  |  [`æ•°ç»„`](/tag/array.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md) | <font color=#ffb800>Medium</font> |