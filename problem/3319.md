# [3319. ç¬¬ K å¤§çš„å®Œç¾äºŒå‰å­æ ‘çš„å¤§å°](https://leetcode.com/problems/k-th-largest-perfect-subtree-size-in-binary-tree)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ ‘`](/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/tag/depth-first-search.md) [`äºŒå‰æ ‘`](/tag/binary-tree.md) [`æ’åº`](/tag/sorting.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/k-th-largest-perfect-subtree-size-in-binary-tree)

## é¢˜ç›®

<p>ç»™ä½ ä¸€æ£µ <strong>äºŒå‰æ ‘ </strong>çš„æ ¹èŠ‚ç‚¹ <code>root</code> å’Œä¸€ä¸ªæ•´æ•°<code>k</code>ã€‚</p>

<p>è¿”å›ç¬¬ <code>k</code> å¤§çš„ <strong>å®Œç¾äºŒå‰</strong><span data-keyword="subtree"><strong>å­æ ‘</strong> </span>çš„å¤§å°ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¿”å› <code>-1</code>ã€‚</p>

<p><strong>å®Œç¾äºŒå‰æ ‘ </strong>æ˜¯æŒ‡æ‰€æœ‰å¶å­èŠ‚ç‚¹éƒ½åœ¨åŒä¸€å±‚çº§çš„æ ‘ï¼Œä¸”æ¯ä¸ªçˆ¶èŠ‚ç‚¹æ°æœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹ã€‚</p>

<p>&nbsp;</p>

<p><strong class="example">ç¤ºä¾‹ 1ï¼š</strong></p>

<div class="example-block">
<p><strong>è¾“å…¥ï¼š</strong> <span class="example-io">root = [5,3,6,5,2,5,7,1,8,null,null,6,8], k = 2</span></p>

<p><strong>è¾“å‡ºï¼š</strong> <span class="example-io">3</span></p>

<p><strong>è§£é‡Šï¼š</strong></p>

<p><img alt="" src="https://assets.leetcode.com/uploads/2024/10/14/tmpresl95rp-1.png" style="width: 400px; height: 173px;" /></p>

<p>å®Œç¾äºŒå‰å­æ ‘çš„æ ¹èŠ‚ç‚¹åœ¨å›¾ä¸­ä»¥é»‘è‰²çªå‡ºæ˜¾ç¤ºã€‚å®ƒä»¬çš„å¤§å°æŒ‰éé€’å¢é¡ºåºæ’åˆ—ä¸º <code>[3, 3, 1, 1, 1, 1, 1, 1]</code>ã€‚<br />
ç¬¬ <code>2</code> å¤§çš„å®Œç¾äºŒå‰å­æ ‘çš„å¤§å°æ˜¯ 3ã€‚</p>
</div>

<p><strong class="example">ç¤ºä¾‹ 2ï¼š</strong></p>

<div class="example-block">
<p><strong>è¾“å…¥ï¼š</strong> <span class="example-io">root = [1,2,3,4,5,6,7], k = 1</span></p>

<p><strong>è¾“å‡ºï¼š</strong> <span class="example-io">7</span></p>

<p><strong>è§£é‡Šï¼š</strong></p>

<p><img alt="" src="https://assets.leetcode.com/uploads/2024/10/14/tmp_s508x9e-1.png" style="width: 300px; height: 189px;" /></p>

<p>å®Œç¾äºŒå‰å­æ ‘çš„å¤§å°æŒ‰éé€’å¢é¡ºåºæ’åˆ—ä¸º <code>[7, 3, 3, 1, 1, 1, 1]</code>ã€‚æœ€å¤§çš„å®Œç¾äºŒå‰å­æ ‘çš„å¤§å°æ˜¯ 7ã€‚</p>
</div>

<p><strong class="example">ç¤ºä¾‹ 3ï¼š</strong></p>

<div class="example-block">
<p><strong>è¾“å…¥ï¼š</strong> <span class="example-io">root = [1,2,3,null,4], k = 3</span></p>

<p><strong>è¾“å‡ºï¼š</strong> <span class="example-io">-1</span></p>

<p><strong>è§£é‡Šï¼š</strong></p>

<p><img alt="" src="https://assets.leetcode.com/uploads/2024/10/14/tmp74xnmpj4-1.png" style="width: 250px; height: 225px;" /></p>

<p>å®Œç¾äºŒå‰å­æ ‘çš„å¤§å°æŒ‰éé€’å¢é¡ºåºæ’åˆ—ä¸º <code>[1, 1]</code>ã€‚å®Œç¾äºŒå‰å­æ ‘çš„æ•°é‡å°‘äº 3ã€‚</p>
</div>

<p>&nbsp;</p>

<p><strong>æç¤ºï¼š</strong></p>

<ul>
	<li>æ ‘ä¸­çš„èŠ‚ç‚¹æ•°ç›®åœ¨ <code>[1, 2000]</code> èŒƒå›´å†…ã€‚</li>
	<li><code>1 &lt;= Node.val &lt;= 2000</code></li>
	<li><code>1 &lt;= k &lt;= 1024</code></li>
</ul>


## è§£é¢˜æ€è·¯

å®Œç¾å­æ ‘æ˜¯æŒ‡è¯¥æ ‘çš„æ‰€æœ‰å¶å­èŠ‚ç‚¹åœ¨åŒä¸€å±‚ï¼Œä¸”æ¯ä¸ªéå¶å­èŠ‚ç‚¹éƒ½æœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹ã€‚å› æ­¤å¯ä»¥ä½¿ç”¨é€’å½’æ¥éå†äºŒå‰æ ‘ï¼Œæ£€æŸ¥æ¯ä¸ªèŠ‚ç‚¹çš„å­æ ‘æ˜¯å¦æ˜¯å®Œç¾å­æ ‘ã€‚

åœ¨é€’å½’è¿‡ç¨‹ä¸­ï¼Œåˆ¤æ–­æŸä¸ªèŠ‚ç‚¹çš„å·¦å³å­æ ‘æ˜¯å¦é«˜åº¦ç›¸åŒä¸”éƒ½æ˜¯å®Œç¾çš„ã€‚å¦‚æœæ˜¯ï¼Œå¯ä»¥è®¡ç®—å½“å‰å­æ ‘çš„èŠ‚ç‚¹æ•°ã€‚

ä½¿ç”¨ä¸€ä¸ªæ•°ç»„å­˜å‚¨æ‰€æœ‰å®Œç¾å­æ ‘çš„å¤§å°ã€‚ç„¶ååœ¨é€’å½’å®Œæˆåï¼Œæ’åºè¯¥æ•°ç»„ï¼Œå¹¶æ‰¾åˆ°ç¬¬ `k` å¤§çš„å®Œç¾å­æ ‘çš„å¤§å°ã€‚

å¦‚æœæ•°ç»„çš„å¤§å°å°äº `k`ï¼Œè¿”å› `-1`ï¼Œå¦åˆ™è¿”å›æ•°ç»„ä¸­ç¬¬ `k` å¤§çš„å…ƒç´ ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œæ¯ä¸ªèŠ‚ç‚¹éå†ä¸€æ¬¡ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œç”¨äºå­˜å‚¨æ‰€æœ‰å®Œç¾å­æ ‘çš„å¤§å°ã€‚

## ä»£ç 

```javascript
/**
 * Definition for a binary tree node.
 * function TreeNode(val, left, right) {
 *     this.val = (val===undefined ? 0 : val)
 *     this.left = (left===undefined ? null : left)
 *     this.right = (right===undefined ? null : right)
 * }
 */
/**
 * @param {TreeNode} root
 * @param {number} k
 * @return {number}
 */
var kthLargestPerfectSubtree = function (root, k) {
	let sizes = findPerfectSubtree(root);
	if (sizes.length < k) return -1;

	// æŒ‰é™åºæ’åº
	sizes.sort((a, b) => b - a);
	return sizes[k - 1];
};

var findPerfectSubtree = function (root) {
	let sizes = [];

	// é€’å½’å‡½æ•°ï¼Œè¿”å›å½“å‰å­æ ‘çš„é«˜åº¦ã€èŠ‚ç‚¹æ•°å’Œæ˜¯å¦ä¸ºå®Œç¾äºŒå‰æ ‘
	const dfs = (root) => {
		if (!root) return [0, 0, true];
		const [leftHeight, leftCount, isLeftPerfect] = dfs(root.left);
		const [rightHeight, rightCount, isRightPerfect] = dfs(root.right);

		const rootCount = leftCount + rightCount + 1;

		// æ£€æŸ¥æ˜¯å¦ä¸ºå®Œç¾å­æ ‘
		if (leftHeight == rightHeight && isLeftPerfect && isRightPerfect) {
			sizes.push(rootCount);
			return [leftHeight + 1, rootCount, true];
		}
		return [Math.max(leftHeight, rightHeight) + 1, rootCount, false];
	};

	dfs(root);
	return sizes;
};
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 110 | [å¹³è¡¡äºŒå‰æ ‘](https://leetcode.com/problems/balanced-binary-tree) | [[âœ“]](/problem/0110.md) |  [`æ ‘`](/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/tag/depth-first-search.md) [`äºŒå‰æ ‘`](/tag/binary-tree.md) | <font color=#15bd66>Easy</font> |