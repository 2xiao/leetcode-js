---
title: 2336. æ— é™é›†ä¸­çš„æœ€å°æ•°å­—
description: LeetCode 2336. æ— é™é›†ä¸­çš„æœ€å°æ•°å­—é¢˜è§£ï¼ŒSmallest Number in Infinite Setï¼ŒåŒ…å«è§£é¢˜æ€è·¯ã€å¤æ‚åº¦åˆ†æä»¥åŠå®Œæ•´çš„ JavaScript ä»£ç å®ç°ã€‚
keywords:
  - LeetCode
  - 2336. æ— é™é›†ä¸­çš„æœ€å°æ•°å­—
  - æ— é™é›†ä¸­çš„æœ€å°æ•°å­—
  - Smallest Number in Infinite Set
  - è§£é¢˜æ€è·¯
  - è®¾è®¡
  - å“ˆå¸Œè¡¨
  - æœ‰åºé›†åˆ
  - å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰
---

# 2336. æ— é™é›†ä¸­çš„æœ€å°æ•°å­—

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`è®¾è®¡`](/tag/design.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`æœ‰åºé›†åˆ`](/tag/ordered-set.md) [`å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰`](/tag/heap-priority-queue.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/smallest-number-in-infinite-set) [`LeetCode`](https://leetcode.com/problems/smallest-number-in-infinite-set)

## é¢˜ç›®

You have a set which contains all positive integers `[1, 2, 3, 4, 5, ...]`.

Implement the `SmallestInfiniteSet` class:

- `SmallestInfiniteSet()` Initializes the **SmallestInfiniteSet** object to contain **all** positive integers.
- `int popSmallest()` **Removes** and returns the smallest integer contained in the infinite set.
- `void addBack(int num)` **Adds** a positive integer `num` back into the infinite set, if it is **not** already in the infinite set.

**Example 1:**

> **Input**
>
> ["SmallestInfiniteSet", "addBack", "popSmallest", "popSmallest", "popSmallest", "addBack", "popSmallest", "popSmallest", "popSmallest"]
>
> [[], [2], [], [], [], [1], [], [], []]
>
> **Output**
>
> [null, null, 1, 2, 3, null, 1, 4, 5]
>
> **Explanation**
>
> ```js
> SmallestInfiniteSet smallestInfiniteSet = new SmallestInfiniteSet();
>
> smallestInfiniteSet.addBack(2); // 2 is already in the set, so no change is made.
>
> smallestInfiniteSet.popSmallest(); // return 1, since 1 is the smallest number, and remove it from the set.
>
> smallestInfiniteSet.popSmallest(); // return 2, and remove it from the set.
>
> smallestInfiniteSet.popSmallest(); // return 3, and remove it from the set.
>
> smallestInfiniteSet.addBack(1); // 1 is added back to the set.
>
> smallestInfiniteSet.popSmallest(); // return 1, since 1 was added back to the set and is the smallest number, and remove it from the set.
>
> smallestInfiniteSet.popSmallest(); // return 4, and remove it from the set.
>
> smallestInfiniteSet.popSmallest(); // return 5, and remove it from the set.
> ```

**Constraints:**

- `1 <= num <= 1000`
- At most `1000` calls will be made **in total** to `popSmallest` and `addBack`.

## é¢˜ç›®å¤§æ„

ç°æœ‰ä¸€ä¸ªåŒ…å«æ‰€æœ‰æ­£æ•´æ•°çš„é›†åˆ `[1, 2, 3, 4, 5, ...]` ã€‚

å®ç° `SmallestInfiniteSet` ç±»ï¼š

- `SmallestInfiniteSet()` åˆå§‹åŒ– **SmallestInfiniteSet** å¯¹è±¡ä»¥åŒ…å« **æ‰€æœ‰** æ­£æ•´æ•°ã€‚
- `int popSmallest()` **ç§»é™¤** å¹¶è¿”å›è¯¥æ— é™é›†ä¸­çš„æœ€å°æ•´æ•°ã€‚
- `void addBack(int num)` å¦‚æœæ­£æ•´æ•° `num` **ä¸** å­˜åœ¨äºæ— é™é›†ä¸­ï¼Œåˆ™å°†ä¸€ä¸ª `num` **æ·»åŠ ** åˆ°è¯¥æ— é™é›†ä¸­ã€‚

**ç¤ºä¾‹ï¼š**

> **è¾“å…¥**
>
> ["SmallestInfiniteSet", "addBack", "popSmallest", "popSmallest", "popSmallest", "addBack", "popSmallest", "popSmallest", "popSmallest"]
>
> [[], [2], [], [], [], [1], [], [], []]
>
> **è¾“å‡º**
>
> [null, null, 1, 2, 3, null, 1, 4, 5]
>
> **è§£é‡Š**
>
> ```js
> SmallestInfiniteSet smallestInfiniteSet = new SmallestInfiniteSet();
>
> smallestInfiniteSet.addBack(2); // 2 å·²ç»åœ¨é›†åˆä¸­ï¼Œæ‰€ä»¥ä¸åšä»»ä½•å˜æ›´ã€‚
>
> smallestInfiniteSet.popSmallest(); // è¿”å› 1 ï¼Œå› ä¸º 1 æ˜¯æœ€å°çš„æ•´æ•°ï¼Œå¹¶å°†å…¶ä»é›†åˆä¸­ç§»é™¤ã€‚
>
> smallestInfiniteSet.popSmallest(); // è¿”å› 2 ï¼Œå¹¶å°†å…¶ä»é›†åˆä¸­ç§»é™¤ã€‚
>
> smallestInfiniteSet.popSmallest(); // è¿”å› 3 ï¼Œå¹¶å°†å…¶ä»é›†åˆä¸­ç§»é™¤ã€‚
>
> smallestInfiniteSet.addBack(1); // å°† 1 æ·»åŠ åˆ°è¯¥é›†åˆä¸­ã€‚
>
> smallestInfiniteSet.popSmallest(); // è¿”å› 1 ï¼Œå› ä¸º 1 åœ¨ä¸Šä¸€æ­¥ä¸­è¢«æ·»åŠ åˆ°é›†åˆä¸­ï¼Œä¸” 1 æ˜¯æœ€å°çš„æ•´æ•°ï¼Œå¹¶å°†å…¶ä»é›†åˆä¸­ç§»é™¤ã€‚
>
> smallestInfiniteSet.popSmallest(); // è¿”å› 4 ï¼Œå¹¶å°†å…¶ä»é›†åˆä¸­ç§»é™¤ã€‚
>
> smallestInfiniteSet.popSmallest(); // è¿”å› 5 ï¼Œå¹¶å°†å…¶ä»é›†åˆä¸­ç§»é™¤ã€‚
> ```

**æç¤ºï¼š**

- `1 <= num <= 1000`
- æœ€å¤šè°ƒç”¨ `popSmallest` å’Œ `addBack` æ–¹æ³• **å…±è®¡** `1000` æ¬¡

## è§£é¢˜æ€è·¯

1. **ç»´æŠ¤æœ€å°å †**ï¼šç”¨æœ€å°å †ä¿å­˜è¢«æ·»åŠ å›é›†åˆçš„æ•°å­—ï¼Œä¿è¯å †é¡¶å§‹ç»ˆæ˜¯é›†åˆä¸­çš„æœ€å°æ•°ï¼Œåˆå§‹æ—¶æœ€å°å †ä¸ºç©ºã€‚

2. **è¿½è¸ªä¸‹ä¸€ä¸ªè‡ªç„¶æ•°**ï¼šç”¨ä¸€ä¸ªå˜é‡ `current` è¡¨ç¤ºå½“å‰è‡ªç„¶æ•°çš„ä¸Šç•Œï¼Œåˆå§‹ä¸º `1`ï¼Œå¦‚æœæœ€å°å †ä¸ºç©ºï¼Œæœ€å°çš„æ•°å­—ä¸º `current`ã€‚

3. **ä½¿ç”¨é›†åˆå»é‡**ï¼šç”¨ä¸€ä¸ªé›†åˆ `addBackSet` æ¥å­˜å‚¨è¢«é‡æ–°æ·»åŠ å›é›†åˆçš„æ•°å­—ï¼Œæ–¹ä¾¿æŸ¥æ‰¾ï¼Œé¿å…é‡å¤æ·»åŠ ã€‚

4. **`popSmallest`**ï¼š

   - å¦‚æœ `minHeap` éç©ºï¼Œä»å †ä¸­å¼¹å‡ºå †é¡¶å…ƒç´ ä½œä¸ºç»“æœï¼ŒåŒæ—¶ä» `addBackSet` ä¸­ç§»é™¤ã€‚
   - å¦‚æœ `minHeap` ä¸ºç©ºï¼Œè¿”å› `current`ï¼Œå¹¶å°† `current` åŠ  1ã€‚

5. **`addBack`**ï¼š
   - å¦‚æœ `num` å°äº `current` ä¸”ä¸åœ¨ `addBackSet` ä¸­ï¼Œå°†å…¶åŠ å…¥ `minHeap` å’Œ `addBackSet`ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(log k)`ï¼Œ

  - `popSmallest()`ï¼šå¼¹å‡ºæœ€å°å †çš„å †é¡¶å…ƒç´ éœ€è¦ `O(log k)`ï¼Œå…¶ä¸­ `k` æ˜¯å½“å‰å †çš„å¤§å°ã€‚å¦‚æœæœ€å°å †ä¸ºç©ºæ—¶ç›´æ¥è¿”å› `current`ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º `O(1)`ã€‚
  - `addBack(num)`ï¼šæ’å…¥å †éœ€è¦ `O(log k)`ï¼Œåˆ¤æ–­æ˜¯å¦åœ¨é›†åˆä¸­ä¸º `O(1)`ã€‚

- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(k)`ï¼Œæœ€å°å †å’Œé›†åˆçš„ç©ºé—´å¤æ‚åº¦å‡ä¸º `O(k)`ï¼Œå…¶ä¸­ `k` æ˜¯å †ä¸­å…ƒç´ çš„æ•°é‡ã€‚

## ä»£ç 

```javascript
var SmallestInfiniteSet = function () {
	this.minHeap = new MinHeap(); // æœ€å°å †å­˜å‚¨è¢«æ·»åŠ å›çš„æ•°
	this.addBackSet = new Set(); // å­˜å‚¨è¢«æ·»åŠ å›çš„æ•°ï¼Œæ–¹ä¾¿æŸ¥æ‰¾
	this.current = 1; // å½“å‰è‡ªç„¶æ•°çš„ä¸‹ç•Œ
};

/**
 * @return {number}
 */
SmallestInfiniteSet.prototype.popSmallest = function () {
	if (this.minHeap.size() == 0) {
		return this.current++;
	}
	const res = this.minHeap.pop();
	this.addBackSet.delete(res);
	return res;
};

/**
 * @param {number} num
 * @return {void}
 */
SmallestInfiniteSet.prototype.addBack = function (num) {
	if (!this.addBackSet.has(num) && this.current > num) {
		this.minHeap.insert(num);
		this.addBackSet.add(num);
	}
};

// æœ€å°å †
class MinHeap {
	constructor() {
		this.heap = [];
	}
	insert(num) {
		this.heap.push(num);
		this.heapifyUp(this.heap.length - 1);
	}
	pop() {
		if (this.heap.length == 0) return null;
		const top = this.heap[0],
			last = this.heap.pop();
		if (this.heap.length > 0) {
			this.heap[0] = last;
			this.heapifyDown(0);
		}
		return top;
	}
	size() {
		return this.heap.length;
	}
	heapifyDown(i) {
		const left = i * 2 + 1,
			right = i * 2 + 2;
		let min = i;
		if (left < this.heap.length && this.heap[left] < this.heap[min]) {
			min = left;
		}
		if (right < this.heap.length && this.heap[right] < this.heap[min]) {
			min = right;
		}
		if (min !== i) {
			[this.heap[i], this.heap[min]] = [this.heap[min], this.heap[i]];
			this.heapifyDown(min);
		}
	}
	heapifyUp(i) {
		while (i) {
			const parent = ((i - 1) / 2) | 0;
			if (this.heap[i] < this.heap[parent]) {
				[this.heap[i], this.heap[parent]] = [this.heap[parent], this.heap[i]];
				i = parent;
			} else {
				break;
			}
		}
	}
}

/**
 * Your SmallestInfiniteSet object will be instantiated and called as such:
 * var obj = new SmallestInfiniteSet()
 * var param_1 = obj.popSmallest()
 * obj.addBack(num)
 */
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ | åŠ›æ‰£ |
| :------: | :------ | :------: | :------ | :------: | :------: |
| 41 | ç¼ºå¤±çš„ç¬¬ä¸€ä¸ªæ­£æ•° | [[âœ“]](/problem/0041.md) |  [`æ•°ç»„`](/tag/array.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) | ğŸ”´ | [ğŸ€„ï¸](https://leetcode.cn/problems/first-missing-positive) [ğŸ”—](https://leetcode.com/problems/first-missing-positive) |