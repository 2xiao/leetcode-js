# [99. æ¢å¤äºŒå‰æœç´¢æ ‘](https://leetcode.com/problems/recover-binary-search-tree)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ ‘`](/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/tag/depth-first-search.md) [`äºŒå‰æœç´¢æ ‘`](/tag/binary-search-tree.md) [`äºŒå‰æ ‘`](/tag/binary-tree.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/recover-binary-search-tree)

## é¢˜ç›®

<p>ç»™ä½ äºŒå‰æœç´¢æ ‘çš„æ ¹èŠ‚ç‚¹ <code>root</code> ï¼Œè¯¥æ ‘ä¸­çš„ <strong>æ°å¥½</strong> ä¸¤ä¸ªèŠ‚ç‚¹çš„å€¼è¢«é”™è¯¯åœ°äº¤æ¢ã€‚<em>è¯·åœ¨ä¸æ”¹å˜å…¶ç»“æ„çš„æƒ…å†µä¸‹ï¼Œæ¢å¤è¿™æ£µæ ‘&nbsp;</em>ã€‚</p>

<p>&nbsp;</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<img alt="" src="https://assets.leetcode.com/uploads/2020/10/28/recover1.jpg" style="width: 300px;" />
<pre>
<strong>è¾“å…¥ï¼š</strong>root = [1,3,null,null,2]
<strong>è¾“å‡ºï¼š</strong>[3,1,null,null,2]
<strong>è§£é‡Šï¼š</strong>3 ä¸èƒ½æ˜¯ 1 çš„å·¦å­©å­ï¼Œå› ä¸º 3 &gt; 1 ã€‚äº¤æ¢ 1 å’Œ 3 ä½¿äºŒå‰æœç´¢æ ‘æœ‰æ•ˆã€‚
</pre>

<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>
<img alt="" src="https://assets.leetcode.com/uploads/2020/10/28/recover2.jpg" style="height: 208px; width: 400px;" />
<pre>
<strong>è¾“å…¥ï¼š</strong>root = [3,1,4,null,null,2]
<strong>è¾“å‡ºï¼š</strong>[2,1,4,null,null,3]
<strong>è§£é‡Šï¼š</strong>2 ä¸èƒ½åœ¨ 3 çš„å³å­æ ‘ä¸­ï¼Œå› ä¸º 2 &lt; 3 ã€‚äº¤æ¢ 2 å’Œ 3 ä½¿äºŒå‰æœç´¢æ ‘æœ‰æ•ˆã€‚</pre>

<p>&nbsp;</p>

<p><strong>æç¤ºï¼š</strong></p>

<ul>
	<li>æ ‘ä¸ŠèŠ‚ç‚¹çš„æ•°ç›®åœ¨èŒƒå›´ <code>[2, 1000]</code> å†…</li>
	<li><code>-2<sup>31</sup> &lt;= Node.val &lt;= 2<sup>31</sup> - 1</code></li>
</ul>

<p>&nbsp;</p>

<p><strong>è¿›é˜¶ï¼š</strong>ä½¿ç”¨ <code>O(n)</code> ç©ºé—´å¤æ‚åº¦çš„è§£æ³•å¾ˆå®¹æ˜“å®ç°ã€‚ä½ èƒ½æƒ³å‡ºä¸€ä¸ªåªä½¿ç”¨&nbsp;<code>O(1)</code> ç©ºé—´çš„è§£å†³æ–¹æ¡ˆå—ï¼Ÿ</p>


## è§£é¢˜æ€è·¯

æ ¹æ® BST çš„æ€§è´¨ï¼ŒBST çš„ä¸­åºéå†æ˜¯å‡åºçš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸­åºéå†æ¥æ‰¾åˆ°è¿™ä¸¤ä¸ªé”™è¯¯èŠ‚ç‚¹ï¼Œå¹¶äº¤æ¢å®ƒä»¬çš„å€¼ï¼Œä»è€Œæ¢å¤ BST çš„æ­£ç¡®é¡ºåºã€‚

1. è¿›è¡Œ BST çš„ä¸­åºéå†ï¼Œå¹¶è®°å½•å…ˆå‰è®¿é—®çš„èŠ‚ç‚¹ `prev`ï¼›
2. åœ¨éå†è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå‘ç°å½“å‰èŠ‚ç‚¹çš„å€¼å°äºå…ˆå‰èŠ‚ç‚¹çš„å€¼ï¼Œè¯´æ˜æ‰¾åˆ°äº†ä¸€ä¸ªé”™è¯¯èŠ‚ç‚¹ï¼›
3. è®°å½•è¿™ä¸¤ä¸ªé”™è¯¯èŠ‚ç‚¹ï¼Œå¹¶ç»§ç»­éå†ï¼›
4. éå†ç»“æŸåï¼Œäº¤æ¢è¿™ä¸¤ä¸ªé”™è¯¯èŠ‚ç‚¹çš„å€¼ï¼Œå³å®Œæˆä¿®å¤æ“ä½œï¼›

## ä»£ç 

```javascript
/**
 * @param {TreeNode} root
 * @return {void} Do not return anything, modify root in-place instead.
 */
var recoverTree = function (root) {
	let prev = null;
	let first = null;
	let second = null;

	const traverse = (root) => {
		if (!root) return;
		traverse(root.left);
		if (prev != null && prev.val >= root.val) {
			if (first == null) {
				first = prev;
			}
			second = root;
		}
		prev = root;
		traverse(root.right);
	};
	traverse(root);
	const temp = first.val;
	first.val = second.val;
	second.val = temp;
};
```
