# [632. æœ€å°åŒºé—´](https://leetcode.com/problems/smallest-range-covering-elements-from-k-lists)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`è´ªå¿ƒ`](/tag/greedy.md) [`æ•°ç»„`](/tag/array.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`æ’åº`](/tag/sorting.md) [`æ»‘åŠ¨çª—å£`](/tag/sliding-window.md) [`å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰`](/tag/heap-priority-queue.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/smallest-range-covering-elements-from-k-lists)

## é¢˜ç›®

<p>ä½ æœ‰&nbsp;<code>k</code>&nbsp;ä¸ª <strong>éé€’å‡æ’åˆ—</strong> çš„æ•´æ•°åˆ—è¡¨ã€‚æ‰¾åˆ°ä¸€ä¸ª <strong>æœ€å° </strong>åŒºé—´ï¼Œä½¿å¾—&nbsp;<code>k</code>&nbsp;ä¸ªåˆ—è¡¨ä¸­çš„æ¯ä¸ªåˆ—è¡¨è‡³å°‘æœ‰ä¸€ä¸ªæ•°åŒ…å«åœ¨å…¶ä¸­ã€‚</p>

<p>æˆ‘ä»¬å®šä¹‰å¦‚æœ&nbsp;<code>b-a &lt; d-c</code>&nbsp;æˆ–è€…åœ¨&nbsp;<code>b-a == d-c</code>&nbsp;æ—¶&nbsp;<code>a &lt; c</code>ï¼Œåˆ™åŒºé—´ <code>[a,b]</code> æ¯” <code>[c,d]</code> å°ã€‚</p>

<p>&nbsp;</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>nums = [[4,10,15,24,26], [0,9,12,20], [5,18,22,30]]
<strong>è¾“å‡ºï¼š</strong>[20,24]
<strong>è§£é‡Šï¼š</strong> 
åˆ—è¡¨ 1ï¼š[4, 10, 15, 24, 26]ï¼Œ24 åœ¨åŒºé—´ [20,24] ä¸­ã€‚
åˆ—è¡¨ 2ï¼š[0, 9, 12, 20]ï¼Œ20 åœ¨åŒºé—´ [20,24] ä¸­ã€‚
åˆ—è¡¨ 3ï¼š[5, 18, 22, 30]ï¼Œ22 åœ¨åŒºé—´ [20,24] ä¸­ã€‚
</pre>

<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>nums = [[1,2,3],[1,2,3],[1,2,3]]
<strong>è¾“å‡ºï¼š</strong>[1,1]
</pre>

<p>&nbsp;</p>

<p><strong>æç¤ºï¼š</strong></p>

<ul>
	<li><code>nums.length == k</code></li>
	<li><code>1 &lt;= k &lt;= 3500</code></li>
	<li><code>1 &lt;= nums[i].length &lt;= 50</code></li>
	<li><code>-10<sup>5</sup> &lt;= nums[i][j] &lt;= 10<sup>5</sup></code></li>
	<li><code>nums[i]</code> æŒ‰éé€’å‡é¡ºåºæ’åˆ—</li>
</ul>

<p>&nbsp;</p>


## è§£é¢˜æ€è·¯

å¯ä»¥ä½¿ç”¨æœ€å°ä¼˜å…ˆé˜Ÿåˆ—æ¥ç»´æŠ¤æ¯ä¸ªæ•°ç»„å½“å‰å…ƒç´ çš„æœ€å°å€¼ã€‚é€šè¿‡è¿™ä¸ªé˜Ÿåˆ—ï¼Œå¯ä»¥å¿«é€Ÿè·å–å½“å‰åŒºé—´çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚

- é¦–å…ˆï¼Œå°†æ¯ä¸ªæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆå³æœ€å°çš„å…ƒç´ ï¼‰æ”¾å…¥ä¼˜å…ˆé˜Ÿåˆ—ä¸­ï¼Œå¹¶è®°å½•å½“å‰çš„æœ€å¤§å…ƒç´ ã€‚
- ç„¶åï¼Œä¸æ–­ä»é˜Ÿåˆ—ä¸­å–å‡ºæœ€å°å…ƒç´ ï¼ŒåŒæ—¶å°†è¿™ä¸ªå…ƒç´ æ‰€åœ¨æ•°ç»„çš„ä¸‹ä¸€ä¸ªå…ƒç´ åŠ å…¥é˜Ÿåˆ—ä¸­ï¼Œå¹¶æ›´æ–°å½“å‰çš„æœ€å¤§å€¼ã€‚
- åœ¨æ¯ä¸€æ­¥ä¸­ï¼Œè®¡ç®—å½“å‰åŒºé—´çš„å¤§å°ï¼Œå¹¶ä¸å½“å‰æœ€ä¼˜åŒºé—´è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœåŒºé—´æ›´å°ï¼Œåˆ™æ›´æ–°æœ€ä¼˜è§£ã€‚

å½“å…¶ä¸­ä¸€ä¸ªæ•°ç»„è¢«éå†å®Œæ—¶ï¼ˆå³å®ƒçš„æ‰€æœ‰å…ƒç´ éƒ½è¢«å¤„ç†å®Œï¼‰ï¼Œå°±æ— æ³•ç»§ç»­æ‰©å±•åŒºé—´äº†ï¼Œæ­¤æ—¶å¾ªç¯ç»“æŸã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n log k)`ï¼Œå…¶ä¸­ `n` æ˜¯æ‰€æœ‰æ•°ç»„çš„å…ƒç´ æ€»æ•°ï¼Œ`k` æ˜¯æ•°ç»„çš„ä¸ªæ•°ã€‚æ¯æ¬¡æ“ä½œéƒ½æ¶‰åŠåˆ°ä»å †ä¸­å–å‡ºæœ€å°å…ƒç´ å¹¶æ’å…¥æ–°å…ƒç´ ï¼Œå †çš„å¤§å°æœ€å¤šä¸º `k`ï¼Œæ‰€ä»¥æ¯æ¬¡æ“ä½œçš„æ—¶é—´å¤æ‚åº¦æ˜¯ `O(log k)`ï¼Œæ¯ä¸ªæ•°ç»„çš„æ‰€æœ‰å…ƒç´ éƒ½ä¼šè¢«å¤„ç†ä¸€æ¬¡ï¼Œå…±å¤„ç† `n` æ¬¡ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(k)`ï¼Œä¼˜å…ˆé˜Ÿåˆ—çš„å¤§å°æœ€å¤šä¸º `k`ã€‚

## ä»£ç 

```javascript
/**
 * @param {number[][]} nums
 * @return {number[]}
 */
var smallestRange = function (nums) {
	let rangeStart = 0,
		rangeEnd = Infinity;
	let maxVal = -Infinity;

	// åˆå§‹åŒ–æœ€å°å †ä¸ºæ¯ä¸ªæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ 
	let minHeap = new MinHeap({ priority: (i) => i[0] });
	for (let i = 0; i < nums.length; i++) {
		minHeap.enqueue([nums[i][0], i, 0]);
		maxVal = Math.max(maxVal, nums[i][0]);
	}

	// å½“å…¶ä¸­ä¸€ä¸ªæ•°ç»„è¢«éå†å®Œæ—¶ï¼Œç»“æŸå¾ªç¯
	while (minHeap.size() == nums.length) {
		// å‡ºå †
		const [minVal, numsIdx, itemIdx] = minHeap.dequeue();
		// æ›´æ–°æœ€ä¼˜è§£
		if (maxVal - minVal < rangeEnd - rangeStart) {
			rangeStart = minVal;
			rangeEnd = maxVal;
		}
		// å¦‚æœæœ‰ä¸‹ä¸€ä¸ªæ•°ï¼Œå…¥å †
		if (itemIdx + 1 < nums[numsIdx].length) {
			const nextVal = nums[numsIdx][itemIdx + 1];
			minHeap.enqueue([nextVal, numsIdx, itemIdx + 1]);
			maxVal = Math.max(maxVal, nextVal);
		}
	}
	return [rangeStart, rangeEnd];
};

// æœ€å°ä¼˜å…ˆé˜Ÿåˆ—
class MinHeap {
	constructor({ priority }) {
		this.heap = [];
		this.priority = priority;
	}

	enqueue(val) {
		this.heap.push(val);
		this.heapifyUp(this.heap.length - 1);
	}
	dequeue() {
		if (this.size() == 0) return null;
		if (this.size() == 1) return this.heap.pop();

		const min = this.heap[0];
		this.heap[0] = this.heap.pop();
		this.heapifyDown(0);
		return min;
	}
	heapifyUp(i) {
		while (i > 0) {
			const parent = ((i - 1) / 2) | 0;
			if (
				this.getPriority(this.heap[i]) < this.getPriority(this.heap[parent])
			) {
				[this.heap[i], this.heap[parent]] = [this.heap[parent], this.heap[i]];
				i = parent;
			} else {
				break;
			}
		}
	}
	heapifyDown(i) {
		const left = i * 2 + 1,
			right = i * 2 + 2;
		let min = i;
		if (
			left < this.size() &&
			this.getPriority(this.heap[min]) > this.getPriority(this.heap[left])
		) {
			min = left;
		}
		if (
			right < this.size() &&
			this.getPriority(this.heap[min]) > this.getPriority(this.heap[right])
		) {
			min = right;
		}
		if (min !== i) {
			[this.heap[i], this.heap[min]] = [this.heap[min], this.heap[i]];
			this.heapifyDown(min);
		}
	}
	getPriority(item) {
		return this.priority(item);
	}
	size() {
		return this.heap.length;
	}
}
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 76 | [æœ€å°è¦†ç›–å­ä¸²](https://leetcode.com/problems/minimum-window-substring) | [[âœ“]](/problem/0076.md) |  [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`å­—ç¬¦ä¸²`](/tag/string.md) [`æ»‘åŠ¨çª—å£`](/tag/sliding-window.md) | <font color=#ff334b>Hard</font> |