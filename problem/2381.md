---
title: 2381. å­—æ¯ç§»ä½ II
description: LeetCode 2381. å­—æ¯ç§»ä½ IIé¢˜è§£ï¼ŒShifting Letters IIï¼ŒåŒ…å«è§£é¢˜æ€è·¯ã€å¤æ‚åº¦åˆ†æä»¥åŠå®Œæ•´çš„ JavaScript ä»£ç å®ç°ã€‚
keywords:
  - LeetCode
  - 2381. å­—æ¯ç§»ä½ II
  - å­—æ¯ç§»ä½ II
  - Shifting Letters II
  - è§£é¢˜æ€è·¯
  - æ•°ç»„
  - å­—ç¬¦ä¸²
  - å‰ç¼€å’Œ
---

# 2381. å­—æ¯ç§»ä½ II

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°ç»„`](/tag/array.md) [`å­—ç¬¦ä¸²`](/tag/string.md) [`å‰ç¼€å’Œ`](/tag/prefix-sum.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/shifting-letters-ii) [`LeetCode`](https://leetcode.com/problems/shifting-letters-ii)

## é¢˜ç›®

You are given a string `s` of lowercase English letters and a 2D integer array
`shifts` where `shifts[i] = [starti, endi, directioni]`. For every `i`,
**shift** the characters in `s` from the index `starti` to the index `endi`
(**inclusive**) forward if `directioni = 1`, or shift the characters backward
if `directioni = 0`.

Shifting a character **forward** means replacing it with the **next** letter
in the alphabet (wrapping around so that `'z'` becomes `'a'`). Similarly,
shifting a character **backward** means replacing it with the **previous**
letter in the alphabet (wrapping around so that `'a'` becomes `'z'`).

Return _the final string after all such shifts to_`s` _are applied_.

**Example 1:**

> Input: s = "abc", shifts = [[0,1,0],[1,2,1],[0,2,1]]
>
> Output: "ace"
>
> Explanation: Firstly, shift the characters from index 0 to index 1 backward. Now s = "zac".
>
> Secondly, shift the characters from index 1 to index 2 forward. Now s = "zbd".
>
> Finally, shift the characters from index 0 to index 2 forward. Now s = "ace".

**Example 2:**

> Input: s = "dztz", shifts = [[0,0,0],[1,1,1]]
>
> Output: "catz"
>
> Explanation: Firstly, shift the characters from index 0 to index 0 backward. Now s = "cztz".
>
> Finally, shift the characters from index 1 to index 1 forward. Now s = "catz".

**Constraints:**

- `1 <= s.length, shifts.length <= 5 * 10^4`
- `shifts[i].length == 3`
- `0 <= starti <= endi < s.length`
- `0 <= directioni <= 1`
- `s` consists of lowercase English letters.

## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªå°å†™è‹±æ–‡å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸² `s` å’Œä¸€ä¸ªäºŒç»´æ•´æ•°æ•°ç»„ `shifts` ï¼Œå…¶ä¸­ `shifts[i] = [starti, endi,
directioni]` ã€‚å¯¹äºæ¯ä¸ª `i` ï¼Œå°† `s` ä¸­ä»ä¸‹æ ‡ `starti` åˆ°ä¸‹æ ‡ `endi` ï¼ˆä¸¤è€…éƒ½åŒ…å«ï¼‰æ‰€æœ‰å­—ç¬¦éƒ½è¿›è¡Œç§»ä½è¿ç®—ï¼Œå¦‚æœ
`directioni = 1` å°†å­—ç¬¦å‘åç§»ä½ï¼Œå¦‚æœ `directioni = 0` å°†å­—ç¬¦å‘å‰ç§»ä½ã€‚

å°†ä¸€ä¸ªå­—ç¬¦ **å‘å** ç§»ä½çš„æ„æ€æ˜¯å°†è¿™ä¸ªå­—ç¬¦ç”¨å­—æ¯è¡¨ä¸­ **ä¸‹ä¸€ä¸ª** å­—æ¯æ›¿æ¢ï¼ˆå­—æ¯è¡¨è§†ä¸ºç¯ç»•çš„ï¼Œæ‰€ä»¥ `'z'` å˜æˆ
`'a'`ï¼‰ã€‚ç±»ä¼¼çš„ï¼Œå°†ä¸€ä¸ªå­—ç¬¦ **å‘å‰** ç§»ä½çš„æ„æ€æ˜¯å°†è¿™ä¸ªå­—ç¬¦ç”¨å­—æ¯è¡¨ä¸­ **å‰ä¸€ä¸ª** å­—æ¯æ›¿æ¢ï¼ˆå­—æ¯è¡¨æ˜¯ç¯ç»•çš„ï¼Œæ‰€ä»¥ `'a'` å˜æˆ
`'z'` ï¼‰ã€‚

è¯·ä½ è¿”å›å¯¹ `s` è¿›è¡Œæ‰€æœ‰ç§»ä½æ“ä½œä»¥åå¾—åˆ°çš„æœ€ç»ˆå­—ç¬¦ä¸²ã€‚

**ç¤ºä¾‹ 1ï¼š**

> **è¾“å…¥ï¼š** s = "abc", shifts = [[0,1,0],[1,2,1],[0,2,1]]
>
> **è¾“å‡ºï¼š** "ace"
>
> **è§£é‡Šï¼š** é¦–å…ˆï¼Œå°†ä¸‹æ ‡ä» 0 åˆ° 1 çš„å­—æ¯å‘å‰ç§»ä½ï¼Œå¾—åˆ° s = "zac" ã€‚
>
> ç„¶åï¼Œå°†ä¸‹æ ‡ä» 1 åˆ° 2 çš„å­—æ¯å‘åç§»ä½ï¼Œå¾—åˆ° s = "zbd" ã€‚
>
> æœ€åï¼Œå°†ä¸‹æ ‡ä» 0 åˆ° 2 çš„å­—ç¬¦å‘åç§»ä½ï¼Œå¾—åˆ° s = "ace" ã€‚

**ç¤ºä¾‹ 2:**

> **è¾“å…¥ï¼š** s = "dztz", shifts = [[0,0,0],[1,1,1]]
>
> **è¾“å‡ºï¼š** "catz"
>
> **è§£é‡Šï¼š** é¦–å…ˆï¼Œå°†ä¸‹æ ‡ä» 0 åˆ° 0 çš„å­—æ¯å‘å‰ç§»ä½ï¼Œå¾—åˆ° s = "cztz" ã€‚
>
> æœ€åï¼Œå°†ä¸‹æ ‡ä» 1 åˆ° 1 çš„å­—ç¬¦å‘åç§»ä½ï¼Œå¾—åˆ° s = "catz" ã€‚

**æç¤ºï¼š**

- `1 <= s.length, shifts.length <= 5 * 10^4`
- `shifts[i].length == 3`
- `0 <= starti <= endi < s.length`
- `0 <= directioni <= 1`
- `s` åªåŒ…å«å°å†™è‹±æ–‡å­—æ¯ã€‚

## è§£é¢˜æ€è·¯

ä¸ºäº†é«˜æ•ˆå¤„ç†å¤šæ¬¡åŒºé—´æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ **å·®åˆ†æ•°ç»„** æ¥è®°å½•æ¯ä¸ªä½ç½®çš„ç´¯ç§¯åç§»é‡ã€‚

1. **æ„å»ºå·®åˆ†æ•°ç»„**ï¼š

   - åˆ›å»ºä¸€ä¸ªä¸å­—ç¬¦ä¸² `s` é•¿åº¦ç›¸åŒçš„å·®åˆ†æ•°ç»„ `diffArr`ã€‚
   - å¯¹äºæ¯æ¬¡ä½ç§»æ“ä½œ `[start, end, direction]`ï¼š
     - å¦‚æœæ˜¯å³ç§»ï¼ˆ`direction = 1`ï¼‰ï¼Œåˆ™ï¼š
       - `diffArr[start] += 1`
       - å¦‚æœ `end + 1` åœ¨èŒƒå›´å†…ï¼Œåˆ™ `diffArr[end + 1] -= 1`
     - å¦‚æœæ˜¯å·¦ç§»ï¼ˆ`direction = 0`ï¼‰ï¼Œåˆ™ï¼š
       - `diffArr[start] -= 1`
       - å¦‚æœ `end + 1` åœ¨èŒƒå›´å†…ï¼Œåˆ™ `diffArr[end + 1] += 1`

2. **è®¡ç®—ç´¯ç§¯åç§»é‡**ï¼š

   - ä½¿ç”¨å‰ç¼€å’Œå°†å·®åˆ†æ•°ç»„è½¬åŒ–ä¸ºç´¯ç§¯åç§»é‡æ•°ç»„ `diff`ã€‚

3. **åº”ç”¨åç§»é‡å¹¶ç”Ÿæˆç»“æœå­—ç¬¦ä¸²**ï¼š

   - éå†å­—ç¬¦ä¸² `s`ï¼Œè®¡ç®—æ¯ä¸ªå­—ç¬¦çš„æœ€ç»ˆä½ç½®ï¼š
     - å°†ç´¯ç§¯åç§»é‡åŠ åˆ°å½“å‰å­—ç¬¦çš„ ASCII å€¼ä¸Šï¼Œå¹¶è¿›è¡Œæ¨¡ `26` è¿ç®—ä»¥ç¡®ä¿å¾ªç¯åœ¨ `'a'` åˆ° `'z'` èŒƒå›´å†…ã€‚

4. **è¿”å›ç»“æœå­—ç¬¦ä¸²**ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n + m)`
  - æ„å»ºå·®åˆ†æ•°ç»„ï¼š`O(m)`ï¼Œå…¶ä¸­ `m` æ˜¯ä½ç§»æ“ä½œçš„ä¸ªæ•°ã€‚
  - è®¡ç®—ç´¯ç§¯åç§»é‡ï¼š`O(n)`ï¼Œå…¶ä¸­ `n` æ˜¯å­—ç¬¦ä¸²é•¿åº¦ã€‚
  - åº”ç”¨åç§»é‡ï¼š`O(n)`ã€‚
  - æ€»å¤æ‚åº¦ï¼š`O(n + m)`ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œå­˜å‚¨å·®åˆ†æ•°ç»„å’Œç»“æœæ•°ç»„ã€‚

## ä»£ç 

```javascript
/**
 * @param {string} s
 * @param {number[][]} shifts
 * @return {string}
 */
var shiftingLetters = function (s, shifts) {
	const n = s.length;
	const diffArr = new Array(n).fill(0);

	// æ„å»ºå·®åˆ†æ•°ç»„
	for (let [start, end, direction] of shifts) {
		if (direction === 1) {
			diffArr[start]++;
			if (end + 1 < n) diffArr[end + 1]--;
		} else {
			diffArr[start]--;
			if (end + 1 < n) diffArr[end + 1]++;
		}
	}

	// è®¡ç®—ç´¯ç§¯åç§»é‡å¹¶ç”Ÿæˆç»“æœå­—ç¬¦ä¸²
	let diff = 0;
	let res = [];
	for (let i = 0; i < n; i++) {
		diff = (diff + diffArr[i]) % 26;
		if (diff < 0) diff += 26; // å¤„ç†è´Ÿåç§»
		res.push(String.fromCharCode(97 + ((s.charCodeAt(i) - 97 + diff) % 26)));
	}

	return res.join('');
};
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ | åŠ›æ‰£ |
| :------: | :------ | :------: | :------ | :------: | :------: |
| 218 | å¤©é™…çº¿é—®é¢˜ |  |  [`æ ‘çŠ¶æ•°ç»„`](/tag/binary-indexed-tree.md) [`çº¿æ®µæ ‘`](/tag/segment-tree.md) [`æ•°ç»„`](/tag/array.md) `4+` | ğŸ”´ | [ğŸ€„ï¸](https://leetcode.cn/problems/the-skyline-problem) [ğŸ”—](https://leetcode.com/problems/the-skyline-problem) |
| 307 | åŒºåŸŸå’Œæ£€ç´¢ - æ•°ç»„å¯ä¿®æ”¹ | [[âœ“]](/problem/0307.md) |  [`è®¾è®¡`](/tag/design.md) [`æ ‘çŠ¶æ•°ç»„`](/tag/binary-indexed-tree.md) [`çº¿æ®µæ ‘`](/tag/segment-tree.md) `1+` | ğŸŸ  | [ğŸ€„ï¸](https://leetcode.cn/problems/range-sum-query-mutable) [ğŸ”—](https://leetcode.com/problems/range-sum-query-mutable) |
| 370 | åŒºé—´åŠ æ³• ğŸ”’ |  |  [`æ•°ç»„`](/tag/array.md) [`å‰ç¼€å’Œ`](/tag/prefix-sum.md) | ğŸŸ  | [ğŸ€„ï¸](https://leetcode.cn/problems/range-addition) [ğŸ”—](https://leetcode.com/problems/range-addition) |
| 848 | å­—æ¯ç§»ä½ |  |  [`æ•°ç»„`](/tag/array.md) [`å­—ç¬¦ä¸²`](/tag/string.md) [`å‰ç¼€å’Œ`](/tag/prefix-sum.md) | ğŸŸ  | [ğŸ€„ï¸](https://leetcode.cn/problems/shifting-letters) [ğŸ”—](https://leetcode.com/problems/shifting-letters) |
| 1854 | äººå£æœ€å¤šçš„å¹´ä»½ | [[âœ“]](/problem/1854.md) |  [`æ•°ç»„`](/tag/array.md) [`è®¡æ•°`](/tag/counting.md) [`å‰ç¼€å’Œ`](/tag/prefix-sum.md) | ğŸŸ¢ | [ğŸ€„ï¸](https://leetcode.cn/problems/maximum-population-year) [ğŸ”—](https://leetcode.com/problems/maximum-population-year) |
| 1943 | æè¿°ç»˜ç”»ç»“æœ |  |  [`æ•°ç»„`](/tag/array.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`å‰ç¼€å’Œ`](/tag/prefix-sum.md) `1+` | ğŸŸ  | [ğŸ€„ï¸](https://leetcode.cn/problems/describe-the-painting) [ğŸ”—](https://leetcode.com/problems/describe-the-painting) |