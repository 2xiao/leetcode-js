# [222. å®Œå…¨äºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°](https://leetcode.com/problems/count-complete-tree-nodes)

ğŸŸ¢ <font color=#15bd66>Easy</font>&emsp; ğŸ”–&ensp; [`ä½è¿ç®—`](/tag/bit-manipulation.md) [`æ ‘`](/tag/tree.md) [`äºŒåˆ†æŸ¥æ‰¾`](/tag/binary-search.md) [`äºŒå‰æ ‘`](/tag/binary-tree.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/count-complete-tree-nodes)

## é¢˜ç›®

<p>ç»™ä½ ä¸€æ£µ<strong> å®Œå…¨äºŒå‰æ ‘</strong> çš„æ ¹èŠ‚ç‚¹ <code>root</code> ï¼Œæ±‚å‡ºè¯¥æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°ã€‚</p>

<p><a href="https://baike.baidu.com/item/%E5%AE%8C%E5%85%A8%E4%BA%8C%E5%8F%89%E6%A0%91/7773232?fr=aladdin">å®Œå…¨äºŒå‰æ ‘</a> çš„å®šä¹‰å¦‚ä¸‹ï¼šåœ¨å®Œå…¨äºŒå‰æ ‘ä¸­ï¼Œé™¤äº†æœ€åº•å±‚èŠ‚ç‚¹å¯èƒ½æ²¡å¡«æ»¡å¤–ï¼Œå…¶ä½™æ¯å±‚èŠ‚ç‚¹æ•°éƒ½è¾¾åˆ°æœ€å¤§å€¼ï¼Œå¹¶ä¸”æœ€ä¸‹é¢ä¸€å±‚çš„èŠ‚ç‚¹éƒ½é›†ä¸­åœ¨è¯¥å±‚æœ€å·¦è¾¹çš„è‹¥å¹²ä½ç½®ã€‚è‹¥æœ€åº•å±‚ä¸ºç¬¬ <code>h</code> å±‚ï¼Œåˆ™è¯¥å±‚åŒ…å« <code>1~Â 2<sup>h</sup></code>Â ä¸ªèŠ‚ç‚¹ã€‚</p>

<p>Â </p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<img alt="" src="https://assets.leetcode.com/uploads/2021/01/14/complete.jpg" style="width: 372px; height: 302px;" />
<pre>
<strong>è¾“å…¥ï¼š</strong>root = [1,2,3,4,5,6]
<strong>è¾“å‡ºï¼š</strong>6
</pre>

<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>root = []
<strong>è¾“å‡ºï¼š</strong>0
</pre>

<p><strong>ç¤ºä¾‹ 3ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>root = [1]
<strong>è¾“å‡ºï¼š</strong>1
</pre>

<p>Â </p>

<p><strong>æç¤ºï¼š</strong></p>

<ul>
	<li>æ ‘ä¸­èŠ‚ç‚¹çš„æ•°ç›®èŒƒå›´æ˜¯<code>[0, 5 * 10<sup>4</sup>]</code></li>
	<li><code>0 &lt;= Node.val &lt;= 5 * 10<sup>4</sup></code></li>
	<li>é¢˜ç›®æ•°æ®ä¿è¯è¾“å…¥çš„æ ‘æ˜¯ <strong>å®Œå…¨äºŒå‰æ ‘</strong></li>
</ul>

<p>Â </p>

<p><strong>è¿›é˜¶ï¼š</strong>éå†æ ‘æ¥ç»Ÿè®¡èŠ‚ç‚¹æ˜¯ä¸€ç§æ—¶é—´å¤æ‚åº¦ä¸º <code>O(n)</code> çš„ç®€å•è§£å†³æ–¹æ¡ˆã€‚ä½ å¯ä»¥è®¾è®¡ä¸€ä¸ªæ›´å¿«çš„ç®—æ³•å—ï¼Ÿ</p>


## è§£é¢˜æ€è·¯

### æ€è·¯ä¸€ï¼šå±‚åºéå†

æŒ‰ç…§å±‚åºéå†ä¸€æ¬¡æ ‘ï¼Œç„¶åæŠŠæ¯ä¸€å±‚çš„ç»“ç‚¹ä¸ªæ•°ç›¸åŠ å³å¯ã€‚

---

### æ€è·¯äºŒï¼šé€’å½’

å…³é”®æ€æƒ³æ˜¯æ¯”è¾ƒå·¦å³å­æ ‘çš„æ·±åº¦ã€‚å¦‚æœå®ƒä»¬ç›¸ç­‰ï¼Œå·¦å­æ ‘æ˜¯ä¸€ä¸ªæ»¡äºŒå‰æ ‘ï¼ŒèŠ‚ç‚¹æ€»æ•°å¯ä»¥ç›´æ¥è®¡ç®— (`2 ^ i - 1`)ã€‚å¦‚æœæ·±åº¦ä¸ç›¸ç­‰ï¼Œå³å­æ ‘æ˜¯ä¸€ä¸ªæ»¡äºŒå‰æ ‘ï¼ŒèŠ‚ç‚¹æ€»æ•°ä¹Ÿå¯ä»¥æ ¹æ®æ·±åº¦è®¡ç®—ã€‚é€’å½’è°ƒç”¨å¤„ç†ä¸¤ä¸ªå­æ ‘ï¼Œç›´åˆ°è¾¾åˆ°åŸºæœ¬æƒ…å†µï¼ˆä¸€ä¸ªç©ºèŠ‚ç‚¹ï¼‰ã€‚

- `countNodes` å‡½æ•°ä»¥å®Œå…¨äºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ä½œä¸ºè¾“å…¥ï¼Œé€’å½’è®¡ç®—èŠ‚ç‚¹çš„æ•°é‡ã€‚
- `getDepth` å‡½æ•°é€šè¿‡éå†å·¦å­©å­ç›´åˆ°å¶å­èŠ‚ç‚¹ï¼Œè®¡ç®—ç»™å®šèŠ‚ç‚¹çš„æ·±åº¦ã€‚

## ä»£ç 

::: code-tabs

@tab å±‚åºéå†

```javascript
/**
 * @param {TreeNode} root
 * @return {number}
 */
var countNodes = function (root) {
	let res = 0;
	if (!root) return res;
	let queue = [root];
	while (queue.length) {
		let len = queue.length;
		for (let i = 0; i < len; i++) {
			if (queue[i].left) queue.push(queue[i].left);
			if (queue[i].right) queue.push(queue[i].right);
			res++;
		}
		queue = queue.slice(len);
	}
	return res;
};
```

@tab é€’å½’

```javascript
/**
 * @param {TreeNode} root
 * @return {number}
 */
var countNodes = function (root) {
	if (!root) return 0;

	const getDepth = (node) => {
		let depth = 0;
		while (node) {
			node = node.left;
			depth++;
		}
		return depth;
	};

	let leftDepth = getDepth(root.left);
	let rightDepth = getDepth(root.right);

	if (leftDepth == rightDepth)
		return Math.pow(2, leftDepth) + countNodes(root.right);
	return Math.pow(2, rightDepth) + countNodes(root.left);
};
```

:::

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 270 | [æœ€æ¥è¿‘çš„äºŒå‰æœç´¢æ ‘å€¼](https://leetcode.com/problems/closest-binary-search-tree-value) |  |  [`æ ‘`](/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/tag/depth-first-search.md) [`äºŒå‰æœç´¢æ ‘`](/tag/binary-search-tree.md) `2+` | <font color=#15bd66>Easy</font> |