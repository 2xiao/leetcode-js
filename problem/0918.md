# [918. ç¯å½¢å­æ•°ç»„çš„æœ€å¤§å’Œ](https://leetcode.com/problems/maximum-sum-circular-subarray)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`é˜Ÿåˆ—`](/tag/queue.md) [`æ•°ç»„`](/tag/array.md) [`åˆ†æ²»`](/tag/divide-and-conquer.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md) [`å•è°ƒé˜Ÿåˆ—`](/tag/monotonic-queue.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/maximum-sum-circular-subarray)

## é¢˜ç›®

<p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º <code>n</code> çš„<strong>ç¯å½¢æ•´æ•°æ•°ç»„</strong>&nbsp;<code>nums</code>&nbsp;ï¼Œè¿”å›<em>&nbsp;<code>nums</code>&nbsp;çš„éç©º <strong>å­æ•°ç»„</strong> çš„æœ€å¤§å¯èƒ½å’Œ&nbsp;</em>ã€‚</p>

<p><strong>ç¯å½¢æ•°ç»„</strong><em>&nbsp;</em>æ„å‘³ç€æ•°ç»„çš„æœ«ç«¯å°†ä¼šä¸å¼€å¤´ç›¸è¿å‘ˆç¯çŠ¶ã€‚å½¢å¼ä¸Šï¼Œ <code>nums[i]</code> çš„ä¸‹ä¸€ä¸ªå…ƒç´ æ˜¯ <code>nums[(i + 1) % n]</code> ï¼Œ <code>nums[i]</code>&nbsp;çš„å‰ä¸€ä¸ªå…ƒç´ æ˜¯ <code>nums[(i - 1 + n) % n]</code> ã€‚</p>

<p><strong>å­æ•°ç»„</strong> æœ€å¤šåªèƒ½åŒ…å«å›ºå®šç¼“å†²åŒº&nbsp;<code>nums</code>&nbsp;ä¸­çš„æ¯ä¸ªå…ƒç´ ä¸€æ¬¡ã€‚å½¢å¼ä¸Šï¼Œå¯¹äºå­æ•°ç»„&nbsp;<code>nums[i], nums[i + 1], ..., nums[j]</code>&nbsp;ï¼Œä¸å­˜åœ¨&nbsp;<code>i &lt;= k1, k2 &lt;= j</code>&nbsp;å…¶ä¸­&nbsp;<code>k1 % n == k2 % n</code>&nbsp;ã€‚</p>

<p>&nbsp;</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>nums = [1,-2,3,-2]
<strong>è¾“å‡ºï¼š</strong>3
<strong>è§£é‡Šï¼š</strong>ä»å­æ•°ç»„ [3] å¾—åˆ°æœ€å¤§å’Œ 3
</pre>

<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>nums = [5,-3,5]
<strong>è¾“å‡ºï¼š</strong>10
<strong>è§£é‡Šï¼š</strong>ä»å­æ•°ç»„ [5,5] å¾—åˆ°æœ€å¤§å’Œ 5 + 5 = 10
</pre>

<p><strong>ç¤ºä¾‹ 3ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>nums = [3,-2,2,-3]
<strong>è¾“å‡ºï¼š</strong>3
<strong>è§£é‡Šï¼š</strong>ä»å­æ•°ç»„ [3] å’Œ [3,-2,2] éƒ½å¯ä»¥å¾—åˆ°æœ€å¤§å’Œ 3
</pre>

<p>&nbsp;</p>

<p><strong>æç¤ºï¼š</strong></p>

<ul>
	<li><code>n == nums.length</code></li>
	<li><code>1 &lt;= n &lt;= 3 * 10<sup>4</sup></code></li>
	<li><code>-3 * 10<sup>4</sup>&nbsp;&lt;= nums[i] &lt;= 3 * 10<sup>4</sup></code>â€‹â€‹â€‹â€‹â€‹â€‹â€‹</li>
</ul>


## è§£é¢˜æ€è·¯

è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥è€ƒè™‘ä¸¤ç§æƒ…å†µï¼š

- **æ™®é€šå­æ•°ç»„**ï¼šå¯ä»¥ç›´æ¥ä½¿ç”¨ç»å…¸çš„ **Kadaneâ€™s Algorithm** æ¥æ‰¾åˆ°éå¾ªç¯çš„æœ€å¤§å­æ•°ç»„å’Œã€‚
- **è·¨è¶Šé¦–å°¾çš„å­æ•°ç»„**ï¼šè¿™ä¸ªå­æ•°ç»„å¯ä»¥è¢«ç†è§£ä¸ºï¼Œæ€»å’Œå‡å»ä¸€ä¸ªæœ€å°çš„å­æ•°ç»„å’Œï¼ˆå³ï¼Œæ‰¾åˆ°æ•´ä¸ªæ•°ç»„çš„å’Œï¼Œå†å‡å»ä¸­é—´çš„ä¸€ä¸ªå­æ•°ç»„ï¼Œä¿ç•™æ•°ç»„ä¸¤ç«¯éƒ¨åˆ†ä½œä¸ºæœ€å¤§å­æ•°ç»„å’Œï¼‰ã€‚è¦å®ç°è¿™ä¸€ç‚¹ï¼Œéœ€è¦æ±‚å‡ºæœ€å°å­æ•°ç»„å’Œã€‚

å› æ­¤ï¼Œè§£é¢˜åˆ†ä¸ºä¸‰æ­¥ï¼š

1. **è®¡ç®—éå¾ªç¯å­æ•°ç»„çš„æœ€å¤§å’Œ**ï¼šä½¿ç”¨ Kadane's ç®—æ³•æ¥æ‰¾åˆ°å­æ•°ç»„çš„æœ€å¤§å’Œ `maxSum`.
2. **è®¡ç®—æœ€å°å­æ•°ç»„å’Œ**ï¼šä½¿ç”¨ Kadane's ç®—æ³•çš„å˜ç§ï¼Œæ‰¾å‡ºå­æ•°ç»„çš„æœ€å°å’Œ `minSum`ï¼Œç„¶åç”¨æ•´ä¸ªæ•°ç»„çš„å’Œ `totalSum` å‡å»è¯¥æœ€å°å’Œã€‚è¿™æ ·å¾—åˆ°è·¨è¶Šé¦–å°¾çš„å­æ•°ç»„å’Œ `totalSum - minSum`ã€‚
3. **è€ƒè™‘ç‰¹æ®Šæƒ…å†µ**ï¼šå½“æ‰€æœ‰å…ƒç´ éƒ½æ˜¯è´Ÿæ•°æ—¶ï¼Œè·¨è¶Šé¦–å°¾çš„å­æ•°ç»„å’Œå¯èƒ½ä¼šæ— æ•ˆï¼Œå› ä¸ºæ•´ä¸ªæ•°ç»„çš„å’Œ `totalSum` ä¼šç­‰äº `minSum`ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿”å› `maxSum` å³å¯ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œå› ä¸ºåªéå†æ•°ç»„ä¸‰æ¬¡ï¼ˆåˆ†åˆ«æ±‚æœ€å¤§å­æ•°ç»„å’Œã€æœ€å°å­æ•°ç»„å’Œï¼Œä»¥åŠæ€»å’Œï¼‰ï¼Œæ¯æ¬¡éå†éœ€è¦ `O(n)` æ—¶é—´ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(1)`ï¼Œå› ä¸ºåªä½¿ç”¨äº†å¸¸æ•°ç©ºé—´æ¥å­˜å‚¨è‹¥å¹²å˜é‡ï¼Œä¸éœ€è¦é¢å¤–çš„æ•°ç»„æˆ–å…¶ä»–æ•°æ®ç»“æ„ã€‚

## ä»£ç 

```javascript
/**
 * @param {number[]} nums
 * @return {number}
 */
var maxSubarraySumCircular = function (nums) {
	const totalSum = nums.reduce((a, b) => a + b, 0);

	const getMaxSum = () => {
		let max = nums[0],
			maxEndingHere = nums[0];
		for (let i = 1; i < nums.length; i++) {
			maxEndingHere = Math.max(nums[i], maxEndingHere + nums[i]);
			max = Math.max(maxEndingHere, max);
		}
		return max;
	};

	const getMinSum = () => {
		let min = nums[0],
			minEndingHere = nums[0];
		for (let i = 1; i < nums.length; i++) {
			minEndingHere = Math.min(nums[i], minEndingHere + nums[i]);
			min = Math.min(minEndingHere, min);
		}
		return min;
	};

	const maxSum = getMaxSum();
	const minSum = getMinSum();

	if (maxSum < 0) return maxSum;
	return Math.max(maxSum, totalSum - minSum);
};
```
