---
title: 1873. è®¡ç®—ç‰¹æ®Šå¥–é‡‘
description: LeetCode 1873. è®¡ç®—ç‰¹æ®Šå¥–é‡‘é¢˜è§£ï¼ŒCalculate Special Bonusï¼ŒåŒ…å«è§£é¢˜æ€è·¯ã€å¤æ‚åº¦åˆ†æä»¥åŠå®Œæ•´çš„ JavaScript ä»£ç å®ç°ã€‚
keywords:
  - LeetCode
  - 1873. è®¡ç®—ç‰¹æ®Šå¥–é‡‘
  - è®¡ç®—ç‰¹æ®Šå¥–é‡‘
  - Calculate Special Bonus
  - è§£é¢˜æ€è·¯
  - æ•°æ®åº“
---

# 1873. è®¡ç®—ç‰¹æ®Šå¥–é‡‘

ğŸŸ¢ <font color=#15bd66>Easy</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/calculate-special-bonus) [`LeetCode`](https://leetcode.com/problems/calculate-special-bonus)

## é¢˜ç›®

Table: `Employees`

> ```
> +-------------+---------+
> | Column Name | Type    |
> +-------------+---------+
> | employee_id | int     |
> | name        | varchar |
> | salary      | int     |
> +-------------+---------+
> ```
>
> employee_id is the primary key (column with unique values) for this table.
>
> Each row of this table indicates the employee ID, employee name, and salary.

Write a solution to calculate the bonus of each employee. The bonus of an
employee is `100%` of their salary if the ID of the employee is **an odd
number** and **the employee 's name does not start with the character **`'M'`.
The bonus of an employee is `0` otherwise.

Return the result table ordered by `employee_id`.

The result format is in the following example.

**Example 1:**

> Input:
>
> Employees table:
>
> ```
> +-------------+---------+--------+
> | employee_id | name    | salary |
> +-------------+---------+--------+
> | 2           | Meir    | 3000   |
> | 3           | Michael | 3800   |
> | 7           | Addilyn | 7400   |
> | 8           | Juan    | 6100   |
> | 9           | Kannon  | 7700   |
> +-------------+---------+--------+
> ```
>
> Output:
>
> ```
> +-------------+-------+
> | employee_id | bonus |
> +-------------+-------+
> | 2           | 0     |
> | 3           | 0     |
> | 7           | 7400  |
> | 8           | 0     |
> | 9           | 7700  |
> +-------------+-------+
> ```
>
> Explanation:
>
> The employees with IDs 2 and 8 get 0 bonus because they have an even employee_id.
>
> The employee with ID 3 gets 0 bonus because their name starts with 'M'.
>
> The rest of the employees get a 100% bonus.

## é¢˜ç›®å¤§æ„

è¡¨: `Employees`

> ```
> +-------------+---------+
> | Column Name | Type    |
> +-------------+---------+
> | employee_id | int     |
> | name        | varchar |
> | salary      | int     |
> +-------------+---------+
> ```
>
> employee_id æ˜¯è¿™ä¸ªè¡¨çš„ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚
>
> æ­¤è¡¨çš„æ¯ä¸€è¡Œç»™å‡ºäº†é›‡å‘˜ id ï¼Œåå­—å’Œè–ªæ°´ã€‚

ç¼–å†™è§£å†³æ–¹æ¡ˆï¼Œè®¡ç®—æ¯ä¸ªé›‡å‘˜çš„å¥–é‡‘ã€‚å¦‚æœä¸€ä¸ªé›‡å‘˜çš„ id æ˜¯ **å¥‡æ•°** å¹¶ä¸”ä»–çš„åå­—ä¸æ˜¯ä»¥ `'M'` **å¼€å¤´** ï¼Œé‚£ä¹ˆä»–çš„å¥–é‡‘æ˜¯ä»–å·¥èµ„çš„
`100%` ï¼Œå¦åˆ™å¥–é‡‘ä¸º `0` ã€‚

è¿”å›çš„ç»“æœæŒ‰ç…§ `employee_id` æ’åºã€‚

è¿”å›ç»“æœæ ¼å¼å¦‚ä¸‹é¢çš„ä¾‹å­æ‰€ç¤ºã€‚

**ç¤ºä¾‹ 1:**

> **è¾“å…¥ï¼š**
>
> Employees è¡¨:
>
> ```
> +-------------+---------+--------+
> | employee_id | name    | salary |
> +-------------+---------+--------+
> | 2           | Meir    | 3000   |
> | 3           | Michael | 3800   |
> | 7           | Addilyn | 7400   |
> | 8           | Juan    | 6100   |
> | 9           | Kannon  | 7700   |
> +-------------+---------+--------+
> ```
>
> **è¾“å‡ºï¼š**
>
> ```
> +-------------+-------+
> | employee_id | bonus |
> +-------------+-------+
> | 2           | 0     |
> | 3           | 0     |
> | 7           | 7400  |
> | 8           | 0     |
> | 9           | 7700  |
> +-------------+-------+
> ```
>
> **è§£é‡Šï¼š**
>
> å› ä¸ºé›‡å‘˜ id æ˜¯å¶æ•°ï¼Œæ‰€ä»¥é›‡å‘˜ id æ˜¯ 2 å’Œ 8 çš„ä¸¤ä¸ªé›‡å‘˜å¾—åˆ°çš„å¥–é‡‘æ˜¯ 0ã€‚
>
> é›‡å‘˜ id ä¸º 3 çš„å› ä¸ºä»–çš„åå­—ä»¥'M'å¼€å¤´ï¼Œæ‰€ä»¥ï¼Œå¥–é‡‘æ˜¯ 0ã€‚
>
> å…¶ä»–çš„é›‡å‘˜å¾—åˆ°äº†ç™¾åˆ†ä¹‹ç™¾çš„å¥–é‡‘ã€‚

## è§£é¢˜æ€è·¯

### MySQL

1. **è¿”å›å­—æ®µ**ï¼š  
   ä½¿ç”¨ `SELECT` æŒ‡å®šè¿”å›å­—æ®µï¼š

   - `employee_id`ï¼šé›‡å‘˜ IDã€‚
   - è®¡ç®—å¥–é‡‘å¹¶å‘½åä¸º `bonus`ã€‚

2. **å¥–é‡‘è®¡ç®—é€»è¾‘**ï¼š  
   ä½¿ç”¨ `CASE` è¡¨è¾¾å¼è®¡ç®—å¥–é‡‘ï¼š

   - å¦‚æœé›‡å‘˜ ID æ˜¯å¥‡æ•° (`employee_id % 2 = 1`) ä¸”åå­—ä¸æ˜¯ä»¥ `'M'` å¼€å¤´ (`name NOT LIKE 'M%'`)ï¼Œåˆ™å¥–é‡‘ç­‰äºå·¥èµ„ï¼ˆ`salary`ï¼‰ã€‚
   - å¦åˆ™å¥–é‡‘ä¸º `0`ã€‚

3. **æ’åºè¦æ±‚**ï¼š  
   æŒ‰ `employee_id` è¿›è¡Œå‡åºæ’åºã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œå‡è®¾è¡¨ä¸­æœ‰ `n` æ¡è®°å½•ï¼Œéœ€è¦å¯¹æ‰€æœ‰è®°å½•åº”ç”¨æ¡ä»¶ç­›é€‰å’Œå¥–é‡‘è®¡ç®—ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼šSQL æŸ¥è¯¢æœ¬èº«ä¸å ç”¨é¢å¤–ç©ºé—´ï¼Œè¿”å›çš„ç»“æœå ç”¨çš„ç©ºé—´ä¸è®°å½•æ•°æˆæ­£æ¯”ã€‚

---

### Pandas

1. **åŠ è½½æ•°æ®**ï¼š  
   å°† `Employees` è¡¨åŠ è½½åˆ° Pandas çš„ `DataFrame` ä¸­ã€‚

2. **å¥–é‡‘è®¡ç®—é€»è¾‘**ï¼š  
   ä½¿ç”¨ Pandas çš„å¸ƒå°”ç´¢å¼•å’Œæ¡ä»¶åˆ¤æ–­ï¼š

   - å¦‚æœ `employee_id` æ˜¯å¥‡æ•°ä¸” `name` åˆ—çš„å€¼ä¸ä»¥ `'M'` å¼€å¤´ï¼Œåˆ™å¥–é‡‘ç­‰äºå¯¹åº”çš„ `salary` å€¼ã€‚
   - å¦åˆ™å¥–é‡‘ä¸º `0`ã€‚

3. **ç»“æœé€‰æ‹©ä¸æ’åº**ï¼š  
   è¿”å›ç»“æœåŒ…å« `employee_id` å’Œè®¡ç®—åçš„ `bonus`ï¼ŒæŒ‰ `employee_id` å‡åºæ’åˆ—ã€‚

## ä»£ç 

::: code-tabs
@tab MySQL

```sql
SELECT employee_id,
       CASE
           WHEN employee_id % 2 = 1 AND name NOT LIKE 'M%' THEN salary
           ELSE 0
       END AS bonus
FROM Employees
ORDER BY employee_id;
```

@tab Pandas

```python
import pandas as pd

def calculate_bonus(employees: pd.DataFrame) -> pd.DataFrame:
    # æ¡ä»¶åˆ¤æ–­ï¼šè®¡ç®—å¥–é‡‘
    employees['bonus'] = employees.apply(
        lambda row: row['salary'] if row['employee_id'] % 2 == 1 and not row['name'].startswith('M') else 0, axis=1
    )
    # è¿”å›ç»“æœå¹¶æŒ‰ employee_id æ’åº
    return employees[['employee_id', 'bonus']].sort_values(by='employee_id')
```

:::
