---
title: 2823. æ·±åº¦å¯¹è±¡ç­›é€‰ ğŸ”’
description: LeetCode,2823. æ·±åº¦å¯¹è±¡ç­›é€‰ ğŸ”’,æ·±åº¦å¯¹è±¡ç­›é€‰,Deep Object Filter,è§£é¢˜æ€è·¯
keywords:
  - LeetCode
  - 2823. æ·±åº¦å¯¹è±¡ç­›é€‰ ğŸ”’
  - æ·±åº¦å¯¹è±¡ç­›é€‰
  - Deep Object Filter
  - è§£é¢˜æ€è·¯
---

# 2823. æ·±åº¦å¯¹è±¡ç­›é€‰ ğŸ”’

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/deep-object-filter) [`LeetCode`](https://leetcode.com/problems/deep-object-filter)

## é¢˜ç›®

Given an object or an array `obj` and a function `fn`, return a filtered
object or array `filteredObject`.

Function `deepFilter` should perform a deep filter operation on the `obj`. The
deep filter operation should remove properties for which the output of the
filter function `fn` is `false`, as well as any empty objects or arrays that
remain after the keys have been removed.

If the deep filter operation results in an empty object or array, with no
remaining properties, `deepFilter` should return `undefined` to indicate that
there is no valid data left in the `filteredObject`.

**Example 1:**

> Input:
>
> ```
> obj = [-5, -4, -3, -2, -1, 0, 1],
>
> fn = (x) => x > 0
> ```
>
> Output: [1]
>
> Explanation: All values that were not greater than 0 were removed.

**Example 2:**

> Input:
>
> ```
> obj = {"a": 1, "b": "2", "c": 3, "d": "4", "e": 5, "f": 6, "g": {"a": 1}},
>
> fn = (x) => typeof x === "string"
> ```
>
> Output: {"b":"2","d":"4"}
>
> Explanation: All keys with values that were not a string were removed. When the object keys were removed during the filtering process, any resulting empty objects were also removed.

**Example 3:**

> Input:
>
> ```
> obj = [-1, [-1, -1, 5, -1, 10], -1, [-1], [-5]],
>
> fn = (x) => x > 0
> ```
>
> Output: [[5,10]]
>
> Explanation: All values that were not greater than 0 were removed. When the values were removed during the filtering process, any resulting empty arrays were also removed.

**Example 4:**

> Input:
>
> ```
> obj = [[[[5]]]],
>
> fn = (x) => Array.isArray(x)
> ```
>
> Output: undefined

**Constraints:**

- `fn` is a function that returns a boolean value
- `obj` is a valid JSON object or array
- `2 <= JSON.stringify(obj).length <= 10^5`

## é¢˜ç›®å¤§æ„

ç»™å®šä¸€ä¸ªå¯¹è±¡ `obj` å’Œä¸€ä¸ªå‡½æ•° `fn`ï¼Œè¿”å›ä¸€ä¸ªç»è¿‡ç­›é€‰çš„å¯¹è±¡ `filteredObject`ã€‚

å‡½æ•° `deepFilter` åº”è¯¥åœ¨å¯¹è±¡ `obj` ä¸Šæ‰§è¡Œæ·±åº¦ç­›é€‰æ“ä½œã€‚æ·±åº¦ç­›é€‰æ“ä½œåº”è¯¥ç§»é™¤ç­›é€‰å‡½æ•° `fn` è¾“å‡ºä¸º `false`
çš„å±æ€§ï¼Œä»¥åŠåœ¨é”®è¢«ç§»é™¤åä»ç„¶å­˜åœ¨çš„ä»»ä½•ç©ºå¯¹è±¡æˆ–æ•°ç»„ã€‚

å¦‚æœæ·±åº¦ç­›é€‰æ“ä½œå¯¼è‡´å¯¹è±¡æˆ–æ•°ç»„ä¸ºç©ºï¼Œæ²¡æœ‰å‰©ä½™å±æ€§ï¼Œ`deepFilter` åº”è¯¥è¿”å› `undefined`ï¼Œè¡¨ç¤ºåœ¨ `filteredObject`
ä¸­æ²¡æœ‰æœ‰æ•ˆæ•°æ®ã€‚

**ç¤ºä¾‹ 1ï¼š**

> **è¾“å…¥ï¼š**
>
> ```
> obj = [-5, -4, -3, -2, -1, 0, 1],
>
> fn = (x) => x > 0
> ```
>
> **è¾“å‡ºï¼š**[1]
>
> **è§£é‡Šï¼š** æ‰€æœ‰ä¸å¤§äº 0 çš„å€¼éƒ½è¢«ç§»é™¤ã€‚

**ç¤ºä¾‹ 2ï¼š**

> **è¾“å…¥ï¼š**
>
> ```
> obj = {"a": 1, "b": "2", "c": 3, "d": "4", "e": 5, "f": 6, "g": {"a": 1}},
>
> fn = (x) => typeof x === "string"
> ```
>
> **è¾“å‡ºï¼š**{"b":"2","d":"4"}
>
> **è§£é‡Šï¼š** æ‰€æœ‰å€¼ä¸æ˜¯å­—ç¬¦ä¸²çš„é”®éƒ½è¢«ç§»é™¤ã€‚åœ¨ç­›é€‰è¿‡ç¨‹ä¸­ç§»é™¤é”®åï¼Œä»»ä½•å¯¼è‡´ä¸ºç©ºçš„å¯¹è±¡ä¹Ÿè¢«ç§»é™¤ã€‚

**ç¤ºä¾‹ 3ï¼š**

> **è¾“å…¥ï¼š**
>
> ```
> obj = [-1, [-1, -1, 5, -1, 10], -1, [-1], [-5]],
>
> fn = (x) => x > 0
> ```
>
> **è¾“å‡ºï¼š**[[5,10]]
>
> **è§£é‡Šï¼š** æ‰€æœ‰ä¸å¤§äº 0 çš„å€¼éƒ½è¢«ç§»é™¤ã€‚åœ¨ç­›é€‰è¿‡ç¨‹ä¸­ç§»é™¤å€¼åï¼Œä»»ä½•å¯¼è‡´ä¸ºç©ºçš„æ•°ç»„ä¹Ÿè¢«ç§»é™¤ã€‚

**ç¤ºä¾‹ 4ï¼š**

> **è¾“å…¥ï¼š**
>
> ```
> obj = [[[[5]]]],
>
> fn = (x) => Array.isArray(x)
> ```
>
> **è¾“å‡ºï¼š** undefined

**æç¤ºï¼š**

- `fn` æ˜¯ä¸€ä¸ªè¿”å›å¸ƒå°”å€¼çš„å‡½æ•°
- `obj` æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ JSON å¯¹è±¡
- `2 <= JSON.stringify(obj).length <= 10**5`

## è§£é¢˜æ€è·¯

1. å®šä¹‰é€’å½’å‡½æ•° `dfs`ï¼Œç”¨äºå¯¹ä¼ å…¥çš„å¯¹è±¡æˆ–æ•°ç»„è¿›è¡Œæ·±åº¦ç­›é€‰ï¼Œä¼šå¯¹ `obj` ä¸­çš„æ¯ä¸ªå±æ€§è¿›è¡Œé€’å½’æ£€æŸ¥ï¼Œç¬¦åˆæ¡ä»¶çš„ä¿ç•™ï¼Œä¸ç¬¦åˆçš„å‰”é™¤ã€‚

2. **é€’å½’å¤„ç†æ•°ç»„**ï¼š

   - åœ¨ `dfs` å‡½æ•°å†…ï¼Œé¦–å…ˆæ£€æŸ¥ `obj` æ˜¯å¦æ˜¯æ•°ç»„ã€‚
   - å¦‚æœæ˜¯æ•°ç»„ï¼Œåˆ™å¯¹æ¯ä¸ªå…ƒç´ è°ƒç”¨ `dfs` é€’å½’å¤„ç†å¹¶å­˜å‚¨åˆ°æ–°æ•°ç»„ `res` ä¸­ã€‚
   - ä¹‹åï¼Œé€šè¿‡ `filter` å»é™¤ `undefined` é¡¹ï¼Œä»…ä¿ç•™æœ‰æ•ˆæ•°æ®ã€‚
   - å¦‚æœ `res` æ•°ç»„æœ‰å†…å®¹ï¼Œè¿”å› `res`ï¼Œå¦åˆ™è¿”å› `undefined`ã€‚

3. **é€’å½’å¤„ç†å¯¹è±¡**ï¼š

   - å¦‚æœ `obj` æ˜¯å¯¹è±¡ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ `res`ï¼Œç„¶åéå† `obj` çš„æ¯ä¸ªå±æ€§ã€‚
   - å¯¹æ¯ä¸ªå±æ€§è°ƒç”¨ `dfs` é€’å½’å¤„ç†ï¼Œå¹¶å°†ç»“æœå­˜å‚¨åœ¨ `filteredValue` ä¸­ã€‚
   - å¦‚æœ `filteredValue` ä¸ä¸º `undefined`ï¼Œå°†è¯¥å±æ€§å’Œå€¼ä¿ç•™åœ¨ `res` ä¸­ã€‚
   - éå†å®Œæˆåï¼Œå¦‚æœ `res` ä¸ä¸ºç©ºï¼Œè¿”å› `res`ï¼›å¦åˆ™è¿”å› `undefined`ã€‚

4. **å¤„ç†åŸºæœ¬æ•°æ®ç±»å‹**ï¼š

   - å¯¹äºéå¯¹è±¡å’Œéæ•°ç»„çš„å€¼ï¼Œç›´æ¥è°ƒç”¨ç­›é€‰å‡½æ•° `fn`ã€‚
   - å¦‚æœ `fn` è¿”å› `true`ï¼Œä¿ç•™è¯¥å€¼ï¼›
   - å¦åˆ™è¿”å› `undefined` è¡¨ç¤ºä¸ä¿ç•™ã€‚

5. æ•´ä¸ª `dfs` å¤„ç†å®Œæˆåï¼Œè¿”å›ç­›é€‰åçš„ç»“æœã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œå…¶ä¸­ `n` æ˜¯å¯¹è±¡çš„èŠ‚ç‚¹æ•°ï¼Œéœ€è¦é€’å½’éå†æ¯ä¸ªèŠ‚ç‚¹ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(d)`ï¼Œå…¶ä¸­ `d` æ˜¯å¯¹è±¡çš„æœ€å¤§åµŒå¥—æ·±åº¦ï¼Œä¸»è¦æ˜¯é€’å½’è°ƒç”¨æ ˆçš„å¼€é”€ã€‚

## ä»£ç 

```javascript
/**
 * @param {Object} obj
 * @param {Function} fn
 * @return {Object}
 */
var deepFilter = function (obj, fn) {
	const dfs = (obj) => {
		// é€’å½’å¤„ç†æ•°ç»„
		if (Array.isArray(obj)) {
			let res = obj.map(dfs).filter((i) => i !== undefined);
			return res.length > 0 ? res : undefined;
		}

		// é€’å½’å¤„ç†å¯¹è±¡
		if (typeof obj == 'object' && obj != null) {
			let res = {};
			for (let key of Object.keys(obj)) {
				const filteredValue = dfs(obj[key]);
				if (filteredValue !== undefined) {
					res[key] = filteredValue;
				}
			}
			return Object.keys(res).length > 0 ? res : undefined;
		}

		// å¤„ç†åŸºæœ¬æ•°æ®ç±»å‹
		return fn(obj) ? obj : undefined;
	};
	return dfs(obj);
};
```
