---
title: 2889. æ•°æ®é‡å¡‘ï¼šé€è§†
description: LeetCode 2889. æ•°æ®é‡å¡‘ï¼šé€è§†é¢˜è§£ï¼ŒReshape Data: Pivotï¼ŒåŒ…å«è§£é¢˜æ€è·¯ã€å¤æ‚åº¦åˆ†æä»¥åŠå®Œæ•´çš„ JavaScript ä»£ç å®ç°ã€‚
keywords:
  - LeetCode
  - 2889. æ•°æ®é‡å¡‘ï¼šé€è§†
  - æ•°æ®é‡å¡‘ï¼šé€è§†
  - Reshape Data: Pivot
  - è§£é¢˜æ€è·¯
---

# 2889. æ•°æ®é‡å¡‘ï¼šé€è§†

ğŸŸ¢ <font color=#15bd66>Easy</font>&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/reshape-data-pivot) [`LeetCode`](https://leetcode.com/problems/reshape-data-pivot)

## é¢˜ç›®

> DataFrame weather
>
> ```
> +-------------+--------+
> | Column Name | Type   |
> +-------------+--------+
> | city        | object |
> | month       | object |
> | temperature | int    |
> +-------------+--------+
> ```

Write a solution to **pivot** the data so that each row represents
temperatures for a specific month, and each city is a separate column.

The result format is in the following example.

> **Example 1:**
>
> **Input:**
>
> ```
> +--------------+----------+-------------+
> | city         | month    | temperature |
> +--------------+----------+-------------+
> | Jacksonville | January  | 13          |
> | Jacksonville | February | 23          |
> | Jacksonville | March    | 38          |
> | Jacksonville | April    | 5           |
> | Jacksonville | May      | 34          |
> | ElPaso       | January  | 20          |
> | ElPaso       | February | 6           |
> | ElPaso       | March    | 26          |
> | ElPaso       | April    | 2           |
> | ElPaso       | May      | 43          |
> +--------------+----------+-------------+
> ```
>
> Output:
>
> ```
> +----------+--------+--------------+
> | month    | ElPaso | Jacksonville |
> +----------+--------+--------------+
> | April    | 2      | 5            |
> | February | 6      | 23           |
> | January  | 20     | 13           |
> | March    | 26     | 38           |
> | May      | 43     | 34           |
> +----------+--------+--------------+
> ```
>
> Explanation: The table is pivoted, each column represents a city, and each row represents a specific month.

## é¢˜ç›®å¤§æ„

> DataFrame weather
>
> ```
> +-------------+--------+
> | Column Name | Type   |
> +-------------+--------+
> | city        | object |
> | month       | object |
> | temperature | int    |
> +-------------+--------+
> ```

ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œä»¥ä¾¿å°†æ•°æ® **æ—‹è½¬** ï¼Œä½¿å¾—æ¯ä¸€è¡Œä»£è¡¨ç‰¹å®šæœˆä»½çš„æ¸©åº¦ï¼Œè€Œæ¯ä¸ªåŸå¸‚éƒ½æ˜¯ä¸€ä¸ªå•ç‹¬çš„åˆ—ã€‚

è¾“å‡ºç»“æœæ ¼å¼å¦‚ä¸‹ç¤ºä¾‹æ‰€ç¤ºã€‚

**ç¤ºä¾‹ 1:**

> **è¾“å…¥ï¼š**
>
> ```
> +--------------+----------+-------------+
> | city         | month    | temperature |
> +--------------+----------+-------------+
> | Jacksonville | January  | 13          |
> | Jacksonville | February | 23          |
> | Jacksonville | March    | 38          |
> | Jacksonville | April    | 5           |
> | Jacksonville | May      | 34          |
> | ElPaso       | January  | 20          |
> | ElPaso       | February | 6           |
> | ElPaso       | March    | 26          |
> | ElPaso       | April    | 2           |
> | ElPaso       | May      | 43          |
> +--------------+----------+-------------+
> ```
>
> **è¾“å‡ºï¼š**
>
> ```
> +----------+--------+--------------+
> | month    | ElPaso | Jacksonville |
> +----------+--------+--------------+
> | April    | 2      | 5            |
> | February | 6      | 23           |
> | January  | 20     | 13           |
> | March    | 26     | 38           |
> | May      | 43     | 34           |
> +----------+--------+--------------+
> ```
>
> **è§£é‡Šï¼š** è¡¨æ ¼è¢«æ—‹è½¬ï¼Œæ¯ä¸€åˆ—ä»£è¡¨ä¸€ä¸ªåŸå¸‚ï¼Œæ¯ä¸€è¡Œä»£è¡¨ç‰¹å®šçš„æœˆä»½ã€‚

## è§£é¢˜æ€è·¯

- åœ¨ Pandas ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ `pivot_table()` æ–¹æ³•å¯¹æ•°æ®è¿›è¡Œé€è§†ï¼Œé‡æ–°ç»„ç»‡ DataFrameã€‚
- é€è§†è¡¨é€šè¿‡æŒ‡å®šè¡Œï¼ˆ`index`ï¼‰ã€åˆ—ï¼ˆ`columns`ï¼‰ã€å€¼ï¼ˆ`values`ï¼‰å’Œèšåˆå‡½æ•°ï¼ˆ`aggfunc`ï¼‰æ¥å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„å’Œèšåˆã€‚

1. **è®¾ç½®è¡Œç´¢å¼• (`index`)**ï¼š
   - ä½¿ç”¨ `'month'` åˆ—ä½œä¸ºé€è§†è¡¨çš„è¡Œç´¢å¼•ï¼Œæ¯ä¸€è¡Œè¡¨ç¤ºä¸€ä¸ªæœˆä»½ã€‚
2. **è®¾ç½®åˆ—ç´¢å¼• (`columns`)**ï¼š
   - ä½¿ç”¨ `'city'` åˆ—ä½œä¸ºé€è§†è¡¨çš„åˆ—ç´¢å¼•ï¼Œæ¯ä¸€åˆ—è¡¨ç¤ºä¸€ä¸ªåŸå¸‚ã€‚
3. **è®¾ç½®å€¼ (`values`)**ï¼š
   - ä½¿ç”¨ `'temperature'` åˆ—ä½œä¸ºéœ€è¦èšåˆçš„å€¼ã€‚
4. **æŒ‡å®šèšåˆå‡½æ•° (`aggfunc`)**ï¼š
   - ä½¿ç”¨ `max` èšåˆå‡½æ•°ï¼Œè¡¨ç¤ºè®¡ç®—æ¯ä¸ªæœˆæ¯ä¸ªåŸå¸‚çš„æœ€é«˜æ¸©åº¦ã€‚

- è¿”å›çš„æ˜¯ä¸€ä¸ªé€è§†åçš„ DataFrameï¼Œå…¶ä¸­è¡Œè¡¨ç¤ºæœˆä»½ï¼Œåˆ—è¡¨ç¤ºåŸå¸‚ï¼Œå€¼ä¸ºæ¯ä¸ªåŸå¸‚åœ¨å¯¹åº”æœˆä»½çš„æœ€é«˜æ¸©åº¦ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œå…¶ä¸­ `n` æ˜¯ DataFrame çš„è¡Œæ•°ã€‚`pivot_table()` éœ€è¦éå†æ•°æ®ä»¥åˆ†ç»„å¹¶è®¡ç®—èšåˆå€¼ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(m * c)`ï¼Œå…¶ä¸­ `m` æ˜¯å”¯ä¸€çš„ `month` æ•°é‡ï¼Œ`c` æ˜¯å”¯ä¸€çš„ `city` æ•°é‡ï¼Œéœ€è¦ä¸ºç”Ÿæˆçš„é€è§†è¡¨åˆ†é…å†…å­˜ã€‚

## ä»£ç 

```python
import pandas as pd

def pivotTable(weather: pd.DataFrame) -> pd.DataFrame:
  return weather.pivot_table(index='month', columns='city', values='temperature', aggfunc='max')
```
