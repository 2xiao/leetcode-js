---
title: 1930. é•¿åº¦ä¸º 3 çš„ä¸åŒå›æ–‡å­åºåˆ—
description: LeetCode 1930. é•¿åº¦ä¸º 3 çš„ä¸åŒå›æ–‡å­åºåˆ—é¢˜è§£ï¼ŒUnique Length-3 Palindromic Subsequencesï¼ŒåŒ…å«è§£é¢˜æ€è·¯ã€å¤æ‚åº¦åˆ†æä»¥åŠå®Œæ•´çš„ JavaScript ä»£ç å®ç°ã€‚
keywords:
  - LeetCode
  - 1930. é•¿åº¦ä¸º 3 çš„ä¸åŒå›æ–‡å­åºåˆ—
  - é•¿åº¦ä¸º 3 çš„ä¸åŒå›æ–‡å­åºåˆ—
  - Unique Length-3 Palindromic Subsequences
  - è§£é¢˜æ€è·¯
  - ä½è¿ç®—
  - å“ˆå¸Œè¡¨
  - å­—ç¬¦ä¸²
  - å‰ç¼€å’Œ
---

# 1930. é•¿åº¦ä¸º 3 çš„ä¸åŒå›æ–‡å­åºåˆ—

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`ä½è¿ç®—`](/tag/bit-manipulation.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`å­—ç¬¦ä¸²`](/tag/string.md) [`å‰ç¼€å’Œ`](/tag/prefix-sum.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/unique-length-3-palindromic-subsequences) [`LeetCode`](https://leetcode.com/problems/unique-length-3-palindromic-subsequences)

## é¢˜ç›®

Given a string `s`, return _the number of**unique palindromes of length three** that are a **subsequence** of_ `s`.

Note that even if there are multiple ways to obtain the same subsequence, it
is still only counted **once**.

A **palindrome** is a string that reads the same forwards and backwards.

A **subsequence** of a string is a new string generated from the original
string with some characters (can be none) deleted without changing the
relative order of the remaining characters.

- For example, `"ace"` is a subsequence of `"abcde "`.

**Example 1:**

> Input: s = "aabca"
>
> Output: 3
>
> Explanation: The 3 palindromic subsequences of length 3 are:
>
> - "aba" (subsequence of "_a_ a _b_ c _a_ ")
> - "aaa" (subsequence of "_aa_ bc _a_ ")
> - "aca" (subsequence of "_a_ ab _ca_ ")

**Example 2:**

> Input: s = "adc"
>
> Output: 0
>
> Explanation: There are no palindromic subsequences of length 3 in "adc".

**Example 3:**

> Input: s = "bbcbaba"
>
> Output: 4
>
> Explanation: The 4 palindromic subsequences of length 3 are:
>
> - "bbb" (subsequence of "_bb_ c _b_ aba")
> - "bcb" (subsequence of "_b_ b _cb_ aba")
> - "bab" (subsequence of "_b_ bcb _ab_ a")
> - "aba" (subsequence of "bbcb _aba_ ")

**Constraints:**

- `3 <= s.length <= 10^5`
- `s` consists of only lowercase English letters.

## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² `s` ï¼Œè¿”å› `s` ä¸­ **é•¿åº¦ä¸º 3** çš„**ä¸åŒå›æ–‡å­åºåˆ—** çš„ä¸ªæ•°ã€‚

å³ä¾¿å­˜åœ¨å¤šç§æ–¹æ³•æ¥æ„å»ºç›¸åŒçš„å­åºåˆ—ï¼Œä½†ç›¸åŒçš„å­åºåˆ—åªè®¡æ•°ä¸€æ¬¡ã€‚

**å›æ–‡** æ˜¯æ­£ç€è¯»å’Œåç€è¯»ä¸€æ ·çš„å­—ç¬¦ä¸²ã€‚

**å­åºåˆ—** æ˜¯ç”±åŸå­—ç¬¦ä¸²åˆ é™¤å…¶ä¸­éƒ¨åˆ†å­—ç¬¦ï¼ˆä¹Ÿå¯ä»¥ä¸åˆ é™¤ï¼‰ä¸”ä¸æ”¹å˜å‰©ä½™å­—ç¬¦ä¹‹é—´ç›¸å¯¹é¡ºåºå½¢æˆçš„ä¸€ä¸ªæ–°å­—ç¬¦ä¸²ã€‚

- ä¾‹å¦‚ï¼Œ`"ace"` æ˜¯ `"abcde "` çš„ä¸€ä¸ªå­åºåˆ—ã€‚

**ç¤ºä¾‹ 1ï¼š**

> **è¾“å…¥ï¼š** s = "aabca"
>
> **è¾“å‡ºï¼š** 3
>
> **è§£é‡Šï¼š** é•¿åº¦ä¸º 3 çš„ 3 ä¸ªå›æ–‡å­åºåˆ—åˆ†åˆ«æ˜¯ï¼š
>
> - "aba" ("**_a_** a** _b_** c** _a_** " çš„å­åºåˆ—)
> - "aaa" ("**_aa_** bc** _a_** " çš„å­åºåˆ—)
> - "aca" ("**_a_** ab** _ca_** " çš„å­åºåˆ—)

**ç¤ºä¾‹ 2ï¼š**

> **è¾“å…¥ï¼š** s = "adc"
>
> **è¾“å‡ºï¼š** 0
>
> **è§£é‡Šï¼š** "adc" ä¸å­˜åœ¨é•¿åº¦ä¸º 3 çš„å›æ–‡å­åºåˆ—ã€‚

**ç¤ºä¾‹ 3ï¼š**

> **è¾“å…¥ï¼š** s = "bbcbaba"
>
> **è¾“å‡ºï¼š** 4
>
> **è§£é‡Šï¼š** é•¿åº¦ä¸º 3 çš„ 4 ä¸ªå›æ–‡å­åºåˆ—åˆ†åˆ«æ˜¯ï¼š
>
> - "bbb" ("**_bb_** c** _b_** aba" çš„å­åºåˆ—)
> - "bcb" ("**_b_** b** _cb_** aba" çš„å­åºåˆ—)
> - "bab" ("**_b_** bcb** _ab_** a" çš„å­åºåˆ—)
> - "aba" ("bbcb** _aba_** " çš„å­åºåˆ—)

**æç¤ºï¼š**

- `3 <= s.length <= 10^5`
- `s` ä»…ç”±å°å†™è‹±æ–‡å­—æ¯ç»„æˆ

## è§£é¢˜æ€è·¯

1. **è·å–å”¯ä¸€å­—ç¬¦é›†åˆ**ï¼š

   - ä½¿ç”¨ `Set` æ”¶é›†å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰å”¯ä¸€å­—ç¬¦ï¼Œé€ä¸ªå­—ç¬¦ä½œä¸ºå›æ–‡å­åºåˆ—çš„é¦–å°¾å­—ç¬¦æ¥ç»Ÿè®¡ã€‚

2. **éå†å­—ç¬¦é›†åˆ**ï¼š

   - å¯¹äºæ¯ä¸ªå­—ç¬¦ `letter`ï¼Œåœ¨å­—ç¬¦ä¸² `s` ä¸­æ‰¾åˆ°å®ƒçš„**ç¬¬ä¸€æ¬¡å‡ºç°ä½ç½®**å’Œ**æœ€åä¸€æ¬¡å‡ºç°ä½ç½®**ã€‚
   - å¦‚æœ `letter` åœ¨å­—ç¬¦ä¸²ä¸­è‡³å°‘å‡ºç°ä¸¤æ¬¡ï¼Œåˆ™æå– `letter` çš„ç¬¬ä¸€æ¬¡å‡ºç°å’Œæœ€åä¸€æ¬¡å‡ºç°ä¹‹é—´çš„å­å­—ç¬¦ä¸²ã€‚

3. **ç»Ÿè®¡ä¸­é—´å­—ç¬¦**ï¼š

   - å¯¹ä¸Šè¿°å­å­—ç¬¦ä¸²ä½¿ç”¨ `Set` å»é‡ï¼Œç»Ÿè®¡ä¸­é—´å­—ç¬¦çš„ç§ç±»æ•°é‡ã€‚
   - å°†è¯¥æ•°é‡ç´¯åŠ åˆ°ç»“æœ `res` ä¸­ã€‚

4. **è¿”å›ç»“æœ**ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n)`
  - æ„å»ºå”¯ä¸€å­—ç¬¦é›†åˆï¼š`O(n)`ï¼Œå…¶ä¸­ `n` æ˜¯å­—ç¬¦ä¸²é•¿åº¦ã€‚
  - å¯¹æ¯ä¸ªå”¯ä¸€å­—ç¬¦ï¼Œæ‰¾åˆ°å®ƒçš„é¦–æ¬¡å’Œæœ«æ¬¡å‡ºç°ä½ç½®ï¼š`O(n)`ã€‚
  - æå–å­å­—ç¬¦ä¸²å¹¶ç»Ÿè®¡ä¸­é—´å­—ç¬¦ï¼š`O(n)`ã€‚
  - æ€»å¤æ‚åº¦ä¸º `O(n * |letters|)`ï¼Œå…¶ä¸­ `|letters|` æ˜¯å”¯ä¸€å­—ç¬¦çš„ä¸ªæ•°ï¼Œæœ€åæƒ…å†µä¸‹ä¸º `26`ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œå­˜å‚¨å”¯ä¸€å­—ç¬¦é›†åˆå’Œä¸­é—´å­—ç¬¦é›†åˆã€‚

## ä»£ç 

```javascript
/**
 * @param {string} s
 * @return {number}
 */
var countPalindromicSubsequence = function (s) {
	const letters = new Set(s);
	let res = 0;

	for (let letter of letters) {
		let start = -1,
			end = 0;

		// æ‰¾åˆ°å­—ç¬¦çš„é¦–æ¬¡å’Œæœ«æ¬¡å‡ºç°ä½ç½®
		for (let i = 0; i < s.length; i++) {
			if (s.charAt(i) === letter) {
				if (start === -1) start = i;
				end = i;
			}
		}

		// å¦‚æœæœ‰æœ‰æ•ˆèŒƒå›´ï¼Œç»Ÿè®¡ä¸­é—´å­—ç¬¦çš„æ•°é‡
		if (start < end) {
			const middleChars = new Set(s.slice(start + 1, end));
			res += middleChars.size;
		}
	}

	return res;
};
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ | åŠ›æ‰£ |
| :------: | :------ | :------: | :------ | :------: | :------: |
| 2484 | ç»Ÿè®¡å›æ–‡å­åºåˆ—æ•°ç›® |  |  [`å­—ç¬¦ä¸²`](/tag/string.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md) | ğŸ”´ | [ğŸ€„ï¸](https://leetcode.cn/problems/count-palindromic-subsequences) [ğŸ”—](https://leetcode.com/problems/count-palindromic-subsequences) |