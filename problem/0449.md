---
title: 449. åºåˆ—åŒ–å’Œååºåˆ—åŒ–äºŒå‰æœç´¢æ ‘
description: LeetCode 449. åºåˆ—åŒ–å’Œååºåˆ—åŒ–äºŒå‰æœç´¢æ ‘é¢˜è§£ï¼ŒSerialize and Deserialize BSTï¼ŒåŒ…å«è§£é¢˜æ€è·¯ã€å¤æ‚åº¦åˆ†æä»¥åŠå®Œæ•´çš„ JavaScript ä»£ç å®ç°ã€‚
keywords:
  - LeetCode
  - 449. åºåˆ—åŒ–å’Œååºåˆ—åŒ–äºŒå‰æœç´¢æ ‘
  - åºåˆ—åŒ–å’Œååºåˆ—åŒ–äºŒå‰æœç´¢æ ‘
  - Serialize and Deserialize BST
  - è§£é¢˜æ€è·¯
  - æ ‘
  - æ·±åº¦ä¼˜å…ˆæœç´¢
  - å¹¿åº¦ä¼˜å…ˆæœç´¢
  - è®¾è®¡
  - äºŒå‰æœç´¢æ ‘
  - å­—ç¬¦ä¸²
  - äºŒå‰æ ‘
---

# 449. åºåˆ—åŒ–å’Œååºåˆ—åŒ–äºŒå‰æœç´¢æ ‘

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ ‘`](/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/tag/depth-first-search.md) [`å¹¿åº¦ä¼˜å…ˆæœç´¢`](/tag/breadth-first-search.md) [`è®¾è®¡`](/tag/design.md) [`äºŒå‰æœç´¢æ ‘`](/tag/binary-search-tree.md) [`å­—ç¬¦ä¸²`](/tag/string.md) [`äºŒå‰æ ‘`](/tag/binary-tree.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/serialize-and-deserialize-bst) [`LeetCode`](https://leetcode.com/problems/serialize-and-deserialize-bst)

## é¢˜ç›®

Serialization is converting a data structure or object into a sequence of bits
so that it can be stored in a file or memory buffer, or transmitted across a
network connection link to be reconstructed later in the same or another
computer environment.

Design an algorithm to serialize and deserialize a **binary search tree**.
There is no restriction on how your serialization/deserialization algorithm
should work. You need to ensure that a binary search tree can be serialized to
a string, and this string can be deserialized to the original tree structure.

**The encoded string should be as compact as possible.**

**Example 1:**

> Input: root = [2,1,3]
>
> Output: [2,1,3]

**Example 2:**

> Input: root = []
>
> Output: []

**Constraints:**

- The number of nodes in the tree is in the range `[0, 104]`.
- `0 <= Node.val <= 10^4`
- The input tree is **guaranteed** to be a binary search tree.

## é¢˜ç›®å¤§æ„

åºåˆ—åŒ–æ˜¯å°†æ•°æ®ç»“æ„æˆ–å¯¹è±¡è½¬æ¢ä¸ºä¸€ç³»åˆ—ä½çš„è¿‡ç¨‹ï¼Œä»¥ä¾¿å®ƒå¯ä»¥å­˜å‚¨åœ¨æ–‡ä»¶æˆ–å†…å­˜ç¼“å†²åŒºä¸­ï¼Œæˆ–é€šè¿‡ç½‘ç»œè¿æ¥é“¾è·¯ä¼ è¾“ï¼Œä»¥ä¾¿ç¨ååœ¨åŒä¸€ä¸ªæˆ–å¦ä¸€ä¸ªè®¡ç®—æœºç¯å¢ƒä¸­é‡å»ºã€‚

è®¾è®¡ä¸€ä¸ªç®—æ³•æ¥åºåˆ—åŒ–å’Œååºåˆ—åŒ–**äºŒå‰æœç´¢æ ‘** ã€‚ å¯¹åºåˆ—åŒ–/ååºåˆ—åŒ–ç®—æ³•çš„å·¥ä½œæ–¹å¼æ²¡æœ‰é™åˆ¶ã€‚
æ‚¨åªéœ€ç¡®ä¿äºŒå‰æœç´¢æ ‘å¯ä»¥åºåˆ—åŒ–ä¸ºå­—ç¬¦ä¸²ï¼Œå¹¶ä¸”å¯ä»¥å°†è¯¥å­—ç¬¦ä¸²ååºåˆ—åŒ–ä¸ºæœ€åˆçš„äºŒå‰æœç´¢æ ‘ã€‚

**ç¼–ç çš„å­—ç¬¦ä¸²åº”å°½å¯èƒ½ç´§å‡‘ã€‚**

**ç¤ºä¾‹ 1ï¼š**

> **è¾“å…¥ï¼š** root = [2,1,3]
>
> **è¾“å‡ºï¼š**[2,1,3]

**ç¤ºä¾‹ 2ï¼š**

> **è¾“å…¥ï¼š** root = []
>
> **è¾“å‡ºï¼š**[]

**æç¤ºï¼š**

- æ ‘ä¸­èŠ‚ç‚¹æ•°èŒƒå›´æ˜¯ `[0, 104]`
- `0 <= Node.val <= 10^4`
- é¢˜ç›®æ•°æ® **ä¿è¯** è¾“å…¥çš„æ ‘æ˜¯ä¸€æ£µäºŒå‰æœç´¢æ ‘ã€‚

## è§£é¢˜æ€è·¯

æœ¬é¢˜è¦æ±‚å¯¹ **äºŒå‰æœç´¢æ ‘ï¼ˆBSTï¼‰** è¿›è¡Œ **åºåˆ—åŒ–**ï¼ˆè½¬å­—ç¬¦ä¸²ï¼‰å’Œ **ååºåˆ—åŒ–**ï¼ˆæ¢å¤åŸæ ‘ï¼‰ã€‚  
ç”±äº **BST çš„å‰åºéå†ï¼ˆPreorderï¼‰å¯ä»¥å”¯ä¸€ç¡®å®š BST ç»“æ„**ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€æ€§è´¨é«˜æ•ˆå®Œæˆé¢˜ç›®ã€‚

1. **åºåˆ—åŒ–ï¼ˆSerializeï¼‰**

- é‡‡ç”¨ **å‰åºéå†ï¼ˆå…ˆæ ¹åå·¦å³ï¼‰** éå† BSTï¼Œå¹¶ **å°†èŠ‚ç‚¹å€¼å­˜å…¥æ•°ç»„**ã€‚
- é‡åˆ° `null` ä¸å­˜å‚¨ï¼Œåªå­˜éç©ºèŠ‚ç‚¹çš„å€¼ï¼Œå‡å°‘å­˜å‚¨å¼€é”€ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦ï¼š** `O(n)`ï¼Œéå†æ‰€æœ‰ `n` ä¸ªèŠ‚ç‚¹ä¸€æ¬¡ã€‚
- **ç©ºé—´å¤æ‚åº¦ï¼š** `O(n)`ï¼Œå­˜å‚¨ `n` ä¸ªèŠ‚ç‚¹çš„å€¼ã€‚

---

2. **ååºåˆ—åŒ–ï¼ˆDeserializeï¼‰**

- ç”±äº `preorder` éå†æ˜¯ **æ ¹ â†’ å·¦ â†’ å³**ï¼š
  1. å–å‡ºå½“å‰å­æ ‘çš„æ ¹èŠ‚ç‚¹ï¼ˆæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼‰ã€‚
  2. åˆ©ç”¨ BST çš„æ€§è´¨ï¼ˆå·¦å­æ ‘ < æ ¹ < å³å­æ ‘ï¼‰ï¼Œç”¨ä¸Šä¸‹ç•Œ `lower` å’Œ `upper` é™åˆ¶èŠ‚ç‚¹å€¼èŒƒå›´ï¼š
     - **å·¦å­æ ‘** é€’å½’æ„é€ èŒƒå›´ `[lower, root.val]`ã€‚
     - **å³å­æ ‘** é€’å½’æ„é€ èŒƒå›´ `[root.val, upper]`ã€‚
  3. å¦‚æœå½“å‰å€¼ä¸åœ¨ `[lower, upper]` èŒƒå›´å†…ï¼Œè¯´æ˜ä¸å±äºå½“å‰å­æ ‘ï¼Œå›æº¯ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦ï¼š** `O(n)`ï¼Œæ¯ä¸ªèŠ‚ç‚¹æœ€å¤šè®¿é—®ä¸€æ¬¡ã€‚
- **ç©ºé—´å¤æ‚åº¦ï¼š** `O(n)`ï¼Œé€’å½’æ ˆçš„æœ€å¤§æ·±åº¦ **æœ€å `O(n)`ï¼ˆé€€åŒ–ä¸ºé“¾è¡¨ï¼‰**ï¼Œ**æœ€ä¼˜ `O(log n)`ï¼ˆå¹³è¡¡ BSTï¼‰**ã€‚

## ä»£ç 

```javascript
/**
 * Encodes a tree to a single string.
 *
 * @param {TreeNode} root
 * @return {string}
 */
var serialize = function (root) {
	let arr = [];

	const preorder = (node) => {
		if (!node) return;
		arr.push(node.val);
		preorder(node.left);
		preorder(node.right);
	};

	preorder(root);
	return arr.join(',');
};

/**
 * Decodes your encoded data to tree.
 *
 * @param {string} data
 * @return {TreeNode}
 */
var deserialize = function (data) {
	if (!data) return null;

	const arr = data.split(',').map(Number);

	const buildTree = (lower, upper) => {
		if (!arr.length || arr[0] < lower || arr[0] > upper) return null;

		let val = arr.shift();
		let root = new TreeNode(val);
		root.left = buildTree(lower, val);
		root.right = buildTree(val, upper);
		return root;
	};

	return buildTree(-Infinity, Infinity);
};
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ | åŠ›æ‰£ |
| :------: | :------ | :------: | :------ | :------: | :------: |
| 297 | äºŒå‰æ ‘çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ– | [[âœ“]](/problem/0297.md) |  [`æ ‘`](/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/tag/depth-first-search.md) [`å¹¿åº¦ä¼˜å…ˆæœç´¢`](/tag/breadth-first-search.md) `3+` | ğŸ”´ | [ğŸ€„ï¸](https://leetcode.cn/problems/serialize-and-deserialize-binary-tree) [ğŸ”—](https://leetcode.com/problems/serialize-and-deserialize-binary-tree) |
| 428 | åºåˆ—åŒ–å’Œååºåˆ—åŒ– N å‰æ ‘ ğŸ”’ |  |  [`æ ‘`](/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/tag/depth-first-search.md) [`å¹¿åº¦ä¼˜å…ˆæœç´¢`](/tag/breadth-first-search.md) `1+` | ğŸ”´ | [ğŸ€„ï¸](https://leetcode.cn/problems/serialize-and-deserialize-n-ary-tree) [ğŸ”—](https://leetcode.com/problems/serialize-and-deserialize-n-ary-tree) |
| 652 | å¯»æ‰¾é‡å¤çš„å­æ ‘ |  |  [`æ ‘`](/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/tag/depth-first-search.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) `1+` | ğŸŸ  | [ğŸ€„ï¸](https://leetcode.cn/problems/find-duplicate-subtrees) [ğŸ”—](https://leetcode.com/problems/find-duplicate-subtrees) |