---
title: 183. ä»ä¸è®¢è´­çš„å®¢æˆ·
description: LeetCode 183. ä»ä¸è®¢è´­çš„å®¢æˆ·é¢˜è§£ï¼ŒCustomers Who Never Orderï¼ŒåŒ…å«è§£é¢˜æ€è·¯ã€å¤æ‚åº¦åˆ†æä»¥åŠå®Œæ•´çš„ JavaScript ä»£ç å®ç°ã€‚
keywords:
  - LeetCode
  - 183. ä»ä¸è®¢è´­çš„å®¢æˆ·
  - ä»ä¸è®¢è´­çš„å®¢æˆ·
  - Customers Who Never Order
  - è§£é¢˜æ€è·¯
  - æ•°æ®åº“
---

# 183. ä»ä¸è®¢è´­çš„å®¢æˆ·

ğŸŸ¢ <font color=#15bd66>Easy</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/customers-who-never-order) [`LeetCode`](https://leetcode.com/problems/customers-who-never-order)

## é¢˜ç›®

Table: `Customers`

> ```
> +-------------+---------+
> | Column Name | Type    |
> +-------------+---------+
> | id          | int     |
> | name        | varchar |
> +-------------+---------+
> ```
>
> id is the primary key (column with unique values) for this table.
>
> Each row of this table indicates the ID and name of a customer.

Table: `Orders`

> ```
> +-------------+------+
> | Column Name | Type |
> +-------------+------+
> | id          | int  |
> | customerId  | int  |
> +-------------+------+
> ```
>
> id is the primary key (column with unique values) for this table.
>
> customerId is a foreign key (reference columns) of the ID from the Customers table.
>
> Each row of this table indicates the ID of an order and the ID of the customer who ordered it.

Write a solution to find all customers who never order anything.

Return the result table in **any order**.

The result format is in the following example.

**Example 1:**

> Input:
>
> Customers table:
>
> ```
> +----+-------+
> | id | name  |
> +----+-------+
> | 1  | Joe   |
> | 2  | Henry |
> | 3  | Sam   |
> | 4  | Max   |
> +----+-------+
> ```
>
> Orders table:
>
> ```
> +----+------------+
> | id | customerId |
> +----+------------+
> | 1  | 3          |
> | 2  | 1          |
> +----+------------+
> ```
>
> Output:
>
> ```
> +-----------+
> | Customers |
> +-----------+
> | Henry     |
> | Max       |
> +-----------+
> ```

## é¢˜ç›®å¤§æ„

`Customers` è¡¨ï¼š

> ```
> +-------------+---------+
> | Column Name | Type    |
> +-------------+---------+
> | id          | int     |
> | name        | varchar |
> +-------------+---------+
> ```
>
> åœ¨ SQL ä¸­ï¼Œid æ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚
>
> è¯¥è¡¨çš„æ¯ä¸€è¡Œéƒ½è¡¨ç¤ºå®¢æˆ·çš„ ID å’Œåç§°ã€‚

`Orders` è¡¨ï¼š

> ```
> +-------------+------+
> | Column Name | Type |
> +-------------+------+
> | id          | int  |
> | customerId  | int  |
> +-------------+------+
> ```
>
> åœ¨ SQL ä¸­ï¼Œid æ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚
>
> customerId æ˜¯ Customers è¡¨ä¸­ ID çš„å¤–é”®( Pandas ä¸­çš„è¿æ¥é”®)ã€‚
>
> è¯¥è¡¨çš„æ¯ä¸€è¡Œéƒ½è¡¨ç¤ºè®¢å•çš„ ID å’Œè®¢è´­è¯¥è®¢å•çš„å®¢æˆ·çš„ IDã€‚

æ‰¾å‡ºæ‰€æœ‰ä»ä¸ç‚¹ä»»ä½•ä¸œè¥¿çš„é¡¾å®¢ã€‚

ä»¥ **ä»»æ„é¡ºåº** è¿”å›ç»“æœè¡¨ã€‚

ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚

**ç¤ºä¾‹ 1ï¼š**

> **è¾“å…¥ï¼š**
>
> Customers table:
>
> ```
> +----+-------+
> | id | name  |
> +----+-------+
> | 1  | Joe   |
> | 2  | Henry |
> | 3  | Sam   |
> | 4  | Max   |
> +----+-------+
> ```
>
> Orders table:
>
> ```
> +----+------------+
> | id | customerId |
> +----+------------+
> | 1  | 3          |
> | 2  | 1          |
> +----+------------+
> ```
>
> **è¾“å‡ºï¼š**
>
> ```
> +-----------+
> | Customers |
> +-----------+
> | Henry     |
> | Max       |
> +-----------+
> ```

## è§£é¢˜æ€è·¯

### MySQL

1. **è¿”å›å­—æ®µ**ï¼š  
   `SELECT` æŒ‡å®šè¦è¿”å›çš„å­—æ®µï¼š`name`ï¼ˆå®¢æˆ·åç§°ï¼‰ï¼Œé‡å‘½åä¸º `Customers`ã€‚  
   `FROM Customers` è¡¨ä½œä¸ºæ•°æ®æ¥æºã€‚

2. **ç­›é€‰æ¡ä»¶**ï¼š
   - ä½¿ç”¨ `LEFT JOIN` å°† `Customers` è¡¨ä¸ `Orders` è¡¨è¿æ¥ï¼Œå…³è”æ¡ä»¶æ˜¯ `Customers.id = Orders.customerId`ã€‚
   - ç­›é€‰å‡ºæœªä¸‹å•çš„å®¢æˆ·ï¼Œå³ `Orders.customerId` ä¸º `NULL` çš„è®°å½•ã€‚
   - ä½¿ç”¨ `WHERE o.customerId IS NULL` ç­›é€‰æ¡ä»¶ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n + m)`ï¼Œå…¶ä¸­ `n` æ˜¯ `Customers` è¡¨çš„è®°å½•æ•°ï¼Œ`m` æ˜¯ `Orders` è¡¨çš„è®°å½•æ•°ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼šè¿”å›çš„ç»“æœå ç”¨çš„ç©ºé—´ä¸æœªä¸‹å•çš„å®¢æˆ·æ•°æˆæ­£æ¯”ã€‚

---

### Pandas

1. **åŠ è½½æ•°æ®**ï¼š  
   å°† `Customers` å’Œ `Orders` æ•°æ®åŠ è½½åˆ° Pandas çš„ä¸¤ä¸ª `DataFrame` ä¸­ã€‚

2. **å·¦è¿æ¥**ï¼š  
   ä½¿ç”¨ `merge` æ¨¡æ‹Ÿ SQL çš„ `LEFT JOIN`ï¼Œ`Customers` ä¸ºå·¦è¡¨ï¼Œ`Orders` ä¸ºå³è¡¨ï¼Œå…³è”æ¡ä»¶æ˜¯ `Customers.id = Orders.customerId`ã€‚

3. **ç­›é€‰æ¡ä»¶**ï¼š  
   ç­›é€‰å‡º `customerId` ä¸º `NaN` çš„è®°å½•ï¼Œå³æœªä¸‹è¿‡è®¢å•çš„å®¢æˆ·ã€‚

4. **é€‰æ‹©åˆ—**ï¼š  
   ä¿ç•™ç­›é€‰åçš„ `name` åˆ—ï¼Œå¹¶é‡å‘½åä¸º `Customers` ï¼Œä½œä¸ºæœ€ç»ˆç»“æœã€‚

## ä»£ç 

::: code-tabs
@tab MySQL

```sql
SELECT c.name as Customers
FROM Customers c
LEFT JOIN Orders o
ON c.id = o.customerId
WHERE o.customerId IS NULL
```

@tab Pandas

```python
import pandas as pd

def customers_without_orders(customers: pd.DataFrame, orders: pd.DataFrame) -> pd.DataFrame:
    # LEFT JOIN æ¨¡æ‹Ÿ
    merged = pd.merge(customers, orders, left_on='id', right_on='customerId', how='left')
    # ç­›é€‰æœªä¸‹è®¢å•çš„å®¢æˆ·
    return merged[merged['customerId'].isna()][['name']].rename(columns={'name': 'Customers'})
```

:::
