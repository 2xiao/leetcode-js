# [224. åŸºæœ¬è®¡ç®—å™¨](https://leetcode.com/problems/basic-calculator)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ ˆ`](/tag/stack.md) [`é€’å½’`](/tag/recursion.md) [`æ•°å­¦`](/tag/math.md) [`å­—ç¬¦ä¸²`](/tag/string.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/basic-calculator)

## é¢˜ç›®

<p>ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸²è¡¨è¾¾å¼ <code>s</code> ï¼Œè¯·ä½ å®ç°ä¸€ä¸ªåŸºæœ¬è®¡ç®—å™¨æ¥è®¡ç®—å¹¶è¿”å›å®ƒçš„å€¼ã€‚</p>

<p>æ³¨æ„:ä¸å…è®¸ä½¿ç”¨ä»»ä½•å°†å­—ç¬¦ä¸²ä½œä¸ºæ•°å­¦è¡¨è¾¾å¼è®¡ç®—çš„å†…ç½®å‡½æ•°ï¼Œæ¯”å¦‚ <code>eval()</code> ã€‚</p>

<p>&nbsp;</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>s = "1 + 1"
<strong>è¾“å‡ºï¼š</strong>2
</pre>

<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>s = " 2-1 + 2 "
<strong>è¾“å‡ºï¼š</strong>3
</pre>

<p><strong>ç¤ºä¾‹ 3ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>s = "(1+(4+5+2)-3)+(6+8)"
<strong>è¾“å‡ºï¼š</strong>23
</pre>

<p>&nbsp;</p>

<p><strong>æç¤ºï¼š</strong></p>

<ul>
	<li><code>1 &lt;= s.length &lt;= 3&nbsp;* 10<sup>5</sup></code></li>
	<li><code>s</code> ç”±æ•°å­—ã€<code>'+'</code>ã€<code>'-'</code>ã€<code>'('</code>ã€<code>')'</code>ã€å’Œ <code>' '</code> ç»„æˆ</li>
	<li><code>s</code> è¡¨ç¤ºä¸€ä¸ªæœ‰æ•ˆçš„è¡¨è¾¾å¼</li>
	<li><font color="#c7254e"><font face="Menlo, Monaco, Consolas, Courier New, monospace"><span style="font-size:12.6px"><span style="background-color:#f9f2f4">'+'</span></span></font></font> ä¸èƒ½ç”¨ä½œä¸€å…ƒè¿ç®—(ä¾‹å¦‚ï¼Œ <font color="#c7254e"><font face="Menlo, Monaco, Consolas, Courier New, monospace"><span style="font-size:12.6px"><span style="background-color:#f9f2f4">"+1"</span></span></font></font>&nbsp;å’Œ <code>"+(2 + 3)"</code>&nbsp;æ— æ•ˆ)</li>
	<li><font color="#c7254e"><font face="Menlo, Monaco, Consolas, Courier New, monospace"><span style="font-size:12.6px"><span style="background-color:#f9f2f4">'-'</span></span></font></font> å¯ä»¥ç”¨ä½œä¸€å…ƒè¿ç®—(å³ <font color="#c7254e"><font face="Menlo, Monaco, Consolas, Courier New, monospace"><span style="font-size:12.6px"><span style="background-color:#f9f2f4">"-1"</span></span></font></font>&nbsp;å’Œ <code>"-(2 + 3)"</code>&nbsp;æ˜¯æœ‰æ•ˆçš„)</li>
	<li>è¾“å…¥ä¸­ä¸å­˜åœ¨ä¸¤ä¸ªè¿ç»­çš„æ“ä½œç¬¦</li>
	<li>æ¯ä¸ªæ•°å­—å’Œè¿è¡Œçš„è®¡ç®—å°†é€‚åˆäºä¸€ä¸ªæœ‰ç¬¦å·çš„ 32ä½ æ•´æ•°</li>
</ul>


## è§£é¢˜æ€è·¯

- åŠ å‡æ³•è®¡ç®—å™¨ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªå»æ‹¬å·çš„è¿‡ç¨‹ï¼Œéœ€è¦æ ¹æ® `+` `-` å’Œ `(` `)`æ¥åˆ¤æ–­æ•°å­—çš„æ­£è´Ÿï¼›
- éå†å­—ç¬¦ä¸²ï¼Œæ¯å½“é‡åˆ° `(` ï¼Œå°±ä½¿ç”¨æ ˆæ¥ä¿å­˜æ‹¬å·å‰çš„è¿ç®—ç¬¦å·ï¼›
- æ³¨æ„ï¼Œè´Ÿè´Ÿå¾—æ­£çš„æƒ…å†µéœ€è¦ç‰¹æ®Šå¤„ç†ï¼Œæ‰€ä»¥éœ€è¦è®°å½•æ¯æ¬¡è®¡ç®—å‡ºæ¥çš„ç¬¦å·ï¼›
- é‡åˆ° `ï¼‰` ï¼Œåˆ™å‡ºæ ˆï¼›
- é‡åˆ° `+` `-`ï¼Œåˆ™ç”¨ `sign` æ¥ä¿å­˜æ•°å­—å‰çš„è¿ç®—ç¬¦å·ï¼›
- æ¯ä¸ªæ•°å­—çš„æ­£è´Ÿéƒ½å–å†³äº æ ˆé¡¶å’Œæ•°å­—å‰çš„è¿ç®—ç¬¦å·çš„ä¹˜ç§¯ï¼Œå³ï¼š`sum * sign * stack[stack.length - 1]`ï¼›
- å°† `æ•°å­— * æ­£è´Ÿç¬¦å·` ç´¯åŠ èµ·æ¥å³å¯ï¼›

## ä»£ç 

```javascript
/**
 * @param {string} s
 * @return {number}
 */
var calculate = function (s) {
	let res = 0,
		sum = 0,
		sign = 1;
	let stack = [1];
	const isDigit = (str) => str <= '9' && str >= '0';
	for (let i of s) {
		if (isDigit(i)) sum = sum * 10 + Number(i);
		else {
			res += sum * sign * stack[stack.length - 1];
			sum = 0;
			if (i === '+') sign = 1;
			else if (i === '-') sign = -1;
			else if (i === '(') {
				stack.push(stack[stack.length - 1] * sign);
				sign = 1;
			} else if (i === ')') stack.pop();
		}
	}
	res += sum * sign;
	return res;
};
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 150 | [é€†æ³¢å…°è¡¨è¾¾å¼æ±‚å€¼](https://leetcode.com/problems/evaluate-reverse-polish-notation) | [[âœ“]](/problem/0150.md) |  [`æ ˆ`](/tag/stack.md) [`æ•°ç»„`](/tag/array.md) [`æ•°å­¦`](/tag/math.md) | <font color=#ffb800>Medium</font> |
| 227 | [åŸºæœ¬è®¡ç®—å™¨ II](https://leetcode.com/problems/basic-calculator-ii) | [[âœ“]](/problem/0227.md) |  [`æ ˆ`](/tag/stack.md) [`æ•°å­¦`](/tag/math.md) [`å­—ç¬¦ä¸²`](/tag/string.md) | <font color=#ffb800>Medium</font> |
| 241 | [ä¸ºè¿ç®—è¡¨è¾¾å¼è®¾è®¡ä¼˜å…ˆçº§](https://leetcode.com/problems/different-ways-to-add-parentheses) |  |  [`é€’å½’`](/tag/recursion.md) [`è®°å¿†åŒ–æœç´¢`](/tag/memoization.md) [`æ•°å­¦`](/tag/math.md) `2+` | <font color=#ffb800>Medium</font> |
| 282 | [ç»™è¡¨è¾¾å¼æ·»åŠ è¿ç®—ç¬¦](https://leetcode.com/problems/expression-add-operators) |  |  [`æ•°å­¦`](/tag/math.md) [`å­—ç¬¦ä¸²`](/tag/string.md) [`å›æº¯`](/tag/backtracking.md) | <font color=#ff334b>Hard</font> |
| 772 | [åŸºæœ¬è®¡ç®—å™¨ III](https://leetcode.com/problems/basic-calculator-iii) | [[âœ“]](/problem/0772.md) |  [`æ ˆ`](/tag/stack.md) [`é€’å½’`](/tag/recursion.md) [`æ•°å­¦`](/tag/math.md) `1+` | <font color=#ff334b>Hard</font> |
| 2019 | [è§£å‡ºæ•°å­¦è¡¨è¾¾å¼çš„å­¦ç”Ÿåˆ†æ•°](https://leetcode.com/problems/the-score-of-students-solving-math-expression) |  |  [`æ ˆ`](/tag/stack.md) [`è®°å¿†åŒ–æœç´¢`](/tag/memoization.md) [`æ•°ç»„`](/tag/array.md) `3+` | <font color=#ff334b>Hard</font> |
| 2232 | [å‘è¡¨è¾¾å¼æ·»åŠ æ‹¬å·åçš„æœ€å°ç»“æœ](https://leetcode.com/problems/minimize-result-by-adding-parentheses-to-expression) |  |  [`å­—ç¬¦ä¸²`](/tag/string.md) [`æšä¸¾`](/tag/enumeration.md) | <font color=#ffb800>Medium</font> |