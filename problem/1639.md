---
title: 1639. é€šè¿‡ç»™å®šè¯å…¸æ„é€ ç›®æ ‡å­—ç¬¦ä¸²çš„æ–¹æ¡ˆæ•°
description: LeetCode 1639. é€šè¿‡ç»™å®šè¯å…¸æ„é€ ç›®æ ‡å­—ç¬¦ä¸²çš„æ–¹æ¡ˆæ•°é¢˜è§£ï¼ŒNumber of Ways to Form a Target String Given a Dictionaryï¼ŒåŒ…å«è§£é¢˜æ€è·¯ã€å¤æ‚åº¦åˆ†æä»¥åŠå®Œæ•´çš„ JavaScript ä»£ç å®ç°ã€‚
keywords:
  - LeetCode
  - 1639. é€šè¿‡ç»™å®šè¯å…¸æ„é€ ç›®æ ‡å­—ç¬¦ä¸²çš„æ–¹æ¡ˆæ•°
  - é€šè¿‡ç»™å®šè¯å…¸æ„é€ ç›®æ ‡å­—ç¬¦ä¸²çš„æ–¹æ¡ˆæ•°
  - Number of Ways to Form a Target String Given a Dictionary
  - è§£é¢˜æ€è·¯
  - æ•°ç»„
  - å­—ç¬¦ä¸²
  - åŠ¨æ€è§„åˆ’
---

# 1639. é€šè¿‡ç»™å®šè¯å…¸æ„é€ ç›®æ ‡å­—ç¬¦ä¸²çš„æ–¹æ¡ˆæ•°

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ•°ç»„`](/tag/array.md) [`å­—ç¬¦ä¸²`](/tag/string.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/number-of-ways-to-form-a-target-string-given-a-dictionary) [`LeetCode`](https://leetcode.com/problems/number-of-ways-to-form-a-target-string-given-a-dictionary)

## é¢˜ç›®

You are given a list of strings of the **same length** `words` and a string
`target`.

Your task is to form `target` using the given `words` under the following
rules:

- `target` should be formed from left to right.
- To form the `ith` character (**0-indexed**) of `target`, you can choose the `kth` character of the `jth` string in `words` if `target[i] = words[j][k]`.
- Once you use the `kth` character of the `jth` string of `words`, you **can no longer** use the `xth` character of any string in `words` where `x <= k`. In other words, all characters to the left of or at index `k` become unusuable for every string.
- Repeat the process until you form the string `target`.

**Notice** that you can use **multiple characters** from the **same string**
in `words` provided the conditions above are met.

Return _the number of ways to form`target` from `words`_. Since the answer may
be too large, return it **modulo** `10^9 + 7`.

**Example 1:**

> Input: words = ["acca","bbbb","caca"], target = "aba"
>
> Output: 6
>
> Explanation: There are 6 ways to form target.
>
> "aba" -> index 0 ("_a_ cca"), index 1 ("b _b_ bb"), index 3 ("cac _a_ ")
>
> "aba" -> index 0 ("_a_ cca"), index 2 ("bb _b_ b"), index 3 ("cac _a_ ")
>
> "aba" -> index 0 ("_a_ cca"), index 1 ("b _b_ bb"), index 3 ("acc _a_ ")
>
> "aba" -> index 0 ("_a_ cca"), index 2 ("bb _b_ b"), index 3 ("acc _a_ ")
>
> "aba" -> index 1 ("c _a_ ca"), index 2 ("bb _b_ b"), index 3 ("acc _a_ ")
>
> "aba" -> index 1 ("c _a_ ca"), index 2 ("bb _b_ b"), index 3 ("cac _a_ ")

**Example 2:**

> Input: words = ["abba","baab"], target = "bab"
>
> Output: 4
>
> Explanation: There are 4 ways to form target.
>
> "bab" -> index 0 ("_b_ aab"), index 1 ("b _a_ ab"), index 2 ("ab _b_ a")
>
> "bab" -> index 0 ("_b_ aab"), index 1 ("b _a_ ab"), index 3 ("baa _b_ ")
>
> "bab" -> index 0 ("_b_ aab"), index 2 ("ba _a_ b"), index 3 ("baa _b_ ")
>
> "bab" -> index 1 ("a _b_ ba"), index 2 ("ba _a_ b"), index 3 ("baa _b_ ")

**Constraints:**

- `1 <= words.length <= 1000`
- `1 <= words[i].length <= 1000`
- All strings in `words` have the same length.
- `1 <= target.length <= 1000`
- `words[i]` and `target` contain only lowercase English letters.

## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ `words` å’Œä¸€ä¸ªç›®æ ‡å­—ç¬¦ä¸² `target` ã€‚`words` ä¸­æ‰€æœ‰å­—ç¬¦ä¸²éƒ½ **é•¿åº¦ç›¸åŒ** ã€‚

ä½ çš„ç›®æ ‡æ˜¯ä½¿ç”¨ç»™å®šçš„ `words` å­—ç¬¦ä¸²åˆ—è¡¨æŒ‰ç…§ä¸‹è¿°è§„åˆ™æ„é€  `target` ï¼š

- ä»å·¦åˆ°å³ä¾æ¬¡æ„é€  `target` çš„æ¯ä¸€ä¸ªå­—ç¬¦ã€‚
- ä¸ºäº†å¾—åˆ° `target` ç¬¬ `i` ä¸ªå­—ç¬¦ï¼ˆä¸‹æ ‡ä» **0** å¼€å§‹ï¼‰ï¼Œå½“ `target[i] = words[j][k]` æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ `words` åˆ—è¡¨ä¸­ç¬¬ `j` ä¸ªå­—ç¬¦ä¸²çš„ç¬¬ `k` ä¸ªå­—ç¬¦ã€‚
- ä¸€æ—¦ä½ ä½¿ç”¨äº† `words` ä¸­ç¬¬ `j` ä¸ªå­—ç¬¦ä¸²çš„ç¬¬ `k` ä¸ªå­—ç¬¦ï¼Œä½ ä¸èƒ½å†ä½¿ç”¨ `words` å­—ç¬¦ä¸²åˆ—è¡¨ä¸­ä»»æ„å•è¯çš„ç¬¬ `x` ä¸ªå­—ç¬¦ï¼ˆ`x <= k`ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰€æœ‰å•è¯ä¸‹æ ‡å°äºç­‰äº `k` çš„å­—ç¬¦éƒ½ä¸èƒ½å†è¢«ä½¿ç”¨ã€‚
- è¯·ä½ é‡å¤æ­¤è¿‡ç¨‹ç›´åˆ°å¾—åˆ°ç›®æ ‡å­—ç¬¦ä¸² `target` ã€‚

**è¯·æ³¨æ„**ï¼Œåœ¨æ„é€ ç›®æ ‡å­—ç¬¦ä¸²çš„è¿‡ç¨‹ä¸­ï¼Œä½ å¯ä»¥æŒ‰ç…§ä¸Šè¿°è§„å®šä½¿ç”¨ `words` åˆ—è¡¨ä¸­ **åŒä¸€ä¸ªå­—ç¬¦ä¸²** çš„ **å¤šä¸ªå­—ç¬¦** ã€‚

è¯·ä½ è¿”å›ä½¿ç”¨ `words` æ„é€  `target` çš„æ–¹æ¡ˆæ•°ã€‚ç”±äºç­”æ¡ˆå¯èƒ½ä¼šå¾ˆå¤§ï¼Œè¯·å¯¹ `10^9 + 7` **å–ä½™** åè¿”å›ã€‚

ï¼ˆè¯‘è€…æ³¨ï¼šæ­¤é¢˜ç›®æ±‚çš„æ˜¯æœ‰å¤šå°‘ä¸ªä¸åŒçš„ `k` åºåˆ—ï¼Œè¯¦æƒ…è¯·è§ç¤ºä¾‹ã€‚ï¼‰

**ç¤ºä¾‹ 1ï¼š**

> **è¾“å…¥ï¼š** words = ["acca","bbbb","caca"], target = "aba"
>
> **è¾“å‡ºï¼š** 6
>
> **è§£é‡Šï¼š** æ€»å…±æœ‰ 6 ç§æ–¹æ³•æ„é€ ç›®æ ‡ä¸²ã€‚
>
> "aba" -> ä¸‹æ ‡ä¸º 0 ("**a** cca")ï¼Œä¸‹æ ‡ä¸º 1 ("b**b** bb")ï¼Œä¸‹æ ‡ä¸º 3 ("cac**a** ")
>
> "aba" -> ä¸‹æ ‡ä¸º 0 ("**a** cca")ï¼Œä¸‹æ ‡ä¸º 2 ("bb**b** b")ï¼Œä¸‹æ ‡ä¸º 3 ("cac**a** ")
>
> "aba" -> ä¸‹æ ‡ä¸º 0 ("**a** cca")ï¼Œä¸‹æ ‡ä¸º 1 ("b**b** bb")ï¼Œä¸‹æ ‡ä¸º 3 ("acc**a** ")
>
> "aba" -> ä¸‹æ ‡ä¸º 0 ("**a** cca")ï¼Œä¸‹æ ‡ä¸º 2 ("bb**b** b")ï¼Œä¸‹æ ‡ä¸º 3 ("acc**a** ")
>
> "aba" -> ä¸‹æ ‡ä¸º 1 ("c**a** ca")ï¼Œä¸‹æ ‡ä¸º 2 ("bb**b** b")ï¼Œä¸‹æ ‡ä¸º 3 ("acc**a** ")
>
> "aba" -> ä¸‹æ ‡ä¸º 1 ("c**a** ca")ï¼Œä¸‹æ ‡ä¸º 2 ("bb**b** b")ï¼Œä¸‹æ ‡ä¸º 3 ("cac**a** ")

**ç¤ºä¾‹ 2ï¼š**

> **è¾“å…¥ï¼š** words = ["abba","baab"], target = "bab"
>
> **è¾“å‡ºï¼š** 4
>
> **è§£é‡Šï¼š** æ€»å…±æœ‰ 4 ç§ä¸åŒå½¢æˆ target çš„æ–¹æ³•ã€‚
>
> "bab" -> ä¸‹æ ‡ä¸º 0 ("**b** aab")ï¼Œä¸‹æ ‡ä¸º 1 ("b**a** ab")ï¼Œä¸‹æ ‡ä¸º 2 ("ab**b** a")
>
> "bab" -> ä¸‹æ ‡ä¸º 0 ("**b** aab")ï¼Œä¸‹æ ‡ä¸º 1 ("b**a** ab")ï¼Œä¸‹æ ‡ä¸º 3 ("baa**b** ")
>
> "bab" -> ä¸‹æ ‡ä¸º 0 ("**b** aab")ï¼Œä¸‹æ ‡ä¸º 2 ("ba**a** b")ï¼Œä¸‹æ ‡ä¸º 3 ("baa**b** ")
>
> "bab" -> ä¸‹æ ‡ä¸º 1 ("a**b** ba")ï¼Œä¸‹æ ‡ä¸º 2 ("ba**a** b")ï¼Œä¸‹æ ‡ä¸º 3 ("baa**b** ")

**ç¤ºä¾‹ 3ï¼š**

> **è¾“å…¥ï¼š** words = ["abcd"], target = "abcd"
>
> **è¾“å‡ºï¼š** 1

**ç¤ºä¾‹ 4ï¼š**

> **è¾“å…¥ï¼š** words = ["abab","baba","abba","baab"], target = "abba"
>
> **è¾“å‡ºï¼š** 16

**æç¤ºï¼š**

- `1 <= words.length <= 1000`
- `1 <= words[i].length <= 1000`
- `words` ä¸­æ‰€æœ‰å•è¯é•¿åº¦ç›¸åŒã€‚
- `1 <= target.length <= 1000`
- `words[i]` å’Œ `target` éƒ½ä»…åŒ…å«å°å†™è‹±æ–‡å­—æ¯ã€‚

## è§£é¢˜æ€è·¯

è¿™é“é¢˜çš„æœ¬è´¨æ˜¯ä¸€ä¸ªç»„åˆé—®é¢˜ï¼Œä½¿ç”¨åŠ¨æ€è§„åˆ’å¯ä»¥æœ‰æ•ˆè§£å†³ã€‚

- è®¾ `dp[j]` è¡¨ç¤ºæ„é€  `target` çš„å‰ `j` ä¸ªå­—ç¬¦çš„æ–¹æ³•æ€»æ•°ã€‚
- éå† `words` çš„åˆ—ï¼Œä»å³å‘å·¦æ›´æ–° `dp` æ•°ç»„ï¼Œè®¡ç®—æ¯åˆ—å¯¹ `target` å„ä¸ªä½ç½®çš„è´¡çŒ®ã€‚
- é€šè¿‡é¢„å¤„ç†ç»Ÿè®¡ `words` å„åˆ—æ¯ä¸ªå­—ç¬¦çš„å‡ºç°æ¬¡æ•°ï¼ŒåŠ é€Ÿè®¡ç®—ã€‚

**1. ç»Ÿè®¡é¢‘ç‡**

- éå† `words`ï¼Œç»Ÿè®¡æ¯åˆ—æ¯ä¸ªå­—ç¬¦çš„å‡ºç°æ¬¡æ•°ï¼Œå­˜å‚¨ä¸ºä¸€ä¸ªé¢‘ç‡çŸ©é˜µ `freq`ã€‚

**2. åˆå§‹åŒ– DP æ•°ç»„**

- åˆå§‹åŒ– `dp` æ•°ç»„ï¼š
  - `dp[j]` è¡¨ç¤ºæ„é€  `target[:j]` çš„æ–¹æ³•æ•°ã€‚
  - åˆå§‹åŒ–ï¼š`dp[0] = 1`ï¼Œè¡¨ç¤ºæ„é€ ç©ºå­—ç¬¦ä¸²çš„æ–¹å¼æ•°ä¸º 1ã€‚

**3. é€åˆ—æ›´æ–° DP**

- å¯¹æ¯åˆ—è¿›è¡Œå¤„ç†ï¼Œä»å³å‘å·¦æ›´æ–° `dp` æ•°ç»„ï¼š
  - å¦‚æœå½“å‰åˆ—èƒ½å¤Ÿä¸ºç›®æ ‡å­—ç¬¦ä¸²çš„ç¬¬ `j` ä¸ªå­—ç¬¦æä¾›ä¸€ä¸ªå­—ç¬¦ï¼š
    - æ›´æ–° `dp[j] += dp[j - 1] * freq[col][target[j - 1]]`ã€‚
  - ä½¿ç”¨æ¨¡ `10^9 + 7` é˜²æ­¢æº¢å‡ºã€‚

**4. è¿”å›ç»“æœ**

- æœ€ç»ˆ `dp[target.length]` å³ä¸ºæ‰€æ±‚ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š

  - ç»Ÿè®¡é¢‘ç‡ï¼š`O(m * w)`ï¼Œå…¶ä¸­ `m` æ˜¯ `words` çš„åˆ—æ•°ï¼Œ`w` æ˜¯è¡Œæ•°ã€‚
  - åŠ¨æ€è§„åˆ’æ›´æ–°ï¼š`O(m * n)`ï¼Œå…¶ä¸­ `n` æ˜¯ `target` çš„é•¿åº¦ã€‚
  - æ€»æ—¶é—´å¤æ‚åº¦ï¼š`O(m * (w + n))`ã€‚

- **ç©ºé—´å¤æ‚åº¦**ï¼š
  - é¢‘ç‡æ•°ç»„ `freq`ï¼š`O(26 * m)`ã€‚
  - åŠ¨æ€è§„åˆ’æ•°ç»„ `dp`ï¼š`O(n)`ã€‚
  - æ€»ç©ºé—´å¤æ‚åº¦ï¼š`O(26 * m + n)`ã€‚

## ä»£ç 

```javascript
/**
 * @param {string[]} words
 * @param {string} target
 * @return {number}
 */
var numWays = function (words, target) {
	const MOD = 1e9 + 7;
	const m = words[0].length; // åˆ—æ•°
	const n = target.length;

	// ç»Ÿè®¡æ¯åˆ—å­—ç¬¦é¢‘ç‡
	let freq = Array.from({ length: m }, () => Array(26).fill(0));
	for (let word of words) {
		for (let col = 0; col < m; col++) {
			freq[col][word.charCodeAt(col) - 'a'.charCodeAt(0)]++;
		}
	}

	// åˆå§‹åŒ– dp æ•°ç»„
	let dp = Array(n + 1).fill(0);
	dp[0] = 1;

	// éå†åˆ—ï¼Œä»å³å‘å·¦æ›´æ–° dp æ•°ç»„
	for (let col = 0; col < m; col++) {
		for (let j = n; j >= 1; j--) {
			const charIndex = target.charCodeAt(j - 1) - 'a'.charCodeAt(0);
			dp[j] += dp[j - 1] * freq[col][charIndex];
			dp[j] %= MOD;
		}
	}

	return dp[n];
};
```
