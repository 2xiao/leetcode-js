# [2676. èŠ‚æµ](https://leetcode.com/problems/throttle)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/throttle)

## é¢˜ç›®



## è§£é¢˜æ€è·¯

è¿™ä¸ª `throttle` å‡½æ•°çš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡æ§åˆ¶å‡½æ•°çš„æ‰§è¡Œé¢‘ç‡ï¼Œé˜²æ­¢åœ¨çŸ­æ—¶é—´å†…é¢‘ç¹è°ƒç”¨åŒä¸€ä¸ªå‡½æ•°ã€‚é€šè¿‡è®¾ç½®ä¸€ä¸ªå»¶è¿Ÿæ—¶é—´ `t`ï¼Œå¯ä»¥ç¡®ä¿åœ¨æŸä¸ªæ—¶é—´çª—å£å†…ï¼Œå‡½æ•°åªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚å¦‚æœåœ¨å»¶è¿ŸæœŸé—´å†æ¬¡è°ƒç”¨å‡½æ•°ï¼Œå®ƒä¼šä¿å­˜æœ€æ–°çš„å‚æ•°ï¼Œå¹¶åœ¨å»¶è¿Ÿç»“æŸåä½¿ç”¨è¿™äº›å‚æ•°å†æ¬¡æ‰§è¡Œå‡½æ•°ã€‚

1. **åˆå§‹åŒ–å˜é‡**ï¼š

   - `pending`: ç”¨æ¥æ ‡è¯†å½“å‰æ˜¯å¦æœ‰ä¸€ä¸ªæ­£åœ¨è¿›è¡Œçš„å»¶è¿Ÿè®¡æ—¶ï¼Œå¦‚æœä¸º `true`ï¼Œæ„å‘³ç€å½“å‰å‡½æ•°è°ƒç”¨æ­£åœ¨è¢«èŠ‚æµï¼Œä¸å…è®¸ç«‹å³å†æ¬¡è°ƒç”¨ã€‚
   - `nestArgs`: ç”¨æ¥å­˜å‚¨æœ€æ–°çš„å‡½æ•°å‚æ•°ï¼Œå½“èŠ‚æµæœŸé—´å†æ¬¡è°ƒç”¨å‡½æ•°æ—¶ï¼Œå®ƒä¼šä¿å­˜æœ€æ–°ä¼ é€’çš„å‚æ•°ã€‚

2. **ç«‹å³æ‰§è¡Œ**ï¼š

   - åœ¨æ²¡æœ‰å»¶è¿Ÿçš„æƒ…å†µä¸‹ï¼ˆ`pending` ä¸º `false`ï¼‰ï¼Œç«‹å³è°ƒç”¨ä¼ é€’çš„å‡½æ•° `fn(...args)`ï¼Œå¹¶å°† `pending` è®¾ä¸º `true`ï¼Œè¡¨ç¤ºæ­¤æ—¶å‡½æ•°è¿›å…¥èŠ‚æµçŠ¶æ€ã€‚
   - è®¾ç½®ä¸€ä¸ª `setTimeout`ï¼Œç¡®ä¿åœ¨å»¶è¿Ÿ `t` æ¯«ç§’åï¼Œé‡ç½® `pending` çŠ¶æ€ï¼Œä»¥å…è®¸å‡½æ•°åœ¨å»¶è¿Ÿç»“æŸåå†æ¬¡æ‰§è¡Œã€‚

3. **å»¶è¿ŸæœŸé—´å­˜å‚¨æœ€æ–°å‚æ•°**ï¼š
   - å½“å»¶è¿Ÿæ—¶é—´å†…å†æ¬¡è°ƒç”¨èŠ‚æµå‡½æ•°æ—¶ï¼Œæ›´æ–°æœ€æ–°çš„å‚æ•°åˆ° `nestArgs`ï¼Œç¡®ä¿æœ€æ–°çš„ä¸€æ¬¡è°ƒç”¨ä¸ä¼šä¸¢å¤±ã€‚
4. **å»¶è¿Ÿç»“æŸåæ‰§è¡Œæœ€æ–°å‚æ•°**ï¼š
   - ä¸€æ—¦å»¶è¿Ÿç»“æŸï¼Œæ£€æŸ¥æ˜¯å¦å­˜åœ¨å­˜å‚¨çš„æœ€æ–°å‚æ•°ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™å†æ¬¡é€’å½’è°ƒç”¨èŠ‚æµå‡½æ•°ï¼Œä½¿ç”¨æœ€æ–°çš„å‚æ•°è¿›è¡Œè°ƒç”¨ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(1)`ï¼Œæ¯æ¬¡è°ƒç”¨ `throttle` å‡½æ•°çš„æ—¶é—´å¤æ‚åº¦ä¸º `O(1)`ï¼Œå› ä¸ºå®ƒåªæ˜¯ç®€å•çš„æ£€æŸ¥è®¡æ—¶å™¨å’Œå­˜å‚¨å‚æ•°ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(1)`ï¼Œä¸»è¦ç”¨äºå­˜å‚¨æœ€æ–°å‚æ•° `lastArgs`ã€‚

## ä»£ç 

```javascript
/**
 * @param {Function} fn
 * @param {number} t milliseconds
 * @return {Function}
 */
var throttle = function (fn, t) {
	let pending = false,
		nestArgs;
	const throttleFn = function (...args) {
		// æ›´æ–°æœ€æ–°çš„å‚æ•°
		nestArgs = args;
		if (!pending) {
			// ç«‹å³è°ƒç”¨
			fn(...args);
			pending = true;
			nestArgs = undefined;
			setTimeout(() => {
				pending = false;
				// åœ¨å»¶è¿Ÿç»“æŸåï¼Œä½¿ç”¨æœ€æ–°å‚æ•°é€’å½’è°ƒç”¨èŠ‚æµå‡½æ•°
				if (nestArgs) {
					throttleFn(...nestArgs);
				}
			}, t);
		}
	};
	return throttleFn;
};

/**
 * const throttled = throttle(console.log, 100);
 * throttled("log"); // logged immediately.
 * throttled("log"); // logged at t=100ms.
 */

/**
 * // æµ‹è¯•å‡½æ•°
 * function runTest() {
 * 	const calls = [
 * 		{ t: 50, inputs: [1] },
 * 		{ t: 75, inputs: [2] },
 * 		{ t: 90, inputs: [8] },
 * 		{ t: 140, inputs: [5, 7] },
 * 		{ t: 300, inputs: [9, 4] }
 * 	];
 *
 * 	const results = [];
 * 	const start = performance.now();
 * 	const throttledLog = throttle((...args) => {
 * 		const time = performance.now();
 * 		results.push({ t: Math.floor(time), inputs: args });
 * 		console.log(`Executed at ${time - start}ms with arguments:`, args);
 * 	}, 70);
 *
 * 	calls.forEach((call) => {
 * 		setTimeout(() => {
 * 			throttledLog(...call.inputs);
 * 		}, call.t);
 * 	});
 *
 * 	// å»¶è¿Ÿ300msåæ‰“å°ç»“æœ
 * 	setTimeout(() => {
 * 		console.log('Final Results:', results);
 * 	}, 400);
 * }
 * runTest();
 */
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 2627 | [å‡½æ•°é˜²æŠ–](https://leetcode.com/problems/debounce) | [[âœ“]](/problem/2627.md) |  | <font color=#ffb800>Medium</font> |
| 2636 | [Promise å¯¹è±¡æ± ](https://leetcode.com/problems/promise-pool) | [[âœ“]](/problem/2636.md) |  | <font color=#ffb800>Medium</font> |
| 2637 | [æœ‰æ—¶é—´é™åˆ¶çš„ Promise å¯¹è±¡](https://leetcode.com/problems/promise-time-limit) | [[âœ“]](/problem/2637.md) |  | <font color=#ffb800>Medium</font> |