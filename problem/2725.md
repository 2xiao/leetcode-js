# [2725. é—´éš”å–æ¶ˆ](https://leetcode.com/problems/interval-cancellation)

ğŸŸ¢ <font color=#15bd66>Easy</font>&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/interval-cancellation)

## é¢˜ç›®

<p>ç°ç»™å®šä¸€ä¸ªå‡½æ•° <code>fn</code>ï¼Œä¸€ä¸ªå‚æ•°æ•°ç»„ <code>args</code> å’Œä¸€ä¸ªæ—¶é—´é—´éš” <code>t</code>ï¼Œè¿”å›ä¸€ä¸ªå–æ¶ˆå‡½æ•° <code>cancelFn</code>ã€‚</p>

<p>åœ¨ç»è¿‡ <code>cancelTimeMs</code> æ¯«ç§’çš„å»¶è¿Ÿåï¼Œå°†è°ƒç”¨è¿”å›çš„å–æ¶ˆå‡½æ•° <code>cancelFn</code>ã€‚</p>

<pre>
setTimeout(cancelFn, cancelTimeMs)
</pre>

<p>å‡½æ•° <code>fn</code> åº”ç«‹å³ä½¿ç”¨å‚æ•° <code>args</code> è°ƒç”¨ï¼Œç„¶åæ¯éš” <code>t</code> æ¯«ç§’è°ƒç”¨ä¸€æ¬¡ï¼Œç›´åˆ°åœ¨ <code>cancelTimeMs</code> æ¯«ç§’æ—¶è°ƒç”¨ <code>cancelFn</code>ã€‚</p>

<p>&nbsp;</p>

<p><strong class="example">ç¤ºä¾‹ 1ï¼š</strong></p>

<pre>
<b>è¾“å…¥ï¼š</b>fn = (x) =&gt; x * 2, args = [4], t = 35, cancelT = 190
<b>è¾“å‡ºï¼š</b>
[
   {"time": 0, "returned": 8},
   {"time": 35, "returned": 8},
   {"time": 70, "returned": 8},
   {"time": 105, "returned": 8},
   {"time": 140, "returned": 8},
   {"time": 175, "returned": 8}
]
<strong>è§£é‡Šï¼š</strong> 
const cancelTimeMs = 190;
const cancelFn = cancellable((x) =&gt; x * 2, [4], 35);
setTimeout(cancelFn, cancelTimeMs);

æ¯éš” 35msï¼Œè°ƒç”¨ fn(4)ã€‚ç›´åˆ° t=190msï¼Œç„¶åå–æ¶ˆã€‚
ç¬¬ä¸€æ¬¡è°ƒç”¨ fn æ˜¯åœ¨ 0msã€‚fn(4) è¿”å› 8ã€‚
ç¬¬äºŒæ¬¡è°ƒç”¨ fn æ˜¯åœ¨ 35msã€‚fn(4) è¿”å› 8ã€‚
ç¬¬ä¸‰æ¬¡è°ƒç”¨ fn æ˜¯åœ¨ 70msã€‚fn(4) è¿”å› 8ã€‚
ç¬¬å››æ¬¡è°ƒç”¨ fn æ˜¯åœ¨&nbsp;105msã€‚fn(4) è¿”å› 8ã€‚
ç¬¬äº”æ¬¡è°ƒç”¨ fn æ˜¯åœ¨ 140msã€‚fn(4) è¿”å› 8ã€‚
ç¬¬å…­æ¬¡è°ƒç”¨ fn æ˜¯åœ¨ 175msã€‚fn(4) è¿”å› 8ã€‚
åœ¨ t=190ms æ—¶å–æ¶ˆ
</pre>

<p><strong class="example">ç¤ºä¾‹ 2ï¼š</strong></p>

<pre>
<b>è¾“å…¥ï¼š</b>fn = (x1, x2) =&gt; (x1 * x2), args = [2, 5], t = 30, cancelT = 165
<strong>è¾“å‡ºï¼š</strong> 
[
   {"time": 0, "returned": 10},
   {"time": 30, "returned": 10},
   {"time": 60, "returned": 10},
   {"time": 90, "returned": 10},
   {"time": 120, "returned": 10},
   {"time": 150, "returned": 10}
]
<strong>è§£é‡Šï¼š</strong>
const cancelTimeMs = 165; 
const cancelFn = cancellable((x1, x2) =&gt; (x1 * x2), [2, 5], 30) 
setTimeout(cancelFn, cancelTimeMs)

æ¯éš” 30msï¼Œè°ƒç”¨ fn(2, 5)ã€‚ç›´åˆ° t=165msï¼Œç„¶åå–æ¶ˆã€‚
ç¬¬ä¸€æ¬¡è°ƒç”¨ fn æ˜¯åœ¨ 0ms
ç¬¬äºŒæ¬¡è°ƒç”¨ fn æ˜¯åœ¨ 30ms
ç¬¬ä¸‰æ¬¡è°ƒç”¨ fn æ˜¯åœ¨ 60ms
ç¬¬å››æ¬¡è°ƒç”¨ fn æ˜¯åœ¨&nbsp;90ms
ç¬¬äº”æ¬¡è°ƒç”¨ fn æ˜¯åœ¨ 120ms
ç¬¬å…­æ¬¡è°ƒç”¨ fn æ˜¯åœ¨ 150ms
åœ¨ 165ms å–æ¶ˆ
</pre>

<p><strong class="example">ç¤ºä¾‹ 3ï¼š</strong></p>

<pre>
<b>è¾“å…¥ï¼š</b>fn = (x1, x2, x3) =&gt; (x1 + x2 + x3), args = [5, 1, 3], t = 50, cancelT = 180
<b>è¾“å‡ºï¼š</b>
[
   {"time": 0, "returned": 9},
   {"time": 50, "returned": 9},
   {"time": 100, "returned": 9},
   {"time": 150, "returned": 9}
]
<b>è§£é‡Šï¼š</b>
const cancelTimeMs = 180;
const cancelFn = cancellable((x1, x2, x3) =&gt; (x1 + x2 + x3), [5, 1, 3], 50)
setTimeout(cancelFn, cancelTimeMs)

æ¯éš” 50msï¼Œè°ƒç”¨ fn(5, 1, 3)ã€‚ç›´åˆ° t=180msï¼Œç„¶åå–æ¶ˆã€‚
ç¬¬ä¸€æ¬¡è°ƒç”¨ fn æ˜¯åœ¨ 0ms
ç¬¬äºŒæ¬¡è°ƒç”¨ fn æ˜¯åœ¨ 50ms
ç¬¬ä¸‰æ¬¡è°ƒç”¨ fn æ˜¯åœ¨ 100ms
ç¬¬å››æ¬¡è°ƒç”¨ fn æ˜¯åœ¨&nbsp;150ms
åœ¨ 180ms å–æ¶ˆ
</pre>

<p>&nbsp;</p>

<p><strong>æç¤ºï¼š</strong></p>

<ul>
	<li><code>fn</code> æ˜¯ä¸€ä¸ªå‡½æ•°</li>
	<li><code>args</code> æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ JSON æ•°ç»„</li>
	<li><code>1 &lt;= args.length &lt;= 10</code></li>
	<li><code><font face="monospace">30 &lt;= t &lt;= 100</font></code></li>
	<li><code><font face="monospace">10 &lt;= cancelT &lt;= 500</font></code></li>
</ul>


## è§£é¢˜æ€è·¯

1. é¢˜ç›®è¦æ±‚å‡½æ•° `fn` åº”ç«‹å³ä½¿ç”¨å‚æ•° `args` è°ƒç”¨ï¼Œç„¶åæ¯éš” `t` æ¯«ç§’è°ƒç”¨ä¸€æ¬¡ï¼Œæ‰€ä»¥ç«‹å³æ‰‹åŠ¨æ‰§è¡Œ `fn` ä¸€æ¬¡ã€‚
2. ä½¿ç”¨ `setInterval` æ¥å¯åŠ¨å®šæ—¶å™¨ï¼Œæ¯éš” `delay` æ¯«ç§’ä¼šæ‰§è¡Œä¸€æ¬¡ä¼ å…¥çš„å‡½æ•° `fn`ï¼Œç¬¬ä¸€æ¬¡æ‰§è¡Œå‘ç”Ÿåœ¨ `delay` æ¯«ç§’ä¹‹åã€‚
3. `setInterval` è¿”å›ä¸€ä¸ª `intervalId`ï¼Œè¿™æ˜¯å”¯ä¸€æ ‡è¯†è¿™ä¸ªå®šæ—¶å™¨çš„å€¼ï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨ `clearInterval(intervalId)` æ¥å–æ¶ˆå®šæ—¶å™¨ã€‚
4. è¿”å›å–æ¶ˆå‡½æ•°ï¼Œè¿™ä¸ªå–æ¶ˆå‡½æ•°åœ¨è¢«è°ƒç”¨æ—¶ï¼Œä¼šåœæ­¢å®šæ—¶å™¨çš„ç»§ç»­æ‰§è¡Œã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(1)`ï¼Œå› ä¸º `setInterval` å’Œ `clearInterval` éƒ½æ˜¯å¸¸æ•°æ—¶é—´æ“ä½œã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(1)`ï¼Œåªå­˜å‚¨äº† `intervalId` ä½œä¸ºå”¯ä¸€çš„å®šæ—¶å™¨æ ‡è¯†ã€‚

## ä»£ç 

```javascript
/**
 * @param {Function} fn
 * @param {Array} args
 * @param {number} t
 * @return {Function}
 */
var cancellable = function (fn, args, t) {
	// ç«‹å³è°ƒç”¨ä¸€æ¬¡ fn
	fn(...args);

	// ä½¿ç”¨ setInterval å¯åŠ¨å®šæ—¶å™¨ï¼Œæ¯éš” t æ¯«ç§’æ‰§è¡Œä¸€æ¬¡ fn
	const intervalId = setInterval(() => fn(...args), t);

	// è¿”å›ä¸€ä¸ªå–æ¶ˆå‡½æ•°ï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨è¯¥å‡½æ•°æ¥æ¸…é™¤å®šæ—¶å™¨
	const cancelFn = () => clearInterval(intervalId);
	return cancelFn;
};

/**
 *  const result = [];
 *
 *  const fn = (x) => x * 2;
 *  const args = [4], t = 35, cancelTimeMs = 190;
 *
 *  const start = performance.now();
 *
 *  const log = (...argsArr) => {
 *      const diff = Math.floor(performance.now() - start);
 *      result.push({"time": diff, "returned": fn(...argsArr)});
 *  }
 *
 *  const cancel = cancellable(log, args, t);
 *
 *  setTimeout(cancel, cancelTimeMs);
 *
 *  setTimeout(() => {
 *      console.log(result);
 *      // [
 *      //     {"time":0,"returned":8},
 *      //     {"time":35,"returned":8},
 *      //     {"time":70,"returned":8},
 *      //     {"time":105,"returned":8},
 *      //     {"time":140,"returned":8},
 *      //     {"time":175,"returned":8}
 *      // ]
 *  }, cancelTimeMs + t + 15)
 */
```
