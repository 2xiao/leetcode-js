---
title: 2725. é—´éš”å–æ¶ˆ
description: LeetCode 2725. é—´éš”å–æ¶ˆé¢˜è§£ï¼ŒInterval Cancellationï¼ŒåŒ…å«è§£é¢˜æ€è·¯ã€å¤æ‚åº¦åˆ†æä»¥åŠå®Œæ•´çš„ JavaScript ä»£ç å®ç°ã€‚
keywords:
  - LeetCode
  - 2725. é—´éš”å–æ¶ˆ
  - é—´éš”å–æ¶ˆ
  - Interval Cancellation
  - è§£é¢˜æ€è·¯
---

# 2725. é—´éš”å–æ¶ˆ

ğŸŸ¢ <font color=#15bd66>Easy</font>&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/interval-cancellation) [`LeetCode`](https://leetcode.com/problems/interval-cancellation)

## é¢˜ç›®

Given a function `fn`, an array of arguments `args`, and an interval time `t`,
return a cancel function `cancelFn`.

After a delay of `cancelTimeMs`, the returned cancel function `cancelFn` will
be invoked.

> setTimeout(cancelFn, cancelTimeMs)

The function `fn` should be called with `args` immediately and then called
again every `t` milliseconds until `cancelFn` is called at `cancelTimeMs` ms.

**Example 1:**

> Input: fn = (x) => x \* 2, args = [4], t = 35
>
> Output:
>
> [
>
> {"time": 0, "returned": 8},
>
> {"time": 35, "returned": 8},
>
> {"time": 70, "returned": 8},
>
> {"time": 105, "returned": 8},
>
> {"time": 140, "returned": 8},
>
> {"time": 175, "returned": 8}
>
> ]
>
> Explanation:
>
> const cancelTimeMs = 190;
>
> const cancelFn = cancellable((x) => x \* 2, [4], 35);
>
> setTimeout(cancelFn, cancelTimeMs);
>
> Every 35ms, fn(4) is called. Until t=190ms, then it is cancelled.
>
> 1st fn call is at 0ms. fn(4) returns 8.
>
> 2nd fn call is at 35ms. fn(4) returns 8.
>
> 3rd fn call is at 70ms. fn(4) returns 8.
>
> 4th fn call is at 105ms. fn(4) returns 8.
>
> 5th fn call is at 140ms. fn(4) returns 8.
>
> 6th fn call is at 175ms. fn(4) returns 8.
>
> Cancelled at 190ms

**Example 2:**

> Input: fn = (x1, x2) => (x1 \* x2), args = [2, 5], t = 30
>
> Output:
>
> [
>
> {"time": 0, "returned": 10},
>
> {"time": 30, "returned": 10},
>
> {"time": 60, "returned": 10},
>
> {"time": 90, "returned": 10},
>
> {"time": 120, "returned": 10},
>
> {"time": 150, "returned": 10}
>
> ]
>
> Explanation:
>
> const cancelTimeMs = 165;
>
> const cancelFn = cancellable((x1, x2) => (x1 \* x2), [2, 5], 30)
>
> setTimeout(cancelFn, cancelTimeMs)
>
> Every 30ms, fn(2, 5) is called. Until t=165ms, then it is cancelled.
>
> 1st fn call is at 0ms
>
> 2nd fn call is at 30ms
>
> 3rd fn call is at 60ms
>
> 4th fn call is at 90ms
>
> 5th fn call is at 120ms
>
> 6th fn call is at 150ms
>
> Cancelled at 165ms

**Example 3:**

> Input: fn = (x1, x2, x3) => (x1 + x2 + x3), args = [5, 1, 3], t = 50
>
> Output:
>
> [
>
> {"time": 0, "returned": 9},
>
> {"time": 50, "returned": 9},
>
> {"time": 100, "returned": 9},
>
> {"time": 150, "returned": 9}
>
> ]
>
> Explanation:
>
> const cancelTimeMs = 180;
>
> const cancelFn = cancellable((x1, x2, x3) => (x1 + x2 + x3), [5, 1, 3], 50)
>
> setTimeout(cancelFn, cancelTimeMs)
>
> Every 50ms, fn(5, 1, 3) is called. Until t=180ms, then it is cancelled.
>
> 1st fn call is at 0ms
>
> 2nd fn call is at 50ms
>
> 3rd fn call is at 100ms
>
> 4th fn call is at 150ms
>
> Cancelled at 180ms

**Constraints:**

- `fn` is a function
- `args` is a valid JSON array
- `1 <= args.length <= 10`
- `30 <= t <= 100`
- `10 <= cancelTimeMs <= 500`

## é¢˜ç›®å¤§æ„

ç°ç»™å®šä¸€ä¸ªå‡½æ•° `fn`ï¼Œä¸€ä¸ªå‚æ•°æ•°ç»„ `args` å’Œä¸€ä¸ªæ—¶é—´é—´éš” `t`ï¼Œè¿”å›ä¸€ä¸ªå–æ¶ˆå‡½æ•° `cancelFn`ã€‚

åœ¨ç»è¿‡ `cancelTimeMs` æ¯«ç§’çš„å»¶è¿Ÿåï¼Œå°†è°ƒç”¨è¿”å›çš„å–æ¶ˆå‡½æ•° `cancelFn`ã€‚

> setTimeout(cancelFn, cancelTimeMs)

å‡½æ•° `fn` åº”ç«‹å³ä½¿ç”¨å‚æ•° `args` è°ƒç”¨ï¼Œç„¶åæ¯éš” `t` æ¯«ç§’è°ƒç”¨ä¸€æ¬¡ï¼Œç›´åˆ°åœ¨ `cancelTimeMs` æ¯«ç§’æ—¶è°ƒç”¨ `cancelFn`ã€‚

**æç¤ºï¼š**

- `fn` æ˜¯ä¸€ä¸ªå‡½æ•°
- `args` æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ JSON æ•°ç»„
- `1 <= args.length <= 10`
- `30 <= t <= 100`
- `10 <= cancelT <= 500`

## è§£é¢˜æ€è·¯

1. é¢˜ç›®è¦æ±‚å‡½æ•° `fn` åº”ç«‹å³ä½¿ç”¨å‚æ•° `args` è°ƒç”¨ï¼Œç„¶åæ¯éš” `t` æ¯«ç§’è°ƒç”¨ä¸€æ¬¡ï¼Œæ‰€ä»¥ç«‹å³æ‰‹åŠ¨æ‰§è¡Œ `fn` ä¸€æ¬¡ã€‚
2. ä½¿ç”¨ `setInterval` æ¥å¯åŠ¨å®šæ—¶å™¨ï¼Œæ¯éš” `delay` æ¯«ç§’ä¼šæ‰§è¡Œä¸€æ¬¡ä¼ å…¥çš„å‡½æ•° `fn`ï¼Œç¬¬ä¸€æ¬¡æ‰§è¡Œå‘ç”Ÿåœ¨ `delay` æ¯«ç§’ä¹‹åã€‚
3. `setInterval` è¿”å›ä¸€ä¸ª `intervalId`ï¼Œè¿™æ˜¯å”¯ä¸€æ ‡è¯†è¿™ä¸ªå®šæ—¶å™¨çš„å€¼ï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨ `clearInterval(intervalId)` æ¥å–æ¶ˆå®šæ—¶å™¨ã€‚
4. è¿”å›å–æ¶ˆå‡½æ•°ï¼Œè¿™ä¸ªå–æ¶ˆå‡½æ•°åœ¨è¢«è°ƒç”¨æ—¶ï¼Œä¼šåœæ­¢å®šæ—¶å™¨çš„ç»§ç»­æ‰§è¡Œã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(1)`ï¼Œå› ä¸º `setInterval` å’Œ `clearInterval` éƒ½æ˜¯å¸¸æ•°æ—¶é—´æ“ä½œã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(1)`ï¼Œåªå­˜å‚¨äº† `intervalId` ä½œä¸ºå”¯ä¸€çš„å®šæ—¶å™¨æ ‡è¯†ã€‚

## ä»£ç 

```javascript
/**
 * @param {Function} fn
 * @param {Array} args
 * @param {number} t
 * @return {Function}
 */
var cancellable = function (fn, args, t) {
	// ç«‹å³è°ƒç”¨ä¸€æ¬¡ fn
	fn(...args);

	// ä½¿ç”¨ setInterval å¯åŠ¨å®šæ—¶å™¨ï¼Œæ¯éš” t æ¯«ç§’æ‰§è¡Œä¸€æ¬¡ fn
	const intervalId = setInterval(() => fn(...args), t);

	// è¿”å›ä¸€ä¸ªå–æ¶ˆå‡½æ•°ï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨è¯¥å‡½æ•°æ¥æ¸…é™¤å®šæ—¶å™¨
	const cancelFn = () => clearInterval(intervalId);
	return cancelFn;
};

/**
 *  const result = [];
 *
 *  const fn = (x) => x * 2;
 *  const args = [4], t = 35, cancelTimeMs = 190;
 *
 *  const start = performance.now();
 *
 *  const log = (...argsArr) => {
 *      const diff = Math.floor(performance.now() - start);
 *      result.push({"time": diff, "returned": fn(...argsArr)});
 *  }
 *
 *  const cancel = cancellable(log, args, t);
 *
 *  setTimeout(cancel, cancelTimeMs);
 *
 *  setTimeout(() => {
 *      console.log(result);
 *      // [
 *      //     {"time":0,"returned":8},
 *      //     {"time":35,"returned":8},
 *      //     {"time":70,"returned":8},
 *      //     {"time":105,"returned":8},
 *      //     {"time":140,"returned":8},
 *      //     {"time":175,"returned":8}
 *      // ]
 *  }, cancelTimeMs + t + 15)
 */
```
