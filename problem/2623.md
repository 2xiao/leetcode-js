---
title: 2623. è®°å¿†å‡½æ•°
description: LeetCode,2623. è®°å¿†å‡½æ•°,è®°å¿†å‡½æ•°,Memoize,è§£é¢˜æ€è·¯
keywords:
  - LeetCode
  - 2623. è®°å¿†å‡½æ•°
  - è®°å¿†å‡½æ•°
  - Memoize
  - è§£é¢˜æ€è·¯
---

# 2623. è®°å¿†å‡½æ•°

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/memoize) [`LeetCode`](https://leetcode.com/problems/memoize)

## é¢˜ç›®

Given a function `fn`, return a **memoized** version of that function.

A **memoized **function is a function that will never be called twice with
the same inputs. Instead it will return a cached value.

You can assume there are **3** possible input functions: `sum`, `fib`, and `factorial`.

- `sum` accepts two integers `a` and `b` and returns `a + b`. Assume that if a value has already been cached for the arguments `(b, a)` where `a != b`, it cannot be used for the arguments `(a, b)`. For example, if the arguments are `(3, 2)` and `(2, 3)`, two separate calls should be made.
- `fib` accepts a single integer `n` and returns `1` if `n <= 1` or `fib(n - 1) + fib(n - 2)` otherwise.
- `factorial` accepts a single integer `n` and returns `1` if `n <= 1` or `factorial(n - 1) * n` otherwise.

**Example 1:**

> Input:
>
> fnName = "sum"
>
> actions = ["call","call","getCallCount","call","getCallCount"]
>
> values = [[2,2],[2,2],[],[1,2],[]]
>
> Output: [4,4,1,3,2]
>
> Explanation:
>
> const sum = (a, b) => a + b;
>
> const memoizedSum = memoize(sum);
>
> memoizedSum(2, 2); // "call" - returns 4. sum() was called as (2, 2) was not seen before.
>
> memoizedSum(2, 2); // "call" - returns 4. However sum() was not called because the same inputs were seen before.
>
> // "getCallCount" - total call count: 1
>
> memoizedSum(1, 2); // "call" - returns 3. sum() was called as (1, 2) was not seen before.
>
> // "getCallCount" - total call count: 2

**Example 2:**

> Input: fnName = "factorial"
>
> actions = ["call","call","call","getCallCount","call","getCallCount"]
>
> values = [[2],[3],[2],[],[3],[]]
>
> Output: [2,6,2,2,6,2]
>
> Explanation:
>
> const factorial = (n) => (n <= 1) ? 1 : (n \* factorial(n - 1));
>
> const memoFactorial = memoize(factorial);
>
> memoFactorial(2); // "call" - returns 2.
>
> memoFactorial(3); // "call" - returns 6.
>
> memoFactorial(2); // "call" - returns 2. However factorial was not called because 2 was seen before.
>
> // "getCallCount" - total call count: 2
>
> memoFactorial(3); // "call" - returns 6. However factorial was not called because 3 was seen before.
>
> // "getCallCount" - total call count: 2

**Example 3:**

> Input: fnName = "fib"
>
> actions = ["call","getCallCount"]
>
> values = [[5],[]]
>
> Output: [8,1]
>
> Explanation: fib(5) = 8 // "call"
>
> // "getCallCount" - total call count: 1

**Constraints:**

- `0 <= a, b <= 10^5`
- `1 <= n <= 10`
- `0 <= actions.length <= 10^5`
- `actions.length === values.length`
- `actions[i]` is one of "call" and "getCallCount"
- `fnName` is one of "sum", "factorial" and "fib"

## é¢˜ç›®å¤§æ„

è¯·ä½ ç¼–å†™ä¸€ä¸ªå‡½æ•° `fn`ï¼Œå®ƒæ¥æ”¶å¦ä¸€ä¸ªå‡½æ•°ä½œä¸ºè¾“å…¥ï¼Œå¹¶è¿”å›è¯¥å‡½æ•°çš„ **è®°å¿†åŒ–** åçš„ç»“æœã€‚

**è®°å¿†å‡½æ•°** æ˜¯ä¸€ä¸ªå¯¹äºç›¸åŒçš„è¾“å…¥æ°¸è¿œä¸ä¼šè¢«è°ƒç”¨ä¸¤æ¬¡çš„å‡½æ•°ã€‚ç›¸åï¼Œå®ƒå°†è¿”å›ä¸€ä¸ªç¼“å­˜å€¼ã€‚

ä½ å¯ä»¥å‡è®¾æœ‰ **3** ä¸ªå¯èƒ½çš„è¾“å…¥å‡½æ•°ï¼š`sum` ã€`fib` å’Œ `factorial` ã€‚

- `sum` æ¥æ”¶ä¸¤ä¸ªæ•´å‹å‚æ•° `a` å’Œ `b` ï¼Œå¹¶è¿”å› `a + b` ã€‚å‡è®¾å¦‚æœå‚æ•° `(b, a)` å·²ç»ç¼“å­˜äº†å€¼ï¼Œå…¶ä¸­ `a != b`ï¼Œå®ƒä¸èƒ½ç”¨äºå‚æ•° `(a, b)`ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå‚æ•°æ˜¯ `(3, 2)` å’Œ `(2, 3)`ï¼Œåˆ™åº”è¿›è¡Œä¸¤ä¸ªå•ç‹¬çš„è°ƒç”¨ã€‚
- `fib` æ¥æ”¶ä¸€ä¸ªæ•´å‹å‚æ•° `n` ï¼Œå¦‚æœ `n <= 1` åˆ™è¿”å› `1`ï¼Œå¦åˆ™è¿”å› `fib (n - 1) + fib (n - 2)`ã€‚
- `factorial` æ¥æ”¶ä¸€ä¸ªæ•´å‹å‚æ•° `n` ï¼Œå¦‚æœ `n <= 1` åˆ™è¿”å› `1` ï¼Œå¦åˆ™è¿”å› `factorial(n - 1) * n` ã€‚

**æç¤ºï¼š**

- `0 <= a, b <= 10^5`
- `1 <= n <= 10`
- `actions.length === values.length`
- `actions[i]` ä¸º "call" å’Œ "getCallCount" ä¸­çš„ä¸€ä¸ª
- `fnName `ä¸º "sum", "factorial" å’Œ "fib" ä¸­çš„ä¸€ä¸ª

## è§£é¢˜æ€è·¯

è®°å¿†åŒ– (Memoization) æ˜¯ä¸€ç§ä¼˜åŒ–æŠ€æœ¯ï¼Œç”¨äºåŠ é€Ÿå‡½æ•°çš„æ‰§è¡Œï¼Œç‰¹åˆ«æ˜¯å¯¹äºæœ‰ç›¸åŒè¾“å…¥æ—¶å¯ä»¥é‡ç”¨ç»“æœçš„å‡½æ•°ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯ä½¿ç”¨ä¸€ä¸ªç¼“å­˜ç»“æ„æ¥å­˜å‚¨ä¹‹å‰çš„è®¡ç®—ç»“æœï¼Œä»¥é¿å…å¯¹ç›¸åŒçš„è¾“å…¥è¿›è¡Œå¤šæ¬¡è®¡ç®—ã€‚

1. åˆ›å»ºä¸€ä¸ªå“ˆå¸Œè¡¨ `cache` æ¥å­˜å‚¨å·²ç»è®¡ç®—è¿‡çš„ç»“æœï¼Œé”®æ˜¯è¾“å…¥å‚æ•°ï¼Œå€¼æ˜¯å¯¹åº”çš„è¾“å‡ºç»“æœã€‚
2. å°†è¾“å…¥å‚æ•°é€šè¿‡ JSON åºåˆ—åŒ–è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œç”¨ä½œç¼“å­˜çš„é”® `key = JSON.stringify(args)`ã€‚
3. æ¯æ¬¡è°ƒç”¨å‡½æ•°æ—¶ï¼Œæ£€æŸ¥è¯¥è¾“å…¥å‚æ•°æ˜¯å¦å·²ç»å­˜åœ¨äºç¼“å­˜ä¸­ï¼š
   - å¦‚æœå­˜åœ¨ï¼Œç›´æ¥è¿”å›ç¼“å­˜ä¸­çš„ç»“æœã€‚
   - å¦‚æœä¸å­˜åœ¨ï¼Œè®¡ç®—è¯¥è¾“å…¥çš„ç»“æœï¼Œå¹¶å°†å…¶å­˜å…¥ç¼“å­˜ä»¥ä¾›ä¸‹æ¬¡ä½¿ç”¨ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(1)`ï¼Œæ¯æ¬¡è°ƒç”¨æ—¶éƒ½ä¼šåœ¨ç¼“å­˜ä¸­è¿›è¡ŒæŸ¥æ‰¾ï¼ˆ`Map` çš„æŸ¥æ‰¾æ—¶é—´å¤æ‚åº¦ä¸º `O(1)`ï¼‰ã€‚å¦‚æœç¼“å­˜å‘½ä¸­ï¼Œç›´æ¥è¿”å›ï¼›å¦‚æœæ²¡æœ‰å‘½ä¸­ï¼Œè¿›è¡Œä¸€æ¬¡è®¡ç®—å¹¶å­˜å‚¨ç»“æœã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œå–å†³äºä¸åŒè¾“å…¥çš„æ•°é‡ã€‚ç¼“å­˜ä¼šæ ¹æ®å‡½æ•°çš„è¾“å…¥å‚æ•°å­˜å‚¨ç»“æœï¼Œå› æ­¤ç©ºé—´æ¶ˆè€—éšè°ƒç”¨çš„ä¸åŒè¾“å…¥å¢å¤šã€‚

## ä»£ç 

```javascript
/**
 * @param {Function} fn
 * @return {Function}
 */
function memoize(fn) {
	const cache = new Map(); // åˆ›å»ºç¼“å­˜

	return function (...args) {
		const key = JSON.stringify(args); // å°†å‚æ•°åºåˆ—åŒ–ä½œä¸ºé”®

		if (cache.has(key)) {
			return cache.get(key); // å¦‚æœç¼“å­˜å­˜åœ¨ç»“æœï¼Œç›´æ¥è¿”å›
		}

		const result = fn(...args); // è®¡ç®—ç»“æœ
		cache.set(key, result); // å­˜å…¥ç¼“å­˜
		return result; // è¿”å›è®¡ç®—ç»“æœ
	};
}

/**
 * let callCount = 0;
 * const memoizedFn = memoize(function (a, b) {
 *	 callCount += 1;
 *   return a + b;
 * })
 * memoizedFn(2, 3) // 5
 * memoizedFn(2, 3) // 5
 * console.log(callCount) // 1
 */
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ | åŠ›æ‰£ |
| :------: | :------ | :------: | :------ | :------: | :------: |
| 2620 | è®¡æ•°å™¨ | [[âœ“]](/problem/2620.md) |  | ğŸŸ¢ | [ğŸ€„ï¸](https://leetcode.cn/problems/counter) [ğŸ”—](https://leetcode.com/problems/counter) |
| 2629 | å¤åˆå‡½æ•° | [[âœ“]](/problem/2629.md) |  | ğŸŸ¢ | [ğŸ€„ï¸](https://leetcode.cn/problems/function-composition) [ğŸ”—](https://leetcode.com/problems/function-composition) |
| 2630 | è®°å¿†å‡½æ•° II | [[âœ“]](/problem/2630.md) |  | ğŸ”´ | [ğŸ€„ï¸](https://leetcode.cn/problems/memoize-ii) [ğŸ”—](https://leetcode.com/problems/memoize-ii) |
| 2632 | æŸ¯é‡ŒåŒ– ğŸ”’ | [[âœ“]](/problem/2632.md) |  | ğŸŸ  | [ğŸ€„ï¸](https://leetcode.cn/problems/curry) [ğŸ”—](https://leetcode.com/problems/curry) |