# [909. è›‡æ¢¯æ£‹](https://leetcode.com/problems/snakes-and-ladders)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`å¹¿åº¦ä¼˜å…ˆæœç´¢`](/outline/tag/breadth-first-search.md) [`æ•°ç»„`](/outline/tag/array.md) [`çŸ©é˜µ`](/outline/tag/matrix.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/snakes-and-ladders)

## é¢˜ç›®

You are given an `n x n` integer matrix `board` where the cells are labeled
from `1` to `n2` in a [**Boustrophedon
style**](https://en.wikipedia.org/wiki/Boustrophedon) starting from the bottom
left of the board (i.e. `board[n - 1][0]`) and alternating direction each row.

You start on square `1` of the board. In each move, starting from square
`curr`, do the following:

- Choose a destination square `next` with a label in the range `[curr + 1, min(curr + 6, n2)]`.
  - This choice simulates the result of a standard **6-sided die roll** : i.e., there are always at most 6 destinations, regardless of the size of the board.
- If `next` has a snake or ladder, you **must** move to the destination of that snake or ladder. Otherwise, you move to `next`.
- The game ends when you reach the square `n2`.

A board square on row `r` and column `c` has a snake or ladder if `board[r][c]
!= -1`. The destination of that snake or ladder is `board[r][c]`. Squares `1`
and `n2` are not the starting points of any snake or ladder.

Note that you only take a snake or ladder at most once per move. If the
destination to a snake or ladder is the start of another snake or ladder, you
do **not** follow the subsequent snake or ladder.

- For example, suppose the board is `[[-1,4],[-1,3]]`, and on the first move, your destination square is `2`. You follow the ladder to square `3`, but do **not** follow the subsequent ladder to `4`.

Return _the least number of moves required to reach the square_`n2` _. If it is not possible to reach the square, return_`-1`.

**Example 1:**

![](https://assets.leetcode.com/uploads/2018/09/23/snakes.png)

> Input: board = [[-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1],[-1,35,-1,-1,13,-1],[-1,-1,-1,-1,-1,-1],[-1,15,-1,-1,-1,-1]]
>
> Output: 4
>
> Explanation:
>
> In the beginning, you start at square 1 (at row 5, column 0).
>
> You decide to move to square 2 and must take the ladder to square 15.
>
> You then decide to move to square 17 and must take the snake to square 13.
>
> You then decide to move to square 14 and must take the ladder to square 35.
>
> You then decide to move to square 36, ending the game.
>
> This is the lowest possible number of moves to reach the last square, so return 4.

**Example 2:**

> Input: board = [[-1,-1],[-1,3]]
>
> Output: 1

**Constraints:**

- `n == board.length == board[i].length`
- `2 <= n <= 20`
- `board[i][j]` is either `-1` or in the range `[1, n2]`.
- The squares labeled `1` and `n2` are not the starting points of any snake or ladder.

## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªå¤§å°ä¸º `n x n` çš„æ•´æ•°çŸ©é˜µ `board` ï¼Œæ–¹æ ¼æŒ‰ä» `1` åˆ° `n2` ç¼–å·ï¼Œç¼–å·éµå¾ª
[è½¬è¡Œäº¤æ›¿æ–¹å¼](https://baike.baidu.com/item/%E7%89%9B%E8%80%95%E5%BC%8F%E8%BD%AC%E8%A1%8C%E4%B9%A6%E5%86%99%E6%B3%95/17195786)\***\*
ï¼Œ**ä»å·¦ä¸‹è§’å¼€å§‹\*\* ï¼ˆå³ï¼Œä» `board[n - 1][0]` å¼€å§‹ï¼‰çš„æ¯ä¸€è¡Œæ”¹å˜æ–¹å‘ã€‚

ä½ ä¸€å¼€å§‹ä½äºæ£‹ç›˜ä¸Šçš„æ–¹æ ¼ `1`ã€‚æ¯ä¸€å›åˆï¼Œç©å®¶éœ€è¦ä»å½“å‰æ–¹æ ¼ `curr` å¼€å§‹å‡ºå‘ï¼ŒæŒ‰ä¸‹è¿°è¦æ±‚å‰è¿›ï¼š

- é€‰å®šç›®æ ‡æ–¹æ ¼ `next` ï¼Œç›®æ ‡æ–¹æ ¼çš„ç¼–å·åœ¨èŒƒå›´ `[curr + 1, min(curr + 6, n2)]` ã€‚
  - è¯¥é€‰æ‹©æ¨¡æ‹Ÿäº†æ· **å…­é¢ä½“éª°å­** çš„æƒ…æ™¯ï¼Œæ— è®ºæ£‹ç›˜å¤§å°å¦‚ä½•ï¼Œç©å®¶æœ€å¤šåªèƒ½æœ‰ 6 ä¸ªç›®çš„åœ°ã€‚
- ä¼ é€ç©å®¶ï¼šå¦‚æœç›®æ ‡æ–¹æ ¼ `next` å¤„å­˜åœ¨è›‡æˆ–æ¢¯å­ï¼Œé‚£ä¹ˆç©å®¶ä¼šä¼ é€åˆ°è›‡æˆ–æ¢¯å­çš„ç›®çš„åœ°ã€‚å¦åˆ™ï¼Œç©å®¶ä¼ é€åˆ°ç›®æ ‡æ–¹æ ¼ `next` ã€‚
- å½“ç©å®¶åˆ°è¾¾ç¼–å· `n2` çš„æ–¹æ ¼æ—¶ï¼Œæ¸¸æˆç»“æŸã€‚

å¦‚æœ `board[r][c] != -1` ï¼Œä½äº `r` è¡Œ `c` åˆ—çš„æ£‹ç›˜æ ¼ä¸­å¯èƒ½å­˜åœ¨ â€œè›‡â€ æˆ– â€œæ¢¯å­â€ã€‚é‚£ä¸ªè›‡æˆ–æ¢¯å­çš„ç›®çš„åœ°å°†ä¼šæ˜¯
`board[r][c]`ã€‚ç¼–å·ä¸º `1` å’Œ `n2` çš„æ–¹æ ¼ä¸æ˜¯ä»»ä½•è›‡æˆ–æ¢¯å­çš„èµ·ç‚¹ã€‚

æ³¨æ„ï¼Œç©å®¶åœ¨æ¯å›åˆçš„å‰è¿›è¿‡ç¨‹ä¸­æœ€å¤šåªèƒ½çˆ¬è¿‡è›‡æˆ–æ¢¯å­ä¸€æ¬¡ï¼šå°±ç®—ç›®çš„åœ°æ˜¯å¦ä¸€æ¡è›‡æˆ–æ¢¯å­çš„èµ·ç‚¹ï¼Œç©å®¶ä¹Ÿ **ä¸èƒ½** ç»§ç»­ç§»åŠ¨ã€‚

- ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æ£‹ç›˜æ˜¯ `[[-1,4],[-1,3]]` ï¼Œç¬¬ä¸€æ¬¡ç§»åŠ¨ï¼Œç©å®¶çš„ç›®æ ‡æ–¹æ ¼æ˜¯ `2` ã€‚é‚£ä¹ˆè¿™ä¸ªç©å®¶å°†ä¼šé¡ºç€æ¢¯å­åˆ°è¾¾æ–¹æ ¼ `3` ï¼Œä½† **ä¸èƒ½** é¡ºç€æ–¹æ ¼ `3` ä¸Šçš„æ¢¯å­å‰å¾€æ–¹æ ¼ `4` ã€‚ï¼ˆç®€å•æ¥è¯´ï¼Œç±»ä¼¼é£è¡Œæ£‹ï¼Œç©å®¶æ·å‡ºéª°å­ç‚¹æ•°åç§»åŠ¨å¯¹åº”æ ¼æ•°ï¼Œé‡åˆ°å•å‘çš„è·¯å¾„ï¼ˆå³æ¢¯å­æˆ–è›‡ï¼‰å¯ä»¥ç›´æ¥è·³åˆ°è·¯å¾„çš„ç»ˆç‚¹ï¼Œä½†å¦‚æœå¤šä¸ªè·¯å¾„é¦–å°¾ç›¸è¿ï¼Œä¹Ÿä¸èƒ½è¿ç»­è·³å¤šä¸ªè·¯å¾„ï¼‰

è¿”å›è¾¾åˆ°ç¼–å·ä¸º `n2` çš„æ–¹æ ¼æ‰€éœ€çš„æœ€å°‘ç§»åŠ¨æ¬¡æ•°ï¼Œå¦‚æœä¸å¯èƒ½ï¼Œåˆ™è¿”å› `-1`ã€‚

**ç¤ºä¾‹ 1ï¼š**

![](https://assets.leetcode.com/uploads/2018/09/23/snakes.png)

> **è¾“å…¥ï¼š** board = [[-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1],[-1,35,-1,-1,13,-1],[-1,-1,-1,-1,-1,-1],[-1,15,-1,-1,-1,-1]]
>
> **è¾“å‡ºï¼š** 4
>
> **è§£é‡Šï¼š**
>
> é¦–å…ˆï¼Œä»æ–¹æ ¼ 1 [ç¬¬ 5 è¡Œï¼Œç¬¬ 0 åˆ—] å¼€å§‹ã€‚
>
> å…ˆå†³å®šç§»åŠ¨åˆ°æ–¹æ ¼ 2 ï¼Œå¹¶å¿…é¡»çˆ¬è¿‡æ¢¯å­ç§»åŠ¨åˆ°åˆ°æ–¹æ ¼ 15 ã€‚
>
> ç„¶åå†³å®šç§»åŠ¨åˆ°æ–¹æ ¼ 17 [ç¬¬ 3 è¡Œï¼Œç¬¬ 4 åˆ—]ï¼Œå¿…é¡»çˆ¬è¿‡è›‡åˆ°æ–¹æ ¼ 13 ã€‚
>
> æ¥ç€å†³å®šç§»åŠ¨åˆ°æ–¹æ ¼ 14 ï¼Œä¸”å¿…é¡»é€šè¿‡æ¢¯å­ç§»åŠ¨åˆ°æ–¹æ ¼ 35 ã€‚
>
> æœ€åå†³å®šç§»åŠ¨åˆ°æ–¹æ ¼ 36 , æ¸¸æˆç»“æŸã€‚
>
> å¯ä»¥è¯æ˜éœ€è¦è‡³å°‘ 4 æ¬¡ç§»åŠ¨æ‰èƒ½åˆ°è¾¾æœ€åä¸€ä¸ªæ–¹æ ¼ï¼Œæ‰€ä»¥ç­”æ¡ˆæ˜¯ 4 ã€‚

**ç¤ºä¾‹ 2ï¼š**

> **è¾“å…¥ï¼š** board = [[-1,-1],[-1,3]]
>
> **è¾“å‡ºï¼š** 1

**æç¤ºï¼š**

- `n == board.length == board[i].length`
- `2 <= n <= 20`
- `board[i][j]` çš„å€¼æ˜¯ `-1` æˆ–åœ¨èŒƒå›´ `[1, n2]` å†…
- ç¼–å·ä¸º `1` å’Œ `n2` çš„æ–¹æ ¼ä¸Šæ²¡æœ‰è›‡æˆ–æ¢¯å­

## è§£é¢˜æ€è·¯

è¿™æ˜¯ä¸€é“ç»å…¸çš„å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰é¢˜ï¼Œå¯ä»¥å°†æ£‹ç›˜ä¸Šçš„æ ¼å­çœ‹ä½œæ˜¯å›¾ä¸­çš„èŠ‚ç‚¹ï¼Œéª°å­æ¯æ¬¡æ·å‡ºçš„ 1 åˆ° 6 ä¸ªç‚¹è¡¨ç¤ºèŠ‚ç‚¹ä¹‹é—´çš„è¾¹ï¼Œè›‡å’Œæ¢¯å­åˆ™æ˜¯ç‰¹æ®Šçš„ç§»åŠ¨è§„åˆ™ã€‚

1. **æ£‹ç›˜å±•å¹³**ï¼š

   - æˆ‘ä»¬éœ€è¦å…ˆæŠŠäºŒç»´æ•°ç»„ `board` å˜ä¸ºä¸€ç»´çš„ï¼Œæ–¹ä¾¿è¿›è¡Œçº¿æ€§æœç´¢ï¼ˆå› ä¸ºæ£‹ç›˜ä¸Šçš„æ•°å­—æ˜¯è¿ç»­çš„ï¼‰ã€‚
   - ä»å·¦å¾€å³ã€ä»å³å¾€å·¦ä¾æ¬¡äº¤æ›¿èµ°æ£‹ç›˜çš„æ¯ä¸€è¡Œï¼Œç¡®ä¿ä¸æ£‹ç›˜ä¸Šçš„ç¼–å·ä¸€è‡´ã€‚

2. **å¹¿åº¦ä¼˜å…ˆæœç´¢**ï¼š

   - ä½¿ç”¨é˜Ÿåˆ—å­˜å‚¨æ¯æ¬¡å¯èƒ½çš„ä¸‹ä¸€æ­¥ç§»åŠ¨ã€‚
   - ä»èµ·å§‹ä½ç½® `1` å¼€å§‹ï¼Œæ¯æ¬¡æŠ•éª°å­å¯ä»¥ä» `1` åˆ° `6` æ­¥ï¼Œæ¯ä¸€æ­¥åˆ°è¾¾ä¸€ä¸ªæ–°çš„ä½ç½®ã€‚å¦‚æœè¯¥ä½ç½®ä¸Šæœ‰æ¢¯å­æˆ–è›‡ï¼Œå°±ç›´æ¥ä¼ é€åˆ°æŒ‡å®šçš„ç›®æ ‡ä½ç½®ã€‚
   - ä¸ºäº†é¿å…é‡å¤è®¿é—®ä½ç½®ï¼Œéœ€è¦è®°å½•è®¿é—®è¿‡çš„ä½ç½®ï¼ˆ`visited`ï¼‰ã€‚

3. **ç»ˆæ­¢æ¡ä»¶**ï¼š
   - å½“åˆ°è¾¾æœ€åä¸€æ ¼ `n * n` æ—¶ï¼Œè¿”å›ç§»åŠ¨çš„æ¬¡æ•°ã€‚
   - å¦‚æœé˜Ÿåˆ—éå†ç»“æŸè¿˜æ²¡åˆ°è¾¾ç»ˆç‚¹ï¼Œè¿”å› `-1` è¡¨ç¤ºæ— æ³•åˆ°è¾¾ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n^2)`ï¼Œå› ä¸ºæ£‹ç›˜çš„å¤§å°æ˜¯ `n * n`ï¼Œæœ€åæƒ…å†µä¸‹æ¯ä¸ªæ ¼å­éƒ½éœ€è¦è¢«è®¿é—®ä¸€æ¬¡ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(n^2)`ï¼Œä½¿ç”¨é˜Ÿåˆ—å’Œè®¿é—®è®°å½•æ•°ç»„ `visited` æ¥å­˜å‚¨æ£‹ç›˜ä¸Šçš„çŠ¶æ€ä¿¡æ¯ã€‚

## ä»£ç 

```javascript
/**
 * @param {number[][]} board
 * @return {number}
 */
var snakesAndLadders = function (board) {
	const n = board.length;
	const visited = new Array(n * n + 1).fill(false);

	// å°†äºŒç»´çš„boardè½¬æ¢ä¸ºä¸€ç»´çš„æ•°ç»„
	const getBoardValue = (num) => {
		const r = Math.floor((num - 1) / n);
		const x = n - 1 - r;
		const y = r % 2 === 0 ? (num - 1) % n : n - 1 - ((num - 1) % n);
		return board[x][y];
	};

	const queue = [[1, 0]]; // [position, moves]
	visited[1] = true;

	while (queue.length > 0) {
		const [pos, moves] = queue.shift();

		// å¦‚æœåˆ°è¾¾ç»ˆç‚¹
		if (pos === n * n) return moves;

		// æ·éª°å­ï¼Œå°è¯•èµ° 1-6 æ­¥
		for (let i = 1; i <= 6; i++) {
			let next = pos + i;
			if (next > n * n) break;

			const boardValue = getBoardValue(next);
			if (boardValue !== -1) {
				next = boardValue; // å¦‚æœæœ‰æ¢¯å­æˆ–è›‡ï¼Œè·³åˆ°ç›®æ ‡ä½ç½®
			}

			if (!visited[next]) {
				visited[next] = true;
				queue.push([next, moves + 1]);
			}
		}
	}

	return -1; // å¦‚æœä¸èƒ½åˆ°è¾¾ç»ˆç‚¹
};
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 2467 | [æ ‘ä¸Šæœ€å¤§å¾—åˆ†å’Œè·¯å¾„](https://leetcode.com/problems/most-profitable-path-in-a-tree) |  |  [`æ ‘`](/outline/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/outline/tag/depth-first-search.md) [`å¹¿åº¦ä¼˜å…ˆæœç´¢`](/outline/tag/breadth-first-search.md) `2+` | <font color=#ffb800>Medium</font> |

<style>
.blue {
    background-color: #096dd9;
    padding: 0.25rem 0.5rem;
    margin: 0;
    font-size: 0.85em;
    border-radius: 3px;
    color: white;
    font-weight: 500;
}
table th:first-of-type { width: 10%; }
table th:nth-of-type(2) { width: 35%; }
table th:nth-of-type(3) { width: 10%; }
table th:nth-of-type(4) { width: 35%; }
table th:nth-of-type(5) { width: 10%; }
</style>
