# [236. äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ](https://leetcode.com/problems/lowest-common-ancestor-of-a-binary-tree)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ ‘`](/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/tag/depth-first-search.md) [`äºŒå‰æ ‘`](/tag/binary-tree.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/lowest-common-ancestor-of-a-binary-tree)

## é¢˜ç›®

<p>ç»™å®šä¸€ä¸ªäºŒå‰æ ‘, æ‰¾åˆ°è¯¥æ ‘ä¸­ä¸¤ä¸ªæŒ‡å®šèŠ‚ç‚¹çš„æœ€è¿‘å…¬å…±ç¥–å…ˆã€‚</p>

<p><a href="https://baike.baidu.com/item/%E6%9C%80%E8%BF%91%E5%85%AC%E5%85%B1%E7%A5%96%E5%85%88/8918834?fr=aladdin" target="_blank">ç™¾åº¦ç™¾ç§‘</a>ä¸­æœ€è¿‘å…¬å…±ç¥–å…ˆçš„å®šä¹‰ä¸ºï¼šâ€œå¯¹äºæœ‰æ ¹æ ‘ T çš„ä¸¤ä¸ªèŠ‚ç‚¹ pã€qï¼Œæœ€è¿‘å…¬å…±ç¥–å…ˆè¡¨ç¤ºä¸ºä¸€ä¸ªèŠ‚ç‚¹ xï¼Œæ»¡è¶³ x æ˜¯ pã€q çš„ç¥–å…ˆä¸” x çš„æ·±åº¦å°½å¯èƒ½å¤§ï¼ˆ<strong>ä¸€ä¸ªèŠ‚ç‚¹ä¹Ÿå¯ä»¥æ˜¯å®ƒè‡ªå·±çš„ç¥–å…ˆ</strong>ï¼‰ã€‚â€</p>

<p>Â </p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<img alt="" src="https://assets.leetcode.com/uploads/2018/12/14/binarytree.png" style="width: 200px; height: 190px;" />
<pre>
<strong>è¾“å…¥ï¼š</strong>root = [3,5,1,6,2,0,8,null,null,7,4], p = 5, q = 1
<strong>è¾“å‡ºï¼š</strong>3
<strong>è§£é‡Šï¼š</strong>èŠ‚ç‚¹ <code>5 </code>å’ŒèŠ‚ç‚¹ <code>1 </code>çš„æœ€è¿‘å…¬å…±ç¥–å…ˆæ˜¯èŠ‚ç‚¹ <code>3 ã€‚</code>
</pre>

<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>
<img alt="" src="https://assets.leetcode.com/uploads/2018/12/14/binarytree.png" style="width: 200px; height: 190px;" />
<pre>
<strong>è¾“å…¥ï¼š</strong>root = [3,5,1,6,2,0,8,null,null,7,4], p = 5, q = 4
<strong>è¾“å‡ºï¼š</strong>5
<strong>è§£é‡Šï¼š</strong>èŠ‚ç‚¹ <code>5 </code>å’ŒèŠ‚ç‚¹ <code>4 </code>çš„æœ€è¿‘å…¬å…±ç¥–å…ˆæ˜¯èŠ‚ç‚¹ <code>5 ã€‚</code>å› ä¸ºæ ¹æ®å®šä¹‰æœ€è¿‘å…¬å…±ç¥–å…ˆèŠ‚ç‚¹å¯ä»¥ä¸ºèŠ‚ç‚¹æœ¬èº«ã€‚
</pre>

<p><strong>ç¤ºä¾‹ 3ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>root = [1,2], p = 1, q = 2
<strong>è¾“å‡ºï¼š</strong>1
</pre>

<p>Â </p>

<p><strong>æç¤ºï¼š</strong></p>

<ul>
	<li>æ ‘ä¸­èŠ‚ç‚¹æ•°ç›®åœ¨èŒƒå›´ <code>[2, 10<sup>5</sup>]</code> å†…ã€‚</li>
	<li><code>-10<sup>9</sup> <= Node.val <= 10<sup>9</sup></code></li>
	<li>æ‰€æœ‰ <code>Node.val</code> <code>äº’ä¸ç›¸åŒ</code> ã€‚</li>
	<li><code>p != q</code></li>
	<li><code>p</code> å’Œ <code>q</code> å‡å­˜åœ¨äºç»™å®šçš„äºŒå‰æ ‘ä¸­ã€‚</li>
</ul>


## è§£é¢˜æ€è·¯

è¿™æ˜¯ä¸€é“ç»å…¸çš„é¢˜ç›®ï¼Œå¯»æ‰¾ä»»æ„ä¸€ä¸ªäºŒå‰æ ‘ä¸­ä¸¤ä¸ªç»“ç‚¹çš„ LCA æœ€è¿‘å…¬å…±ç¥–å…ˆï¼Œè€ƒå¯Ÿé€’å½’ã€‚

ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œé€’å½’åœ°å‘å·¦å­æ ‘å’Œå³å­æ ‘æœç´¢ã€‚é€’å½’çš„ç»ˆæ­¢æ¡ä»¶æœ‰å‡ ç§æƒ…å†µï¼š

1. å¦‚æœå½“å‰èŠ‚ç‚¹ä¸º `null`ï¼Œè¡¨ç¤ºéå†åˆ°ç©ºèŠ‚ç‚¹ï¼Œç›´æ¥è¿”å› `null`ã€‚
2. å¦‚æœå½“å‰èŠ‚ç‚¹ç­‰äº `p` æˆ– `q`ï¼Œè¡¨ç¤ºæ‰¾åˆ°äº†å…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç›´æ¥è¿”å›å½“å‰èŠ‚ç‚¹ã€‚

é€’å½’æ­¥éª¤å¦‚ä¸‹ï¼š

1. é€’å½’åœ°åœ¨å·¦å­æ ‘ä¸­å¯»æ‰¾ `p` å’Œ `q` çš„æœ€ä½å…±åŒç¥–å…ˆï¼Œç»“æœå­˜å‚¨åœ¨å˜é‡ `left` ä¸­ã€‚
2. é€’å½’åœ°åœ¨å³å­æ ‘ä¸­å¯»æ‰¾ `p` å’Œ `q` çš„æœ€ä½å…±åŒç¥–å…ˆï¼Œç»“æœå­˜å‚¨åœ¨å˜é‡ `right` ä¸­ã€‚

ç„¶åï¼Œæ ¹æ® `left` å’Œ `right` çš„æƒ…å†µï¼Œå¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š

- å¦‚æœ `left` å’Œ `right` éƒ½ä¸ä¸º `null`ï¼Œè¯´æ˜ `p` å’Œ `q` åˆ†åˆ«ä½äºå½“å‰èŠ‚ç‚¹çš„å·¦å³å­æ ‘ï¼Œå› æ­¤å½“å‰èŠ‚ç‚¹å°±æ˜¯å®ƒä»¬çš„æœ€ä½å…±åŒç¥–å…ˆï¼Œç›´æ¥è¿”å›å½“å‰èŠ‚ç‚¹ã€‚
- å¦‚æœåªæœ‰ `left` ä¸ä¸º `null`ï¼Œè¯´æ˜ `p` å’Œ `q` éƒ½åœ¨å·¦å­æ ‘ï¼Œæœ€ä½å…±åŒç¥–å…ˆåœ¨å·¦å­æ ‘ä¸­ï¼Œè¿”å› `left`ã€‚
- å¦‚æœåªæœ‰ `right` ä¸ä¸º `null`ï¼Œè¯´æ˜ `p` å’Œ `q` éƒ½åœ¨å³å­æ ‘ï¼Œæœ€ä½å…±åŒç¥–å…ˆåœ¨å³å­æ ‘ä¸­ï¼Œè¿”å› `right`ã€‚

é€’å½’æ³•çš„å…³é”®åœ¨äºå°†å¤§é—®é¢˜åˆ’åˆ†ä¸ºè§„æ¨¡è¾ƒå°çš„å­é—®é¢˜ï¼Œç„¶åé€šè¿‡é€’å½’è°ƒç”¨æ¥è§£å†³å­é—®é¢˜ï¼Œæœ€ç»ˆå¾—åˆ°æ•´ä½“çš„è§£å†³æ–¹æ¡ˆã€‚åœ¨è¿™é‡Œï¼Œé€’å½’è°ƒç”¨çš„å­é—®é¢˜æ˜¯åœ¨å·¦å³å­æ ‘ä¸­å¯»æ‰¾ `p` å’Œ `q` çš„æœ€ä½å…±åŒç¥–å…ˆã€‚

é€’å½’æ³•çš„ä¼˜ç‚¹åœ¨äºå…¶ç®€æ´æ€§å’Œç›´è§‚æ€§ï¼Œä½†éœ€è¦æ³¨æ„é¿å…é‡å¤è®¡ç®—ï¼Œä»¥æé«˜æ€§èƒ½ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œå…¶ä¸­ `n` æ˜¯æ ‘ä¸­èŠ‚ç‚¹çš„æ€»æ•°ï¼Œå› ä¸ºåœ¨æœ€åçš„æƒ…å†µä¸‹ï¼Œéœ€è¦æ£€æŸ¥æ¯ä¸ªèŠ‚ç‚¹æ¥æ‰¾åˆ°æœ€è¿‘å…¬å…±ç¥–å…ˆã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(h)`ï¼Œå…¶ä¸­ `h` æ˜¯æ ‘çš„é«˜åº¦ï¼Œç©ºé—´å¤æ‚åº¦ä¸»è¦ç”±é€’å½’è°ƒç”¨æ ˆçš„æ·±åº¦å†³å®šã€‚
  - åœ¨å¹³è¡¡æ ‘ä¸­ï¼Œé€’å½’æ·±åº¦ä¸º `O(h)`ï¼Œå…¶ä¸­ `h` æ˜¯æ ‘çš„é«˜åº¦ã€‚
  - åœ¨æœ€åæƒ…å†µä¸‹ï¼ˆä¾‹å¦‚ï¼Œæ ‘æ˜¯å®Œå…¨ä¸å¹³è¡¡çš„ï¼‰ï¼Œé€’å½’çš„æ·±åº¦å¯ä»¥è¾¾åˆ° `O(n)`ï¼Œå…¶ä¸­ `n` æ˜¯æ ‘ä¸­èŠ‚ç‚¹çš„æ€»æ•°ã€‚

## ä»£ç 

```javascript
/**
 * @param {TreeNode} root
 * @param {TreeNode} p
 * @param {TreeNode} q
 * @return {TreeNode}
 */
var lowestCommonAncestor = function (root, p, q) {
	if (!root || root == p || root == q) return root;

	let left = lowestCommonAncestor(root.left, p, q);
	let right = lowestCommonAncestor(root.right, p, q);

	if (left && right) return root;
	return left ? left : right;
};
```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 235 | [äºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ](https://leetcode.com/problems/lowest-common-ancestor-of-a-binary-search-tree) | [[âœ“]](/problem/0235.md) |  [`æ ‘`](/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/tag/depth-first-search.md) [`äºŒå‰æœç´¢æ ‘`](/tag/binary-search-tree.md) `1+` | <font color=#ffb800>Medium</font> |
| 1257 | [æœ€å°å…¬å…±åŒºåŸŸ](https://leetcode.com/problems/smallest-common-region) |  |  [`æ ‘`](/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/tag/depth-first-search.md) [`å¹¿åº¦ä¼˜å…ˆæœç´¢`](/tag/breadth-first-search.md) `3+` | <font color=#ffb800>Medium</font> |
| 1644 | [äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ II](https://leetcode.com/problems/lowest-common-ancestor-of-a-binary-tree-ii) |  |  [`æ ‘`](/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/tag/depth-first-search.md) [`äºŒå‰æ ‘`](/tag/binary-tree.md) | <font color=#ffb800>Medium</font> |
| 1650 | [äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ III](https://leetcode.com/problems/lowest-common-ancestor-of-a-binary-tree-iii) |  |  [`æ ‘`](/tag/tree.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`åŒæŒ‡é’ˆ`](/tag/two-pointers.md) `1+` | <font color=#ffb800>Medium</font> |
| 1676 | [äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ IV](https://leetcode.com/problems/lowest-common-ancestor-of-a-binary-tree-iv) |  |  [`æ ‘`](/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/tag/depth-first-search.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) `1+` | <font color=#ffb800>Medium</font> |
| 2096 | [ä»äºŒå‰æ ‘ä¸€ä¸ªèŠ‚ç‚¹åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹æ¯ä¸€æ­¥çš„æ–¹å‘](https://leetcode.com/problems/step-by-step-directions-from-a-binary-tree-node-to-another) |  |  [`æ ‘`](/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/tag/depth-first-search.md) [`å­—ç¬¦ä¸²`](/tag/string.md) `1+` | <font color=#ffb800>Medium</font> |
| 2225 | [æ‰¾å‡ºè¾“æ‰é›¶åœºæˆ–ä¸€åœºæ¯”èµ›çš„ç©å®¶](https://leetcode.com/problems/find-players-with-zero-or-one-losses) |  |  [`æ•°ç»„`](/tag/array.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`è®¡æ•°`](/tag/counting.md) `1+` | <font color=#ffb800>Medium</font> |
| 2509 | [æŸ¥è¯¢æ ‘ä¸­ç¯çš„é•¿åº¦](https://leetcode.com/problems/cycle-length-queries-in-a-tree) |  |  [`æ ‘`](/tag/tree.md) [`æ•°ç»„`](/tag/array.md) [`äºŒå‰æ ‘`](/tag/binary-tree.md) | <font color=#ff334b>Hard</font> |