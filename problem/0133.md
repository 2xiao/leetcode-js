# [133. å…‹éš†å›¾](https://leetcode.com/problems/clone-graph)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/tag/depth-first-search.md) [`å¹¿åº¦ä¼˜å…ˆæœç´¢`](/tag/breadth-first-search.md) [`å›¾`](/tag/graph.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/clone-graph)

## é¢˜ç›®

<p>ç»™ä½ æ— å‘&nbsp;<strong><a href="https://baike.baidu.com/item/è¿é€šå›¾/6460995?fr=aladdin" target="_blank">è¿é€š</a>&nbsp;</strong>å›¾ä¸­ä¸€ä¸ªèŠ‚ç‚¹çš„å¼•ç”¨ï¼Œè¯·ä½ è¿”å›è¯¥å›¾çš„&nbsp;<a href="https://baike.baidu.com/item/æ·±æ‹·è´/22785317?fr=aladdin" target="_blank"><strong>æ·±æ‹·è´</strong></a>ï¼ˆå…‹éš†ï¼‰ã€‚</p>

<p>å›¾ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½åŒ…å«å®ƒçš„å€¼ <code>val</code>ï¼ˆ<code>int</code>ï¼‰ å’Œå…¶é‚»å±…çš„åˆ—è¡¨ï¼ˆ<code>list[Node]</code>ï¼‰ã€‚</p>

<pre>
class Node {
    public int val;
    public List&lt;Node&gt; neighbors;
}</pre>

<p>&nbsp;</p>

<p><strong>æµ‹è¯•ç”¨ä¾‹æ ¼å¼ï¼š</strong></p>

<p>ç®€å•èµ·è§ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½å’Œå®ƒçš„ç´¢å¼•ç›¸åŒã€‚ä¾‹å¦‚ï¼Œç¬¬ä¸€ä¸ªèŠ‚ç‚¹å€¼ä¸º 1ï¼ˆ<code>val = 1</code>ï¼‰ï¼Œç¬¬äºŒä¸ªèŠ‚ç‚¹å€¼ä¸º 2ï¼ˆ<code>val = 2</code>ï¼‰ï¼Œä»¥æ­¤ç±»æ¨ã€‚è¯¥å›¾åœ¨æµ‹è¯•ç”¨ä¾‹ä¸­ä½¿ç”¨é‚»æ¥åˆ—è¡¨è¡¨ç¤ºã€‚</p>

<p><strong>é‚»æ¥åˆ—è¡¨</strong> æ˜¯ç”¨äºè¡¨ç¤ºæœ‰é™å›¾çš„æ— åºåˆ—è¡¨çš„é›†åˆã€‚æ¯ä¸ªåˆ—è¡¨éƒ½æè¿°äº†å›¾ä¸­èŠ‚ç‚¹çš„é‚»å±…é›†ã€‚</p>

<p>ç»™å®šèŠ‚ç‚¹å°†å§‹ç»ˆæ˜¯å›¾ä¸­çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆå€¼ä¸º 1ï¼‰ã€‚ä½ å¿…é¡»å°†&nbsp;<strong>ç»™å®šèŠ‚ç‚¹çš„æ‹·è´&nbsp;</strong>ä½œä¸ºå¯¹å…‹éš†å›¾çš„å¼•ç”¨è¿”å›ã€‚</p>

<p>&nbsp;</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<p><img alt="" src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2020/02/01/133_clone_graph_question.png" style="height: 500px; width: 500px;" /></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>adjList = [[2,4],[1,3],[2,4],[1,3]]
<strong>è¾“å‡ºï¼š</strong>[[2,4],[1,3],[2,4],[1,3]]
<strong>è§£é‡Šï¼š
</strong>å›¾ä¸­æœ‰ 4 ä¸ªèŠ‚ç‚¹ã€‚
èŠ‚ç‚¹ 1 çš„å€¼æ˜¯ 1ï¼Œå®ƒæœ‰ä¸¤ä¸ªé‚»å±…ï¼šèŠ‚ç‚¹ 2 å’Œ 4 ã€‚
èŠ‚ç‚¹ 2 çš„å€¼æ˜¯ 2ï¼Œå®ƒæœ‰ä¸¤ä¸ªé‚»å±…ï¼šèŠ‚ç‚¹ 1 å’Œ 3 ã€‚
èŠ‚ç‚¹ 3 çš„å€¼æ˜¯ 3ï¼Œå®ƒæœ‰ä¸¤ä¸ªé‚»å±…ï¼šèŠ‚ç‚¹ 2 å’Œ 4 ã€‚
èŠ‚ç‚¹ 4 çš„å€¼æ˜¯ 4ï¼Œå®ƒæœ‰ä¸¤ä¸ªé‚»å±…ï¼šèŠ‚ç‚¹ 1 å’Œ 3 ã€‚
</pre>

<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>

<p><img alt="" src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2020/02/01/graph.png" style="height: 148px; width: 163px;" /></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>adjList = [[]]
<strong>è¾“å‡ºï¼š</strong>[[]]
<strong>è§£é‡Šï¼š</strong>è¾“å…¥åŒ…å«ä¸€ä¸ªç©ºåˆ—è¡¨ã€‚è¯¥å›¾ä»…ä»…åªæœ‰ä¸€ä¸ªå€¼ä¸º 1 çš„èŠ‚ç‚¹ï¼Œå®ƒæ²¡æœ‰ä»»ä½•é‚»å±…ã€‚
</pre>

<p><strong>ç¤ºä¾‹ 3ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>adjList = []
<strong>è¾“å‡ºï¼š</strong>[]
<strong>è§£é‡Šï¼š</strong>è¿™ä¸ªå›¾æ˜¯ç©ºçš„ï¼Œå®ƒä¸å«ä»»ä½•èŠ‚ç‚¹ã€‚
</pre>

<p>&nbsp;</p>

<p><strong>æç¤ºï¼š</strong></p>

<ul>
	<li>è¿™å¼ å›¾ä¸­çš„èŠ‚ç‚¹æ•°åœ¨ <code>[0, 100]</code>&nbsp;ä¹‹é—´ã€‚</li>
	<li><code>1 &lt;= Node.val &lt;= 100</code></li>
	<li>æ¯ä¸ªèŠ‚ç‚¹å€¼&nbsp;<code>Node.val</code> éƒ½æ˜¯å”¯ä¸€çš„ï¼Œ</li>
	<li>å›¾ä¸­æ²¡æœ‰é‡å¤çš„è¾¹ï¼Œä¹Ÿæ²¡æœ‰è‡ªç¯ã€‚</li>
	<li>å›¾æ˜¯è¿é€šå›¾ï¼Œä½ å¯ä»¥ä»ç»™å®šèŠ‚ç‚¹è®¿é—®åˆ°æ‰€æœ‰èŠ‚ç‚¹ã€‚</li>
</ul>


## è§£é¢˜æ€è·¯

å…‹éš†å›¾çš„å¸¸è§è§£æ³•æ˜¯ä½¿ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰æˆ–å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰ã€‚ä»¥æ·±åº¦ä¼˜å…ˆæœç´¢ä¸ºä¾‹ï¼Œå¯ä»¥é€šè¿‡é€’å½’å®ç°å›¾çš„å…‹éš†ã€‚åœ¨é€’å½’çš„è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨ `visited` å“ˆå¸Œè¡¨æ¥è®°å½•å·²ç»è®¿é—®è¿‡çš„èŠ‚ç‚¹ï¼Œé¿å…é‡å¤éå†ã€‚

1. ä½¿ç”¨ä¸€ä¸ªå“ˆå¸Œè¡¨ `visited` æ¥å­˜å‚¨åŸå›¾èŠ‚ç‚¹å’Œå…‹éš†å›¾èŠ‚ç‚¹çš„æ˜ å°„å…³ç³»ã€‚é”®ä¸ºåŸå›¾èŠ‚ç‚¹ï¼Œå€¼ä¸ºå…‹éš†å›¾èŠ‚ç‚¹ã€‚
2. å®šä¹‰ä¸€ä¸ª DFS å‡½æ•°ï¼Œè¾“å…¥ä¸ºåŸå›¾èŠ‚ç‚¹ `node`ï¼Œåœ¨å‡½æ•°ä¸­è¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š
   - å¦‚æœ `node` ä¸ºç©ºï¼Œç›´æ¥è¿”å› `null`ã€‚
   - å¦‚æœ `node` åœ¨ `visited` ä¸­ï¼Œè¯´æ˜å·²ç»è®¿é—®è¿‡ï¼Œç›´æ¥è¿”å›å¯¹åº”çš„å…‹éš†å›¾èŠ‚ç‚¹ã€‚
   - å¦åˆ™ï¼Œåˆ›å»ºä¸€ä¸ªå…‹éš†å›¾èŠ‚ç‚¹ï¼Œå¹¶å°†å…¶æ”¾å…¥ `visited` ä¸­ï¼Œé”®ä¸º `node`ï¼Œå€¼ä¸º `cloneNode`ã€‚
   - å¯¹ `node` çš„é‚»å±…è¿›è¡Œé€’å½’è°ƒç”¨ DFSï¼Œå¹¶å°†ç»“æœæ·»åŠ åˆ° `visited.get(node)` çš„é‚»å±…åˆ—è¡¨ä¸­ã€‚
3. æœ€åè¿”å›å…‹éš†å›¾çš„èµ·å§‹èŠ‚ç‚¹ã€‚

å½“ç„¶ä¹Ÿæœ‰äººå†™ DFS æ—¶ä¸ä¹ æƒ¯è¿”å›å€¼ï¼Œè¿™æ ·æ›´æ¸…æ™°æ˜“æ‡‚ä¸€äº›ï¼Œè¯¦è§è§£æ³•äºŒã€‚

## ä»£ç 

::: code-tabs

@tab DFS

```javascript
/**
 * // Definition for a Node.
 * function Node(val, neighbors) {
 *    this.val = val === undefined ? 0 : val;
 *    this.neighbors = neighbors === undefined ? [] : neighbors;
 * };
 */

/**
 * @param {Node} node
 * @return {Node}
 */
var cloneGraph = function (node) {
	if (!node) return null;
	let visited = new Map();
	const dfs = (node) => {
		if (!node) return null;
		if (visited.has(node)) return visited.get(node);
		visited.set(node, new Node(node.val));
		for (let i of node.neighbors) {
			visited.get(node).neighbors.push(dfs(i));
		}
		return visited.get(node);
	};

	return dfs(node);
};
```

@tab DFS æ— è¿”å›å€¼ç‰ˆ

```javascript
/**
 * @param {_Node} node
 * @return {_Node}
 */
var cloneGraph = function (node) {
	let copy = new Map();

	const dfs = (node) => {
		if (!node) return;
		if (copy.has(node)) return;
		copy.set(node, new Node(node.val));

		for (let item of node.neighbors) {
			dfs(item);
			copy.get(node).neighbors.push(copy.get(item));
		}
	};

	dfs(node);
	return copy.get(node);
};
```

:::

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 138 | [éšæœºé“¾è¡¨çš„å¤åˆ¶](https://leetcode.com/problems/copy-list-with-random-pointer) | [[âœ“]](/problem/0138.md) |  [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`é“¾è¡¨`](/tag/linked-list.md) | <font color=#ffb800>Medium</font> |
| 1485 | [å…‹éš†å«éšæœºæŒ‡é’ˆçš„äºŒå‰æ ‘](https://leetcode.com/problems/clone-binary-tree-with-random-pointer) |  |  [`æ ‘`](/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/tag/depth-first-search.md) [`å¹¿åº¦ä¼˜å…ˆæœç´¢`](/tag/breadth-first-search.md) `2+` | <font color=#ffb800>Medium</font> |
| 1490 | [å…‹éš† N å‰æ ‘](https://leetcode.com/problems/clone-n-ary-tree) |  |  [`æ ‘`](/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/tag/depth-first-search.md) [`å¹¿åº¦ä¼˜å…ˆæœç´¢`](/tag/breadth-first-search.md) `1+` | <font color=#ffb800>Medium</font> |