# [28. å±•å¹³å¤šçº§åŒå‘é“¾è¡¨](https://2xiao.github.io/leetcode-js/offer2/jz_offer_II_028.html)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/tag/depth-first-search.md) [`é“¾è¡¨`](/tag/linked-list.md) [`åŒå‘é“¾è¡¨`](/tag/doubly-linked-list.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/Qv1Da2)

## é¢˜ç›®

å¤šçº§åŒå‘é“¾è¡¨ä¸­ï¼Œé™¤äº†æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹å’Œå‰ä¸€ä¸ªèŠ‚ç‚¹æŒ‡é’ˆä¹‹å¤–ï¼Œå®ƒè¿˜æœ‰ä¸€ä¸ªå­é“¾è¡¨æŒ‡é’ˆï¼Œå¯èƒ½æŒ‡å‘å•ç‹¬çš„åŒå‘é“¾è¡¨ã€‚è¿™äº›å­åˆ—è¡¨ä¹Ÿå¯èƒ½ä¼šæœ‰ä¸€ä¸ªæˆ–å¤šä¸ªè‡ªå·±çš„å­é¡¹ï¼Œä¾æ­¤ç±»æ¨ï¼Œç”Ÿæˆå¤šçº§æ•°æ®ç»“æ„ï¼Œå¦‚ä¸‹é¢çš„ç¤ºä¾‹æ‰€ç¤ºã€‚

ç»™å®šä½äºåˆ—è¡¨ç¬¬ä¸€çº§çš„å¤´èŠ‚ç‚¹ï¼Œè¯·æ‰å¹³åŒ–åˆ—è¡¨ï¼Œå³å°†è¿™æ ·çš„å¤šçº§åŒå‘é“¾è¡¨å±•å¹³æˆæ™®é€šçš„åŒå‘é“¾è¡¨ï¼Œä½¿æ‰€æœ‰ç»“ç‚¹å‡ºç°åœ¨å•çº§åŒé“¾è¡¨ä¸­ã€‚

**ç¤ºä¾‹ 1ï¼š**

> **è¾“å…¥ï¼š** head = [1,2,3,4,5,6,null,null,null,7,8,9,10,null,null,11,12]
>
> **è¾“å‡ºï¼š**[1,2,3,7,8,11,12,9,10,4,5,6]
>
> **è§£é‡Šï¼š**
>
> è¾“å…¥çš„å¤šçº§åˆ—è¡¨å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
>
> ![](https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/10/12/multilevellinkedlist.png)
>
> æ‰å¹³åŒ–åçš„é“¾è¡¨å¦‚ä¸‹å›¾ï¼š
>
> ![](https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/10/12/multilevellinkedlistflattened.png)

**ç¤ºä¾‹ 2ï¼š**

> **è¾“å…¥ï¼š** head = [1,2,null,3]
>
> **è¾“å‡ºï¼š**[1,3,2]
>
> **è§£é‡Šï¼š** è¾“å…¥çš„å¤šçº§åˆ—è¡¨å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
>
> 1---2---NULL
>
> |
>
> 3---NULL

**ç¤ºä¾‹ 3ï¼š**

> **è¾“å…¥ï¼š** head = []
>
> **è¾“å‡ºï¼š**[]

**å¦‚ä½•è¡¨ç¤ºæµ‹è¯•ç”¨ä¾‹ä¸­çš„å¤šçº§é“¾è¡¨ï¼Ÿ**

ä»¥ **ç¤ºä¾‹ 1** ä¸ºä¾‹ï¼š

> 1---2---3---4---5---6--NULL
>
> > |
>
> > 7---8---9---10--NULL
>
> > |
>
> > 11--12--NULL

åºåˆ—åŒ–å…¶ä¸­çš„æ¯ä¸€çº§ä¹‹åï¼š

> [1,2,3,4,5,6,null]
>
> [7,8,9,10,null]
>
> [11,12,null]

ä¸ºäº†å°†æ¯ä¸€çº§éƒ½åºåˆ—åŒ–åˆ°ä¸€èµ·ï¼Œæˆ‘ä»¬éœ€è¦æ¯ä¸€çº§ä¸­æ·»åŠ å€¼ä¸º null çš„å…ƒç´ ï¼Œä»¥è¡¨ç¤ºæ²¡æœ‰èŠ‚ç‚¹è¿æ¥åˆ°ä¸Šä¸€çº§çš„ä¸Šçº§èŠ‚ç‚¹ã€‚

> [1,2,3,4,5,6,null]
>
> [null,null,7,8,9,10,null]
>
> [null,11,12,null]

åˆå¹¶æ‰€æœ‰åºåˆ—åŒ–ç»“æœï¼Œå¹¶å»é™¤æœ«å°¾çš„ null ã€‚

> [1,2,3,4,5,6,null,null,null,7,8,9,10,null,null,11,12]

**æç¤ºï¼š**

- èŠ‚ç‚¹æ•°ç›®ä¸è¶…è¿‡ `1000`
- `1 <= Node.val <= 10^5`

::: warning
æœ¬é¢˜ä¸ LeetCode [ç¬¬ 430 é¢˜](../problem/0430.md) ç›¸åŒã€‚
:::

## è§£é¢˜æ€è·¯

1. ä½¿ç”¨é€’å½’éå†å¤šçº§é“¾è¡¨ï¼Œå¦‚æœæŸä¸ªèŠ‚ç‚¹æœ‰å­é“¾è¡¨ï¼Œåˆ™å¯¹å­é“¾è¡¨è¿›è¡Œé€’å½’å¤„ç†ã€‚
2. åœ¨é€’å½’å¤„ç†è¿‡ç¨‹ä¸­ï¼Œå°†å½“å‰èŠ‚ç‚¹çš„ `next` æŒ‡é’ˆæŒ‡å‘é€’å½’å¤„ç†åçš„å­é“¾è¡¨ï¼ŒåŒæ—¶å°†å­é“¾è¡¨çš„ `prev` æŒ‡é’ˆæŒ‡å‘å½“å‰èŠ‚ç‚¹ã€‚
3. æœ€åï¼Œå°†å½“å‰èŠ‚ç‚¹çš„ `child` æŒ‡é’ˆç½®ä¸º `null`ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œå…¶ä¸­ `n` æ˜¯é“¾è¡¨çš„èŠ‚ç‚¹æ€»æ•°ã€‚è¿™ä¸ªç®—æ³•é€’å½’åœ°å¤„ç†äº†å¤šçº§é“¾è¡¨ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½åªå¤„ç†ä¸€æ¬¡ã€‚
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(1)`ã€‚

## ä»£ç 

```javascript
/**
 * @param {Node} head
 * @return {Node}
 */
var flatten = function (head) {
	if (!head) return null;
	const next = head.next;
	const child = head.child;

	// å¤„ç†å½“å‰èŠ‚ç‚¹çš„å­é“¾è¡¨
	const flattenChild = flatten(child);
	// è¿æ¥å½“å‰èŠ‚ç‚¹å’Œé€’å½’å¤„ç†åçš„å­é“¾è¡¨
	if (flattenChild) {
		head.next = flattenChild;
		flattenChild.prev = head;
		head.child = null;
	}
	// é€’å½’å¤„ç†åç»­èŠ‚ç‚¹
	const flattenNext = flatten(next);
	// è¿æ¥é€’å½’å¤„ç†åçš„å­é“¾è¡¨å’Œåç»­èŠ‚ç‚¹
	if (flattenNext) {
		const last = findLast(flattenChild) || head;
		last.next = flattenNext;
		flattenNext.prev = last;
	}
	return head;
};

// è¾…åŠ©å‡½æ•°ï¼šæ‰¾åˆ°é“¾è¡¨çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹
var findLast = function (head) {
	while (head && head.next) {
		head = head.next;
	}
	return head;
};
```
