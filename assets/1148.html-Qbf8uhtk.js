import{_ as u,r as i,o as p,c as v,a as e,b as n,d as a,w as s,e as m}from"./app-fBVbqwGY.js";const h={},b=e("h1",{id:"_1148-æ–‡ç« æµè§ˆ-i",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#_1148-æ–‡ç« æµè§ˆ-i","aria-hidden":"true"},"#"),n(" 1148. æ–‡ç« æµè§ˆ I")],-1),_=e("code",null,"æ•°æ®åº“",-1),k={href:"https://leetcode.cn/problems/article-views-i",target:"_blank",rel:"noopener noreferrer"},g=e("code",null,"åŠ›æ‰£",-1),w={href:"https://leetcode.com/problems/article-views-i",target:"_blank",rel:"noopener noreferrer"},x=e("code",null,"LeetCode",-1),f=m(`<h2 id="é¢˜ç›®" tabindex="-1"><a class="header-anchor" href="#é¢˜ç›®" aria-hidden="true">#</a> é¢˜ç›®</h2><p>Table: <code>Views</code></p><blockquote><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| article_id    | int     |
| author_id     | int     |
| viewer_id     | int     |
| view_date     | date    |
+---------------+---------+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>There is no primary key (column with unique values) for this table, the table may have duplicate rows.</p><p>Each row of this table indicates that some viewer viewed an article (written by some author) on some date.</p><p>Note that equal author_id and viewer_id indicate the same person.</p></blockquote><p>Write a solution to find all the authors that viewed at least one of their own articles.</p><p>Return the result table sorted by <code>id</code> in ascending order.</p><p>The result format is in the following example.</p><p><strong>Example 1:</strong></p><blockquote><p>Input:</p><p>Views table:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>+------------+-----------+-----------+------------+
| article_id | author_id | viewer_id | view_date  |
+------------+-----------+-----------+------------+
| 1          | 3         | 5         | 2019-08-01 |
| 1          | 3         | 6         | 2019-08-02 |
| 2          | 7         | 7         | 2019-08-01 |
| 2          | 7         | 6         | 2019-08-02 |
| 4          | 7         | 1         | 2019-07-22 |
| 3          | 4         | 4         | 2019-07-21 |
| 3          | 4         | 4         | 2019-07-21 |
+------------+-----------+-----------+------------+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Output:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>+------+
| id   |
+------+
| 4    |
| 7    |
+------+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h2 id="é¢˜ç›®å¤§æ„" tabindex="-1"><a class="header-anchor" href="#é¢˜ç›®å¤§æ„" aria-hidden="true">#</a> é¢˜ç›®å¤§æ„</h2><p><code>Views</code> è¡¨ï¼š</p><blockquote><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| article_id    | int     |
| author_id     | int     |
| viewer_id     | int     |
| view_date     | date    |
+---------------+---------+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤è¡¨å¯èƒ½ä¼šå­˜åœ¨é‡å¤è¡Œã€‚ï¼ˆæ¢å¥è¯è¯´ï¼Œåœ¨ SQL ä¸­è¿™ä¸ªè¡¨æ²¡æœ‰ä¸»é”®ï¼‰</p><p>æ­¤è¡¨çš„æ¯ä¸€è¡Œéƒ½è¡¨ç¤ºæŸäººåœ¨æŸå¤©æµè§ˆäº†æŸä½ä½œè€…çš„æŸç¯‡æ–‡ç« ã€‚</p><p>è¯·æ³¨æ„ï¼ŒåŒä¸€äººçš„ author_id å’Œ viewer_id æ˜¯ç›¸åŒçš„ã€‚</p></blockquote><p>è¯·æŸ¥è¯¢å‡ºæ‰€æœ‰æµè§ˆè¿‡è‡ªå·±æ–‡ç« çš„ä½œè€…</p><p>ç»“æœæŒ‰ç…§ <code>id</code> å‡åºæ’åˆ—ã€‚</p><p>æŸ¥è¯¢ç»“æœçš„æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><blockquote><p><strong>è¾“å…¥ï¼š</strong></p><p>Views è¡¨ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>+------------+-----------+-----------+------------+
| article_id | author_id | viewer_id | view_date  |
+------------+-----------+-----------+------------+
| 1          | 3         | 5         | 2019-08-01 |
| 1          | 3         | 6         | 2019-08-02 |
| 2          | 7         | 7         | 2019-08-01 |
| 2          | 7         | 6         | 2019-08-02 |
| 4          | 7         | 1         | 2019-07-22 |
| 3          | 4         | 4         | 2019-07-21 |
| 3          | 4         | 4         | 2019-07-21 |
+------------+-----------+-----------+------------+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>è¾“å‡ºï¼š</strong></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>+------+
| id   |
+------+
| 4    |
| 7    |
+------+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h2 id="è§£é¢˜æ€è·¯" tabindex="-1"><a class="header-anchor" href="#è§£é¢˜æ€è·¯" aria-hidden="true">#</a> è§£é¢˜æ€è·¯</h2><h3 id="mysql" tabindex="-1"><a class="header-anchor" href="#mysql" aria-hidden="true">#</a> MySQL</h3><ol><li><p><strong>è¿”å›å­—æ®µ</strong>ï¼š<br><code>SELECT</code> æŒ‡å®šè¦è¿”å›çš„å­—æ®µï¼š<code>DISTINCT author_id AS id</code>ï¼Œè¡¨ç¤ºéœ€è¦è¿”å›å»é‡åçš„ä½œè€… IDã€‚</p></li><li><p><strong>ç­›é€‰æ¡ä»¶</strong>ï¼š</p><ul><li><code>author_id = viewer_id</code>ï¼šç­›é€‰å‡ºä½œè€…æµè§ˆè‡ªå·±æ–‡ç« çš„è®°å½•ã€‚</li><li>ä½¿ç”¨ <code>WHERE</code> å­å¥å°†æ¡ä»¶åº”ç”¨åˆ° <code>Views</code> è¡¨ä¸­ã€‚</li></ul></li><li><p><strong>ç»“æœæ’åº</strong>ï¼š<br> ä½¿ç”¨ <code>ORDER BY author_id ASC</code> æŒ‰ç…§ä½œè€… ID å‡åºæ’åºã€‚</p></li></ol><h4 id="å¤æ‚åº¦åˆ†æ" tabindex="-1"><a class="header-anchor" href="#å¤æ‚åº¦åˆ†æ" aria-hidden="true">#</a> å¤æ‚åº¦åˆ†æ</h4><ul><li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼š<code>O(n)</code>ï¼Œå‡è®¾è¡¨ä¸­æœ‰ <code>n</code> æ¡è®°å½•ï¼Œéœ€è¦éå†æ‰€æœ‰è®°å½•æ¥è¯„ä¼°æ¡ä»¶ã€‚</li><li><strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼šæŸ¥è¯¢æœ¬èº«ä¸å ç”¨é¢å¤–ç©ºé—´ï¼Œè¿”å›çš„ç»“æœå ç”¨çš„ç©ºé—´ä¸æ»¡è¶³æ¡ä»¶çš„è®°å½•æ•°æˆæ­£æ¯”ã€‚</li></ul><hr><h3 id="pandas" tabindex="-1"><a class="header-anchor" href="#pandas" aria-hidden="true">#</a> Pandas</h3><ol><li><p><strong>åŠ è½½æ•°æ®</strong>ï¼šå°† <code>Views</code> è¡¨åŠ è½½åˆ° Pandas çš„ <code>DataFrame</code> ä¸­ã€‚</p></li><li><p><strong>ç­›é€‰æ¡ä»¶</strong>ï¼šä½¿ç”¨ Pandas çš„å¸ƒå°”ç´¢å¼•ç­›é€‰å‡º <code>author_id</code> ç­‰äº <code>viewer_id</code> çš„è®°å½•ã€‚</p></li><li><p><strong>å»é‡æ“ä½œ</strong>ï¼šä½¿ç”¨ <code>.drop_duplicates()</code> æ–¹æ³•è·å–å»é‡åçš„ <code>author_id</code>ã€‚</p></li><li><p><strong>ç»“æœæ’åº</strong>ï¼šä½¿ç”¨ <code>.sort_values(by=&#39;author_id&#39;)</code> å¯¹ç»“æœæŒ‰å‡åºæ’åºã€‚</p></li><li><p><strong>é‡å‘½å</strong>ï¼šä½¿ç”¨ <code>.rename(columns={&#39;author_id&#39;: &#39;id&#39;})</code> å¯¹åˆ—è¿›è¡Œé‡å‘½å</p></li></ol><h2 id="ä»£ç " tabindex="-1"><a class="header-anchor" href="#ä»£ç " aria-hidden="true">#</a> ä»£ç </h2>`,25),y=e("div",{class:"language-sql line-numbers-mode","data-ext":"sql"},[e("pre",{class:"language-sql"},[e("code",null,[e("span",{class:"token keyword"},"SELECT"),n(),e("span",{class:"token keyword"},"DISTINCT"),n(" author_id "),e("span",{class:"token keyword"},"AS"),n(` id
`),e("span",{class:"token keyword"},"FROM"),n(` Views
`),e("span",{class:"token keyword"},"WHERE"),n(" author_id "),e("span",{class:"token operator"},"="),n(` viewer_id
`),e("span",{class:"token keyword"},"ORDER"),n(),e("span",{class:"token keyword"},"BY"),n(" author_id "),e("span",{class:"token keyword"},"ASC"),e("span",{class:"token punctuation"},";"),n(`
`)])]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"})])],-1),E=e("div",{class:"language-python line-numbers-mode","data-ext":"py"},[e("pre",{class:"language-python"},[e("code",null,[e("span",{class:"token keyword"},"import"),n(" pandas "),e("span",{class:"token keyword"},"as"),n(` pd

`),e("span",{class:"token keyword"},"def"),n(),e("span",{class:"token function"},"authors_who_viewed_their_articles"),e("span",{class:"token punctuation"},"("),n("views"),e("span",{class:"token punctuation"},":"),n(" pd"),e("span",{class:"token punctuation"},"."),n("DataFrame"),e("span",{class:"token punctuation"},")"),n(),e("span",{class:"token operator"},"-"),e("span",{class:"token operator"},">"),n(" pd"),e("span",{class:"token punctuation"},"."),n("DataFrame"),e("span",{class:"token punctuation"},":"),n(`
    `),e("span",{class:"token comment"},"# ç­›é€‰ author_id == viewer_id çš„è®°å½•ï¼Œå¹¶å»é‡å’Œæ’åº"),n(`
    `),e("span",{class:"token keyword"},"return"),n(" views"),e("span",{class:"token punctuation"},"["),n("views"),e("span",{class:"token punctuation"},"["),e("span",{class:"token string"},"'author_id'"),e("span",{class:"token punctuation"},"]"),n(),e("span",{class:"token operator"},"=="),n(" views"),e("span",{class:"token punctuation"},"["),e("span",{class:"token string"},"'viewer_id'"),e("span",{class:"token punctuation"},"]"),e("span",{class:"token punctuation"},"]"),e("span",{class:"token punctuation"},"["),e("span",{class:"token punctuation"},"["),e("span",{class:"token string"},"'author_id'"),e("span",{class:"token punctuation"},"]"),e("span",{class:"token punctuation"},"]"),e("span",{class:"token punctuation"},"."),n("drop_duplicates"),e("span",{class:"token punctuation"},"("),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},"."),n("sort_values"),e("span",{class:"token punctuation"},"("),n("by"),e("span",{class:"token operator"},"="),e("span",{class:"token string"},"'author_id'"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},"."),n("rename"),e("span",{class:"token punctuation"},"("),n("columns"),e("span",{class:"token operator"},"="),e("span",{class:"token punctuation"},"{"),e("span",{class:"token string"},"'author_id'"),e("span",{class:"token punctuation"},":"),n(),e("span",{class:"token string"},"'id'"),e("span",{class:"token punctuation"},"}"),e("span",{class:"token punctuation"},")"),n(`
`)])]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"})])],-1);function q(T,C){const o=i("font"),r=i("RouterLink"),l=i("ExternalLinkIcon"),c=i("CodeTabs");return p(),v("div",null,[b,e("p",null,[n("ğŸŸ¢ "),a(o,{color:"#15bd66"},{default:s(()=>[n("Easy")]),_:1}),n("â€ƒ ğŸ”–â€‚ "),a(r,{to:"/tag/database.html"},{default:s(()=>[_]),_:1}),n("â€ƒ ğŸ”—â€‚"),e("a",k,[g,a(l)]),n(),e("a",w,[x,a(l)])]),f,a(c,{id:"176",data:[{id:"MySQL"},{id:"Pandas"}]},{title0:s(({value:t,isActive:d})=>[n("MySQL")]),title1:s(({value:t,isActive:d})=>[n("Pandas")]),tab0:s(({value:t,isActive:d})=>[y]),tab1:s(({value:t,isActive:d})=>[E]),_:1})])}const L=u(h,[["render",q],["__file","1148.html.vue"]]);export{L as default};
