import{_ as c,r as l,o as r,c as p,a as e,b as n,d as t,w as o,f as d,e as u}from"./app-fBVbqwGY.js";const m={},h=e("h1",{id:"_2636-promise-å¯¹è±¡æ± -ğŸ”’",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#_2636-promise-å¯¹è±¡æ± -ğŸ”’","aria-hidden":"true"},"#"),n(" 2636. Promise å¯¹è±¡æ±  ğŸ”’")],-1),f={href:"https://leetcode.cn/problems/promise-pool",target:"_blank",rel:"noopener noreferrer"},k=e("code",null,"åŠ›æ‰£",-1),_={href:"https://leetcode.com/problems/promise-pool",target:"_blank",rel:"noopener noreferrer"},v=e("code",null,"LeetCode",-1),g=u(`<h2 id="é¢˜ç›®" tabindex="-1"><a class="header-anchor" href="#é¢˜ç›®" aria-hidden="true">#</a> é¢˜ç›®</h2><p>Given an array of asynchronous functions <code>functions</code> and a pool limit <code>n</code>, return an asynchronous function <code>promisePool</code>. It should return a promise that resolves when all the input functions resolve.</p><p>Pool limit is defined as the maximum number promises that can be pending at once. <code>promisePool</code> should begin execution of as many functions as possible and continue executing new functions when old promises resolve. <code>promisePool</code> should execute <code>functions[i]</code> then <code>functions[i + 1]</code> then <code>functions[i + 2]</code>, etc. When the last promise resolves, <code>promisePool</code> should also resolve.</p><p>For example, if <code>n = 1</code>, <code>promisePool</code> will execute one function at a time in series. However, if <code>n = 2</code>, it first executes two functions. When either of the two functions resolve, a 3rd function should be executed (if available), and so on until there are no functions left to execute.</p><p>You can assume all functions never reject. It is acceptable for <code>promisePool</code> to return a promise that resolves any value.</p><p><strong>Example 1:</strong></p><blockquote><p>Input: functions = [</p><p>() =&gt; new Promise(res =&gt; setTimeout(res, 300)), () =&gt; new Promise(res =&gt; setTimeout(res, 400)), () =&gt; new Promise(res =&gt; setTimeout(res, 200)) ] n = 2</p><p>Output: [[300,400,500],500]</p><p>Explanation: Three functions are passed in. They sleep for 300ms, 400ms, and 200ms respectively. They resolve at 300ms, 400ms, and 500ms respectively. The returned promise resolves at 500ms.</p><ul><li>At t=0, the first 2 functions are executed. The pool size limit of 2 is reached.</li><li>At t=300, the 1st function resolves, and the 3rd function is executed. Pool size is 2.</li><li>At t=400, the 2nd function resolves. There is nothing left to execute. Pool size is 1.</li><li>At t=500, the 3rd function resolves. Pool size is zero so the returned promise also resolves.</li></ul></blockquote><p><strong>Example 2:</strong></p><blockquote><p>Input: functions = [</p><p>() =&gt; new Promise(res =&gt; setTimeout(res, 300)), () =&gt; new Promise(res =&gt; setTimeout(res, 400)), () =&gt; new Promise(res =&gt; setTimeout(res, 200)) ] n = 5</p><p>Output: [[300,400,200],400]</p><p>Explanation: The three input promises resolve at 300ms, 400ms, and 200ms respectively. The returned promise resolves at 400ms.</p><ul><li>At t=0, all 3 functions are executed. The pool limit of 5 is never met.</li><li>At t=200, the 3rd function resolves. Pool size is 2.</li><li>At t=300, the 1st function resolved. Pool size is 1.</li><li>At t=400, the 2nd function resolves. Pool size is 0, so the returned promise also resolves.</li></ul></blockquote><p><strong>Example 3:</strong></p><blockquote><p>Input: functions = [</p><p>() =&gt; new Promise(res =&gt; setTimeout(res, 300)), () =&gt; new Promise(res =&gt; setTimeout(res, 400)), () =&gt; new Promise(res =&gt; setTimeout(res, 200)) ] n = 1</p><p>Output: [[300,700,900],900]</p><p>Explanation: The three input promises resolve at 300ms, 700ms, and 900ms respectively. The returned promise resolves at 900ms.</p><ul><li>At t=0, the 1st function is executed. Pool size is 1.</li><li>At t=300, the 1st function resolves and the 2nd function is executed. Pool size is 1.</li><li>At t=700, the 2nd function resolves and the 3rd function is executed. Pool size is 1.</li><li>At t=900, the 3rd function resolves. Pool size is 0 so the returned promise resolves.</li></ul></blockquote><p>Constraints:</p><p><code>0 &lt;= functions.length &lt;= 10</code><code>1 &lt;= n &lt;= 10</code></p><h2 id="é¢˜ç›®å¤§æ„" tabindex="-1"><a class="header-anchor" href="#é¢˜ç›®å¤§æ„" aria-hidden="true">#</a> é¢˜ç›®å¤§æ„</h2><p>è¯·ä½ ç¼–å†™ä¸€ä¸ªå¼‚æ­¥å‡½æ•° <code>promisePool</code> ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªå¼‚æ­¥å‡½æ•°æ•°ç»„ <code>functions</code> å’Œ <strong>æ± é™åˆ¶</strong> <code>n</code>ã€‚å®ƒåº”è¯¥è¿”å›ä¸€ä¸ª promise å¯¹è±¡ï¼Œå½“æ‰€æœ‰è¾“å…¥å‡½æ•°éƒ½æ‰§è¡Œå®Œæ¯•åï¼Œpromise å¯¹è±¡å°±æ‰§è¡Œå®Œæ¯•ã€‚</p><p><strong>æ± é™åˆ¶</strong> å®šä¹‰æ˜¯ä¸€æ¬¡å¯ä»¥æŒ‚èµ·çš„æœ€å¤š promise å¯¹è±¡çš„æ•°é‡ã€‚<code>promisePool</code> åº”è¯¥å¼€å§‹æ‰§è¡Œå°½å¯èƒ½å¤šçš„å‡½æ•°ï¼Œå¹¶åœ¨æ—§çš„ promise æ‰§è¡Œå®Œæ¯•åç»§ç»­æ‰§è¡Œæ–°å‡½æ•°ã€‚<code>promisePool</code> åº”è¯¥å…ˆæ‰§è¡Œ <code>functions[i]</code>ï¼Œå†æ‰§è¡Œ <code>functions[i + 1]</code>ï¼Œç„¶åæ‰§è¡Œ <code>functions[i + 2]</code>ï¼Œç­‰ç­‰ã€‚å½“æœ€åä¸€ä¸ª promise æ‰§è¡Œå®Œæ¯•æ—¶ï¼Œ<code>promisePool</code> ä¹Ÿåº”è¯¥æ‰§è¡Œå®Œæ¯•ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœ <code>n = 1</code> , <code>promisePool</code> åœ¨åºåˆ—ä¸­æ¯æ¬¡æ‰§è¡Œä¸€ä¸ªå‡½æ•°ã€‚ç„¶è€Œï¼Œå¦‚æœ <code>n = 2</code> ï¼Œå®ƒé¦–å…ˆæ‰§è¡Œä¸¤ä¸ªå‡½æ•°ã€‚å½“ä¸¤ä¸ªå‡½æ•°ä¸­çš„ä»»ä½•ä¸€ä¸ªæ‰§è¡Œå®Œæ¯•åï¼Œå†æ‰§è¡Œç¬¬ä¸‰ä¸ªå‡½æ•°(å¦‚æœå®ƒæ˜¯å¯ç”¨çš„)ï¼Œä¾æ­¤ç±»æ¨ï¼Œç›´åˆ°æ²¡æœ‰å‡½æ•°è¦æ‰§è¡Œä¸ºæ­¢ã€‚</p><p>ä½ å¯ä»¥å‡è®¾æ‰€æœ‰çš„ <code>functions</code> éƒ½ä¸ä¼šè¢«æ‹’ç»ã€‚å¯¹äº <code>promisePool</code> æ¥è¯´ï¼Œè¿”å›ä¸€ä¸ªå¯ä»¥è§£æä»»ä½•å€¼çš„ promise éƒ½æ˜¯å¯ä»¥æ¥å—çš„ã€‚</p><h2 id="è§£é¢˜æ€è·¯" tabindex="-1"><a class="header-anchor" href="#è§£é¢˜æ€è·¯" aria-hidden="true">#</a> è§£é¢˜æ€è·¯</h2><p><strong>æ± é™åˆ¶</strong>çš„æ ¸å¿ƒæ˜¯æ§åˆ¶å¹¶å‘æ•°é‡ï¼Œå³åŒæ—¶åªèƒ½æœ‰æœ€å¤š <code>n</code> ä¸ªå¼‚æ­¥ä»»åŠ¡åœ¨æ‰§è¡Œï¼Œéœ€è¦åœ¨ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œåï¼Œæ‰èƒ½å¯åŠ¨æ–°çš„ä»»åŠ¡ã€‚</p><ol><li><p>å®šä¹‰ä¸€ä¸ªè°ƒåº¦å™¨å‡½æ•°<code>executeNext</code>ï¼Œå®ƒä¼šé€’å½’åœ°è°ƒç”¨è‡ªèº«ä»¥ç¡®ä¿æ‰€æœ‰ä»»åŠ¡æŒ‰é¡ºåºæ‰§è¡Œã€‚æ¯æ¬¡æ‰§è¡Œä¸€ä¸ªå‡½æ•°åï¼Œä¼šç»§ç»­æ‰§è¡Œä¸‹ä¸€ä¸ªå‡½æ•°ï¼Œç›´åˆ°å‡½æ•°æ•°ç»„ä¸ºç©ºã€‚</p></li><li><p>åˆ›å»ºå¹¶å‘æ± ï¼Œä½¿ç”¨ <code>Array(n).fill(null)</code> åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º <code>n</code> çš„æ•°ç»„ï¼Œ<code>map</code> æ–¹æ³•ç”¨æ¥è°ƒç”¨ <code>executeNext</code>ï¼Œå³å¯åŠ¨ <code>n</code> ä¸ªå¹¶å‘ä»»åŠ¡ã€‚</p></li><li><p><code>Promise.all</code> ä¼šç­‰å¾…æ‰€æœ‰å¹¶å‘ä»»åŠ¡å®Œæˆï¼Œç¡®ä¿ <code>promisePool</code> å‡½æ•°åœ¨æ‰€æœ‰ä»»åŠ¡éƒ½æ‰§è¡Œå®Œåæ‰ resolveã€‚</p></li></ol><h4 id="å¤æ‚åº¦åˆ†æ" tabindex="-1"><a class="header-anchor" href="#å¤æ‚åº¦åˆ†æ" aria-hidden="true">#</a> å¤æ‚åº¦åˆ†æ</h4><ul><li><strong>æ—¶é—´å¤æ‚åº¦</strong>: <code>O(m)</code>ï¼Œå…¶ä¸­ <code>m</code> æ˜¯ <code>functions</code> çš„é•¿åº¦ã€‚æ¯ä¸ªä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´å–å†³äºå„è‡ªçš„æ‰§è¡Œæ—¶é—´ï¼Œæ€»å…±ä¼šæ‰§è¡Œ <code>m</code> ä¸ªä»»åŠ¡ã€‚</li><li><strong>ç©ºé—´å¤æ‚åº¦</strong>: <code>O(n)</code>ï¼Œå› ä¸ºæœ€å¤šä¼šåŒæ—¶æ‰§è¡Œ <code>n</code> ä¸ªä»»åŠ¡ã€‚</li></ul><h2 id="ä»£ç " tabindex="-1"><a class="header-anchor" href="#ä»£ç " aria-hidden="true">#</a> ä»£ç </h2><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>Function<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span> <span class="token parameter">functions</span>
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>Number<span class="token punctuation">}</span></span> <span class="token parameter">n</span>
 * <span class="token keyword">@return</span> <span class="token class-name"><span class="token punctuation">{</span>Function<span class="token punctuation">}</span></span>
 */</span>
<span class="token keyword">var</span> <span class="token function-variable function">promisePool</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">functions<span class="token punctuation">,</span> n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> <span class="token function-variable function">executeNext</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>functions<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token comment">// æ‰€æœ‰å‡½æ•°éƒ½æ‰§è¡Œå®Œæ¯•</span>
		<span class="token keyword">const</span> fn <span class="token operator">=</span> functions<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å–å‡ºä¸‹ä¸€ä¸ªè¦æ‰§è¡Œçš„å‡½æ•°</span>
		<span class="token keyword">await</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ‰§è¡Œå‡½æ•°å¹¶ç­‰å¾…å…¶å®Œæˆ</span>
		<span class="token keyword">await</span> <span class="token function">executeNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é€’å½’è°ƒç”¨ï¼Œå¤„ç†ä¸‹ä¸€ä¸ªä»»åŠ¡</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>

	<span class="token comment">// åˆ›å»º n ä¸ªå¹¶å‘ä»»åŠ¡ï¼Œå¼€å§‹æ‰§è¡Œ</span>
	<span class="token keyword">const</span> pool <span class="token operator">=</span> <span class="token function">Array</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>executeNext<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// ç­‰å¾…æ‰€æœ‰å¹¶å‘ä»»åŠ¡éƒ½å®Œæˆ</span>
	<span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Example usage:
 * const sleep = (time) =&gt; new Promise(resolve =&gt; setTimeout(resolve, time));
 *
 * promisePool([() =&gt; sleep(500), () =&gt; sleep(400), () =&gt; sleep(300)], 2)
 *   .then(() =&gt; console.log(&#39;All functions done&#39;));
 */</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ç›¸å…³é¢˜ç›®" tabindex="-1"><a class="header-anchor" href="#ç›¸å…³é¢˜ç›®" aria-hidden="true">#</a> ç›¸å…³é¢˜ç›®</h2>`,26),b=e("thead",null,[e("tr",null,[e("th",{style:{"text-align":"center"}},"é¢˜å·"),e("th",{style:{"text-align":"left"}},"æ ‡é¢˜"),e("th",{style:{"text-align":"center"}},"é¢˜è§£"),e("th",{style:{"text-align":"left"}},"æ ‡ç­¾"),e("th",{style:{"text-align":"center"}},"éš¾åº¦"),e("th",{style:{"text-align":"center"}},"åŠ›æ‰£")])],-1),x=e("td",{style:{"text-align":"center"}},"2621",-1),y=e("td",{style:{"text-align":"left"}},"ç¡çœ å‡½æ•°",-1),w={style:{"text-align":"center"}},P=e("td",{style:{"text-align":"left"}},null,-1),T=e("td",{style:{"text-align":"center"}},"ğŸŸ¢",-1),A={style:{"text-align":"center"}},z={href:"https://leetcode.cn/problems/sleep",target:"_blank",rel:"noopener noreferrer"},N={href:"https://leetcode.com/problems/sleep",target:"_blank",rel:"noopener noreferrer"},E=e("td",{style:{"text-align":"center"}},"2622",-1),I=e("td",{style:{"text-align":"left"}},"æœ‰æ—¶é—´é™åˆ¶çš„ç¼“å­˜",-1),q={style:{"text-align":"center"}},C=e("td",{style:{"text-align":"left"}},null,-1),L=e("td",{style:{"text-align":"center"}},"ğŸŸ ",-1),O={style:{"text-align":"center"}},V={href:"https://leetcode.cn/problems/cache-with-time-limit",target:"_blank",rel:"noopener noreferrer"},j={href:"https://leetcode.com/problems/cache-with-time-limit",target:"_blank",rel:"noopener noreferrer"},B=e("td",{style:{"text-align":"center"}},"2637",-1),F=e("td",{style:{"text-align":"left"}},"æœ‰æ—¶é—´é™åˆ¶çš„ Promise å¯¹è±¡",-1),R={style:{"text-align":"center"}},W=e("td",{style:{"text-align":"left"}},null,-1),G=e("td",{style:{"text-align":"center"}},"ğŸŸ ",-1),H={style:{"text-align":"center"}},M={href:"https://leetcode.cn/problems/promise-time-limit",target:"_blank",rel:"noopener noreferrer"},S={href:"https://leetcode.com/problems/promise-time-limit",target:"_blank",rel:"noopener noreferrer"},Y=e("td",{style:{"text-align":"center"}},"2676",-1),D=e("td",{style:{"text-align":"left"}},"èŠ‚æµ ğŸ”’",-1),J={style:{"text-align":"center"}},K=e("td",{style:{"text-align":"left"}},null,-1),Q=e("td",{style:{"text-align":"center"}},"ğŸŸ ",-1),U={style:{"text-align":"center"}},X={href:"https://leetcode.cn/problems/throttle",target:"_blank",rel:"noopener noreferrer"},Z={href:"https://leetcode.com/problems/throttle",target:"_blank",rel:"noopener noreferrer"};function $(ee,ne){const i=l("font"),s=l("ExternalLinkIcon"),a=l("RouterLink");return r(),p("div",null,[h,e("p",null,[n("ğŸŸ  "),t(i,{color:"#ffb800"},{default:o(()=>[n("Medium")]),_:1}),n("â€ƒ ğŸ”—â€‚"),e("a",f,[k,t(s)]),n(),e("a",_,[v,t(s)])]),g,d(" prettier-ignore "),e("table",null,[b,e("tbody",null,[e("tr",null,[x,y,e("td",w,[t(a,{to:"/problem/2621.html"},{default:o(()=>[n("[âœ“]")]),_:1})]),P,T,e("td",A,[e("a",z,[n("ğŸ€„ï¸"),t(s)]),n(),e("a",N,[n("ğŸ”—"),t(s)])])]),e("tr",null,[E,I,e("td",q,[t(a,{to:"/problem/2622.html"},{default:o(()=>[n("[âœ“]")]),_:1})]),C,L,e("td",O,[e("a",V,[n("ğŸ€„ï¸"),t(s)]),n(),e("a",j,[n("ğŸ”—"),t(s)])])]),e("tr",null,[B,F,e("td",R,[t(a,{to:"/problem/2637.html"},{default:o(()=>[n("[âœ“]")]),_:1})]),W,G,e("td",H,[e("a",M,[n("ğŸ€„ï¸"),t(s)]),n(),e("a",S,[n("ğŸ”—"),t(s)])])]),e("tr",null,[Y,D,e("td",J,[t(a,{to:"/problem/2676.html"},{default:o(()=>[n("[âœ“]")]),_:1})]),K,Q,e("td",U,[e("a",X,[n("ğŸ€„ï¸"),t(s)]),n(),e("a",Z,[n("ğŸ”—"),t(s)])])])])])])}const se=c(m,[["render",$],["__file","2636.html.vue"]]);export{se as default};
