---
title: 308. 二维区域和检索 - 矩阵可修改 🔒
description: LeetCode 308. 二维区域和检索 - 矩阵可修改 🔒题解，Range Sum Query 2D - Mutable，包含解题思路、复杂度分析以及完整的 JavaScript 代码实现。
keywords:
  - LeetCode
  - 308. 二维区域和检索 - 矩阵可修改 🔒
  - 二维区域和检索 - 矩阵可修改
  - Range Sum Query 2D - Mutable
  - 解题思路
  - 设计
  - 树状数组
  - 线段树
  - 数组
  - 矩阵
---

# 308. 二维区域和检索 - 矩阵可修改 🔒

🔴 <font color=#ff334b>Hard</font>&emsp; 🔖&ensp; [`设计`](/tag/design.md) [`树状数组`](/tag/binary-indexed-tree.md) [`线段树`](/tag/segment-tree.md) [`数组`](/tag/array.md) [`矩阵`](/tag/matrix.md)&emsp; 🔗&ensp;[`力扣`](https://leetcode.cn/problems/range-sum-query-2d-mutable) [`LeetCode`](https://leetcode.com/problems/range-sum-query-2d-mutable)

## 题目

Given a 2D matrix `matrix`, handle multiple queries of the following types:

  1. **Update** the value of a cell in `matrix`.
  2. Calculate the **sum** of the elements of `matrix` inside the rectangle defined by its **upper left corner** `(row1, col1)` and **lower right corner** `(row2, col2)`.

Implement the NumMatrix class:

  * `NumMatrix(int[][] matrix)` Initializes the object with the integer matrix `matrix`.
  * `void update(int row, int col, int val)` **Updates** the value of `matrix[row][col]` to be `val`.
  * `int sumRegion(int row1, int col1, int row2, int col2)` Returns the **sum** of the elements of `matrix` inside the rectangle defined by its **upper left corner** `(row1, col1)` and **lower right corner** `(row2, col2)`.



**Example 1:**

![](https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/0300-0399/0308.Range%20Sum%20Query%202D%20-%20Mutable/images/summut-
grid.jpg)

> 
> 
> 
> 
> 
> **Input**
> 
> ["NumMatrix", "sumRegion", "update", "sumRegion"]
> 
> [[[[3, 0, 1, 4, 2], [5, 6, 3, 2, 1], [1, 2, 0, 1, 5], [4, 1, 0, 1, 7], [1, 0, 3, 0, 5]]], [2, 1, 4, 3], [3, 2, 2], [2, 1, 4, 3]]
> 
> **Output**
> 
> [null, 8, null, 10]
> 
> 
> 
> **Explanation**
> 
> NumMatrix numMatrix = new NumMatrix([[3, 0, 1, 4, 2], [5, 6, 3, 2, 1], [1, 2, 0, 1, 5], [4, 1, 0, 1, 7], [1, 0, 3, 0, 5]]);
> 
> numMatrix.sumRegion(2, 1, 4, 3); // return 8 (i.e. sum of the left red rectangle)
> 
> numMatrix.update(3, 2, 2); // matrix changes from left image to right image
> 
> numMatrix.sumRegion(2, 1, 4, 3); // return 10 (i.e. sum of the right red rectangle)
> 
> 

**Constraints:**

  * `m == matrix.length`
  * `n == matrix[i].length`
  * `1 <= m, n <= 200`
  * `-1000 <= matrix[i][j] <= 1000`
  * `0 <= row < m`
  * `0 <= col < n`
  * `-1000 <= val <= 1000`
  * `0 <= row1 <= row2 < m`
  * `0 <= col1 <= col2 < n`
  * At most `5000` calls will be made to `sumRegion` and `update`.


## 题目大意

给你一个二维矩阵 `matrix` ，处理以下类型的多个查询:

  1. **更新** `matrix` 中单元格的值。
  2. 计算由 **左上角** `(row1, col1)` 和 **右下角** `(row2, col2)` 定义的 `matrix` 内矩阵元素的 **和** 。

实现 `NumMatrix` 类：

  * `NumMatrix(int[][] matrix)` 用整数矩阵 `matrix` 初始化对象。
  * `void update(int row, int col, int val)` **更新** `matrix[row][col]` 的值到 `val` 。
  * `int sumRegion(int row1, int col1, int row2, int col2)` 返回矩阵 `matrix` 中指定矩形区域元素的 **和** ，该区域由 **左上角** `(row1, col1)` 和 **右下角** `(row2, col2)` 界定。



**示例 1：**

![](https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/0300-0399/0308.Range%20Sum%20Query%202D%20-%20Mutable/images/summut-
grid.jpg)

> 
> 
> 
> 
> 
> **输入**
> 
> ["NumMatrix", "sumRegion", "update", "sumRegion"]
> 
> [[[[3, 0, 1, 4, 2], [5, 6, 3, 2, 1], [1, 2, 0, 1, 5], [4, 1, 0, 1, 7], [1, 0, 3, 0, 5]]], [2, 1, 4, 3], [3, 2, 2], [2, 1, 4, 3]]
> 
> **输出**
> 
> [null, 8, null, 10]
> 
> 
> 
> **解释**
> 
> NumMatrix numMatrix = new NumMatrix([[3, 0, 1, 4, 2], [5, 6, 3, 2, 1], [1, 2, 0, 1, 5], [4, 1, 0, 1, 7], [1, 0, 3, 0, 5]]);
> 
> numMatrix.sumRegion(2, 1, 4, 3); // 返回 8 (即, 左侧红色矩形的和)
> 
> numMatrix.update(3, 2, 2); // 矩阵从左图变为右图
> 
> numMatrix.sumRegion(2, 1, 4, 3); // 返回 10 (即，右侧红色矩形的和)
> 
> 
> 
> 



**提示：**

  * `m == matrix.length`
  * `n == matrix[i].length`
  * `1 <= m, n <= 200`
  * `-10^5 <= matrix[i][j] <= 10^5`
  * `0 <= row < m`
  * `0 <= col < n`
  * `-10^5 <= val <= 10^5`
  * `0 <= row1 <= row2 < m`
  * `0 <= col1 <= col2 < n`
  * 最多调用`10^4` 次 `sumRegion` 和 `update` 方法


## 解题思路

#### 复杂度分析

- **时间复杂度**：`O()`，
- **空间复杂度**：`O()`，

## 代码

```javascript

```

## 相关题目

<!-- prettier-ignore -->
| 题号 | 标题 | 题解 | 标签 | 难度 | 力扣 |
| :------: | :------ | :------: | :------ | :------: | :------: |
| 304 | 二维区域和检索 - 矩阵不可变 | [[✓]](/problem/0304.md) |  [`设计`](/tag/design.md) [`数组`](/tag/array.md) [`矩阵`](/tag/matrix.md) `1+` | 🟠 | [🀄️](https://leetcode.cn/problems/range-sum-query-2d-immutable) [🔗](https://leetcode.com/problems/range-sum-query-2d-immutable) |
| 307 | 区域和检索 - 数组可修改 | [[✓]](/problem/0307.md) |  [`设计`](/tag/design.md) [`树状数组`](/tag/binary-indexed-tree.md) [`线段树`](/tag/segment-tree.md) `1+` | 🟠 | [🀄️](https://leetcode.cn/problems/range-sum-query-mutable) [🔗](https://leetcode.com/problems/range-sum-query-mutable) |
| 2536 | 子矩阵元素加 1 |  |  [`数组`](/tag/array.md) [`矩阵`](/tag/matrix.md) [`前缀和`](/tag/prefix-sum.md) | 🟠 | [🀄️](https://leetcode.cn/problems/increment-submatrices-by-one) [🔗](https://leetcode.com/problems/increment-submatrices-by-one) |
| 2718 | 查询后矩阵的和 |  |  [`数组`](/tag/array.md) [`哈希表`](/tag/hash-table.md) | 🟠 | [🀄️](https://leetcode.cn/problems/sum-of-matrix-after-queries) [🔗](https://leetcode.com/problems/sum-of-matrix-after-queries) |