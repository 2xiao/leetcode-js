# [2502. è®¾è®¡å†…å­˜åˆ†é…å™¨](https://leetcode.com/problems/design-memory-allocator)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`è®¾è®¡`](/outline/tag/design.md) [`æ•°ç»„`](/outline/tag/array.md) [`å“ˆå¸Œè¡¨`](/outline/tag/hash-table.md) [`æ¨¡æ‹Ÿ`](/outline/tag/simulation.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/design-memory-allocator)

## é¢˜ç›®

You are given an integer `n` representing the size of a **0-indexed** memory
array. All memory units are initially free.

You have a memory allocator with the following functionalities:

  1. **Allocate** a block of `size` consecutive free memory units and assign it the id `mID`.
  2. **Free** all memory units with the given id `mID`.

**Note** that:

  * Multiple blocks can be allocated to the same `mID`.
  * You should free all the memory units with `mID`, even if they were allocated in different blocks.

Implement the `Allocator` class:

  * `Allocator(int n)` Initializes an `Allocator` object with a memory array of size `n`.
  * `int allocate(int size, int mID)` Find the **leftmost** block of `size` **consecutive** free memory units and allocate it with the id `mID`. Return the block's first index. If such a block does not exist, return `-1`.
  * `int free(int mID)` Free all memory units with the id `mID`. Return the number of memory units you have freed.



**Example 1:**

> 
> 
> 
> 
> 
> **Input**
> 
> ["Allocator", "allocate", "allocate", "allocate", "free", "allocate", "allocate", "allocate", "free", "allocate", "free"]
> 
> [[10], [1, 1], [1, 2], [1, 3], [2], [3, 4], [1, 1], [1, 1], [1], [10, 2], [7]]
> 
> **Output**
> 
> [null, 0, 1, 2, 1, 3, 1, 6, 3, -1, 0]
> 
> 
> 
> **Explanation**
> 
> Allocator loc = new Allocator(10); // Initialize a memory array of size 10. All memory units are initially free.
> 
> loc.allocate(1, 1); // The leftmost block's first index is 0. The memory array becomes [**1** ,_,_,_,_,_,_,_,_,_]. We return 0.
> 
> loc.allocate(1, 2); // The leftmost block's first index is 1. The memory array becomes [1,**2** ,_,_,_,_,_,_,_,_]. We return 1.
> 
> loc.allocate(1, 3); // The leftmost block's first index is 2. The memory array becomes [1,2,**3** ,_,_,_,_,_,_,_]. We return 2.
> 
> loc.free(2); // Free all memory units with mID 2. The memory array becomes [1,_, 3,_,_,_,_,_,_,_]. We return 1 since there is only 1 unit with mID 2.
> 
> loc.allocate(3, 4); // The leftmost block's first index is 3. The memory array becomes [1,_,3,**4** ,**4** ,**4** ,_,_,_,_]. We return 3.
> 
> loc.allocate(1, 1); // The leftmost block's first index is 1. The memory array becomes [1,**1** ,3,4,4,4,_,_,_,_]. We return 1.
> 
> loc.allocate(1, 1); // The leftmost block's first index is 6. The memory array becomes [1,1,3,4,4,4,**1** ,_,_,_]. We return 6.
> 
> loc.free(1); // Free all memory units with mID 1. The memory array becomes [_,_,3,4,4,4,_,_,_,_]. We return 3 since there are 3 units with mID 1.
> 
> loc.allocate(10, 2); // We can not find any free block with 10 consecutive free memory units, so we return -1.
> 
> loc.free(7); // Free all memory units with mID 7. The memory array remains the same since there is no memory unit with mID 7. We return 0.

**Constraints:**

  * `1 <= n, size, mID <= 1000`
  * At most `1000` calls will be made to `allocate` and `free`.


## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªæ•´æ•° `n` ï¼Œè¡¨ç¤ºä¸‹æ ‡ä» **0** å¼€å§‹çš„å†…å­˜æ•°ç»„çš„å¤§å°ã€‚æ‰€æœ‰å†…å­˜å•å…ƒå¼€å§‹éƒ½æ˜¯ç©ºé—²çš„ã€‚

è¯·ä½ è®¾è®¡ä¸€ä¸ªå…·å¤‡ä»¥ä¸‹åŠŸèƒ½çš„å†…å­˜åˆ†é…å™¨ï¼š

  1. **åˆ†é…** ä¸€å—å¤§å°ä¸º `size` çš„è¿ç»­ç©ºé—²å†…å­˜å•å…ƒå¹¶èµ‹ id `mID` ã€‚
  2. **é‡Šæ”¾** ç»™å®š id `mID` å¯¹åº”çš„æ‰€æœ‰å†…å­˜å•å…ƒã€‚

**æ³¨æ„ï¼š**

  * å¤šä¸ªå—å¯ä»¥è¢«åˆ†é…åˆ°åŒä¸€ä¸ª `mID` ã€‚
  * ä½ å¿…é¡»é‡Šæ”¾ `mID` å¯¹åº”çš„æ‰€æœ‰å†…å­˜å•å…ƒï¼Œå³ä¾¿è¿™äº›å†…å­˜å•å…ƒè¢«åˆ†é…åœ¨ä¸åŒçš„å—ä¸­ã€‚

å®ç° `Allocator` ç±»ï¼š

  * `Allocator(int n)` ä½¿ç”¨ä¸€ä¸ªå¤§å°ä¸º `n` çš„å†…å­˜æ•°ç»„åˆå§‹åŒ– `Allocator` å¯¹è±¡ã€‚
  * `int allocate(int size, int mID)` æ‰¾å‡ºå¤§å°ä¸º `size` ä¸ªè¿ç»­ç©ºé—²å†…å­˜å•å…ƒä¸”ä½äº  **æœ€å·¦ä¾§** çš„å—ï¼Œåˆ†é…å¹¶èµ‹ id `mID` ã€‚è¿”å›å—çš„ç¬¬ä¸€ä¸ªä¸‹æ ‡ã€‚å¦‚æœä¸å­˜åœ¨è¿™æ ·çš„å—ï¼Œè¿”å› `-1` ã€‚
  * `int free(int mID)` é‡Šæ”¾ id `mID` å¯¹åº”çš„æ‰€æœ‰å†…å­˜å•å…ƒã€‚è¿”å›é‡Šæ”¾çš„å†…å­˜å•å…ƒæ•°ç›®ã€‚



**ç¤ºä¾‹ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥**
> 
> ["Allocator", "allocate", "allocate", "allocate", "free", "allocate", "allocate", "allocate", "free", "allocate", "free"]
> 
> [[10], [1, 1], [1, 2], [1, 3], [2], [3, 4], [1, 1], [1, 1], [1], [10, 2], [7]]
> 
> **è¾“å‡º**
> 
> [null, 0, 1, 2, 1, 3, 1, 6, 3, -1, 0]
> 
> 
> 
> **è§£é‡Š**
> 
> Allocator loc = new Allocator(10); // åˆå§‹åŒ–ä¸€ä¸ªå¤§å°ä¸º 10 çš„å†…å­˜æ•°ç»„ï¼Œæ‰€æœ‰å†…å­˜å•å…ƒéƒ½æ˜¯ç©ºé—²çš„ã€‚
> 
> loc.allocate(1, 1); // æœ€å·¦ä¾§çš„å—çš„ç¬¬ä¸€ä¸ªä¸‹æ ‡æ˜¯ 0 ã€‚å†…å­˜æ•°ç»„å˜ä¸º [**1** , , , , , , , , , ]ã€‚è¿”å› 0 ã€‚
> 
> loc.allocate(1, 2); // æœ€å·¦ä¾§çš„å—çš„ç¬¬ä¸€ä¸ªä¸‹æ ‡æ˜¯ 1 ã€‚å†…å­˜æ•°ç»„å˜ä¸º [1,**2** , , , , , , , , ]ã€‚è¿”å› 1 ã€‚
> 
> loc.allocate(1, 3); // æœ€å·¦ä¾§çš„å—çš„ç¬¬ä¸€ä¸ªä¸‹æ ‡æ˜¯ 2 ã€‚å†…å­˜æ•°ç»„å˜ä¸º [1,2,**3** , , , , , , , ]ã€‚è¿”å› 2 ã€‚
> 
> loc.free(2); // é‡Šæ”¾ mID ä¸º 2 çš„æ‰€æœ‰å†…å­˜å•å…ƒã€‚å†…å­˜æ•°ç»„å˜ä¸º [1, ,**3** , , , , , , , ] ã€‚è¿”å› 1 ï¼Œå› ä¸ºåªæœ‰ 1 ä¸ª mID ä¸º 2 çš„å†…å­˜å•å…ƒã€‚
> 
> loc.allocate(3, 4); // æœ€å·¦ä¾§çš„å—çš„ç¬¬ä¸€ä¸ªä¸‹æ ‡æ˜¯ 3 ã€‚å†…å­˜æ•°ç»„å˜ä¸º [1, ,3,**4** ,**4** ,**4** , , , , ]ã€‚è¿”å› 3 ã€‚
> 
> loc.allocate(1, 1); // æœ€å·¦ä¾§çš„å—çš„ç¬¬ä¸€ä¸ªä¸‹æ ‡æ˜¯ 1 ã€‚å†…å­˜æ•°ç»„å˜ä¸º [1,**1** ,3,4,4,4, , , , ]ã€‚è¿”å› 1 ã€‚
> 
> loc.allocate(1, 1); // æœ€å·¦ä¾§çš„å—çš„ç¬¬ä¸€ä¸ªä¸‹æ ‡æ˜¯ 6 ã€‚å†…å­˜æ•°ç»„å˜ä¸º [1,1,3,4,4,4,**1** , , , ]ã€‚è¿”å› 6 ã€‚
> 
> loc.free(1); // é‡Šæ”¾ mID ä¸º 1 çš„æ‰€æœ‰å†…å­˜å•å…ƒã€‚å†…å­˜æ•°ç»„å˜ä¸º [ , ,3,4,4,4,**** , , , ] ã€‚è¿”å› 3 ï¼Œå› ä¸ºæœ‰ 3 ä¸ª mID ä¸º 1 çš„å†…å­˜å•å…ƒã€‚
> 
> loc.allocate(10, 2); // æ— æ³•æ‰¾å‡ºé•¿åº¦ä¸º 10 ä¸ªè¿ç»­ç©ºé—²å†…å­˜å•å…ƒçš„ç©ºé—²å—ï¼Œæ‰€æœ‰è¿”å› -1 ã€‚
> 
> loc.free(7); // é‡Šæ”¾ mID ä¸º 7 çš„æ‰€æœ‰å†…å­˜å•å…ƒã€‚å†…å­˜æ•°ç»„ä¿æŒåŸçŠ¶ï¼Œå› ä¸ºä¸å­˜åœ¨ mID ä¸º 7 çš„å†…å­˜å•å…ƒã€‚è¿”å› 0 ã€‚
> 
> 



**æç¤ºï¼š**

  * `1 <= n, size, mID <= 1000`
  * æœ€å¤šè°ƒç”¨ `allocate` å’Œ `free` æ–¹æ³• `1000` æ¬¡


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```