---
title: 3390. Longest Team Pass Streak ğŸ”’
description: LeetCode 3390. Longest Team Pass Streak ğŸ”’é¢˜è§£ï¼ŒLongest Team Pass Streakï¼ŒåŒ…å«è§£é¢˜æ€è·¯ã€å¤æ‚åº¦åˆ†æä»¥åŠå®Œæ•´çš„ JavaScript ä»£ç å®ç°ã€‚
keywords:
  - LeetCode
  - 3390. Longest Team Pass Streak ğŸ”’
  - Longest Team Pass Streak
  - Longest Team Pass Streak
  - è§£é¢˜æ€è·¯
  - æ•°æ®åº“
---

# 3390. Longest Team Pass Streak ğŸ”’

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/longest-team-pass-streak) [`LeetCode`](https://leetcode.com/problems/longest-team-pass-streak)

## é¢˜ç›®

Table: `Teams`

> 
> 
> 
> 
> 
> +-------------+---------+
> 
> | Column Name | Type> 
> |
> 
> +-------------+---------+
> 
> | player_id   | int> 
>  |
> 
> | team_name   | varchar | 
> 
> +-------------+---------+
> 
> player_id is the unique key for this table.
> 
> Each row contains the unique identifier for player and the name of one of the teams participating in that match.
> 
> 

Table: `Passes`

> 
> 
> 
> 
> 
> +-------------+---------+
> 
> | Column Name | Type> 
> |
> 
> +-------------+---------+
> 
> | pass_from   | int> 
>  |
> 
> | time_stamp  | varchar |
> 
> | pass_to> 
>  | int> 
>  |
> 
> +-------------+---------+
> 
> (pass_from, time_stamp) is the unique key for this table.
> 
> pass_from is a foreign key to player_id from Teams table.
> 
> Each row represents a pass made during a match, time_stamp represents the time in minutes (00:00-90:00) when the pass was made,
> 
> pass_to is the player_id of the player receiving the pass.
> 
> 

Write a solution to find the **longest successful pass streak** for **each
team** during the match. The rules are as follows:

  * A successful pass streak is defined as consecutive passes where: 
> 
> * Both the `pass_from` and `pass_to` players belong to the same team
  * A streak breaks when either: 
> 
> * The pass is intercepted (received by a player from the opposing team)

Return _the result table ordered by_ `team_name` _in**ascending** order_.

The result format is in the following example.



**Example:**

**Input:**

Teams table:

> 
> 
> 
> 
> 
> +-----------+-----------+
> 
> | player_id | team_name |
> 
> +-----------+-----------+
> 
> | 1> 
> > 
>  | Arsenal   |
> 
> | 2> 
> > 
>  | Arsenal   |
> 
> | 3> 
> > 
>  | Arsenal   |
> 
> | 4> 
> > 
>  | Arsenal   |
> 
> | 5> 
> > 
>  | Chelsea   |
> 
> | 6> 
> > 
>  | Chelsea   |
> 
> | 7> 
> > 
>  | Chelsea   |
> 
> | 8> 
> > 
>  | Chelsea   |
> 
> +-----------+-----------+
> 
> 

Passes table:

> 
> 
> 
> 
> 
> +-----------+------------+---------+
> 
> | pass_from | time_stamp | pass_to |
> 
> +-----------+------------+---------+
> 
> | 1> 
> > 
>  | 00:05> 
>   | 2> 
>    |
> 
> | 2> 
> > 
>  | 00:07> 
>   | 3> 
>    |
> 
> | 3> 
> > 
>  | 00:08> 
>   | 4> 
>    |
> 
> | 4> 
> > 
>  | 00:10> 
>   | 5> 
>    |
> 
> | 6> 
> > 
>  | 00:15> 
>   | 7> 
>    |
> 
> | 7> 
> > 
>  | 00:17> 
>   | 8> 
>    |
> 
> | 8> 
> > 
>  | 00:20> 
>   | 6> 
>    |
> 
> | 6> 
> > 
>  | 00:22> 
>   | 5> 
>    |
> 
> | 1> 
> > 
>  | 00:25> 
>   | 2> 
>    |
> 
> | 2> 
> > 
>  | 00:27> 
>   | 3> 
>    |
> 
> +-----------+------------+---------+
> 
> 

**Output:**

> 
> 
> 
> 
> 
> +-----------+----------------+
> 
> | team_name | longest_streak |
> 
> +-----------+----------------+
> 
> | Arsenal   | 3> 
> > 
> > 
>   |
> 
> | Chelsea   | 4> 
> > 
> > 
>   |
> 
> +-----------+----------------+
> 
> 

**Explanation:**

  * **Arsenal** 's streaks: 
> 
> * First streak: 3 passes (1->2->3->4) ended when player 4 passed to Chelsea's player 5
> 
> * Second streak: 2 passes (1->2->3)
> 
> * Longest streak = 3
  * **Chelsea** 's streaks: 
> 
> * First streak: 3 passes (6->7->8->6->5)
> 
> * Longest streak = 4


## é¢˜ç›®å¤§æ„

Table: `Teams`

> 
> 
> 
> 
> 
> +-------------+---------+
> 
> | Column Name | Type> 
> |
> 
> +-------------+---------+
> 
> | player_id   | int> 
>  |
> 
> | team_name   | varchar | 
> 
> +-------------+---------+
> 
> player_id is the unique key for this table.
> 
> Each row contains the unique identifier for player and the name of one of the teams participating in that match.
> 
> 

Table: `Passes`

> 
> 
> 
> 
> 
> +-------------+---------+
> 
> | Column Name | Type> 
> |
> 
> +-------------+---------+
> 
> | pass_from   | int> 
>  |
> 
> | time_stamp  | varchar |
> 
> | pass_to> 
>  | int> 
>  |
> 
> +-------------+---------+
> 
> (pass_from, time_stamp) is the unique key for this table.
> 
> pass_from is a foreign key to player_id from Teams table.
> 
> Each row represents a pass made during a match, time_stamp represents the time in minutes (00:00-90:00) when the pass was made,
> 
> pass_to is the player_id of the player receiving the pass.
> 
> 

Write a solution to find the **longest successful pass streak** for **each
team** during the match. The rules are as follows:

  * A successful pass streak is defined as consecutive passes where: 
> 
> * Both the `pass_from` and `pass_to` players belong to the same team
  * A streak breaks when either: 
> 
> * The pass is intercepted (received by a player from the opposing team)

Return _the result table ordered by_ `team_name` _in**ascending** order_.

The result format is in the following example.



**Example:**

**Input:**

Teams table:

> 
> 
> 
> 
> 
> +-----------+-----------+
> 
> | player_id | team_name |
> 
> +-----------+-----------+
> 
> | 1> 
> > 
>  | Arsenal   |
> 
> | 2> 
> > 
>  | Arsenal   |
> 
> | 3> 
> > 
>  | Arsenal   |
> 
> | 4> 
> > 
>  | Arsenal   |
> 
> | 5> 
> > 
>  | Chelsea   |
> 
> | 6> 
> > 
>  | Chelsea   |
> 
> | 7> 
> > 
>  | Chelsea   |
> 
> | 8> 
> > 
>  | Chelsea   |
> 
> +-----------+-----------+
> 
> 

Passes table:

> 
> 
> 
> 
> 
> +-----------+------------+---------+
> 
> | pass_from | time_stamp | pass_to |
> 
> +-----------+------------+---------+
> 
> | 1> 
> > 
>  | 00:05> 
>   | 2> 
>    |
> 
> | 2> 
> > 
>  | 00:07> 
>   | 3> 
>    |
> 
> | 3> 
> > 
>  | 00:08> 
>   | 4> 
>    |
> 
> | 4> 
> > 
>  | 00:10> 
>   | 5> 
>    |
> 
> | 6> 
> > 
>  | 00:15> 
>   | 7> 
>    |
> 
> | 7> 
> > 
>  | 00:17> 
>   | 8> 
>    |
> 
> | 8> 
> > 
>  | 00:20> 
>   | 6> 
>    |
> 
> | 6> 
> > 
>  | 00:22> 
>   | 5> 
>    |
> 
> | 1> 
> > 
>  | 00:25> 
>   | 2> 
>    |
> 
> | 2> 
> > 
>  | 00:27> 
>   | 3> 
>    |
> 
> +-----------+------------+---------+
> 
> 

**Output:**

> 
> 
> 
> 
> 
> +-----------+----------------+
> 
> | team_name | longest_streak |
> 
> +-----------+----------------+
> 
> | Arsenal   | 3> 
> > 
> > 
>   |
> 
> | Chelsea   | 4> 
> > 
> > 
>   |
> 
> +-----------+----------------+
> 
> 

**Explanation:**

  * **Arsenal** 's streaks: 
> 
> * First streak: 3 passes (1->2->3->4) ended when player 4 passed to Chelsea's player 5
> 
> * Second streak: 2 passes (1->2->3)
> 
> * Longest streak = 3
  * **Chelsea** 's streaks: 
> 
> * First streak: 3 passes (6->7->8->6->5)
> 
> * Longest streak = 4


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```