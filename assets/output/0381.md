# [381. O(1) æ—¶é—´æ’å…¥ã€åˆ é™¤å’Œè·å–éšæœºå…ƒç´  - å…è®¸é‡å¤](https://leetcode.com/problems/insert-delete-getrandom-o1-duplicates-allowed)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`è®¾è®¡`](/leetcode/outline/tag/design.md) [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`å“ˆå¸Œè¡¨`](/leetcode/outline/tag/hash-table.md) [`æ•°å­¦`](/leetcode/outline/tag/math.md) [`éšæœºåŒ–`](/leetcode/outline/tag/randomized.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/insert-delete-getrandom-o1-duplicates-allowed)


## é¢˜ç›®

`RandomizedCollection` is a data structure that contains a collection of
numbers, possibly duplicates (i.e., a multiset). It should support inserting
and removing specific elements and also reporting a random element.

Implement the `RandomizedCollection` class:

  * `RandomizedCollection()` Initializes the empty `RandomizedCollection` object.
  * `bool insert(int val)` Inserts an item `val` into the multiset, even if the item is already present. Returns `true` if the item is not present, `false` otherwise.
  * `bool remove(int val)` Removes an item `val` from the multiset if present. Returns `true` if the item is present, `false` otherwise. Note that if `val` has multiple occurrences in the multiset, we only remove one of them.
  * `int getRandom()` Returns a random element from the current multiset of elements. The probability of each element being returned is **linearly related** to the number of the same values the multiset contains.

You must implement the functions of the class such that each function works on
**average** `O(1)` time complexity.

**Note:** The test cases are generated such that `getRandom` will only be
called if there is **at least one** item in the `RandomizedCollection`.



**Example 1:**

> 
> 
> 
> 
> 
> **Input**
> 
> ["RandomizedCollection", "insert", "insert", "insert", "getRandom", "remove", "getRandom"]
> 
> [[], [1], [1], [2], [], [1], []]
> 
> **Output**
> 
> [null, true, false, true, 2, true, 1]
> 
> 
> 
> **Explanation**
> 
> RandomizedCollection randomizedCollection = new RandomizedCollection();
> 
> randomizedCollection.insert(1);   // return true since the collection does not contain 1.
> 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
>   // Inserts 1 into the collection.
> 
> randomizedCollection.insert(1);   // return false since the collection contains 1.
> 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
>   // Inserts another 1 into the collection. Collection now contains [1,1].
> 
> randomizedCollection.insert(2);   // return true since the collection does not contain 2.
> 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
>   // Inserts 2 into the collection. Collection now contains [1,1,2].
> 
> randomizedCollection.getRandom(); // getRandom should:
> 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
>   // - return 1 with probability 2/3, or
> 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
>   // - return 2 with probability 1/3.
> 
> randomizedCollection.remove(1);   // return true since the collection contains 1.
> 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
>   // Removes 1 from the collection. Collection now contains [1,2].
> 
> randomizedCollection.getRandom(); // getRandom should return 1 or 2, both equally likely.

**Constraints:**

  * `-231 <= val <= 231 - 1`
  * At most `2 * 10^5` calls **in total** will be made to `insert`, `remove`, and `getRandom`.
  * There will be **at least one** element in the data structure when `getRandom` is called.


## é¢˜ç›®å¤§æ„

`RandomizedCollection` æ˜¯ä¸€ç§åŒ…å«æ•°å­—é›†åˆ(å¯èƒ½æ˜¯é‡å¤çš„)çš„æ•°æ®ç»“æ„ã€‚å®ƒåº”è¯¥æ”¯æŒæ’å…¥å’Œåˆ é™¤ç‰¹å®šå…ƒç´ ï¼Œä»¥åŠåˆ é™¤éšæœºå…ƒç´ ã€‚

å®ç° `RandomizedCollection` ç±»:

  * `RandomizedCollection()`åˆå§‹åŒ–ç©ºçš„ `RandomizedCollection` å¯¹è±¡ã€‚
  * `bool insert(int val)` å°†ä¸€ä¸ª `val` é¡¹æ’å…¥åˆ°é›†åˆä¸­ï¼Œå³ä½¿è¯¥é¡¹å·²ç»å­˜åœ¨ã€‚å¦‚æœè¯¥é¡¹ä¸å­˜åœ¨ï¼Œåˆ™è¿”å› `true` ï¼Œå¦åˆ™è¿”å› `false` ã€‚
  * `bool remove(int val)` å¦‚æœå­˜åœ¨ï¼Œä»é›†åˆä¸­ç§»é™¤ä¸€ä¸ª `val` é¡¹ã€‚å¦‚æœè¯¥é¡¹å­˜åœ¨ï¼Œåˆ™è¿”å› `true` ï¼Œå¦åˆ™è¿”å› `false` ã€‚æ³¨æ„ï¼Œå¦‚æœ `val` åœ¨é›†åˆä¸­å‡ºç°å¤šæ¬¡ï¼Œæˆ‘ä»¬åªåˆ é™¤å…¶ä¸­ä¸€ä¸ªã€‚
  * `int getRandom()` ä»å½“å‰çš„å¤šä¸ªå…ƒç´ é›†åˆä¸­è¿”å›ä¸€ä¸ªéšæœºå…ƒç´ ã€‚æ¯ä¸ªå…ƒç´ è¢«è¿”å›çš„æ¦‚ç‡ä¸é›†åˆä¸­åŒ…å«çš„ç›¸åŒå€¼çš„æ•°é‡ **çº¿æ€§ç›¸å…³** ã€‚

æ‚¨å¿…é¡»å®ç°ç±»çš„å‡½æ•°ï¼Œä½¿æ¯ä¸ªå‡½æ•°çš„ **å¹³å‡** æ—¶é—´å¤æ‚åº¦ä¸º `O(1)` ã€‚

**æ³¨æ„ï¼š** ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹æ—¶ï¼Œåªæœ‰åœ¨ `RandomizedCollection` ä¸­ **è‡³å°‘æœ‰ä¸€é¡¹** æ—¶ï¼Œæ‰ä¼šè°ƒç”¨ `getRandom` ã€‚



**ç¤ºä¾‹ 1:**

> 
> 
> 
> 
> 
> **è¾“å…¥**
> 
> ["RandomizedCollection", "insert", "insert", "insert", "getRandom", "remove", "getRandom"]
> 
> [[], [1], [1], [2], [], [1], []]
> 
> **è¾“å‡º**
> 
> [null, true, false, true, 2, true, 1]
> 
> 
> 
> **è§£é‡Š**
> 
> RandomizedCollection collection = new RandomizedCollection();// åˆå§‹åŒ–ä¸€ä¸ªç©ºçš„é›†åˆã€‚
> 
> collection.insert(1);   // è¿”å› trueï¼Œå› ä¸ºé›†åˆä¸åŒ…å« 1ã€‚
> 
> > 
> > 
> > 
> > 
> > 
> > 
> // å°† 1 æ’å…¥åˆ°é›†åˆä¸­ã€‚
> 
> collection.insert(1);   // è¿”å› falseï¼Œå› ä¸ºé›†åˆåŒ…å« 1ã€‚
> 
> > 
> > 
> > 
> > 
> > 
> > 
> // å°†å¦ä¸€ä¸ª 1 æ’å…¥åˆ°é›†åˆä¸­ã€‚é›†åˆç°åœ¨åŒ…å« [1,1]ã€‚
> 
> collection.insert(2);   // è¿”å› trueï¼Œå› ä¸ºé›†åˆä¸åŒ…å« 2ã€‚
> 
> > 
> > 
> > 
> > 
> > 
> > 
> // å°† 2 æ’å…¥åˆ°é›†åˆä¸­ã€‚é›†åˆç°åœ¨åŒ…å« [1,1,2]ã€‚
> 
> collection.getRandom(); // getRandom åº”å½“:
> 
> > 
> > 
> > 
> > 
> > 
> > 
> // æœ‰ 2/3 çš„æ¦‚ç‡è¿”å› 1,
> 
> > 
> > 
> > 
> > 
> > 
> > 
> // 1/3 çš„æ¦‚ç‡è¿”å› 2ã€‚
> 
> collection.remove(1);   // è¿”å› trueï¼Œå› ä¸ºé›†åˆåŒ…å« 1ã€‚
> 
> > 
> > 
> > 
> > 
> > 
> > 
> // ä»é›†åˆä¸­ç§»é™¤ 1ã€‚é›†åˆç°åœ¨åŒ…å« [1,2]ã€‚
> 
> collection.getRandom(); // getRandom åº”è¯¥è¿”å› 1 æˆ– 2ï¼Œä¸¤è€…çš„å¯èƒ½æ€§ç›¸åŒã€‚



**æç¤º:**

  * `-231 <= val <= 231 - 1`
  * `insert`, `remove` å’Œ `getRandom` æœ€å¤š **æ€»å…±** è¢«è°ƒç”¨ `2 * 10^5` æ¬¡
  * å½“è°ƒç”¨ `getRandom` æ—¶ï¼Œæ•°æ®ç»“æ„ä¸­ **è‡³å°‘æœ‰ä¸€ä¸ª** å…ƒç´ 


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 380 | [O(1) æ—¶é—´æ’å…¥ã€åˆ é™¤å’Œè·å–éšæœºå…ƒç´ ](https://leetcode.com/problems/insert-delete-getrandom-o1) | [[âœ“]](https://2xiao.github.io/leetcode-js/leetcode/problem/0380) |  [`è®¾è®¡`](/leetcode/outline/tag/design.md) [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`å“ˆå¸Œè¡¨`](/leetcode/outline/tag/hash-table.md) `2+` | <font color=#ffb800>Medium</font> |

<style>
.blue {
    background-color: #096dd9;
    padding: 0.25rem 0.5rem;
    margin: 0;
    font-size: 0.85em;
    border-radius: 3px;
    color: white;
    font-weight: 500;
}
table th:first-of-type { width: 10%; }
table th:nth-of-type(2) { width: 35%; }
table th:nth-of-type(3) { width: 10%; }
table th:nth-of-type(4) { width: 35%; }
table th:nth-of-type(5) { width: 10%; }
</style>
