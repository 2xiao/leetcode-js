# [2467. æ ‘ä¸Šæœ€å¤§å¾—åˆ†å’Œè·¯å¾„](https://leetcode.com/problems/most-profitable-path-in-a-tree)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ ‘`](/leetcode/outline/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/leetcode/outline/tag/depth-first-search.md) [`å¹¿åº¦ä¼˜å…ˆæœç´¢`](/leetcode/outline/tag/breadth-first-search.md) [`å›¾`](/leetcode/outline/tag/graph.md) [`æ•°ç»„`](/leetcode/outline/tag/array.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/most-profitable-path-in-a-tree)

## é¢˜ç›®

There is an undirected tree with `n` nodes labeled from `0` to `n - 1`, rooted
at node `0`. You are given a 2D integer array `edges` of length `n - 1` where
`edges[i] = [ai, bi]` indicates that there is an edge between nodes `ai` and
`bi` in the tree.

At every node `i`, there is a gate. You are also given an array of even
integers `amount`, where `amount[i]` represents:

- the price needed to open the gate at node `i`, if `amount[i]` is negative, or,
- the cash reward obtained on opening the gate at node `i`, otherwise.

The game goes on as follows:

- Initially, Alice is at node `0` and Bob is at node `bob`.
- At every second, Alice and Bob **each** move to an adjacent node. Alice moves towards some **leaf node** , while Bob moves towards node `0`.
- For **every** node along their path, Alice and Bob either spend money to open the gate at that node, or accept the reward. Note that:
  > - If the gate is **already open** , no price will be required, nor will there be any cash reward.
  >
  > - If Alice and Bob reach the node **simultaneously** , they share the price/reward for opening the gate there. In other words, if the price to open the gate is `c`, then both Alice and Bob pay `c / 2` each. Similarly, if the reward at the gate is `c`, both of them receive `c / 2` each.
- If Alice reaches a leaf node, she stops moving. Similarly, if Bob reaches node `0`, he stops moving. Note that these events are **independent** of each other.

Return _the**maximum** net income Alice can have if she travels towards the
optimal leaf node._

**Example 1:**

![](https://assets.leetcode.com/uploads/2022/10/29/eg1.png)

> Input: edges = [[0,1],[1,2],[1,3],[3,4]], bob = 3, amount = [-2,4,2,-4,6]
>
> Output: 6
>
> Explanation:
>
> The above diagram represents the given tree. The game goes as follows:
>
> - Alice is initially on node 0, Bob on node 3. They open the gates of their respective nodes.
>
>   Alice's net income is now -2.
>
> - Both Alice and Bob move to node 1.
>
>   Since they reach here simultaneously, they open the gate together and share the reward.
>
>   Alice's net income becomes -2 + (4 / 2) = 0.
>
> - Alice moves on to node 3. Since Bob already opened its gate, Alice's income remains unchanged.
>
>   Bob moves on to node 0, and stops moving.
>
> - Alice moves on to node 4 and opens the gate there. Her net income becomes 0 + 6 = 6.
>
> Now, neither Alice nor Bob can make any further moves, and the game ends.
>
> It is not possible for Alice to get a higher net income.

**Example 2:**

![](https://assets.leetcode.com/uploads/2022/10/29/eg2.png)

> Input: edges = [[0,1]], bob = 1, amount = [-7280,2350]
>
> Output: -7280
>
> Explanation:
>
> Alice follows the path 0->1 whereas Bob follows the path 1->0.
>
> Thus, Alice opens the gate at node 0 only. Hence, her net income is -7280.

**Constraints:**

- `2 <= n <= 10^5`
- `edges.length == n - 1`
- `edges[i].length == 2`
- `0 <= ai, bi < n`
- `ai != bi`
- `edges` represents a valid tree.
- `1 <= bob < n`
- `amount.length == n`
- `amount[i]` is an **even** integer in the range `[-10^4, 10^4]`.

## é¢˜ç›®å¤§æ„

ä¸€ä¸ª `n` ä¸ªèŠ‚ç‚¹çš„æ— å‘æ ‘ï¼ŒèŠ‚ç‚¹ç¼–å·ä¸º `0` åˆ° `n - 1` ï¼Œæ ‘çš„æ ¹ç»“ç‚¹æ˜¯ `0` å·èŠ‚ç‚¹ã€‚ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º `n - 1` çš„äºŒç»´æ•´æ•°æ•°ç»„
`edges` ï¼Œå…¶ä¸­ `edges[i] = [ai, bi]` ï¼Œè¡¨ç¤ºèŠ‚ç‚¹ `ai` å’Œ `bi` åœ¨æ ‘ä¸­æœ‰ä¸€æ¡è¾¹ã€‚

åœ¨æ¯ä¸€ä¸ªèŠ‚ç‚¹ `i` å¤„æœ‰ä¸€æ‰‡é—¨ã€‚åŒæ—¶ç»™ä½ ä¸€ä¸ªéƒ½æ˜¯å¶æ•°çš„æ•°ç»„ `amount` ï¼Œå…¶ä¸­ `amount[i]` è¡¨ç¤ºï¼š

- å¦‚æœ `amount[i]` çš„å€¼æ˜¯è´Ÿæ•°ï¼Œé‚£ä¹ˆå®ƒè¡¨ç¤ºæ‰“å¼€èŠ‚ç‚¹ `i` å¤„é—¨æ‰£é™¤çš„åˆ†æ•°ã€‚
- å¦‚æœ `amount[i]` çš„å€¼æ˜¯æ­£æ•°ï¼Œé‚£ä¹ˆå®ƒè¡¨ç¤ºæ‰“å¼€èŠ‚ç‚¹ `i` å¤„é—¨åŠ ä¸Šçš„åˆ†æ•°ã€‚

æ¸¸æˆæŒ‰ç…§å¦‚ä¸‹è§„åˆ™è¿›è¡Œï¼š

- ä¸€å¼€å§‹ï¼ŒAlice åœ¨èŠ‚ç‚¹ `0` å¤„ï¼ŒBob åœ¨èŠ‚ç‚¹ `bob` å¤„ã€‚
- æ¯ä¸€ç§’é’Ÿï¼ŒAlice å’Œ Bob **åˆ†åˆ«** ç§»åŠ¨åˆ°ç›¸é‚»çš„èŠ‚ç‚¹ã€‚Alice æœç€æŸä¸ª **å¶å­ç»“ç‚¹** ç§»åŠ¨ï¼ŒBob æœç€èŠ‚ç‚¹ `0` ç§»åŠ¨ã€‚
- å¯¹äºä»–ä»¬ä¹‹é—´è·¯å¾„ä¸Šçš„ **æ¯ä¸€ä¸ª** èŠ‚ç‚¹ï¼ŒAlice å’Œ Bob è¦ä¹ˆæ‰“å¼€é—¨å¹¶æ‰£åˆ†ï¼Œè¦ä¹ˆæ‰“å¼€é—¨å¹¶åŠ åˆ†ã€‚æ³¨æ„ï¼š
  > - å¦‚æœé—¨ **å·²ç»æ‰“å¼€** ï¼ˆè¢«å¦ä¸€ä¸ªäººæ‰“å¼€ï¼‰ï¼Œä¸ä¼šæœ‰é¢å¤–åŠ åˆ†ä¹Ÿä¸ä¼šæ‰£åˆ†ã€‚
  >
  > - å¦‚æœ Alice å’Œ Bob **åŒæ—¶** åˆ°è¾¾ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä»–ä»¬ä¼šå…±äº«è¿™ä¸ªèŠ‚ç‚¹çš„åŠ åˆ†æˆ–è€…æ‰£åˆ†ã€‚æ¢è¨€ä¹‹ï¼Œå¦‚æœæ‰“å¼€è¿™æ‰‡é—¨æ‰£ `c` åˆ†ï¼Œé‚£ä¹ˆ Alice å’Œ Bob åˆ†åˆ«æ‰£ `c / 2` åˆ†ã€‚å¦‚æœè¿™æ‰‡é—¨çš„åŠ åˆ†ä¸º `c` ï¼Œé‚£ä¹ˆä»–ä»¬åˆ†åˆ«åŠ  `c / 2` åˆ†ã€‚
- å¦‚æœ Alice åˆ°è¾¾äº†ä¸€ä¸ªå¶å­ç»“ç‚¹ï¼Œå¥¹ä¼šåœæ­¢ç§»åŠ¨ã€‚ç±»ä¼¼çš„ï¼Œå¦‚æœ Bob åˆ°è¾¾äº†èŠ‚ç‚¹ `0` ï¼Œä»–ä¹Ÿä¼šåœæ­¢ç§»åŠ¨ã€‚æ³¨æ„è¿™äº›äº‹ä»¶äº’ç›¸ **ç‹¬ç«‹** ï¼Œä¸ä¼šå½±å“å¦ä¸€æ–¹ç§»åŠ¨ã€‚

è¯·ä½ è¿”å› Alice æœæœ€ä¼˜å¶å­ç»“ç‚¹ç§»åŠ¨çš„ **æœ€å¤§** å‡€å¾—åˆ†ã€‚

**ç¤ºä¾‹ 1ï¼š**

![](https://assets.leetcode.com/uploads/2022/10/29/eg1.png)

> **è¾“å…¥ï¼š** edges = [[0,1],[1,2],[1,3],[3,4]], bob = 3, amount = [-2,4,2,-4,6]
>
> **è¾“å‡ºï¼š** 6
>
> **è§£é‡Šï¼š**
>
> ä¸Šå›¾å±•ç¤ºäº†è¾“å…¥ç»™å‡ºçš„ä¸€æ£µæ ‘ã€‚æ¸¸æˆè¿›è¡Œå¦‚ä¸‹ï¼š
>
> - Alice ä¸€å¼€å§‹åœ¨èŠ‚ç‚¹ 0 å¤„ï¼ŒBob åœ¨èŠ‚ç‚¹ 3 å¤„ã€‚ä»–ä»¬åˆ†åˆ«æ‰“å¼€æ‰€åœ¨èŠ‚ç‚¹çš„é—¨ã€‚
>
>   Alice å¾—åˆ†ä¸º -2 ã€‚
>
> - Alice å’Œ Bob éƒ½ç§»åŠ¨åˆ°èŠ‚ç‚¹ 1 ã€‚
>
>   å› ä¸ºä»–ä»¬åŒæ—¶åˆ°è¾¾è¿™ä¸ªèŠ‚ç‚¹ï¼Œä»–ä»¬ä¸€èµ·æ‰“å¼€é—¨å¹¶å¹³åˆ†å¾—åˆ†ã€‚
>
>   Alice çš„å¾—åˆ†å˜ä¸º -2 + (4 / 2) = 0 ã€‚
>
> - Alice ç§»åŠ¨åˆ°èŠ‚ç‚¹ 3 ã€‚å› ä¸º Bob å·²ç»æ‰“å¼€äº†è¿™æ‰‡é—¨ï¼ŒAlice å¾—åˆ†ä¸å˜ã€‚
>
>   Bob ç§»åŠ¨åˆ°èŠ‚ç‚¹ 0 ï¼Œå¹¶åœæ­¢ç§»åŠ¨ã€‚
>
> - Alice ç§»åŠ¨åˆ°èŠ‚ç‚¹ 4 å¹¶æ‰“å¼€è¿™ä¸ªèŠ‚ç‚¹çš„é—¨ï¼Œå¥¹å¾—åˆ†å˜ä¸º 0 + 6 = 6 ã€‚
>
> ç°åœ¨ï¼ŒAlice å’Œ Bob éƒ½ä¸èƒ½è¿›è¡Œä»»ä½•ç§»åŠ¨äº†ï¼Œæ‰€ä»¥æ¸¸æˆç»“æŸã€‚
>
> Alice æ— æ³•å¾—åˆ°æ›´é«˜åˆ†æ•°ã€‚

**ç¤ºä¾‹ 2ï¼š**

![](https://assets.leetcode.com/uploads/2022/10/29/eg2.png)

> **è¾“å…¥ï¼š** edges = [[0,1]], bob = 1, amount = [-7280,2350]
>
> **è¾“å‡ºï¼š** -7280
>
> **è§£é‡Šï¼š**
>
> Alice æŒ‰ç…§è·¯å¾„ 0->1 ç§»åŠ¨ï¼ŒåŒæ—¶ Bob æŒ‰ç…§è·¯å¾„ 1->0 ç§»åŠ¨ã€‚
>
> æ‰€ä»¥ Alice åªæ‰“å¼€èŠ‚ç‚¹ 0 å¤„çš„é—¨ï¼Œå¥¹çš„å¾—åˆ†ä¸º -7280 ã€‚

**æç¤ºï¼š**

- `2 <= n <= 10^5`
- `edges.length == n - 1`
- `edges[i].length == 2`
- `0 <= ai, bi < n`
- `ai != bi`
- `edges` è¡¨ç¤ºä¸€æ£µæœ‰æ•ˆçš„æ ‘ã€‚
- `1 <= bob < n`
- `amount.length == n`
- `amount[i]` æ˜¯èŒƒå›´ `[-10^4, 10^4]` ä¹‹é—´çš„ä¸€ä¸ª **å¶æ•°** ã€‚

## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 909 | [è›‡æ¢¯æ£‹](https://leetcode.com/problems/snakes-and-ladders) | [[âœ“]](https://2xiao.github.io/leetcode-js/leetcode/problem/0909) |  [`å¹¿åº¦ä¼˜å…ˆæœç´¢`](/leetcode/outline/tag/breadth-first-search.md) [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`çŸ©é˜µ`](/leetcode/outline/tag/matrix.md) | <font color=#ffb800>Medium</font> |
| 3241 | [æ ‡è®°æ‰€æœ‰èŠ‚ç‚¹éœ€è¦çš„æ—¶é—´](https://leetcode.com/problems/time-taken-to-mark-all-nodes) |  |  [`æ ‘`](/leetcode/outline/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/leetcode/outline/tag/depth-first-search.md) [`å›¾`](/leetcode/outline/tag/graph.md) `1+` | <font color=#ff334b>Hard</font> |

<style>
.blue {
    background-color: #096dd9;
    padding: 0.25rem 0.5rem;
    margin: 0;
    font-size: 0.85em;
    border-radius: 3px;
    color: white;
    font-weight: 500;
}
table th:first-of-type { width: 10%; }
table th:nth-of-type(2) { width: 35%; }
table th:nth-of-type(3) { width: 10%; }
table th:nth-of-type(4) { width: 35%; }
table th:nth-of-type(5) { width: 10%; }
</style>
