# [1830. ä½¿å­—ç¬¦ä¸²æœ‰åºçš„æœ€å°‘æ“ä½œæ¬¡æ•°](https://leetcode.com/problems/minimum-number-of-operations-to-make-string-sorted)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ•°å­¦`](/leetcode/outline/tag/math.md) [`å­—ç¬¦ä¸²`](/leetcode/outline/tag/string.md) [`ç»„åˆæ•°å­¦`](/leetcode/outline/tag/combinatorics.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/minimum-number-of-operations-to-make-string-sorted)


## é¢˜ç›®

You are given a string `s` (**0-indexed**)â€‹â€‹â€‹â€‹â€‹â€‹. You are asked to perform the
following operation on `s`â€‹â€‹â€‹â€‹â€‹â€‹ until you get a sorted string:

  1. Find **the largest index** `i` such that `1 <= i < s.length` and `s[i] < s[i - 1]`.
  2. Find **the largest index** `j` such that `i <= j < s.length` and `s[k] < s[i - 1]` for all the possible values of `k` in the range `[i, j]` inclusive.
  3. Swap the two characters at indices `i - 1`â€‹â€‹â€‹â€‹ and `j`â€‹â€‹â€‹â€‹â€‹.
  4. Reverse the suffix starting at index `i`â€‹â€‹â€‹â€‹â€‹â€‹.

Return _the number of operations needed to make the string sorted._ Since the
answer can be too large, return it **modulo** `109 + 7`.



**Example 1:**

> Input: s = "cba"
> 
> Output: 5
> 
> Explanation: The simulation goes as follows:
> 
> Operation 1: i=2, j=2. Swap s[1] and s[2] to get s="cab", then reverse the suffix starting at 2. Now, s="cab".
> 
> Operation 2: i=1, j=2. Swap s[0] and s[2] to get s="bac", then reverse the suffix starting at 1. Now, s="bca".
> 
> Operation 3: i=2, j=2. Swap s[1] and s[2] to get s="bac", then reverse the suffix starting at 2. Now, s="bac".
> 
> Operation 4: i=1, j=1. Swap s[0] and s[1] to get s="abc", then reverse the suffix starting at 1. Now, s="acb".
> 
> Operation 5: i=2, j=2. Swap s[1] and s[2] to get s="abc", then reverse the suffix starting at 2. Now, s="abc".

**Example 2:**

> Input: s = "aabaa"
> 
> Output: 2
> 
> Explanation: The simulation goes as follows:
> 
> Operation 1: i=3, j=4. Swap s[2] and s[4] to get s="aaaab", then reverse the substring starting at 3. Now, s="aaaba".
> 
> Operation 2: i=4, j=4. Swap s[3] and s[4] to get s="aaaab", then reverse the substring starting at 4. Now, s="aaaab".

**Constraints:**

  * `1 <= s.length <= 3000`
  * `s`â€‹â€‹â€‹â€‹â€‹â€‹ consists only of lowercase English letters.


## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² `s` ï¼ˆ**ä¸‹æ ‡ä» 0 å¼€å§‹** ï¼‰ã€‚ä½ éœ€è¦å¯¹ `s` æ‰§è¡Œä»¥ä¸‹æ“ä½œç›´åˆ°å®ƒå˜ä¸ºä¸€ä¸ªæœ‰åºå­—ç¬¦ä¸²ï¼š

  1. æ‰¾åˆ° **æœ€å¤§ä¸‹æ ‡** `i` ï¼Œä½¿å¾— `1 <= i < s.length` ä¸” `s[i] < s[i - 1]` ã€‚
  2. æ‰¾åˆ° **æœ€å¤§ä¸‹æ ‡** `j` ï¼Œä½¿å¾— `i <= j < s.length` ä¸”å¯¹äºæ‰€æœ‰åœ¨é—­åŒºé—´ `[i, j]` ä¹‹é—´çš„ `k` éƒ½æœ‰ `s[k] < s[i - 1]` ã€‚
  3. äº¤æ¢ä¸‹æ ‡ä¸º `i - 1`â€‹â€‹â€‹â€‹ å’Œ `j`â€‹â€‹â€‹â€‹ å¤„çš„ä¸¤ä¸ªå­—ç¬¦ã€‚
  4. å°†ä¸‹æ ‡ `i` å¼€å§‹çš„å­—ç¬¦ä¸²åç¼€åè½¬ã€‚

è¯·ä½ è¿”å›å°†å­—ç¬¦ä¸²å˜æˆæœ‰åºçš„æœ€å°‘æ“ä½œæ¬¡æ•°ã€‚ç”±äºç­”æ¡ˆå¯èƒ½ä¼šå¾ˆå¤§ï¼Œè¯·è¿”å›å®ƒå¯¹ `109 + 7` **å–ä½™** çš„ç»“æœã€‚

**ç¤ºä¾‹ 1ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** s = "cba"
> 
> **è¾“å‡ºï¼š** 5
> 
> **è§£é‡Šï¼š** æ¨¡æ‹Ÿè¿‡ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š
> 
> æ“ä½œ 1ï¼ši=2ï¼Œj=2ã€‚äº¤æ¢ s[1] å’Œ s[2] å¾—åˆ° s="cab" ï¼Œç„¶ååè½¬ä¸‹æ ‡ä» 2 å¼€å§‹çš„åç¼€å­—ç¬¦ä¸²ï¼Œå¾—åˆ° s="cab" ã€‚
> 
> æ“ä½œ 2ï¼ši=1ï¼Œj=2ã€‚äº¤æ¢ s[0] å’Œ s[2] å¾—åˆ° s="bac" ï¼Œç„¶ååè½¬ä¸‹æ ‡ä» 1 å¼€å§‹çš„åç¼€å­—ç¬¦ä¸²ï¼Œå¾—åˆ° s="bca" ã€‚
> 
> æ“ä½œ 3ï¼ši=2ï¼Œj=2ã€‚äº¤æ¢ s[1] å’Œ s[2] å¾—åˆ° s="bac" ï¼Œç„¶ååè½¬ä¸‹æ ‡ä» 2 å¼€å§‹çš„åç¼€å­—ç¬¦ä¸²ï¼Œå¾—åˆ° s="bac" ã€‚
> 
> æ“ä½œ 4ï¼ši=1ï¼Œj=1ã€‚äº¤æ¢ s[0] å’Œ s[1] å¾—åˆ° s="abc" ï¼Œç„¶ååè½¬ä¸‹æ ‡ä» 1 å¼€å§‹çš„åç¼€å­—ç¬¦ä¸²ï¼Œå¾—åˆ° s="acb" ã€‚
> 
> æ“ä½œ 5ï¼ši=2ï¼Œj=2ã€‚äº¤æ¢ s[1] å’Œ s[2] å¾—åˆ° s="abc" ï¼Œç„¶ååè½¬ä¸‹æ ‡ä» 2 å¼€å§‹çš„åç¼€å­—ç¬¦ä¸²ï¼Œå¾—åˆ° s="abc" ã€‚
> 
> 

**ç¤ºä¾‹ 2ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** s = "aabaa"
> 
> **è¾“å‡ºï¼š** 2
> 
> **è§£é‡Šï¼š** æ¨¡æ‹Ÿè¿‡ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š
> 
> æ“ä½œ 1ï¼ši=3ï¼Œj=4ã€‚äº¤æ¢ s[2] å’Œ s[4] å¾—åˆ° s="aaaab" ï¼Œç„¶ååè½¬ä¸‹æ ‡ä» 3 å¼€å§‹çš„åç¼€å­—ç¬¦ä¸²ï¼Œå¾—åˆ° s="aaaba" ã€‚
> 
> æ“ä½œ 2ï¼ši=4ï¼Œj=4ã€‚äº¤æ¢ s[3] å’Œ s[4] å¾—åˆ° s="aaaab" ï¼Œç„¶ååè½¬ä¸‹æ ‡ä» 4 å¼€å§‹çš„åç¼€å­—ç¬¦ä¸²ï¼Œå¾—åˆ° s="aaaab" ã€‚
> 
> 

**ç¤ºä¾‹ 3ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** s = "cdbea"
> 
> **è¾“å‡ºï¼š** 63

**ç¤ºä¾‹ 4ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** s = "leetcodeleetcodeleetcode"
> 
> **è¾“å‡ºï¼š** 982157772
> 
> 

**æç¤ºï¼š**

  * `1 <= s.length <= 3000`
  * `s`â€‹ åªåŒ…å«å°å†™è‹±æ–‡å­—æ¯ã€‚


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```