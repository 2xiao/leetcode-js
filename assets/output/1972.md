# [1972. åŒä¸€å¤©çš„ç¬¬ä¸€ä¸ªç”µè¯å’Œæœ€åä¸€ä¸ªç”µè¯](https://leetcode.com/problems/first-and-last-call-on-the-same-day)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/first-and-last-call-on-the-same-day)

## é¢˜ç›®

Table: `Calls`

> 
> 
> 
> 
> 
> +--------------+----------+
> 
> | Column Name  | Type> 
>  |
> 
> +--------------+----------+
> 
> | caller_id> 
> | int> 
>   |
> 
> | recipient_id | int> 
>   |
> 
> | call_time> 
> | datetime |
> 
> +--------------+----------+
> 
> (caller_id, recipient_id, call_time) is the primary key (combination of columns with unique values) for this table.
> 
> Each row contains information about the time of a phone call between caller_id and recipient_id.
> 
> 



Write a solution to report the IDs of the users whose first and last calls on
**any day** were with **the same person**. Calls are counted regardless of
being the caller or the recipient.

Return the result table in **any order**.

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Calls table:
> 
> +-----------+--------------+---------------------+
> 
> | caller_id | recipient_id | call_time> 
> > 
>    |
> 
> +-----------+--------------+---------------------+
> 
> | 8> 
> > 
>  | 4> 
> > 
> > 
> | 2021-08-24 17:46:07 |
> 
> | 4> 
> > 
>  | 8> 
> > 
> > 
> | 2021-08-24 19:57:13 |
> 
> | 5> 
> > 
>  | 1> 
> > 
> > 
> | 2021-08-11 05:28:44 |
> 
> | 8> 
> > 
>  | 3> 
> > 
> > 
> | 2021-08-17 04:04:15 |
> 
> | 11> 
> > 
> | 3> 
> > 
> > 
> | 2021-08-17 13:07:00 |
> 
> | 8> 
> > 
>  | 11> 
> > 
>    | 2021-08-17 22:22:22 |
> 
> +-----------+--------------+---------------------+
> 
> Output: 
> 
> +---------+
> 
> | user_id |
> 
> +---------+
> 
> | 1> 
>    |
> 
> | 4> 
>    |
> 
> | 5> 
>    |
> 
> | 8> 
>    |
> 
> +---------+
> 
> Explanation: 
> 
> On 2021-08-24, the first and last call of this day for user 8 was with user 4. User 8 should be included in the answer.
> 
> Similarly, user 4 on 2021-08-24 had their first and last call with user 8. User 4 should be included in the answer.
> 
> On 2021-08-11, user 1 and 5 had a call. This call was the only call for both of them on this day. Since this call is the first and last call of the day for both of them, they should both be included in the answer.
> 
> 


## é¢˜ç›®å¤§æ„

è¡¨: `Calls`

> 
> 
> 
> 
> 
> +--------------+----------+
> 
> | Column Name  | Type> 
>  |
> 
> +--------------+----------+
> 
> | caller_id> 
> | int> 
>   |
> 
> | recipient_id | int> 
>   |
> 
> | call_time> 
> | datetime |
> 
> +--------------+----------+
> 
> (caller_id, recipient_id, call_time) æ˜¯è¿™ä¸ªè¡¨çš„ä¸»é”®ã€‚
> 
> æ¯ä¸€è¡Œæ‰€å«çš„æ—¶é—´ä¿¡æ¯éƒ½æ˜¯å…³äºcaller_id å’Œrecipient_idçš„ã€‚
> 
> 



ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢æ¥æ‰¾å‡ºé‚£äº›IDä»¬åœ¨**ä»»æ„ä¸€å¤©** çš„ç¬¬ä¸€ä¸ªç”µè¯å’Œæœ€åä¸€ä¸ªç”µè¯éƒ½æ˜¯å’ŒåŒä¸€ä¸ªäººçš„ã€‚è¿™äº›ç”µè¯ä¸è®ºæ˜¯æ‹¨æ‰“è€…è¿˜æ˜¯æ¥æ”¶è€…éƒ½ä¼šè¢«è®°å½•ã€‚

ç»“æœè¯·æ”¾åœ¨ä¸€ä¸ª**ä»»æ„æ¬¡åº** çº¦æŸçš„è¡¨ä¸­ã€‚

æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºï¼š

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š**
> 
> Calls table:
> 
> +-----------+--------------+---------------------+
> 
> | caller_id | recipient_id | call_time> 
> > 
>    |
> 
> +-----------+--------------+---------------------+
> 
> | 8> 
> > 
>  | 4> 
> > 
> > 
> | 2021-08-24 17:46:07 |
> 
> | 4> 
> > 
>  | 8> 
> > 
> > 
> | 2021-08-24 19:57:13 |
> 
> | 5> 
> > 
>  | 1> 
> > 
> > 
> | 2021-08-11 05:28:44 |
> 
> | 8> 
> > 
>  | 3> 
> > 
> > 
> | 2021-08-17 04:04:15 |
> 
> | 11> 
> > 
> | 3> 
> > 
> > 
> | 2021-08-17 13:07:00 |
> 
> | 8> 
> > 
>  | 11> 
> > 
>    | 2021-08-17 22:22:22 |
> 
> +-----------+--------------+---------------------+
> 
> **è¾“å‡ºï¼š**
> 
> +---------+
> 
> | user_id |
> 
> +---------+
> 
> | 1> 
>    |
> 
> | 4> 
>    |
> 
> | 5> 
>    |
> 
> | 8> 
>    |
> 
> +---------+
> 
> **è§£é‡Šï¼š**
> 
> åœ¨ 2021-08-24ï¼Œè¿™å¤©çš„ç¬¬ä¸€ä¸ªç”µè¯å’Œæœ€åä¸€ä¸ªç”µè¯éƒ½æ˜¯åœ¨user 8å’Œuser 4ä¹‹é—´ã€‚user8åº”è¯¥è¢«åŒ…å«åœ¨ç­”æ¡ˆä¸­ã€‚
> 
> åŒæ ·çš„ï¼Œuser 4åœ¨2 021-08-24 çš„ç¬¬ä¸€ä¸ªç”µè¯å’Œæœ€åä¸€ä¸ªç”µè¯éƒ½æ˜¯å’Œuser 8çš„ã€‚user 4ä¹Ÿåº”è¯¥è¢«åŒ…å«åœ¨ç­”æ¡ˆä¸­ã€‚
> 
> åœ¨ 2021-08-11ï¼Œuser 1å’Œ5æœ‰ä¸€ä¸ªç”µè¯ã€‚è¿™ä¸ªç”µè¯æ˜¯ä»–ä»¬å½¼æ­¤å½“å¤©çš„å”¯ä¸€ä¸€ä¸ªç”µè¯ã€‚å› æ­¤è¿™ä¸ªç”µè¯æ˜¯ä»–ä»¬å½“å¤©çš„ç¬¬ä¸€ä¸ªç”µè¯ä¹Ÿæ˜¯æœ€åä¸€ä¸ªç”µè¯ï¼Œä»–ä»¬éƒ½åº”è¯¥è¢«åŒ…å«åœ¨ç­”æ¡ˆä¸­ã€‚
> 
> 


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```