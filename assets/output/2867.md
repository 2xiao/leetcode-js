---
title: 2867. ç»Ÿè®¡æ ‘ä¸­çš„åˆæ³•è·¯å¾„æ•°ç›®
description: LeetCode,2867. ç»Ÿè®¡æ ‘ä¸­çš„åˆæ³•è·¯å¾„æ•°ç›®,ç»Ÿè®¡æ ‘ä¸­çš„åˆæ³•è·¯å¾„æ•°ç›®,Count Valid Paths in a Tree,è§£é¢˜æ€è·¯,æ ‘,æ·±åº¦ä¼˜å…ˆæœç´¢,æ•°å­¦,åŠ¨æ€è§„åˆ’,æ•°è®º
keywords:
  - LeetCode
  - 2867. ç»Ÿè®¡æ ‘ä¸­çš„åˆæ³•è·¯å¾„æ•°ç›®
  - ç»Ÿè®¡æ ‘ä¸­çš„åˆæ³•è·¯å¾„æ•°ç›®
  - Count Valid Paths in a Tree
  - è§£é¢˜æ€è·¯
  - æ ‘
  - æ·±åº¦ä¼˜å…ˆæœç´¢
  - æ•°å­¦
  - åŠ¨æ€è§„åˆ’
  - æ•°è®º
---

# 2867. ç»Ÿè®¡æ ‘ä¸­çš„åˆæ³•è·¯å¾„æ•°ç›®

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ ‘`](/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/tag/depth-first-search.md) [`æ•°å­¦`](/tag/math.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md) [`æ•°è®º`](/tag/number-theory.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/count-valid-paths-in-a-tree) [`LeetCode`](https://leetcode.com/problems/count-valid-paths-in-a-tree)

## é¢˜ç›®

There is an undirected tree with `n` nodes labeled from `1` to `n`. You are
given the integer `n` and a 2D integer array `edges` of length `n - 1`, where
`edges[i] = [ui, vi]` indicates that there is an edge between nodes `ui` and
`vi` in the tree.

Return _the**number of valid paths** in the tree_.

A path `(a, b)` is **valid** if there exists **exactly one** prime number
among the node labels in the path from `a` to `b`.

**Note** that:

  * The path `(a, b)` is a sequence of **distinct** nodes starting with node `a` and ending with node `b` such that every two adjacent nodes in the sequence share an edge in the tree.
  * Path `(a, b)` and path `(b, a)` are considered the **same** and counted only **once**.



**Example 1:**

![](https://assets.leetcode.com/uploads/2023/08/27/example1.png)

> Input: n = 5, edges = [[1,2],[1,3],[2,4],[2,5]]
> 
> Output: 4
> 
> Explanation: The pairs with exactly one prime number on the path between them are: 
> - (1, 2) since the path from 1 to 2 contains prime number 2. 
> - (1, 3) since the path from 1 to 3 contains prime number 3.
> - (1, 4) since the path from 1 to 4 contains prime number 2.
> - (2, 4) since the path from 2 to 4 contains prime number 2.
> 
> It can be shown that there are only 4 valid paths.

**Example 2:**

![](https://assets.leetcode.com/uploads/2023/08/27/example2.png)

> Input: n = 6, edges = [[1,2],[1,3],[2,4],[3,5],[3,6]]
> 
> Output: 6
> 
> Explanation: The pairs with exactly one prime number on the path between them are: 
> - (1, 2) since the path from 1 to 2 contains prime number 2.
> - (1, 3) since the path from 1 to 3 contains prime number 3.
> - (1, 4) since the path from 1 to 4 contains prime number 2.
> - (1, 6) since the path from 1 to 6 contains prime number 3.
> - (2, 4) since the path from 2 to 4 contains prime number 2.
> - (3, 6) since the path from 3 to 6 contains prime number 3.
> 
> It can be shown that there are only 6 valid paths.

**Constraints:**

  * `1 <= n <= 10^5`
  * `edges.length == n - 1`
  * `edges[i].length == 2`
  * `1 <= ui, vi <= n`
  * The input is generated such that `edges` represent a valid tree.


## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€æ£µ `n` ä¸ªèŠ‚ç‚¹çš„æ— å‘æ ‘ï¼ŒèŠ‚ç‚¹ç¼–å·ä¸º `1` åˆ° `n` ã€‚ç»™ä½ ä¸€ä¸ªæ•´æ•° `n` å’Œä¸€ä¸ªé•¿åº¦ä¸º `n - 1` çš„äºŒç»´æ•´æ•°æ•°ç»„ `edges`
ï¼Œå…¶ä¸­ `edges[i] = [ui, vi]` è¡¨ç¤ºèŠ‚ç‚¹ `ui` å’Œ `vi` åœ¨æ ‘ä¸­æœ‰ä¸€æ¡è¾¹ã€‚

è¯·ä½ è¿”å›æ ‘ä¸­çš„ **åˆæ³•è·¯å¾„æ•°ç›®**  ã€‚

å¦‚æœåœ¨èŠ‚ç‚¹ `a` åˆ°èŠ‚ç‚¹ `b` ä¹‹é—´ **æ°å¥½æœ‰ä¸€ä¸ª**  èŠ‚ç‚¹çš„ç¼–å·æ˜¯è´¨æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç§°è·¯å¾„ `(a, b)` æ˜¯ **åˆæ³•çš„**  ã€‚

**æ³¨æ„ï¼š**

  * è·¯å¾„ `(a, b)` æŒ‡çš„æ˜¯ä¸€æ¡ä»èŠ‚ç‚¹ `a` å¼€å§‹åˆ°èŠ‚ç‚¹ `b` ç»“æŸçš„ä¸€ä¸ªèŠ‚ç‚¹åºåˆ—ï¼Œåºåˆ—ä¸­çš„èŠ‚ç‚¹ **äº’ä¸ç›¸åŒ**  ï¼Œä¸”ç›¸é‚»èŠ‚ç‚¹ä¹‹é—´åœ¨æ ‘ä¸Šæœ‰ä¸€æ¡è¾¹ã€‚
  * è·¯å¾„ `(a, b)` å’Œè·¯å¾„ `(b, a)` è§†ä¸º **åŒä¸€æ¡**  è·¯å¾„ï¼Œä¸”åªè®¡å…¥ç­”æ¡ˆ **ä¸€æ¬¡**  ã€‚



**ç¤ºä¾‹ 1ï¼š**

![](https://assets.leetcode.com/uploads/2023/08/27/example1.png)

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** n = 5, edges = [[1,2],[1,3],[2,4],[2,5]]
> 
> **è¾“å‡ºï¼š** 4
> 
> **è§£é‡Šï¼š** æ°å¥½æœ‰ä¸€ä¸ªè´¨æ•°ç¼–å·çš„èŠ‚ç‚¹è·¯å¾„æœ‰ï¼š
> - (1, 2) å› ä¸ºè·¯å¾„ 1 åˆ° 2 åªåŒ…å«ä¸€ä¸ªè´¨æ•° 2 ã€‚
> - (1, 3) å› ä¸ºè·¯å¾„ 1 åˆ° 3 åªåŒ…å«ä¸€ä¸ªè´¨æ•° 3 ã€‚
> - (1, 4) å› ä¸ºè·¯å¾„ 1 åˆ° 4 åªåŒ…å«ä¸€ä¸ªè´¨æ•° 2 ã€‚
> - (2, 4) å› ä¸ºè·¯å¾„ 2 åˆ° 4 åªåŒ…å«ä¸€ä¸ªè´¨æ•° 2 ã€‚
> 
> åªæœ‰ 4 æ¡åˆæ³•è·¯å¾„ã€‚
> 
> 

**ç¤ºä¾‹ 2ï¼š**

![](https://assets.leetcode.com/uploads/2023/08/27/example2.png)

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** n = 6, edges = [[1,2],[1,3],[2,4],[3,5],[3,6]]
> 
> **è¾“å‡ºï¼š** 6
> 
> **è§£é‡Šï¼š** æ°å¥½æœ‰ä¸€ä¸ªè´¨æ•°ç¼–å·çš„èŠ‚ç‚¹è·¯å¾„æœ‰ï¼š
> - (1, 2) å› ä¸ºè·¯å¾„ 1 åˆ° 2 åªåŒ…å«ä¸€ä¸ªè´¨æ•° 2 ã€‚
> - (1, 3) å› ä¸ºè·¯å¾„ 1 åˆ° 3 åªåŒ…å«ä¸€ä¸ªè´¨æ•° 3 ã€‚
> - (1, 4) å› ä¸ºè·¯å¾„ 1 åˆ° 4 åªåŒ…å«ä¸€ä¸ªè´¨æ•° 2 ã€‚
> - (1, 6) å› ä¸ºè·¯å¾„ 1 åˆ° 6 åªåŒ…å«ä¸€ä¸ªè´¨æ•° 3 ã€‚
> - (2, 4) å› ä¸ºè·¯å¾„ 2 åˆ° 4 åªåŒ…å«ä¸€ä¸ªè´¨æ•° 2 ã€‚
> - (3, 6) å› ä¸ºè·¯å¾„ 3 åˆ° 6 åªåŒ…å«ä¸€ä¸ªè´¨æ•° 3 ã€‚
> 
> åªæœ‰ 6 æ¡åˆæ³•è·¯å¾„ã€‚
> 
> 



**æç¤ºï¼š**

  * `1 <= n <= 10^5`
  * `edges.length == n - 1`
  * `edges[i].length == 2`
  * `1 <= ui, vi <= n`
  * è¾“å…¥ä¿è¯ `edges` å½¢æˆä¸€æ£µåˆæ³•çš„æ ‘ã€‚


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 2791 | [æ ‘ä¸­å¯ä»¥å½¢æˆå›æ–‡çš„è·¯å¾„æ•°](https://leetcode.com/problems/count-paths-that-can-form-a-palindrome-in-a-tree) |  |  [`ä½è¿ç®—`](/tag/bit-manipulation.md) [`æ ‘`](/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/tag/depth-first-search.md) `2+` | <font color=#ff334b>Hard</font> |