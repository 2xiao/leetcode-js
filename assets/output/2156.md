# [2156. æŸ¥æ‰¾ç»™å®šå“ˆå¸Œå€¼çš„å­ä¸²](https://leetcode.com/problems/find-substring-with-given-hash-value)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`å­—ç¬¦ä¸²`](/leetcode/outline/tag/string.md) [`æ»‘åŠ¨çª—å£`](/leetcode/outline/tag/sliding-window.md) [`å“ˆå¸Œå‡½æ•°`](/leetcode/outline/tag/hash-function.md) [`æ»šåŠ¨å“ˆå¸Œ`](/leetcode/outline/tag/rolling-hash.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/find-substring-with-given-hash-value)


## é¢˜ç›®

The hash of a **0-indexed** string `s` of length `k`, given integers `p` and
`m`, is computed using the following function:

  * `hash(s, p, m) = (val(s[0]) * p0 + val(s[1]) * p1 + ... + val(s[k-1]) * pk-1) mod m`.

Where `val(s[i])` represents the index of `s[i]` in the alphabet from
`val('a') = 1` to `val('z') = 26`.

You are given a string `s` and the integers `power`, `modulo`, `k`, and
`hashValue.` Return `sub`,_the**first** **substring** of _`s` _of length_`k`
_such that_`hash(sub, power, modulo) == hashValue`.

The test cases will be generated such that an answer always **exists**.

A **substring** is a contiguous non-empty sequence of characters within a
string.



**Example 1:**

> Input: s = "leetcode", power = 7, modulo = 20, k = 2, hashValue = 0
> 
> Output: "ee"
> 
> Explanation: The hash of "ee" can be computed to be hash("ee", 7, 20) = (5 * 1 + 5 * 7) mod 20 = 40 mod 20 = 0. 
> 
> "ee" is the first substring of length 2 with hashValue 0. Hence, we return "ee".

**Example 2:**

> Input: s = "fbxzaad", power = 31, modulo = 100, k = 3, hashValue = 32
> 
> Output: "fbx"
> 
> Explanation: The hash of "fbx" can be computed to be hash("fbx", 31, 100) = (6 * 1 + 2 * 31 + 24 * 312) mod 100 = 23132 mod 100 = 32. 
> 
> The hash of "bxz" can be computed to be hash("bxz", 31, 100) = (2 * 1 + 24 * 31 + 26 * 312) mod 100 = 25732 mod 100 = 32. 
> 
> "fbx" is the first substring of length 3 with hashValue 32. Hence, we return "fbx".
> 
> Note that "bxz" also has a hash of 32 but it appears later than "fbx".

**Constraints:**

  * `1 <= k <= s.length <= 2 * 10^4`
  * `1 <= power, modulo <= 10^9`
  * `0 <= hashValue < modulo`
  * `s` consists of lowercase English letters only.
  * The test cases are generated such that an answer always **exists**.


## é¢˜ç›®å¤§æ„

ç»™å®šæ•´æ•° `p` å’Œ `m` ï¼Œä¸€ä¸ªé•¿åº¦ä¸º `k` ä¸”ä¸‹æ ‡ä» **0**  å¼€å§‹çš„å­—ç¬¦ä¸² `s` çš„å“ˆå¸Œå€¼æŒ‰ç…§å¦‚ä¸‹å‡½æ•°è®¡ç®—ï¼š

  * `hash(s, p, m) = (val(s[0]) * p0 + val(s[1]) * p1 + ... + val(s[k-1]) * pk-1) mod m`.

å…¶ä¸­ `val(s[i])` è¡¨ç¤º `s[i]` åœ¨å­—æ¯è¡¨ä¸­çš„ä¸‹æ ‡ï¼Œä» `val('a') = 1` åˆ° `val('z') = 26` ã€‚

ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² `s` å’Œæ•´æ•° `power`ï¼Œ`modulo`ï¼Œ`k` å’Œ `hashValue` ã€‚è¯·ä½ è¿”å› `s` ä¸­ **ç¬¬ä¸€ä¸ª** é•¿åº¦ä¸º `k`
çš„ **å­ä¸²**  `sub` ï¼Œæ»¡è¶³ _ _`hash(sub, power, modulo) == hashValue` ã€‚

æµ‹è¯•æ•°æ®ä¿è¯ä¸€å®š **å­˜åœ¨**  è‡³å°‘ä¸€ä¸ªè¿™æ ·çš„å­ä¸²ã€‚

**å­ä¸²** å®šä¹‰ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ä¸­è¿ç»­éç©ºå­—ç¬¦ç»„æˆçš„åºåˆ—ã€‚



**ç¤ºä¾‹ 1ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** s = "leetcode", power = 7, modulo = 20, k = 2, hashValue = 0
> 
> **è¾“å‡ºï¼š** "ee"
> 
> **è§£é‡Šï¼š** "ee" çš„å“ˆå¸Œå€¼ä¸º hash("ee", 7, 20) = (5 * 1 + 5 * 7) mod 20 = 40 mod 20 = 0 ã€‚
> 
> "ee" æ˜¯é•¿åº¦ä¸º 2 çš„ç¬¬ä¸€ä¸ªå“ˆå¸Œå€¼ä¸º 0 çš„å­ä¸²ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿”å› "ee" ã€‚
> 
> 

**ç¤ºä¾‹ 2ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** s = "fbxzaad", power = 31, modulo = 100, k = 3, hashValue = 32
> 
> **è¾“å‡ºï¼š** "fbx"
> 
> **è§£é‡Šï¼š** "fbx" çš„å“ˆå¸Œå€¼ä¸º hash("fbx", 31, 100) = (6 * 1 + 2 * 31 + 24 * 312) mod 100 = 23132 mod 100 = 32 ã€‚
> 
> "bxz" çš„å“ˆå¸Œå€¼ä¸º hash("bxz", 31, 100) = (2 * 1 + 24 * 31 + 26 * 312) mod 100 = 25732 mod 100 = 32 ã€‚
> 
> "fbx" æ˜¯é•¿åº¦ä¸º 3 çš„ç¬¬ä¸€ä¸ªå“ˆå¸Œå€¼ä¸º 32 çš„å­ä¸²ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿”å› "fbx" ã€‚
> 
> æ³¨æ„ï¼Œ"bxz" çš„å“ˆå¸Œå€¼ä¹Ÿä¸º 32 ï¼Œä½†æ˜¯å®ƒåœ¨å­—ç¬¦ä¸²ä¸­æ¯” "fbx" æ›´æ™šå‡ºç°ã€‚
> 
> 



**æç¤ºï¼š**

  * `1 <= k <= s.length <= 2 * 10^4`
  * `1 <= power, modulo <= 10^9`
  * `0 <= hashValue < modulo`
  * `s` åªåŒ…å«å°å†™è‹±æ–‡å­—æ¯ã€‚
  * æµ‹è¯•æ•°æ®ä¿è¯ä¸€å®š **å­˜åœ¨**  æ»¡è¶³æ¡ä»¶çš„å­ä¸²ã€‚


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 1316 | [ä¸åŒçš„å¾ªç¯å­å­—ç¬¦ä¸²](https://leetcode.com/problems/distinct-echo-substrings) |  |  [`å­—å…¸æ ‘`](/leetcode/outline/tag/trie.md) [`å­—ç¬¦ä¸²`](/leetcode/outline/tag/string.md) [`å“ˆå¸Œå‡½æ•°`](/leetcode/outline/tag/hash-function.md) `1+` | <font color=#ff334b>Hard</font> |

<style>
.blue {
    background-color: #096dd9;
    padding: 0.25rem 0.5rem;
    margin: 0;
    font-size: 0.85em;
    border-radius: 3px;
    color: white;
    font-weight: 500;
}
table th:first-of-type { width: 10%; }
table th:nth-of-type(2) { width: 35%; }
table th:nth-of-type(3) { width: 10%; }
table th:nth-of-type(4) { width: 35%; }
table th:nth-of-type(5) { width: 10%; }
</style>
