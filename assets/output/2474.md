---
title: 2474. è´­ä¹°é‡ä¸¥æ ¼å¢åŠ çš„å®¢æˆ· ğŸ”’
description: LeetCode,2474. è´­ä¹°é‡ä¸¥æ ¼å¢åŠ çš„å®¢æˆ· ğŸ”’,è´­ä¹°é‡ä¸¥æ ¼å¢åŠ çš„å®¢æˆ·,Customers With Strictly Increasing Purchases,è§£é¢˜æ€è·¯,æ•°æ®åº“
keywords:
  - LeetCode
  - 2474. è´­ä¹°é‡ä¸¥æ ¼å¢åŠ çš„å®¢æˆ· ğŸ”’
  - è´­ä¹°é‡ä¸¥æ ¼å¢åŠ çš„å®¢æˆ·
  - Customers With Strictly Increasing Purchases
  - è§£é¢˜æ€è·¯
  - æ•°æ®åº“
---

# 2474. è´­ä¹°é‡ä¸¥æ ¼å¢åŠ çš„å®¢æˆ· ğŸ”’

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/customers-with-strictly-increasing-purchases) [`LeetCode`](https://leetcode.com/problems/customers-with-strictly-increasing-purchases)

## é¢˜ç›®

Table: `Orders`

> 
> 
> 
> 
> 
> +--------------+------+
> 
> | Column Name  | Type |
> 
> +--------------+------+
> 
> | order_id> 
>  | int  |
> 
> | customer_id  | int  |
> 
> | order_date   | date |
> 
> | price> 
> > 
> | int  |
> 
> +--------------+------+
> 
> order_id is the column with unique values for this table.
> 
> Each row contains the id of an order, the id of customer that ordered it, the date of the order, and its price.
> 
> 



Write a solution to report the IDs of the customers with the **total
purchases** strictly increasing yearly.

  * The **total purchases** of a customer in one year is the sum of the prices of their orders in that year. If for some year the customer did not make any order, we consider the total purchases `0`.
  * The first year to consider for each customer is the year of their **first order**.
  * The last year to consider for each customer is the year of their **last order**.

Return the result table **in any order**.

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Orders table:
> 
> +----------+-------------+------------+-------+
> 
> | order_id | customer_id | order_date | price |
> 
> +----------+-------------+------------+-------+
> 
> | 1> 
> > 
> | 1> 
> > 
>    | 2019-07-01 | 1100  |
> 
> | 2> 
> > 
> | 1> 
> > 
>    | 2019-11-01 | 1200  |
> 
> | 3> 
> > 
> | 1> 
> > 
>    | 2020-05-26 | 3000  |
> 
> | 4> 
> > 
> | 1> 
> > 
>    | 2021-08-31 | 3100  |
> 
> | 5> 
> > 
> | 1> 
> > 
>    | 2022-12-07 | 4700  |
> 
> | 6> 
> > 
> | 2> 
> > 
>    | 2015-01-01 | 700   |
> 
> | 7> 
> > 
> | 2> 
> > 
>    | 2017-11-07 | 1000  |
> 
> | 8> 
> > 
> | 3> 
> > 
>    | 2017-01-01 | 900   |
> 
> | 9> 
> > 
> | 3> 
> > 
>    | 2018-11-07 | 900   |
> 
> +----------+-------------+------------+-------+
> 
> Output: 
> 
> +-------------+
> 
> | customer_id |
> 
> +-------------+
> 
> | 1> 
> > 
>    |
> 
> +-------------+
> 
> Explanation: 
> 
> Customer 1: The first year is 2019 and the last year is 2022
  > - 2019: 1100 + 1200 = 2300
  > - 2020: 3000
  > - 2021: 3100
  > - 2022: 4700
> 
>   We can see that the total purchases are strictly increasing yearly, so we include customer 1 in the answer.
> 
> 
> 
> Customer 2: The first year is 2015 and the last year is 2017
  > - 2015: 700
  > - 2016: 0
  > - 2017: 1000
> 
>   We do not include customer 2 in the answer because the total purchases are not strictly increasing. Note that customer 2 did not make any purchases in 2016.
> 
> 
> 
> Customer 3: The first year is 2017, and the last year is 2018
  > - 2017: 900
  > - 2018: 900
> 
>  We do not include customer 3 in the answer because the total purchases are not strictly increasing.
> 
> 


## é¢˜ç›®å¤§æ„

è¡¨: `Orders`

> 
> 
> 
> 
> 
> +--------------+------+
> 
> | Column Name  | Type |
> 
> +--------------+------+
> 
> | order_id> 
>  | int  |
> 
> | customer_id  | int  |
> 
> | order_date   | date |
> 
> | price> 
> > 
> | int  |
> 
> +--------------+------+
> 
> order_id æ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚
> 
> æ¯è¡ŒåŒ…å«è®¢å•çš„ idã€è®¢è´­è¯¥è®¢å•çš„å®¢æˆ· idã€è®¢å•æ—¥æœŸå’Œä»·æ ¼ã€‚
> 
> 



ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼ŒæŠ¥å‘Š **æ€»è´­ä¹°é‡  **æ¯å¹´ä¸¥æ ¼å¢åŠ çš„å®¢æˆ· idã€‚

  * å®¢æˆ·åœ¨ä¸€å¹´å†…çš„ **æ€»è´­ä¹°é‡  **æ˜¯è¯¥å¹´è®¢å•ä»·æ ¼çš„æ€»å’Œã€‚å¦‚æœæŸä¸€å¹´å®¢æˆ·æ²¡æœ‰ä¸‹ä»»ä½•è®¢å•ï¼Œæˆ‘ä»¬è®¤ä¸ºæ€»è´­ä¹°é‡ä¸º `0`ã€‚
  * å¯¹äºæ¯ä¸ªå®¢æˆ·ï¼Œè¦è€ƒè™‘çš„ç¬¬ä¸€ä¸ªå¹´æ˜¯ä»–ä»¬ **ç¬¬ä¸€æ¬¡ä¸‹å•  **çš„å¹´ä»½ã€‚
  * å¯¹äºæ¯ä¸ªå®¢æˆ·ï¼Œè¦è€ƒè™‘çš„æœ€åä¸€å¹´æ˜¯ä»–ä»¬ **æœ€åä¸€æ¬¡ä¸‹å•  **çš„å¹´ä»½ã€‚

ä»¥ **ä»»æ„é¡ºåº  **è¿”å›ç»“æœè¡¨ã€‚

æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1:**

> 
> 
> 
> 
> 
> **è¾“å…¥:** 
> 
> Orders è¡¨:
> 
> +----------+-------------+------------+-------+
> 
> | order_id | customer_id | order_date | price |
> 
> +----------+-------------+------------+-------+
> 
> | 1> 
> > 
> | 1> 
> > 
>    | 2019-07-01 | 1100  |
> 
> | 2> 
> > 
> | 1> 
> > 
>    | 2019-11-01 | 1200  |
> 
> | 3> 
> > 
> | 1> 
> > 
>    | 2020-05-26 | 3000  |
> 
> | 4> 
> > 
> | 1> 
> > 
>    | 2021-08-31 | 3100  |
> 
> | 5> 
> > 
> | 1> 
> > 
>    | 2022-12-07 | 4700  |
> 
> | 6> 
> > 
> | 2> 
> > 
>    | 2015-01-01 | 700   |
> 
> | 7> 
> > 
> | 2> 
> > 
>    | 2017-11-07 | 1000  |
> 
> | 8> 
> > 
> | 3> 
> > 
>    | 2017-01-01 | 900   |
> 
> | 9> 
> > 
> | 3> 
> > 
>    | 2018-11-07 | 900   |
> 
> +----------+-------------+------------+-------+
> 
> **è¾“å‡º:** 
> 
> +-------------+
> 
> | customer_id |
> 
> +-------------+
> 
> | 1> 
> > 
>    |
> 
> +-------------+
> 
> **è§£é‡Š:** 
> 
> å®¢æˆ· 1: ç¬¬ä¸€å¹´æ˜¯ 2019 å¹´ï¼Œæœ€åä¸€å¹´æ˜¯ 2022 å¹´
  > - 2019: 1100 + 1200 = 2300
  > - 2020: 3000
  > - 2021: 3100
  > - 2022: 4700
> 
>   æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ€»è´­ä¹°é‡æ¯å¹´éƒ½åœ¨ä¸¥æ ¼å¢åŠ ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ç­”æ¡ˆä¸­åŒ…å«äº†å®¢æˆ· 1ã€‚
> 
> 
> 
> å®¢æˆ· 2: ç¬¬ä¸€å¹´æ˜¯2015å¹´ï¼Œæœ€åä¸€å¹´æ˜¯2017å¹´
  > - 2015: 700
  > - 2016: 0
  > - 2017: 1000
> 
>   æˆ‘ä»¬æ²¡æœ‰æŠŠå®¢æˆ· 2 åŒ…æ‹¬åœ¨ç­”æ¡ˆä¸­ï¼Œå› ä¸ºæ€»çš„è´­ä¹°é‡å¹¶æ²¡æœ‰ä¸¥æ ¼åœ°å¢åŠ ã€‚è¯·æ³¨æ„ï¼Œå®¢æˆ· 2 åœ¨ 2016 å¹´æ²¡æœ‰è´­ä¹°ä»»ä½•ç‰©å“ã€‚
> 
> 
> 
> å®¢æˆ· 3: ç¬¬ä¸€å¹´æ˜¯ 2017 å¹´ï¼Œæœ€åä¸€å¹´æ˜¯ 2018 å¹´
  > - 2017: 900
  > - 2018: 900


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ | åŠ›æ‰£ |
| :------: | :------ | :------: | :------ | :------ | :------: |
| 1225 | æŠ¥å‘Šç³»ç»ŸçŠ¶æ€çš„è¿ç»­æ—¥æœŸ ğŸ”’ |  |  [`æ•°æ®åº“`](/tag/database.md) | <font color=#ff334b>Hard</font> | [ğŸ€„ï¸](https://leetcode.cn/problems/report-contiguous-dates) [ğŸ”—](https://leetcode.com/problems/report-contiguous-dates) |
| 1285 | æ‰¾åˆ°è¿ç»­åŒºé—´çš„å¼€å§‹å’Œç»“æŸæ•°å­— ğŸ”’ |  |  [`æ•°æ®åº“`](/tag/database.md) | <font color=#ffb800>Medium</font> | [ğŸ€„ï¸](https://leetcode.cn/problems/find-the-start-and-end-number-of-continuous-ranges) [ğŸ”—](https://leetcode.com/problems/find-the-start-and-end-number-of-continuous-ranges) |