# [2104. å­æ•°ç»„èŒƒå›´å’Œ](https://leetcode.com/problems/sum-of-subarray-ranges)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ ˆ`](/leetcode/outline/tag/stack.md) [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`å•è°ƒæ ˆ`](/leetcode/outline/tag/monotonic-stack.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/sum-of-subarray-ranges)


## é¢˜ç›®

You are given an integer array `nums`. The **range** of a subarray of `nums`
is the difference between the largest and smallest element in the subarray.

Return _the**sum of all** subarray ranges of _`nums` _._

A subarray is a contiguous **non-empty** sequence of elements within an array.



**Example 1:**

> Input: nums = [1,2,3]
> 
> Output: 4
> 
> Explanation: The 6 subarrays of nums are the following:
> 
> [1], range = largest - smallest = 1 - 1 = 0 
> 
> [2], range = 2 - 2 = 0
> 
> [3], range = 3 - 3 = 0
> 
> [1,2], range = 2 - 1 = 1
> 
> [2,3], range = 3 - 2 = 1
> 
> [1,2,3], range = 3 - 1 = 2
> 
> So the sum of all ranges is 0 + 0 + 0 + 1 + 1 + 2 = 4.

**Example 2:**

> Input: nums = [1,3,3]
> 
> Output: 4
> 
> Explanation: The 6 subarrays of nums are the following:
> 
> [1], range = largest - smallest = 1 - 1 = 0
> 
> [3], range = 3 - 3 = 0
> 
> [3], range = 3 - 3 = 0
> 
> [1,3], range = 3 - 1 = 2
> 
> [3,3], range = 3 - 3 = 0
> 
> [1,3,3], range = 3 - 1 = 2
> 
> So the sum of all ranges is 0 + 0 + 0 + 2 + 0 + 2 = 4.

**Example 3:**

> Input: nums = [4,-2,-3,4,1]
> 
> Output: 59
> 
> Explanation: The sum of all subarray ranges of nums is 59.

**Constraints:**

  * `1 <= nums.length <= 1000`
  * `-10^9 <= nums[i] <= 10^9`



**Follow-up:** Could you find a solution with `O(n)` time complexity?


## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums` ã€‚`nums` ä¸­ï¼Œå­æ•°ç»„çš„ **èŒƒå›´** æ˜¯å­æ•°ç»„ä¸­æœ€å¤§å…ƒç´ å’Œæœ€å°å…ƒç´ çš„å·®å€¼ã€‚

è¿”å› `nums` ä¸­ **æ‰€æœ‰** å­æ•°ç»„èŒƒå›´çš„ **å’Œ** _ã€‚_

å­æ•°ç»„æ˜¯æ•°ç»„ä¸­ä¸€ä¸ªè¿ç»­ **éç©º** çš„å…ƒç´ åºåˆ—ã€‚



**ç¤ºä¾‹ 1ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** nums = [1,2,3]
> 
> **è¾“å‡ºï¼š** 4
> 
> **è§£é‡Šï¼š** nums çš„ 6 ä¸ªå­æ•°ç»„å¦‚ä¸‹æ‰€ç¤ºï¼š
> 
> [1]ï¼ŒèŒƒå›´ = æœ€å¤§ - æœ€å° = 1 - 1 = 0 
> 
> [2]ï¼ŒèŒƒå›´ = 2 - 2 = 0
> 
> [3]ï¼ŒèŒƒå›´ = 3 - 3 = 0
> 
> [1,2]ï¼ŒèŒƒå›´ = 2 - 1 = 1
> 
> [2,3]ï¼ŒèŒƒå›´ = 3 - 2 = 1
> 
> [1,2,3]ï¼ŒèŒƒå›´ = 3 - 1 = 2
> 
> æ‰€æœ‰èŒƒå›´çš„å’Œæ˜¯ 0 + 0 + 0 + 1 + 1 + 2 = 4

**ç¤ºä¾‹ 2ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** nums = [1,3,3]
> 
> **è¾“å‡ºï¼š** 4
> 
> **è§£é‡Šï¼š** nums çš„ 6 ä¸ªå­æ•°ç»„å¦‚ä¸‹æ‰€ç¤ºï¼š
> 
> [1]ï¼ŒèŒƒå›´ = æœ€å¤§ - æœ€å° = 1 - 1 = 0
> 
> [3]ï¼ŒèŒƒå›´ = 3 - 3 = 0
> 
> [3]ï¼ŒèŒƒå›´ = 3 - 3 = 0
> 
> [1,3]ï¼ŒèŒƒå›´ = 3 - 1 = 2
> 
> [3,3]ï¼ŒèŒƒå›´ = 3 - 3 = 0
> 
> [1,3,3]ï¼ŒèŒƒå›´ = 3 - 1 = 2
> 
> æ‰€æœ‰èŒƒå›´çš„å’Œæ˜¯ 0 + 0 + 0 + 2 + 0 + 2 = 4
> 
> 

**ç¤ºä¾‹ 3ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** nums = [4,-2,-3,4,1]
> 
> **è¾“å‡ºï¼š** 59
> 
> **è§£é‡Šï¼š** nums ä¸­æ‰€æœ‰å­æ•°ç»„èŒƒå›´çš„å’Œæ˜¯ 59
> 
> 



**æç¤ºï¼š**

  * `1 <= nums.length <= 1000`
  * `-10^9 <= nums[i] <= 10^9`



**è¿›é˜¶ï¼š** ä½ å¯ä»¥è®¾è®¡ä¸€ç§æ—¶é—´å¤æ‚åº¦ä¸º `O(n)` çš„è§£å†³æ–¹æ¡ˆå—ï¼Ÿ


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

:::: md-demo ç›¸å…³é¢˜ç›®
- [ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  I](https://leetcode.com/problems/next-greater-element-i)
- [å­æ•°ç»„çš„æœ€å°å€¼ä¹‹å’Œ](https://leetcode.com/problems/sum-of-subarray-minimums)
- [é˜Ÿåˆ—ä¸­å¯ä»¥çœ‹åˆ°çš„äººæ•°](https://leetcode.com/problems/number-of-visible-people-in-a-queue)
- [ç»Ÿè®¡åŒè´¨å­å­—ç¬¦ä¸²çš„æ•°ç›®](https://leetcode.com/problems/count-number-of-homogenous-substrings)
- [å·«å¸ˆçš„æ€»åŠ›é‡å’Œ](https://leetcode.com/problems/sum-of-total-strength-of-wizards)

::::
