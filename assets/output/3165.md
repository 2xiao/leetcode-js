---
title: 3165. ä¸åŒ…å«ç›¸é‚»å…ƒç´ çš„å­åºåˆ—çš„æœ€å¤§å’Œ
description: LeetCode,3165. ä¸åŒ…å«ç›¸é‚»å…ƒç´ çš„å­åºåˆ—çš„æœ€å¤§å’Œ,ä¸åŒ…å«ç›¸é‚»å…ƒç´ çš„å­åºåˆ—çš„æœ€å¤§å’Œ,Maximum Sum of Subsequence With Non-adjacent Elements,è§£é¢˜æ€è·¯,çº¿æ®µæ ‘,æ•°ç»„,åˆ†æ²»,åŠ¨æ€è§„åˆ’
keywords:
  - LeetCode
  - 3165. ä¸åŒ…å«ç›¸é‚»å…ƒç´ çš„å­åºåˆ—çš„æœ€å¤§å’Œ
  - ä¸åŒ…å«ç›¸é‚»å…ƒç´ çš„å­åºåˆ—çš„æœ€å¤§å’Œ
  - Maximum Sum of Subsequence With Non-adjacent Elements
  - è§£é¢˜æ€è·¯
  - çº¿æ®µæ ‘
  - æ•°ç»„
  - åˆ†æ²»
  - åŠ¨æ€è§„åˆ’
---

# 3165. ä¸åŒ…å«ç›¸é‚»å…ƒç´ çš„å­åºåˆ—çš„æœ€å¤§å’Œ

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`çº¿æ®µæ ‘`](/tag/segment-tree.md) [`æ•°ç»„`](/tag/array.md) [`åˆ†æ²»`](/tag/divide-and-conquer.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/maximum-sum-of-subsequence-with-non-adjacent-elements) [`LeetCode`](https://leetcode.com/problems/maximum-sum-of-subsequence-with-non-adjacent-elements)

## é¢˜ç›®

You are given an array `nums` consisting of integers. You are also given a 2D
array `queries`, where `queries[i] = [posi, xi]`.

For query `i`, we first set `nums[posi]` equal to `xi`, then we calculate the
answer to query `i` which is the **maximum** sum of a subsequence of `nums`
where **no two adjacent elements are selected**.

Return the _sum_ of the answers to all queries.

Since the final answer may be very large, return it **modulo** `109 + 7`.

A **subsequence** is an array that can be derived from another array by
deleting some or no elements without changing the order of the remaining
elements.



**Example 1:**

**Input:** nums = [3,5,9], queries = [[1,-2],[0,-3]]

**Output:** 21

**Explanation:**  
After the 1st query, `nums = [3,-2,9]` and the maximum sum of a subsequence
with non-adjacent elements is `3 + 9 = 12`.  
After the 2nd query, `nums = [-3,-2,9]` and the maximum sum of a subsequence
with non-adjacent elements is 9.

**Example 2:**

**Input:** nums = [0,-1], queries = [[0,-5]]

**Output:** 0

**Explanation:**  
After the 1st query, `nums = [-5,-1]` and the maximum sum of a subsequence
with non-adjacent elements is 0 (choosing an empty subsequence).



**Constraints:**

  * `1 <= nums.length <= 5 * 10^4`
  * `-10^5 <= nums[i] <= 10^5`
  * `1 <= queries.length <= 5 * 10^4`
  * `queries[i] == [posi, xi]`
  * `0 <= posi <= nums.length - 1`
  * `-10^5 <= xi <= 10^5`


## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums` å’Œä¸€ä¸ªäºŒç»´æ•°ç»„ `queries`ï¼Œå…¶ä¸­ `queries[i] = [posi, xi]`ã€‚

å¯¹äºæ¯ä¸ªæŸ¥è¯¢ `i`ï¼Œé¦–å…ˆå°† `nums[posi]` è®¾ç½®ä¸º `xi`ï¼Œç„¶åè®¡ç®—æŸ¥è¯¢ `i` çš„ç­”æ¡ˆï¼Œè¯¥ç­”æ¡ˆä¸º `nums` ä¸­ **ä¸åŒ…å«ç›¸é‚»å…ƒç´ **
çš„ å­åºåˆ— çš„ **æœ€å¤§** å’Œã€‚

è¿”å›æ‰€æœ‰æŸ¥è¯¢çš„ç­”æ¡ˆä¹‹å’Œã€‚

ç”±äºæœ€ç»ˆç­”æ¡ˆå¯èƒ½éå¸¸å¤§ï¼Œè¿”å›å…¶å¯¹ `109 + 7` **å–ä½™** çš„ç»“æœã€‚

**å­åºåˆ—** æ˜¯æŒ‡ä»å¦ä¸€ä¸ªæ•°ç»„ä¸­åˆ é™¤ä¸€äº›æˆ–ä¸åˆ é™¤å…ƒç´ è€Œä¸æ”¹å˜å‰©ä½™å…ƒç´ é¡ºåºå¾—åˆ°çš„æ•°ç»„ã€‚



**ç¤ºä¾‹ 1ï¼š**

**è¾“å…¥ï¼š** nums = [3,5,9], queries = [[1,-2],[0,-3]]

**è¾“å‡ºï¼š** 21

**è§£é‡Šï¼š**  
æ‰§è¡Œç¬¬ 1 ä¸ªæŸ¥è¯¢åï¼Œ`nums = [3,-2,9]`ï¼Œä¸åŒ…å«ç›¸é‚»å…ƒç´ çš„å­åºåˆ—çš„æœ€å¤§å’Œä¸º `3 + 9 = 12`ã€‚  
æ‰§è¡Œç¬¬ 2 ä¸ªæŸ¥è¯¢åï¼Œ`nums = [-3,-2,9]`ï¼Œä¸åŒ…å«ç›¸é‚»å…ƒç´ çš„å­åºåˆ—çš„æœ€å¤§å’Œä¸º 9 ã€‚

**ç¤ºä¾‹ 2ï¼š**

**è¾“å…¥ï¼š** nums = [0,-1], queries = [[0,-5]]

**è¾“å‡ºï¼š** 0

**è§£é‡Šï¼š**  
æ‰§è¡Œç¬¬ 1 ä¸ªæŸ¥è¯¢åï¼Œ`nums = [-5,-1]`ï¼Œä¸åŒ…å«ç›¸é‚»å…ƒç´ çš„å­åºåˆ—çš„æœ€å¤§å’Œä¸º 0ï¼ˆé€‰æ‹©ç©ºå­åºåˆ—ï¼‰ã€‚



**æç¤ºï¼š**

  * `1 <= nums.length <= 5 * 10^4`
  * `-10^5 <= nums[i] <= 10^5`
  * `1 <= queries.length <= 5 * 10^4`
  * `queries[i] == [posi, xi]`
  * `0 <= posi <= nums.length - 1`
  * `-10^5 <= xi <= 10^5`


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```