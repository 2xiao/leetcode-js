# [2003. æ¯æ£µå­æ ‘å†…ç¼ºå¤±çš„æœ€å°åŸºå› å€¼](https://leetcode.com/problems/smallest-missing-genetic-value-in-each-subtree)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ ‘`](/outline/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/outline/tag/depth-first-search.md) [`å¹¶æŸ¥é›†`](/outline/tag/union-find.md) [`åŠ¨æ€è§„åˆ’`](/outline/tag/dynamic-programming.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/smallest-missing-genetic-value-in-each-subtree)

## é¢˜ç›®

There is a **family tree** rooted at `0` consisting of `n` nodes numbered `0`
to `n - 1`. You are given a **0-indexed** integer array `parents`, where
`parents[i]` is the parent for node `i`. Since node `0` is the **root** ,
`parents[0] == -1`.

There are `10^5` genetic values, each represented by an integer in the
**inclusive** range `[1, 105]`. You are given a **0-indexed** integer array
`nums`, where `nums[i]` is a **distinct** genetic value for node `i`.

Return _an array_`ans` _of length_`n` _where_`ans[i]`_is_ _the**smallest**
genetic value that is **missing** from the subtree rooted at node_ `i`.

The **subtree** rooted at a node `x` contains node `x` and all of its
**descendant** nodes.



**Example 1:**

![](https://assets.leetcode.com/uploads/2021/08/23/case-1.png)

> Input: parents = [-1,0,0,2], nums = [1,2,3,4]
> 
> Output: [5,1,1,1]
> 
> Explanation: The answer for each subtree is calculated as follows:
> - 0: The subtree contains nodes [0,1,2,3] with values [1,2,3,4]. 5 is the smallest missing value.
> - 1: The subtree contains only node 1 with value 2. 1 is the smallest missing value.
> - 2: The subtree contains nodes [2,3] with values [3,4]. 1 is the smallest missing value.
> - 3: The subtree contains only node 3 with value 4. 1 is the smallest missing value.

**Example 2:**

![](https://assets.leetcode.com/uploads/2021/08/23/case-2.png)

> Input: parents = [-1,0,1,0,3,3], nums = [5,4,6,2,1,3]
> 
> Output: [7,1,1,4,2,1]
> 
> Explanation: The answer for each subtree is calculated as follows:
> - 0: The subtree contains nodes [0,1,2,3,4,5] with values [5,4,6,2,1,3]. 7 is the smallest missing value.
> - 1: The subtree contains nodes [1,2] with values [4,6]. 1 is the smallest missing value.
> - 2: The subtree contains only node 2 with value 6. 1 is the smallest missing value.
> - 3: The subtree contains nodes [3,4,5] with values [2,1,3]. 4 is the smallest missing value.
> - 4: The subtree contains only node 4 with value 1. 2 is the smallest missing value.
> - 5: The subtree contains only node 5 with value 3. 1 is the smallest missing value.

**Example 3:**

> Input: parents = [-1,2,3,0,2,4,1], nums = [2,3,4,5,6,7,8]
> 
> Output: [1,1,1,1,1,1,1]
> 
> Explanation: The value 1 is missing from all the subtrees.

**Constraints:**

  * `n == parents.length == nums.length`
  * `2 <= n <= 10^5`
  * `0 <= parents[i] <= n - 1` for `i != 0`
  * `parents[0] == -1`
  * `parents` represents a valid tree.
  * `1 <= nums[i] <= 10^5`
  * Each `nums[i]` is distinct.


## é¢˜ç›®å¤§æ„

æœ‰ä¸€æ£µæ ¹èŠ‚ç‚¹ä¸º `0` çš„ **å®¶æ—æ ‘**  ï¼Œæ€»å…±åŒ…å« `n` ä¸ªèŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹ç¼–å·ä¸º `0` åˆ° `n - 1` ã€‚ç»™ä½ ä¸€ä¸ªä¸‹æ ‡ä» **0**
å¼€å§‹çš„æ•´æ•°æ•°ç»„ `parents` ï¼Œå…¶ä¸­ `parents[i]` æ˜¯èŠ‚ç‚¹ `i` çš„çˆ¶èŠ‚ç‚¹ã€‚ç”±äºèŠ‚ç‚¹ `0` æ˜¯ **æ ¹**  ï¼Œæ‰€ä»¥
`parents[0] == -1` ã€‚

æ€»å…±æœ‰ `10^5` ä¸ªåŸºå› å€¼ï¼Œæ¯ä¸ªåŸºå› å€¼éƒ½ç”¨ **é—­åŒºé—´**  `[1, 105]` ä¸­çš„ä¸€ä¸ªæ•´æ•°è¡¨ç¤ºã€‚ç»™ä½ ä¸€ä¸ªä¸‹æ ‡ä» **0**  å¼€å§‹çš„æ•´æ•°æ•°ç»„
`nums` ï¼Œå…¶ä¸­ `nums[i]` æ˜¯èŠ‚ç‚¹ `i` çš„åŸºå› å€¼ï¼Œä¸”åŸºå› å€¼ **äº’ä¸ç›¸åŒ**  ã€‚

è¯·ä½ è¿”å›ä¸€ä¸ªæ•°ç»„ _ _`ans` ï¼Œé•¿åº¦ä¸º `n` ï¼Œå…¶ä¸­ `ans[i]` æ˜¯ä»¥èŠ‚ç‚¹ `i` ä¸ºæ ¹çš„å­æ ‘å†… **ç¼ºå¤±**  çš„ **æœ€å°**  åŸºå› å€¼ã€‚

èŠ‚ç‚¹ `x` ä¸ºæ ¹çš„ **å­æ ‘  **åŒ…å«èŠ‚ç‚¹ `x` å’Œå®ƒæ‰€æœ‰çš„ **åä»£**  èŠ‚ç‚¹ã€‚



**ç¤ºä¾‹ 1ï¼š**

![](https://assets.leetcode.com/uploads/2021/08/23/case-1.png)

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** parents = [-1,0,0,2], nums = [1,2,3,4]
> 
> **è¾“å‡ºï¼š**[5,1,1,1]
> 
> **è§£é‡Šï¼š** æ¯ä¸ªå­æ ‘ç­”æ¡ˆè®¡ç®—ç»“æœå¦‚ä¸‹ï¼š
> - 0ï¼šå­æ ‘åŒ…å«èŠ‚ç‚¹ [0,1,2,3] ï¼ŒåŸºå› å€¼åˆ†åˆ«ä¸º [1,2,3,4] ã€‚5 æ˜¯ç¼ºå¤±çš„æœ€å°åŸºå› å€¼ã€‚
> - 1ï¼šå­æ ‘åªåŒ…å«èŠ‚ç‚¹ 1 ï¼ŒåŸºå› å€¼ä¸º 2 ã€‚1 æ˜¯ç¼ºå¤±çš„æœ€å°åŸºå› å€¼ã€‚
> - 2ï¼šå­æ ‘åŒ…å«èŠ‚ç‚¹ [2,3] ï¼ŒåŸºå› å€¼åˆ†åˆ«ä¸º [3,4] ã€‚1 æ˜¯ç¼ºå¤±çš„æœ€å°åŸºå› å€¼ã€‚
> - 3ï¼šå­æ ‘åªåŒ…å«èŠ‚ç‚¹ 3 ï¼ŒåŸºå› å€¼ä¸º 4 ã€‚1æ˜¯ç¼ºå¤±çš„æœ€å°åŸºå› å€¼ã€‚
> 
> 

**ç¤ºä¾‹ 2ï¼š**

![](https://assets.leetcode.com/uploads/2021/08/23/case-2.png)

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** parents = [-1,0,1,0,3,3], nums = [5,4,6,2,1,3]
> 
> **è¾“å‡ºï¼š**[7,1,1,4,2,1]
> 
> **è§£é‡Šï¼š** æ¯ä¸ªå­æ ‘ç­”æ¡ˆè®¡ç®—ç»“æœå¦‚ä¸‹ï¼š
> - 0ï¼šå­æ ‘å†…åŒ…å«èŠ‚ç‚¹ [0,1,2,3,4,5] ï¼ŒåŸºå› å€¼åˆ†åˆ«ä¸º [5,4,6,2,1,3] ã€‚7 æ˜¯ç¼ºå¤±çš„æœ€å°åŸºå› å€¼ã€‚
> - 1ï¼šå­æ ‘å†…åŒ…å«èŠ‚ç‚¹ [1,2] ï¼ŒåŸºå› å€¼åˆ†åˆ«ä¸º [4,6] ã€‚ 1 æ˜¯ç¼ºå¤±çš„æœ€å°åŸºå› å€¼ã€‚
> - 2ï¼šå­æ ‘å†…åªåŒ…å«èŠ‚ç‚¹ 2 ï¼ŒåŸºå› å€¼ä¸º 6 ã€‚1 æ˜¯ç¼ºå¤±çš„æœ€å°åŸºå› å€¼ã€‚
> - 3ï¼šå­æ ‘å†…åŒ…å«èŠ‚ç‚¹ [3,4,5] ï¼ŒåŸºå› å€¼åˆ†åˆ«ä¸º [2,1,3] ã€‚4 æ˜¯ç¼ºå¤±çš„æœ€å°åŸºå› å€¼ã€‚
> - 4ï¼šå­æ ‘å†…åªåŒ…å«èŠ‚ç‚¹ 4 ï¼ŒåŸºå› å€¼ä¸º 1 ã€‚2 æ˜¯ç¼ºå¤±çš„æœ€å°åŸºå› å€¼ã€‚
> - 5ï¼šå­æ ‘å†…åªåŒ…å«èŠ‚ç‚¹ 5 ï¼ŒåŸºå› å€¼ä¸º 3 ã€‚1 æ˜¯ç¼ºå¤±çš„æœ€å°åŸºå› å€¼ã€‚
> 
> 

**ç¤ºä¾‹ 3ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** parents = [-1,2,3,0,2,4,1], nums = [2,3,4,5,6,7,8]
> 
> **è¾“å‡ºï¼š**[1,1,1,1,1,1,1]
> 
> **è§£é‡Šï¼š** æ‰€æœ‰å­æ ‘éƒ½ç¼ºå¤±åŸºå› å€¼ 1 ã€‚
> 
> 



**æç¤ºï¼š**

  * `n == parents.length == nums.length`
  * `2 <= n <= 10^5`
  * å¯¹äº `i != 0` ï¼Œæ»¡è¶³ `0 <= parents[i] <= n - 1`
  * `parents[0] == -1`
  * `parents` è¡¨ç¤ºä¸€æ£µåˆæ³•çš„æ ‘ã€‚
  * `1 <= nums[i] <= 10^5`
  * `nums[i]` äº’ä¸ç›¸åŒã€‚


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```