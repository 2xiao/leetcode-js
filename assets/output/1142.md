# [1142. è¿‡å»30å¤©çš„ç”¨æˆ·æ´»åŠ¨ II](https://leetcode.com/problems/user-activity-for-the-past-30-days-ii)

ğŸŸ¢ <font color=#15bd66>Easy</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/user-activity-for-the-past-30-days-ii)

## é¢˜ç›®

Table: `Activity`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | user_id> 
>    | int> 
>  |
> 
> | session_id> 
> | int> 
>  |
> 
> | activity_date | date> 
> |
> 
> | activity_type | enum> 
> |
> 
> +---------------+---------+
> 
> This table may have duplicate rows.
> 
> The activity_type column is an ENUM (category) of type ('open_session', 'end_session', 'scroll_down', 'send_message').
> 
> The table shows the user activities for a social media website. 
> 
> Note that each session belongs to exactly one user.
> 
> 



Write a solution to find the average number of sessions per user for a period
of `30` days ending `2019-07-27` inclusively, **rounded to 2 decimal places**.
The sessions we want to count for a user are those with at least one activity
in that time period.

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Activity table:
> 
> +---------+------------+---------------+---------------+
> 
> | user_id | session_id | activity_date | activity_type |
> 
> +---------+------------+---------------+---------------+
> 
> | 1> 
>    | 1> 
> > 
>   | 2019-07-20> 
> | open_session  |
> 
> | 1> 
>    | 1> 
> > 
>   | 2019-07-20> 
> | scroll_down   |
> 
> | 1> 
>    | 1> 
> > 
>   | 2019-07-20> 
> | end_session   |
> 
> | 2> 
>    | 4> 
> > 
>   | 2019-07-20> 
> | open_session  |
> 
> | 2> 
>    | 4> 
> > 
>   | 2019-07-21> 
> | send_message  |
> 
> | 2> 
>    | 4> 
> > 
>   | 2019-07-21> 
> | end_session   |
> 
> | 3> 
>    | 2> 
> > 
>   | 2019-07-21> 
> | open_session  |
> 
> | 3> 
>    | 2> 
> > 
>   | 2019-07-21> 
> | send_message  |
> 
> | 3> 
>    | 2> 
> > 
>   | 2019-07-21> 
> | end_session   |
> 
> | 3> 
>    | 5> 
> > 
>   | 2019-07-21> 
> | open_session  |
> 
> | 3> 
>    | 5> 
> > 
>   | 2019-07-21> 
> | scroll_down   |
> 
> | 3> 
>    | 5> 
> > 
>   | 2019-07-21> 
> | end_session   |
> 
> | 4> 
>    | 3> 
> > 
>   | 2019-06-25> 
> | open_session  |
> 
> | 4> 
>    | 3> 
> > 
>   | 2019-06-25> 
> | end_session   |
> 
> +---------+------------+---------------+---------------+
> 
> Output: 
> 
> +---------------------------+ 
> 
> | average_sessions_per_user |
> 
> +---------------------------+ 
> 
> | 1.33> 
> > 
> > 
> > 
> > 
>   |
> 
> +---------------------------+
> 
> Explanation: User 1 and 2 each had 1 session in the past 30 days while user 3 had 2 sessions so the average is (1 + 1 + 2) / 3 = 1.33.
> 
> 


## é¢˜ç›®å¤§æ„

`Activity` è¡¨ï¼š

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | user_id> 
>    | int> 
>  |
> 
> | session_id> 
> | int> 
>  |
> 
> | activity_date | date> 
> |
> 
> | activity_type | enum> 
> |
> 
> +---------------+---------+
> 
> è¯¥è¡¨æ²¡æœ‰ä¸»é”®ï¼Œå®ƒå¯èƒ½æœ‰é‡å¤çš„è¡Œã€‚
> 
> activity_type åˆ—æ˜¯ ENUM ç±»å‹ï¼Œå¯ä»¥å–ï¼ˆâ€œ open_sessionâ€ï¼Œâ€œ end_sessionâ€ï¼Œâ€œ scroll_downâ€ï¼Œâ€œ send_messageâ€ï¼‰å››ç§æ´»åŠ¨ç±»å‹ä¹‹ä¸€ã€‚
> 
> è¯¥è¡¨æ˜¾ç¤ºäº†ç¤¾äº¤åª’ä½“ç½‘ç«™çš„ç”¨æˆ·æ´»åŠ¨ã€‚
> 
> è¯·æ³¨æ„ï¼Œæ¯ä¸ªä¼šè¯åªå±äºä¸€ä¸ªç”¨æˆ·ã€‚



ç¼–å†™è§£å†³æ–¹æ¡ˆï¼Œç»Ÿè®¡æˆªè‡³ `2019-07-27`ï¼ˆå«ï¼‰çš„ `30` å¤©å†…æ¯ä¸ªç”¨æˆ·çš„å¹³å‡ä¼šè¯æ•°ï¼Œ**å››èˆäº”å…¥åˆ°å°æ•°ç‚¹åä¸¤ä½**
ã€‚åªç»Ÿè®¡é‚£äº›ä¼šè¯æœŸé—´ç”¨æˆ·è‡³å°‘è¿›è¡Œä¸€é¡¹æ´»åŠ¨çš„æœ‰æ•ˆä¼šè¯ã€‚

ç»“æœæ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š**
> 
> Activity è¡¨ï¼š
> 
> +---------+------------+---------------+---------------+
> 
> | user_id | session_id | activity_date | activity_type |
> 
> +---------+------------+---------------+---------------+
> 
> | 1> 
>    | 1> 
> > 
>   | 2019-07-20> 
> | open_session  |
> 
> | 1> 
>    | 1> 
> > 
>   | 2019-07-20> 
> | scroll_down   |
> 
> | 1> 
>    | 1> 
> > 
>   | 2019-07-20> 
> | end_session   |
> 
> | 2> 
>    | 4> 
> > 
>   | 2019-07-20> 
> | open_session  |
> 
> | 2> 
>    | 4> 
> > 
>   | 2019-07-21> 
> | send_message  |
> 
> | 2> 
>    | 4> 
> > 
>   | 2019-07-21> 
> | end_session   |
> 
> | 3> 
>    | 2> 
> > 
>   | 2019-07-21> 
> | open_session  |
> 
> | 3> 
>    | 2> 
> > 
>   | 2019-07-21> 
> | send_message  |
> 
> | 3> 
>    | 2> 
> > 
>   | 2019-07-21> 
> | end_session   |
> 
> | 3> 
>    | 5> 
> > 
>   | 2019-07-21> 
> | open_session  |
> 
> | 3> 
>    | 5> 
> > 
>   | 2019-07-21> 
> | scroll_down   |
> 
> | 3> 
>    | 5> 
> > 
>   | 2019-07-21> 
> | end_session   |
> 
> | 4> 
>    | 3> 
> > 
>   | 2019-06-25> 
> | open_session  |
> 
> | 4> 
>    | 3> 
> > 
>   | 2019-06-25> 
> | end_session   |
> 
> +---------+------------+---------------+---------------+
> 
> **è¾“å‡ºï¼š**
> 
> +---------------------------+ 
> 
> | average_sessions_per_user |
> 
> +---------------------------+ 
> 
> | 1.33> 
> > 
> > 
> > 
> > 
>   |
> 
> +---------------------------+
> 
> **è§£é‡Šï¼š** ç”¨æˆ· 1 å’Œ 2 æ¯äººåœ¨è¿‡å» 30 å¤©æœ‰ 1 ä¸ªä¼šè¯ï¼Œè€Œç”¨æˆ· 3 æœ‰ 2 ä¸ªä¼šè¯ã€‚æ‰€ä»¥å¹³å‡æ˜¯ (1 + 1 + 2) / 3 = 1.33 ã€‚
> 
> 


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```