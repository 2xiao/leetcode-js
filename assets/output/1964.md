# [1964. æ‰¾å‡ºåˆ°æ¯ä¸ªä½ç½®ä¸ºæ­¢æœ€é•¿çš„æœ‰æ•ˆéšœç¢èµ›è·‘è·¯çº¿](https://leetcode.com/problems/find-the-longest-valid-obstacle-course-at-each-position)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ ‘çŠ¶æ•°ç»„`](/tag/binary-indexed-tree.md) [`æ•°ç»„`](/tag/array.md) [`äºŒåˆ†æŸ¥æ‰¾`](/tag/binary-search.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/find-the-longest-valid-obstacle-course-at-each-position)

## é¢˜ç›®

You want to build some obstacle courses. You are given a **0-indexed** integer
array `obstacles` of length `n`, where `obstacles[i]` describes the height of
the `ith` obstacle.

For every index `i` between `0` and `n - 1` (**inclusive**), find the length
of the **longest obstacle course** in `obstacles` such that:

  * You choose any number of obstacles between `0` and `i` **inclusive**.
  * You must include the `ith` obstacle in the course.
  * You must put the chosen obstacles in the **same order** as they appear in `obstacles`.
  * Every obstacle (except the first) is **taller** than or the **same height** as the obstacle immediately before it.

Return _an array_ `ans` _of length_ `n`, _where_ `ans[i]` _is the length of
the**longest obstacle course** for index_ `i` _as described above_.



**Example 1:**

> Input: obstacles = [1,2,3,2]
> 
> Output: [1,2,3,3]
> 
> Explanation: The longest valid obstacle course at each position is:
> - i = 0: [_1_], [1] has length 1.
> - i = 1: [_1_ ,_2_], [1,2] has length 2.
> - i = 2: [_1_ ,_2_ ,_3_], [1,2,3] has length 3.
> - i = 3: [_1_ ,_2_ ,3,_2_], [1,2,2] has length 3.

**Example 2:**

> Input: obstacles = [2,2,1]
> 
> Output: [1,2,1]
> 
> Explanation: The longest valid obstacle course at each position is:
> - i = 0: [_2_], [2] has length 1.
> - i = 1: [_2_ ,_2_], [2,2] has length 2.
> - i = 2: [2,2,_1_], [1] has length 1.

**Example 3:**

> Input: obstacles = [3,1,5,6,4,2]
> 
> Output: [1,1,2,3,2,2]
> 
> Explanation: The longest valid obstacle course at each position is:
> - i = 0: [_3_], [3] has length 1.
> - i = 1: [3,_1_], [1] has length 1.
> - i = 2: [_3_ ,1,_5_], [3,5] has length 2. [1,5] is also valid.
> - i = 3: [_3_ ,1,_5_ ,_6_], [3,5,6] has length 3. [1,5,6] is also valid.
> - i = 4: [_3_ ,1,5,6,_4_], [3,4] has length 2. [1,4] is also valid.
> - i = 5: [3,_1_ ,5,6,4,_2_], [1,2] has length 2.

**Constraints:**

  * `n == obstacles.length`
  * `1 <= n <= 10^5`
  * `1 <= obstacles[i] <= 10^7`


## é¢˜ç›®å¤§æ„

ä½ æ‰“ç®—æ„å»ºä¸€äº›éšœç¢èµ›è·‘è·¯çº¿ã€‚ç»™ä½ ä¸€ä¸ª **ä¸‹æ ‡ä» 0 å¼€å§‹** çš„æ•´æ•°æ•°ç»„ `obstacles` ï¼Œæ•°ç»„é•¿åº¦ä¸º `n` ï¼Œå…¶ä¸­
`obstacles[i]` è¡¨ç¤ºç¬¬ `i` ä¸ªéšœç¢çš„é«˜åº¦ã€‚

å¯¹äºæ¯ä¸ªä»‹äº `0` å’Œ `n - 1` ä¹‹é—´ï¼ˆåŒ…å« `0` å’Œ `n - 1`ï¼‰çš„ä¸‹æ ‡  `i` ï¼Œåœ¨æ»¡è¶³ä¸‹è¿°æ¡ä»¶çš„å‰æä¸‹ï¼Œè¯·ä½ æ‰¾å‡º
`obstacles` èƒ½æ„æˆçš„æœ€é•¿éšœç¢è·¯çº¿çš„é•¿åº¦ï¼š

  * ä½ å¯ä»¥é€‰æ‹©ä¸‹æ ‡ä»‹äº `0` åˆ° `i` ä¹‹é—´ï¼ˆåŒ…å« `0` å’Œ `i`ï¼‰çš„ä»»æ„ä¸ªéšœç¢ã€‚
  * åœ¨è¿™æ¡è·¯çº¿ä¸­ï¼Œå¿…é¡»åŒ…å«ç¬¬ `i` ä¸ªéšœç¢ã€‚
  * ä½ å¿…é¡»æŒ‰éšœç¢åœ¨ `obstacles` ä¸­çš„******å‡ºç°é¡ºåº** å¸ƒç½®è¿™äº›éšœç¢ã€‚
  * é™¤ç¬¬ä¸€ä¸ªéšœç¢å¤–ï¼Œè·¯çº¿ä¸­æ¯ä¸ªéšœç¢çš„é«˜åº¦éƒ½å¿…é¡»å’Œå‰ä¸€ä¸ªéšœç¢ **ç›¸åŒ** æˆ–è€… **æ›´é«˜** ã€‚

è¿”å›é•¿åº¦ä¸º `n` çš„ç­”æ¡ˆæ•°ç»„ `ans` ï¼Œå…¶ä¸­ `ans[i]` æ˜¯ä¸Šé¢æ‰€è¿°çš„ä¸‹æ ‡ `i` å¯¹åº”çš„æœ€é•¿éšœç¢èµ›è·‘è·¯çº¿çš„é•¿åº¦ã€‚



**ç¤ºä¾‹ 1ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** obstacles = [1,2,3,2]
> 
> **è¾“å‡ºï¼š**[1,2,3,3]
> 
> **è§£é‡Šï¼š** æ¯ä¸ªä½ç½®çš„æœ€é•¿æœ‰æ•ˆéšœç¢è·¯çº¿æ˜¯ï¼š
> - i = 0: [_**1**_], [1] é•¿åº¦ä¸º 1
> - i = 1: [_**1**_ ,_**2**_], [1,2] é•¿åº¦ä¸º 2
> - i = 2: [_**1**_ ,_**2**_ ,_**3**_], [1,2,3] é•¿åº¦ä¸º 3
> - i = 3: [_**1**_ ,_**2**_ ,3,_**2**_], [1,2,2] é•¿åº¦ä¸º 3
> 
> 

**ç¤ºä¾‹ 2ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** obstacles = [2,2,1]
> 
> **è¾“å‡ºï¼š**[1,2,1]
> 
> **è§£é‡Šï¼š** æ¯ä¸ªä½ç½®çš„æœ€é•¿æœ‰æ•ˆéšœç¢è·¯çº¿æ˜¯ï¼š
> - i = 0: [_**2**_], [2] é•¿åº¦ä¸º 1
> - i = 1: [_**2**_ ,_**2**_], [2,2] é•¿åº¦ä¸º 2
> - i = 2: [2,2,_**1**_], [1] é•¿åº¦ä¸º 1
> 
> 

**ç¤ºä¾‹ 3ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** obstacles = [3,1,5,6,4,2]
> 
> **è¾“å‡ºï¼š**[1,1,2,3,2,2]
> 
> **è§£é‡Šï¼š** æ¯ä¸ªä½ç½®çš„æœ€é•¿æœ‰æ•ˆéšœç¢è·¯çº¿æ˜¯ï¼š
> - i = 0: [_**3**_], [3] é•¿åº¦ä¸º 1
> - i = 1: [3,_**1**_], [1] é•¿åº¦ä¸º 1
> - i = 2: [_**3**_ ,1,_**5**_], [3,5] é•¿åº¦ä¸º 2, [1,5] ä¹Ÿæ˜¯æœ‰æ•ˆçš„éšœç¢èµ›è·‘è·¯çº¿
> - i = 3: [_**3**_ ,1,_**5**_ ,_**6**_], [3,5,6] é•¿åº¦ä¸º 3, [1,5,6] ä¹Ÿæ˜¯æœ‰æ•ˆçš„éšœç¢èµ›è·‘è·¯çº¿
> - i = 4: [_**3**_ ,1,5,6,_**4**_], [3,4] é•¿åº¦ä¸º 2, [1,4] ä¹Ÿæ˜¯æœ‰æ•ˆçš„éšœç¢èµ›è·‘è·¯çº¿
> - i = 5: [3,_**1**_ ,5,6,4,_**2**_], [1,2] é•¿åº¦ä¸º 2
> 
> 



**æç¤ºï¼š**

  * `n == obstacles.length`
  * `1 <= n <= 10^5`
  * `1 <= obstacles[i] <= 10^7`


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 300 | [æœ€é•¿é€’å¢å­åºåˆ—](https://leetcode.com/problems/longest-increasing-subsequence) | [[âœ“]](/problem/0300.md) |  [`æ•°ç»„`](/tag/array.md) [`äºŒåˆ†æŸ¥æ‰¾`](/tag/binary-search.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md) | <font color=#ffb800>Medium</font> |

<style>
.blue {
    background-color: #096dd9;
    padding: 0.25rem 0.5rem;
    margin: 0;
    font-size: 0.85em;
    border-radius: 3px;
    color: white;
    font-weight: 500;
}
table th:first-of-type { width: 10%; }
table th:nth-of-type(2) { width: 35%; }
table th:nth-of-type(3) { width: 10%; }
table th:nth-of-type(4) { width: 35%; }
table th:nth-of-type(5) { width: 10%; }
</style>
