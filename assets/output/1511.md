# [1511. æ¶ˆè´¹è€…ä¸‹å•é¢‘ç‡](https://leetcode.com/problems/customer-order-frequency)

ğŸŸ¢ <font color=#15bd66>Easy</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/customer-order-frequency)

## é¢˜ç›®

Table: `Customers`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | customer_id   | int> 
>  |
> 
> | name> 
> > 
>   | varchar |
> 
> | country> 
>    | varchar |
> 
> +---------------+---------+
> 
> customer_id is the column with unique values for this table.
> 
> This table contains information about the customers in the company.
> 
> 



Table: `Product`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | product_id> 
> | int> 
>  |
> 
> | description   | varchar |
> 
> | price> 
> > 
>  | int> 
>  |
> 
> +---------------+---------+
> 
> product_id is the column with unique values for this table.
> 
> This table contains information on the products in the company.
> 
> price is the product cost.
> 
> 



Table: `Orders`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | order_id> 
>   | int> 
>  |
> 
> | customer_id   | int> 
>  |
> 
> | product_id> 
> | int> 
>  |
> 
> | order_date> 
> | date> 
> |
> 
> | quantity> 
>   | int> 
>  |
> 
> +---------------+---------+
> 
> order_id is the column with unique values for this table.
> 
> This table contains information on customer orders.
> 
> customer_id is the id of the customer who bought "quantity" products with id "product_id".
> 
> Order_date is the date in format ('YYYY-MM-DD') when the order was shipped.
> 
> 



Write a solution to report the `customer_id` and `customer_name` of customers
who have spent at least `$100` in each month of **June and July 2020**.

Return the result table in **any order**.

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Customers table:
> 
> +--------------+-----------+-------------+
> 
> | customer_id  | name> 
>   | country> 
>  |
> 
> +--------------+-----------+-------------+
> 
> | 1> 
> > 
> > 
> | Winston   | USA> 
> > 
>  |
> 
> | 2> 
> > 
> > 
> | Jonathan  | Peru> 
> > 
> |
> 
> | 3> 
> > 
> > 
> | Moustafa  | Egypt> 
>    |
> 
> +--------------+-----------+-------------+
> 
> Product table:
> 
> +--------------+-------------+-------------+
> 
> | product_id   | description | price> 
>    |
> 
> +--------------+-------------+-------------+
> 
> | 10> 
> > 
>    | LC Phone> 
> | 300> 
> > 
>  |
> 
> | 20> 
> > 
>    | LC T-Shirt  | 10> 
> > 
>   |
> 
> | 30> 
> > 
>    | LC Book> 
>  | 45> 
> > 
>   |
> 
> | 40> 
> > 
>    | LC Keychain | 2> 
> > 
>    |
> 
> +--------------+-------------+-------------+
> 
> Orders table:
> 
> +--------------+-------------+-------------+-------------+-----------+
> 
> | order_id> 
>  | customer_id | product_id  | order_date  | quantity  |
> 
> +--------------+-------------+-------------+-------------+-----------+
> 
> | 1> 
> > 
> > 
> | 1> 
> > 
>    | 10> 
> > 
>   | 2020-06-10  | 1> 
> > 
>  |
> 
> | 2> 
> > 
> > 
> | 1> 
> > 
>    | 20> 
> > 
>   | 2020-07-01  | 1> 
> > 
>  |
> 
> | 3> 
> > 
> > 
> | 1> 
> > 
>    | 30> 
> > 
>   | 2020-07-08  | 2> 
> > 
>  |
> 
> | 4> 
> > 
> > 
> | 2> 
> > 
>    | 10> 
> > 
>   | 2020-06-15  | 2> 
> > 
>  |
> 
> | 5> 
> > 
> > 
> | 2> 
> > 
>    | 40> 
> > 
>   | 2020-07-01  | 10> 
> > 
> |
> 
> | 6> 
> > 
> > 
> | 3> 
> > 
>    | 20> 
> > 
>   | 2020-06-24  | 2> 
> > 
>  |
> 
> | 7> 
> > 
> > 
> | 3> 
> > 
>    | 30> 
> > 
>   | 2020-06-25  | 2> 
> > 
>  |
> 
> | 9> 
> > 
> > 
> | 3> 
> > 
>    | 30> 
> > 
>   | 2020-05-08  | 3> 
> > 
>  |
> 
> +--------------+-------------+-------------+-------------+-----------+
> 
> Output: 
> 
> +--------------+------------+
> 
> | customer_id  | name> 
>    |  
> 
> +--------------+------------+
> 
> | 1> 
> > 
> > 
> | Winston> 
> |
> 
> +--------------+------------+
> 
> Explanation: 
> 
> Winston spent $300 (300 * 1) in June and $100 ( 10 * 1 + 45 * 2) in July 2020.
> 
> Jonathan spent $600 (300 * 2) in June and $20 ( 2 * 10) in July 2020.
> 
> Moustafa spent $110 (10 * 2 + 45 * 2) in June and $0 in July 2020.
> 
> 


## é¢˜ç›®å¤§æ„

è¡¨: `Customers`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | customer_id   | int> 
>  |
> 
> | name> 
> > 
>   | varchar |
> 
> | country> 
>    | varchar |
> 
> +---------------+---------+
> 
> customer_id æ˜¯è¯¥è¡¨å…·æœ‰å”¯ä¸€å€¼çš„åˆ—.
> 
> è¯¥è¡¨åŒ…å«å…¬å¸æ¶ˆè´¹è€…çš„ä¿¡æ¯.
> 
> 



è¡¨: `Product`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | product_id> 
> | int> 
>  |
> 
> | description   | varchar |
> 
> | price> 
> > 
>  | int> 
>  |
> 
> +---------------+---------+
> 
> product_id æ˜¯è¯¥è¡¨å…·æœ‰å”¯ä¸€å€¼çš„åˆ—.
> 
> è¯¥è¡¨åŒ…å«å…¬å¸äº§å“çš„ä¿¡æ¯.
> 
> price æ˜¯è¯¥äº§å“æ‰€éœ€çš„èŠ±é”€.



è¡¨: `Orders`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | order_id> 
>   | int> 
>  |
> 
> | customer_id   | int> 
>  |
> 
> | product_id> 
> | int> 
>  |
> 
> | order_date> 
> | date> 
> |
> 
> | quantity> 
>   | int> 
>  |
> 
> +---------------+---------+
> 
> order_id æ˜¯è¯¥è¡¨å…·æœ‰å”¯ä¸€å€¼çš„åˆ—.
> 
> è¯¥è¡¨åŒ…å«æ¶ˆè´¹è€…ä¸‹å•çš„ä¿¡æ¯.
> 
> customer_id æ˜¯ä¹°äº†æ•°é‡ä¸º "quantity", id ä¸º "product_id" äº§å“çš„æ¶ˆè´¹è€…çš„ id.
> 
> Order_date æ˜¯è®¢å•å‘è´§çš„æ—¥æœŸ, æ ¼å¼ä¸º('YYYY-MM-DD').



å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼ŒæŠ¥å‘Šåœ¨ **2020 å¹´ 6 æœˆå’Œ 7 æœˆ  **æ¯ä¸ªæœˆè‡³å°‘èŠ±è´¹ `$100` çš„å®¢æˆ·çš„ `customer_id` å’Œ
`customer_name` ã€‚

ä»¥ **ä»»æ„é¡ºåº  **è¿”å›ç»“æœè¡¨.

ç»“æœæ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1:**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š**
> 
> Customers table:
> 
> +--------------+-----------+-------------+
> 
> | customer_id  | name> 
>   | country> 
>  |
> 
> +--------------+-----------+-------------+
> 
> | 1> 
> > 
> > 
> | Winston   | USA> 
> > 
>  |
> 
> | 2> 
> > 
> > 
> | Jonathan  | Peru> 
> > 
> |
> 
> | 3> 
> > 
> > 
> | Moustafa  | Egypt> 
>    |
> 
> +--------------+-----------+-------------+
> 
> Product table:
> 
> +--------------+-------------+-------------+
> 
> | product_id   | description | price> 
>    |
> 
> +--------------+-------------+-------------+
> 
> | 10> 
> > 
>    | LC Phone> 
> | 300> 
> > 
>  |
> 
> | 20> 
> > 
>    | LC T-Shirt  | 10> 
> > 
>   |
> 
> | 30> 
> > 
>    | LC Book> 
>  | 45> 
> > 
>   |
> 
> | 40> 
> > 
>    | LC Keychain | 2> 
> > 
>    |
> 
> +--------------+-------------+-------------+
> 
> Orders table:
> 
> +--------------+-------------+-------------+-------------+-----------+
> 
> | order_id> 
>  | customer_id | product_id  | order_date  | quantity  |
> 
> +--------------+-------------+-------------+-------------+-----------+
> 
> | 1> 
> > 
> > 
> | 1> 
> > 
>    | 10> 
> > 
>   | 2020-06-10  | 1> 
> > 
>  |
> 
> | 2> 
> > 
> > 
> | 1> 
> > 
>    | 20> 
> > 
>   | 2020-07-01  | 1> 
> > 
>  |
> 
> | 3> 
> > 
> > 
> | 1> 
> > 
>    | 30> 
> > 
>   | 2020-07-08  | 2> 
> > 
>  |
> 
> | 4> 
> > 
> > 
> | 2> 
> > 
>    | 10> 
> > 
>   | 2020-06-15  | 2> 
> > 
>  |
> 
> | 5> 
> > 
> > 
> | 2> 
> > 
>    | 40> 
> > 
>   | 2020-07-01  | 10> 
> > 
> |
> 
> | 6> 
> > 
> > 
> | 3> 
> > 
>    | 20> 
> > 
>   | 2020-06-24  | 2> 
> > 
>  |
> 
> | 7> 
> > 
> > 
> | 3> 
> > 
>    | 30> 
> > 
>   | 2020-06-25  | 2> 
> > 
>  |
> 
> | 9> 
> > 
> > 
> | 3> 
> > 
>    | 30> 
> > 
>   | 2020-05-08  | 3> 
> > 
>  |
> 
> +--------------+-------------+-------------+-------------+-----------+
> 
> **è¾“å‡ºï¼š**
> 
> +--------------+------------+
> 
> | customer_id  | name> 
>    |  
> 
> +--------------+------------+
> 
> | 1> 
> > 
> > 
> | Winston> 
> |
> 
> +--------------+------------+ 
> 
> **è§£é‡Šï¼š**
> 
> Winston åœ¨ 2020 å¹´ 6 æœˆèŠ±è´¹äº† $300(300 * 1), åœ¨ 7 æœˆèŠ±è´¹äº† $100(10 * 1 + 45 * 2).
> 
> Jonathan åœ¨ 2020 å¹´ 6 æœˆèŠ±è´¹äº† $600(300 * 2), åœ¨ 7 æœˆèŠ±è´¹äº† $20(2 * 10).
> 
> Moustafa åœ¨ 2020 å¹´ 6 æœˆèŠ±è´¹äº† $110 (10 * 2 + 45 * 2), åœ¨ 7 æœˆèŠ±è´¹äº† $0.


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```