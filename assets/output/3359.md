---
title: 3359. 查找最大元素不超过 K 的有序子矩阵 🔒
description: LeetCode 3359. 查找最大元素不超过 K 的有序子矩阵 🔒题解，Find Sorted Submatrices With Maximum Element at Most K，包含解题思路、复杂度分析以及完整的 JavaScript 代码实现。
keywords:
  - LeetCode
  - 3359. 查找最大元素不超过 K 的有序子矩阵 🔒
  - 查找最大元素不超过 K 的有序子矩阵
  - Find Sorted Submatrices With Maximum Element at Most K
  - 解题思路
  - 栈
  - 数组
  - 矩阵
  - 单调栈
---

# 3359. 查找最大元素不超过 K 的有序子矩阵 🔒

🔴 <font color=#ff334b>Hard</font>&emsp; 🔖&ensp; [`栈`](/tag/stack.md) [`数组`](/tag/array.md) [`矩阵`](/tag/matrix.md) [`单调栈`](/tag/monotonic-stack.md)&emsp; 🔗&ensp;[`力扣`](https://leetcode.cn/problems/find-sorted-submatrices-with-maximum-element-at-most-k) [`LeetCode`](https://leetcode.com/problems/find-sorted-submatrices-with-maximum-element-at-most-k)

## 题目

You are given a 2D matrix `grid` of size `m x n`. You are also given a **non-
negative** integer `k`.

Return the number of **submatrices** of `grid` that satisfy the following
conditions:

  * The maximum element in the submatrix **less than or equal to** `k`.
  * Each row in the submatrix is sorted in **non-increasing** order.

A submatrix `(x1, y1, x2, y2)` is a matrix that forms by choosing all cells
`grid[x][y]` where `x1 <= x <= x2` and `y1 <= y <= y2`.



**Example 1:**

**Input:** grid = [[4,3,2,1],[8,7,6,1]], k = 3

**Output:** 8

**Explanation:**

**![](https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/3300-3399/3359.Find%20Sorted%20Submatrices%20With%20Maximum%20Element%20at%20Most%20K/images/mine.png)**

The 8 submatrices are:

  * `[[1]]`
  * `[[1]]`
  * `[[2,1]]`
  * `[[3,2,1]]`
  * `[[1],[1]]`
  * `[[2]]`
  * `[[3]]`
  * `[[3,2]]`

**Example 2:**

**Input:** grid = [[1,1,1],[1,1,1],[1,1,1]], k = 1

**Output:** 36

**Explanation:**

There are 36 submatrices of grid. All submatrices have their maximum element
equal to 1.

**Example 3:**

**Input:** grid = [[1]], k = 1

**Output:** 1



**Constraints:**

  * `1 <= m == grid.length <= 10^3`
  * `1 <= n == grid[i].length <= 10^3`
  * `1 <= grid[i][j] <= 10^9`
  * `1 <= k <= 10^9`



​​​​​​


## 题目大意

给定一个大小为 `m x n` 的二维矩阵 `grid`。同时给定一个 **非负整数**  `k`。

返回满足下列条件的 `grid` 的子矩阵数量：

  * 子矩阵中最大的元素 **小于等于**  `k`。
  * 子矩阵的每一行都以 **非递增** 顺序排序。

矩阵的子矩阵 `(x1, y1, x2, y2)` 是通过选择所有满足 `x1 <= x <= x2` 且 `y1 <= y <= y2` 的
`grid[x][y]` 元素组成的矩阵。



**示例 1：**

**输入：** grid = [[4,3,2,1],[8,7,6,1]], k = 3

**输出：** 8

**解释：**

**![](https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/3300-3399/3359.Find%20Sorted%20Submatrices%20With%20Maximum%20Element%20at%20Most%20K/images/mine.png)**

8 个子矩阵分别是：

  * `[[1]]`
  * `[[1]]`
  * `[[2,1]]`
  * `[[3,2,1]]`
  * `[[1],[1]]`
  * `[[2]]`
  * `[[3]]`
  * `[[3,2]]`

**示例 2：**

**输入：** grid = [[1,1,1],[1,1,1],[1,1,1]], k = 1

**输出：** 36

**解释：**

矩阵中有 36 个子矩阵。所有子矩阵的最大元素都等于 1。

**示例 3：**

**输入：** grid = [[1]], k = 1

**输出：** 1



**提示：**

  * `1 <= m == grid.length <= 10^3`
  * `1 <= n == grid[i].length <= 10^3`
  * `1 <= grid[i][j] <= 10^9`
  * `1 <= k <= 10^9`



​​​​​​


## 解题思路

#### 复杂度分析

- **时间复杂度**：`O()`，
- **空间复杂度**：`O()`，

## 代码

```javascript

```

## 相关题目

<!-- prettier-ignore -->
| 题号 | 标题 | 题解 | 标签 | 难度 | 力扣 |
| :------: | :------ | :------: | :------ | :------: | :------: |
| 85 | 最大矩形 | [[✓]](/problem/0085.md) |  [`栈`](/tag/stack.md) [`数组`](/tag/array.md) [`动态规划`](/tag/dynamic-programming.md) `2+` | 🔴 | [🀄️](https://leetcode.cn/problems/maximal-rectangle) [🔗](https://leetcode.com/problems/maximal-rectangle) |