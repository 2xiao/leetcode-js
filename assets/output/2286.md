# [2286. ä»¥ç»„ä¸ºå•ä½è®¢éŸ³ä¹ä¼šçš„é—¨ç¥¨](https://leetcode.com/problems/booking-concert-tickets-in-groups)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`è®¾è®¡`](/leetcode/outline/tag/design.md) [`æ ‘çŠ¶æ•°ç»„`](/leetcode/outline/tag/binary-indexed-tree.md) [`çº¿æ®µæ ‘`](/leetcode/outline/tag/segment-tree.md) [`äºŒåˆ†æŸ¥æ‰¾`](/leetcode/outline/tag/binary-search.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/booking-concert-tickets-in-groups)


## é¢˜ç›®

A concert hall has `n` rows numbered from `0` to `n - 1`, each with `m` seats,
numbered from `0` to `m - 1`. You need to design a ticketing system that can
allocate seats in the following cases:

  * If a group of `k` spectators can sit **together** in a row.
  * If **every** member of a group of `k` spectators can get a seat. They may or **may not** sit together.

Note that the spectators are very picky. Hence:

  * They will book seats only if each member of their group can get a seat with row number **less than or equal** to `maxRow`. `maxRow` can **vary** from group to group.
  * In case there are multiple rows to choose from, the row with the **smallest** number is chosen. If there are multiple seats to choose in the same row, the seat with the **smallest** number is chosen.

Implement the `BookMyShow` class:

  * `BookMyShow(int n, int m)` Initializes the object with `n` as number of rows and `m` as number of seats per row.
  * `int[] gather(int k, int maxRow)` Returns an array of length `2` denoting the row and seat number (respectively) of the **first seat** being allocated to the `k` members of the group, who must sit **together**. In other words, it returns the smallest possible `r` and `c` such that all `[c, c + k - 1]` seats are valid and empty in row `r`, and `r <= maxRow`. Returns `[]` in case it is **not possible** to allocate seats to the group.
  * `boolean scatter(int k, int maxRow)` Returns `true` if all `k` members of the group can be allocated seats in rows `0` to `maxRow`, who may or **may not** sit together. If the seats can be allocated, it allocates `k` seats to the group with the **smallest** row numbers, and the smallest possible seat numbers in each row. Otherwise, returns `false`.



**Example 1:**

> 
> 
> 
> 
> 
> **Input**
> 
> ["BookMyShow", "gather", "gather", "scatter", "scatter"]
> 
> [[2, 5], [4, 0], [2, 0], [5, 1], [5, 1]]
> 
> **Output**
> 
> [null, [0, 0], [], true, false]
> 
> 
> 
> **Explanation**
> 
> BookMyShow bms = new BookMyShow(2, 5); // There are 2 rows with 5 seats each 
> 
> bms.gather(4, 0); // return [0, 0]
> 
> > 
> > 
> > 
> > 
>   // The group books seats [0, 3] of row 0. 
> 
> bms.gather(2, 0); // return []
> 
> > 
> > 
> > 
> > 
>   // There is only 1 seat left in row 0,
> 
> > 
> > 
> > 
> > 
>   // so it is not possible to book 2 consecutive seats. 
> 
> bms.scatter(5, 1); // return True
> 
> > 
> > 
> > 
> > 
>    // The group books seat 4 of row 0 and seats [0, 3] of row 1. 
> 
> bms.scatter(5, 1); // return False
> 
> > 
> > 
> > 
> > 
>    // There is only one seat left in the hall.

**Constraints:**

  * `1 <= n <= 5 * 10^4`
  * `1 <= m, k <= 10^9`
  * `0 <= maxRow <= n - 1`
  * At most `5 * 10^4` calls **in total** will be made to `gather` and `scatter`.


## é¢˜ç›®å¤§æ„

ä¸€ä¸ªéŸ³ä¹ä¼šæ€»å…±æœ‰ `n` æ’åº§ä½ï¼Œç¼–å·ä» `0` åˆ° `n - 1` ï¼Œæ¯ä¸€æ’æœ‰ `m` ä¸ªåº§æ¤…ï¼Œç¼–å·ä¸º `0` åˆ° `m - 1`
ã€‚ä½ éœ€è¦è®¾è®¡ä¸€ä¸ªä¹°ç¥¨ç³»ç»Ÿï¼Œé’ˆå¯¹ä»¥ä¸‹æƒ…å†µè¿›è¡Œåº§ä½å®‰æ’ï¼š

  * åŒä¸€ç»„çš„ `k` ä½è§‚ä¼—ååœ¨**åŒä¸€æ’åº§ä½ï¼Œä¸”åº§ä½è¿ç»­** ã€‚
  * `k` ä½è§‚ä¼—ä¸­ **æ¯ä¸€ä½**  éƒ½æœ‰åº§ä½åï¼Œä½†ä»–ä»¬ **ä¸ä¸€å®š**  ååœ¨ä¸€èµ·ã€‚

ç”±äºè§‚ä¼—éå¸¸æŒ‘å‰”ï¼Œæ‰€ä»¥ï¼š

  * åªæœ‰å½“ä¸€ä¸ªç»„é‡Œæ‰€æœ‰æˆå‘˜åº§ä½çš„æ’æ•°éƒ½ **å°äºç­‰äº**  `maxRow` ï¼Œè¿™ä¸ªç»„æ‰èƒ½è®¢åº§ä½ã€‚æ¯ä¸€ç»„çš„ `maxRow` å¯èƒ½ **ä¸åŒ**  ã€‚
  * å¦‚æœæœ‰å¤šæ’åº§ä½å¯ä»¥é€‰æ‹©ï¼Œä¼˜å…ˆé€‰æ‹© **æœ€å°**  çš„æ’æ•°ã€‚å¦‚æœåŒä¸€æ’ä¸­æœ‰å¤šä¸ªåº§ä½å¯ä»¥åï¼Œä¼˜å…ˆé€‰æ‹©å·ç  **æœ€å°**  çš„ã€‚

è¯·ä½ å®ç° `BookMyShow` ç±»ï¼š

  * `BookMyShow(int n, int m)` ï¼Œåˆå§‹åŒ–å¯¹è±¡ï¼Œ`n` æ˜¯æ’æ•°ï¼Œ`m` æ˜¯æ¯ä¸€æ’çš„åº§ä½æ•°ã€‚
  * `int[] gather(int k, int maxRow)` è¿”å›é•¿åº¦ä¸º `2` çš„æ•°ç»„ï¼Œè¡¨ç¤º `k` ä¸ªæˆå‘˜ä¸­ **ç¬¬ä¸€ä¸ªåº§ä½**  çš„æ’æ•°å’Œåº§ä½ç¼–å·ï¼Œè¿™ `k` ä½æˆå‘˜å¿…é¡»ååœ¨ **åŒä¸€æ’åº§ä½ï¼Œä¸”åº§ä½è¿ç»­** ã€‚æ¢è¨€ä¹‹ï¼Œè¿”å›æœ€å°å¯èƒ½çš„ `r` å’Œ `c` æ»¡è¶³ç¬¬ `r` æ’ä¸­ `[c, c + k - 1]` çš„åº§ä½éƒ½æ˜¯ç©ºçš„ï¼Œä¸” `r <= maxRow` ã€‚å¦‚æœ **æ— æ³•**  å®‰æ’åº§ä½ï¼Œè¿”å› `[]` ã€‚
  * `boolean scatter(int k, int maxRow)` å¦‚æœç»„é‡Œæ‰€æœ‰ `k` ä¸ªæˆå‘˜ **ä¸ä¸€å®š**  è¦ååœ¨ä¸€èµ·çš„å‰æä¸‹ï¼Œéƒ½èƒ½åœ¨ç¬¬ `0` æ’åˆ°ç¬¬ `maxRow` æ’ä¹‹é—´æ‰¾åˆ°åº§ä½ï¼Œé‚£ä¹ˆè¯·è¿”å› `true` ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæ¯ä¸ªæˆå‘˜éƒ½ä¼˜å…ˆæ‰¾æ’æ•° **æœ€å°**  ï¼Œç„¶åæ˜¯åº§ä½ç¼–å·æœ€å°çš„åº§ä½ã€‚å¦‚æœä¸èƒ½å®‰æ’æ‰€æœ‰ `k` ä¸ªæˆå‘˜çš„åº§ä½ï¼Œè¯·è¿”å› `false` ã€‚



**ç¤ºä¾‹ 1ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š**
> 
> ["BookMyShow", "gather", "gather", "scatter", "scatter"]
> 
> [[2, 5], [4, 0], [2, 0], [5, 1], [5, 1]]
> 
> **è¾“å‡ºï¼š**
> 
> [null, [0, 0], [], true, false]
> 
> 
> 
> **è§£é‡Šï¼š**
> 
> BookMyShow bms = new BookMyShow(2, 5); // æ€»å…±æœ‰ 2 æ’ï¼Œæ¯æ’ 5 ä¸ªåº§ä½ã€‚
> 
> bms.gather(4, 0); // è¿”å› [0, 0]
> 
> > 
> > 
> > 
> > 
>   // è¿™ä¸€ç»„å®‰æ’ç¬¬ 0 æ’ [0, 3] çš„åº§ä½ã€‚
> 
> bms.gather(2, 0); // è¿”å› []
> 
> > 
> > 
> > 
> > 
>   // ç¬¬ 0 æ’åªå‰©ä¸‹ 1 ä¸ªåº§ä½ã€‚
> 
> > 
> > 
> > 
> > 
>   // æ‰€ä»¥æ— æ³•å®‰æ’ 2 ä¸ªè¿ç»­åº§ä½ã€‚
> 
> bms.scatter(5, 1); // è¿”å› True
> 
> > 
> > 
> > 
> > 
>    // è¿™ä¸€ç»„å®‰æ’ç¬¬ 0 æ’ç¬¬ 4 ä¸ªåº§ä½å’Œç¬¬ 1 æ’ [0, 3] çš„åº§ä½ã€‚
> 
> bms.scatter(5, 1); // è¿”å› False
> 
> > 
> > 
> > 
> > 
>    // æ€»å…±åªå‰©ä¸‹ 1 ä¸ªåº§ä½ã€‚
> 
> 



**æç¤ºï¼š**

  * `1 <= n <= 5 * 10^4`
  * `1 <= m, k <= 10^9`
  * `0 <= maxRow <= n - 1`
  * `gather` å’Œ `scatter` **æ€»** è°ƒç”¨æ¬¡æ•°ä¸è¶…è¿‡ `5 * 10^4` æ¬¡ã€‚


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

:::: md-demo ç›¸å…³é¢˜ç›®
- [1386. å®‰æ’ç”µå½±é™¢åº§ä½](https://leetcode.com/problems/cinema-seat-allocation)
- [2407. æœ€é•¿é€’å¢å­åºåˆ— II](https://leetcode.com/problems/longest-increasing-subsequence-ii)

::::
