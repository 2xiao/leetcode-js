# [3055. æœ€é«˜æ¬ºè¯ˆç™¾åˆ†ä½æ•°](https://leetcode.com/problems/top-percentile-fraud)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/top-percentile-fraud)

## é¢˜ç›®

Table: `Fraud`

> 
> 
> 
> 
> 
> +-------------+---------+
> 
> | Column Name | Type> 
> |
> 
> +-------------+---------+
> 
> | policy_id   | int> 
>  |
> 
> | state> 
>    | varchar |
> 
> | fraud_score | int> 
>  |
> 
> +-------------+---------+
> 
> policy_id is column of unique values for this table.
> 
> This table contains policy id, state, and fraud score.
> 
> 

The Leetcode Insurance Corp has developed an ML-driven **predictive model** to
detect the **likelihood** of fraudulent claims. Consequently, they allocate
their most seasoned claim adjusters to address the top `5%` of **claims**
**flagged** by this model.

Write a solution to find the top `5` **percentile** of claims from **each
state**.

Return _the result table ordered by_`state` _in**ascending** order,
_`fraud_score` _in**descending** order, and _`policy_id` _in**ascending**
order._

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Fraud table:
> 
> +-----------+------------+-------------+
> 
> | policy_id | state> 
>   | fraud_score | 
> 
> +-----------+------------+-------------+
> 
> | 1> 
> > 
>  | California | 0.92> 
> > 
> | 
> 
> | 2> 
> > 
>  | California | 0.68> 
> > 
> |   
> 
> | 3> 
> > 
>  | California | 0.17> 
> > 
> | 
> 
> | 4> 
> > 
>  | New York   | 0.94> 
> > 
> | 
> 
> | 5> 
> > 
>  | New York   | 0.81> 
> > 
> | 
> 
> | 6> 
> > 
>  | New York   | 0.77> 
> > 
> |  
> 
> | 7> 
> > 
>  | Texas> 
>   | 0.98> 
> > 
> |  
> 
> | 8> 
> > 
>  | Texas> 
>   | 0.97> 
> > 
> | 
> 
> | 9> 
> > 
>  | Texas> 
>   | 0.96> 
> > 
> | 
> 
> | 10> 
> > 
> | Florida> 
> | 0.97> 
> > 
> |  
> 
> | 11> 
> > 
> | Florida> 
> | 0.98> 
> > 
> | 
> 
> | 12> 
> > 
> | Florida> 
> | 0.78> 
> > 
> | 
> 
> | 13> 
> > 
> | Florida> 
> | 0.88> 
> > 
> | 
> 
> | 14> 
> > 
> | Florida> 
> | 0.66> 
> > 
> | 
> 
> +-----------+------------+-------------+
> 
> Output: 
> 
> +-----------+------------+-------------+
> 
> | policy_id | state> 
>   | fraud_score |
> 
> +-----------+------------+-------------+
> 
> | 1> 
> > 
>  | California | 0.92> 
> > 
> | 
> 
> | 11> 
> > 
> | Florida> 
> | 0.98> 
> > 
> | 
> 
> | 4> 
> > 
>  | New York   | 0.94> 
> > 
> | 
> 
> | 7> 
> > 
>  | Texas> 
>   | 0.98> 
> > 
> |  
> 
> +-----------+------------+-------------+
> 
> **Explanation**
> - For the state of California, only policy ID 1, with a fraud score of 0.92, falls within the top 5 percentile for this state.
> - For the state of Florida, only policy ID 11, with a fraud score of 0.98, falls within the top 5 percentile for this state. 
> - For the state of New York, only policy ID 4, with a fraud score of 0.94, falls within the top 5 percentile for this state. 
> - For the state of Texas, only policy ID 7, with a fraud score of 0.98, falls within the top 5 percentile for this state. 
> 
> Output table is ordered by state in ascending order, fraud score in descending order, and policy ID in ascending order.
> 
> 


## é¢˜ç›®å¤§æ„

è¡¨ï¼š`Fraud`

> 
> 
> 
> 
> 
> +-------------+---------+
> 
> | Column Name | Type> 
> |
> 
> +-------------+---------+
> 
> | policy_id   | int> 
>  |
> 
> | state> 
>    | varchar |
> 
> | fraud_score | int> 
>  |
> 
> +-------------+---------+
> 
> policy_id æ˜¯è¿™å¼ è¡¨ä¸­å…·æœ‰ä¸åŒå€¼çš„åˆ—ã€‚
> 
> è¿™å¼ è¡¨åŒ…å« policy idï¼Œstate å’Œ fraud scoreã€‚
> 
> 

Leetcode ä¿é™©å…¬å¸å¼€å‘äº†ä¸€ä¸ª ML é©±åŠ¨çš„ **é¢„æµ‹æ¨¡å‹** æ¥æ£€æµ‹æ¬ºè¯ˆç´¢èµ”çš„ **å¯èƒ½æ€§** ã€‚å› æ­¤ï¼Œä»–ä»¬åˆ†é…äº†ç»éªŒæœ€ä¸°å¯Œçš„ç†èµ”å‘˜æ¥å¤„ç†å‰
`5%` **è¢«æ ‡è®°** çš„ç´¢èµ”ã€‚

ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ¥æ‰¾å‡º **æ¯ä¸ªå·** ç´¢èµ”çš„å‰ `5` **ç™¾åˆ†ä½æ•°** ã€‚

è¿”å›ç»“æœè¡¨ï¼Œä»¥ `state` **å‡åº  **æ’åºï¼Œ`fraud_score` **é™åº** æ’åºï¼Œ`policy_id` **å‡åº** æ’åºã€‚

ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š**
> 
> Fraud è¡¨ï¼š
> 
> +-----------+------------+-------------+
> 
> | policy_id | state> 
>   | fraud_score | 
> 
> +-----------+------------+-------------+
> 
> | 1> 
> > 
>  | California | 0.92> 
> > 
> | 
> 
> | 2> 
> > 
>  | California | 0.68> 
> > 
> |   
> 
> | 3> 
> > 
>  | California | 0.17> 
> > 
> | 
> 
> | 4> 
> > 
>  | New York   | 0.94> 
> > 
> | 
> 
> | 5> 
> > 
>  | New York   | 0.81> 
> > 
> | 
> 
> | 6> 
> > 
>  | New York   | 0.77> 
> > 
> |  
> 
> | 7> 
> > 
>  | Texas> 
>   | 0.98> 
> > 
> |  
> 
> | 8> 
> > 
>  | Texas> 
>   | 0.97> 
> > 
> | 
> 
> | 9> 
> > 
>  | Texas> 
>   | 0.96> 
> > 
> | 
> 
> | 10> 
> > 
> | Florida> 
> | 0.97> 
> > 
> |  
> 
> | 11> 
> > 
> | Florida> 
> | 0.98> 
> > 
> | 
> 
> | 12> 
> > 
> | Florida> 
> | 0.78> 
> > 
> | 
> 
> | 13> 
> > 
> | Florida> 
> | 0.88> 
> > 
> | 
> 
> | 14> 
> > 
> | Florida> 
> | 0.66> 
> > 
> | 
> 
> +-----------+------------+-------------+
> 
> **è¾“å‡ºï¼š** 
> 
> +-----------+------------+-------------+
> 
> | policy_id | state> 
>   | fraud_score |
> 
> +-----------+------------+-------------+
> 
> | 1> 
> > 
>  | California | 0.92> 
> > 
> | 
> 
> | 11> 
> > 
> | Florida> 
> | 0.98> 
> > 
> | 
> 
> | 4> 
> > 
>  | New York   | 0.94> 
> > 
> | 
> 
> | 7> 
> > 
>  | Texas> 
>   | 0.98> 
> > 
> |  
> 
> +-----------+------------+-------------+
> 
> **è§£é‡Šï¼š**
> - å¯¹äº California å·ï¼Œåªæœ‰ ID ä¸º 1 çš„ä¿å•çš„æ¬ºè¯ˆåˆ†æ•°ä¸º 0.92ï¼Œå±äºè¯¥å·çš„å‰ 5%ã€‚
> - å¯¹äº Florida å·ï¼Œåªæœ‰ ID ä¸º 11 çš„ä¿å•çš„æ¬ºè¯ˆåˆ†æ•°ä¸º 0.98ï¼Œå±äºè¯¥å·çš„å‰ 5%ã€‚
> - å¯¹äº New York å·ï¼Œåªæœ‰ ID ä¸º 4 çš„ä¿å•çš„æ¬ºè¯ˆåˆ†æ•°ä¸º 0.94ï¼Œå±äºè¯¥å·çš„å‰ 5%ã€‚
> - å¯¹äº Texas å·ï¼Œåªæœ‰ ID ä¸º 7 çš„ä¿å•çš„æ¬ºè¯ˆåˆ†æ•°ä¸º 0.98ï¼Œå±äºè¯¥å·çš„å‰ 5%ã€‚
> 
> è¾“å‡ºè¡¨ä»¥ state å‡åºæ’åºï¼Œfraud_score é™åºæ’åºï¼Œpolicy_id å‡åºæ’åºã€‚
> 
> 


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```