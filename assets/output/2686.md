# [2686. å³æ—¶é£Ÿç‰©é…é€ III](https://leetcode.com/problems/immediate-food-delivery-iii)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/immediate-food-delivery-iii)

## é¢˜ç›®

Table: `Delivery`

> 
> 
> 
> 
> 
> +-----------------------------+---------+
> 
> | Column Name> 
> > 
> > 
> > 
>  | Type> 
> |
> 
> +-----------------------------+---------+
> 
> | delivery_id> 
> > 
> > 
> > 
>  | int> 
>  |
> 
> | customer_id> 
> > 
> > 
> > 
>  | int> 
>  |
> 
> | order_date> 
> > 
> > 
> > 
>   | date> 
> |
> 
> | customer_pref_delivery_date | date> 
> |
> 
> +-----------------------------+---------+
> 
> delivery_id is the column with unique values of this table.
> 
> Each row contains information about food delivery to a customer that makes an order at some date and specifies a preferred delivery date (on the order date or after it).
> 
> 

If the customer's preferred delivery date is the same as the order date, then
the order is called **immediate,**  otherwise, it is **scheduled**.

Write a solution to find the percentage of immediate orders on each unique
`order_date`, **rounded to 2 decimal places**.

Return _the result table ordered by_ `order_date` _in**ascending** order._

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Delivery table:
> 
> +-------------+-------------+------------+-----------------------------+
> 
> | delivery_id | customer_id | order_date | customer_pref_delivery_date |
> 
> +-------------+-------------+------------+-----------------------------+
> 
> | 1> 
> > 
>    | 1> 
> > 
>    | 2019-08-01 | 2019-08-02> 
> > 
> > 
> > 
>   |
> 
> | 2> 
> > 
>    | 2> 
> > 
>    | 2019-08-01 | 2019-08-01> 
> > 
> > 
> > 
>   |
> 
> | 3> 
> > 
>    | 1> 
> > 
>    | 2019-08-01 | 2019-08-01> 
> > 
> > 
> > 
>   |
> 
> | 4> 
> > 
>    | 3> 
> > 
>    | 2019-08-02 | 2019-08-13> 
> > 
> > 
> > 
>   |
> 
> | 5> 
> > 
>    | 3> 
> > 
>    | 2019-08-02 | 2019-08-02> 
> > 
> > 
> > 
>   |
> 
> | 6> 
> > 
>    | 2> 
> > 
>    | 2019-08-02 | 2019-08-02> 
> > 
> > 
> > 
>   |
> 
> | 7> 
> > 
>    | 4> 
> > 
>    | 2019-08-03 | 2019-08-03> 
> > 
> > 
> > 
>   |
> 
> | 8> 
> > 
>    | 1> 
> > 
>    | 2019-08-03 | 2019-08-03> 
> > 
> > 
> > 
>   |
> 
> | 9> 
> > 
>    | 5> 
> > 
>    | 2019-08-04 | 2019-08-08> 
> > 
> > 
> > 
>   |
> 
> | 10> 
> > 
>   | 2> 
> > 
>    | 2019-08-04 | 2019-08-18> 
> > 
> > 
> > 
>   |
> 
> +-------------+-------------+------------+-----------------------------+
> 
> Output: 
> 
> +------------+----------------------+
> 
> | order_date | immediate_percentage |
> 
> +------------+----------------------+
> 
> | 2019-08-01 | 66.67> 
> > 
> > 
> > 
> |
> 
> | 2019-08-02 | 66.67> 
> > 
> > 
> > 
> |
> 
> | 2019-08-03 | 100.00> 
> > 
> > 
>    |
> 
> | 2019-08-04 | 0.00> 
> > 
> > 
> > 
>  |
> 
> +------------+----------------------+
> 
> Explanation: 
> - On 2019-08-01 there were three orders, out of those, two were immediate and one was scheduled. So, immediate percentage for that date was 66.67.
> - On 2019-08-02 there were three orders, out of those, two were immediate and one was scheduled. So, immediate percentage for that date was 66.67.
> - On 2019-08-03 there were two orders, both were immediate. So, the immediate percentage for that date was 100.00.
> - On 2019-08-04 there were two orders, both were scheduled. So, the immediate percentage for that date was 0.00.
> 
> order_date is sorted in ascending order.
> 
> 


## é¢˜ç›®å¤§æ„

`Delivery` è¡¨ï¼š

> 
> 
> 
> 
> 
> +-----------------------------+---------+
> 
> | å­—æ®µå> 
> > 
> > 
> > 
> > 
>    | ç±»å‹   |
> 
> +-----------------------------+---------+
> 
> | delivery_id> 
> > 
> > 
> > 
>  | int> 
>  |
> 
> | customer_id> 
> > 
> > 
> > 
>  | int> 
>  |
> 
> | order_date> 
> > 
> > 
> > 
>   | date> 
> |
> 
> | customer_pref_delivery_date | date> 
> |
> 
> +-----------------------------+---------+
> 
> delivery_id æ˜¯è¯¥è¡¨çš„å…·æœ‰å”¯ä¸€å€¼çš„åˆ—ã€‚
> 
> æ¯ä¸€è¡ŒåŒ…å«æœ‰å…³å‘é¡¾å®¢äº¤ä»˜é£Ÿç‰©çš„ä¿¡æ¯ï¼Œé¡¾å®¢åœ¨æŸä¸ªæ—¥æœŸä¸‹è®¢å•ï¼Œå¹¶æŒ‡å®šäº†ä¸€ä¸ªé¦–é€‰äº¤ä»˜æ—¥æœŸï¼ˆåœ¨è®¢å•æ—¥æœŸå½“å¤©æˆ–ä¹‹åï¼‰ã€‚
> 
> 



å¦‚æœé¡¾å®¢çš„é¦–é€‰äº¤ä»˜æ—¥æœŸä¸è®¢å•æ—¥æœŸç›¸åŒï¼Œåˆ™è¯¥è®¢å•ç§°ä¸º **ç«‹å³äº¤ä»˜**  ï¼Œå¦åˆ™ç§°ä¸º **è®¡åˆ’äº¤ä»˜**  ã€‚

ç¼–å†™è§£å†³æ–¹æ¡ˆï¼Œæ‰¾å‡ºæ¯ä¸ªå”¯ä¸€çš„ `order_date` ä¸­ç«‹å³äº¤ä»˜è®¢å•çš„ç™¾åˆ†æ¯”ã€‚**ç»“æœä¿ç•™ä¸¤ä½å°æ•°** ã€‚

è¿”å›æŸ¥è¯¢ç»“æœå¹¶æŒ‰ `order_date` **å‡åº** æ’åºã€‚

æŸ¥è¯¢ç»“æœçš„æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š**
> 
> Delivery è¡¨:
> 
> +-------------+-------------+------------+-----------------------------+
> 
> | delivery_id | customer_id | order_date | customer_pref_delivery_date |
> 
> +-------------+-------------+------------+-----------------------------+
> 
> | 1> 
> > 
>    | 1> 
> > 
>    | 2019-08-01 | 2019-08-02> 
> > 
> > 
> > 
>   |
> 
> | 2> 
> > 
>    | 2> 
> > 
>    | 2019-08-01 | 2019-08-01> 
> > 
> > 
> > 
>   |
> 
> | 3> 
> > 
>    | 1> 
> > 
>    | 2019-08-01 | 2019-08-01> 
> > 
> > 
> > 
>   |
> 
> | 4> 
> > 
>    | 3> 
> > 
>    | 2019-08-02 | 2019-08-13> 
> > 
> > 
> > 
>   |
> 
> | 5> 
> > 
>    | 3> 
> > 
>    | 2019-08-02 | 2019-08-02> 
> > 
> > 
> > 
>   |
> 
> | 6> 
> > 
>    | 2> 
> > 
>    | 2019-08-02 | 2019-08-02> 
> > 
> > 
> > 
>   |
> 
> | 7> 
> > 
>    | 4> 
> > 
>    | 2019-08-03 | 2019-08-03> 
> > 
> > 
> > 
>   |
> 
> | 8> 
> > 
>    | 1> 
> > 
>    | 2019-08-03 | 2019-08-03> 
> > 
> > 
> > 
>   |
> 
> | 9> 
> > 
>    | 5> 
> > 
>    | 2019-08-04 | 2019-08-08> 
> > 
> > 
> > 
>   |
> 
> | 10> 
> > 
>   | 2> 
> > 
>    | 2019-08-04 | 2019-08-18> 
> > 
> > 
> > 
>   |
> 
> +-------------+-------------+------------+-----------------------------+
> 
> **è¾“å‡ºï¼š**
> 
> +------------+----------------------+
> 
> | order_date | immediate_percentage |
> 
> +------------+----------------------+
> 
> | 2019-08-01 | 66.67> 
> > 
> > 
> > 
> |
> 
> | 2019-08-02 | 66.67> 
> > 
> > 
> > 
> |
> 
> | 2019-08-03 | 100.00> 
> > 
> > 
>    |
> 
> | 2019-08-04 | 0.00> 
> > 
> > 
> > 
>  |
> 
> +------------+----------------------+
> 
> **è§£é‡Šï¼š**
> 
> â€“ 2019å¹´8æœˆ1æ—¥å…±æœ‰3ä¸ªè®¢å•ï¼Œå…¶ä¸­2ä¸ªæ˜¯å³æ—¶è®¢å•ï¼Œ1ä¸ªæ˜¯é¢„å®šè®¢å•ã€‚å› æ­¤ï¼Œè¯¥æ—¥æœŸçš„å³æ—¶è®¢å•ç™¾åˆ†æ¯”ä¸º66.67ã€‚
> 
> â€“ 2019å¹´8æœˆ2æ—¥å…±æœ‰3ä¸ªè®¢å•ï¼Œå…¶ä¸­2ä¸ªæ˜¯å³æ—¶è®¢å•ï¼Œ1ä¸ªæ˜¯é¢„å®šè®¢å•ã€‚å› æ­¤ï¼Œè¯¥æ—¥æœŸçš„å³æ—¶è®¢å•ç™¾åˆ†æ¯”ä¸º66.67ã€‚
> 
> â€“ 2019å¹´8æœˆ3æ—¥å…±æœ‰2ä¸ªè®¢å•ï¼Œå‡ä¸ºå³æ—¶è®¢å•ã€‚å› æ­¤ï¼Œè¯¥æ—¥æœŸçš„å³æ—¶è®¢å•ç™¾åˆ†æ¯”ä¸º100.00ã€‚
> 
> â€“ 2019å¹´8æœˆ4æ—¥å…±æœ‰2ä¸ªè®¢å•ï¼Œå‡ä¸ºé¢„å®šè®¢å•ã€‚å› æ­¤ï¼Œè¯¥æ—¥æœŸçš„å³æ—¶è®¢å•ç™¾åˆ†æ¯”ä¸º0.00ã€‚
> 
> order_dste æŒ‰å‡åºæ’åºã€‚


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```