---
title: 1532. æœ€è¿‘çš„ä¸‰ç¬”è®¢å• ğŸ”’
description: LeetCode,1532. æœ€è¿‘çš„ä¸‰ç¬”è®¢å• ğŸ”’,æœ€è¿‘çš„ä¸‰ç¬”è®¢å•,The Most Recent Three Orders,è§£é¢˜æ€è·¯,æ•°æ®åº“
keywords:
  - LeetCode
  - 1532. æœ€è¿‘çš„ä¸‰ç¬”è®¢å• ğŸ”’
  - æœ€è¿‘çš„ä¸‰ç¬”è®¢å•
  - The Most Recent Three Orders
  - è§£é¢˜æ€è·¯
  - æ•°æ®åº“
---

# 1532. æœ€è¿‘çš„ä¸‰ç¬”è®¢å• ğŸ”’

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/the-most-recent-three-orders) [`LeetCode`](https://leetcode.com/problems/the-most-recent-three-orders)

## é¢˜ç›®

Table: `Customers`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | customer_id   | int> 
>  |
> 
> | name> 
> > 
>   | varchar |
> 
> +---------------+---------+
> 
> customer_id is the column with unique values for this table.
> 
> This table contains information about customers.
> 
> 



Table: `Orders`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | order_id> 
>   | int> 
>  |
> 
> | order_date> 
> | date> 
> |
> 
> | customer_id   | int> 
>  |
> 
> | cost> 
> > 
>   | int> 
>  |
> 
> +---------------+---------+
> 
> order_id is the column with unique values for this table.
> 
> This table contains information about the orders made by customer_id.
> 
> Each customer has **one order per day**.
> 
> 



Write a solution to find the most recent three orders of each user. If a user
ordered less than three orders, return all of their orders.

Return the result table ordered by `customer_name` in **ascending order** and
in case of a tie by the `customer_id` in **ascending order**. If there is
still a tie, order them by `order_date` in **descending order**.

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Customers table:
> 
> +-------------+-----------+
> 
> | customer_id | name> 
>   |
> 
> +-------------+-----------+
> 
> | 1> 
> > 
>    | Winston   |
> 
> | 2> 
> > 
>    | Jonathan  |
> 
> | 3> 
> > 
>    | Annabelle |
> 
> | 4> 
> > 
>    | Marwan> 
> |
> 
> | 5> 
> > 
>    | Khaled> 
> |
> 
> +-------------+-----------+
> 
> Orders table:
> 
> +----------+------------+-------------+------+
> 
> | order_id | order_date | customer_id | cost |
> 
> +----------+------------+-------------+------+
> 
> | 1> 
> > 
> | 2020-07-31 | 1> 
> > 
>    | 30   |
> 
> | 2> 
> > 
> | 2020-07-30 | 2> 
> > 
>    | 40   |
> 
> | 3> 
> > 
> | 2020-07-31 | 3> 
> > 
>    | 70   |
> 
> | 4> 
> > 
> | 2020-07-29 | 4> 
> > 
>    | 100  |
> 
> | 5> 
> > 
> | 2020-06-10 | 1> 
> > 
>    | 1010 |
> 
> | 6> 
> > 
> | 2020-08-01 | 2> 
> > 
>    | 102  |
> 
> | 7> 
> > 
> | 2020-08-01 | 3> 
> > 
>    | 111  |
> 
> | 8> 
> > 
> | 2020-08-03 | 1> 
> > 
>    | 99   |
> 
> | 9> 
> > 
> | 2020-08-07 | 2> 
> > 
>    | 32   |
> 
> | 10> 
>    | 2020-07-15 | 1> 
> > 
>    | 2> 
> |
> 
> +----------+------------+-------------+------+
> 
> Output: 
> 
> +---------------+-------------+----------+------------+
> 
> | customer_name | customer_id | order_id | order_date |
> 
> +---------------+-------------+----------+------------+
> 
> | Annabelle> 
>  | 3> 
> > 
>    | 7> 
> > 
> | 2020-08-01 |
> 
> | Annabelle> 
>  | 3> 
> > 
>    | 3> 
> > 
> | 2020-07-31 |
> 
> | Jonathan> 
>   | 2> 
> > 
>    | 9> 
> > 
> | 2020-08-07 |
> 
> | Jonathan> 
>   | 2> 
> > 
>    | 6> 
> > 
> | 2020-08-01 |
> 
> | Jonathan> 
>   | 2> 
> > 
>    | 2> 
> > 
> | 2020-07-30 |
> 
> | Marwan> 
> > 
> | 4> 
> > 
>    | 4> 
> > 
> | 2020-07-29 |
> 
> | Winston> 
>    | 1> 
> > 
>    | 8> 
> > 
> | 2020-08-03 |
> 
> | Winston> 
>    | 1> 
> > 
>    | 1> 
> > 
> | 2020-07-31 |
> 
> | Winston> 
>    | 1> 
> > 
>    | 10> 
>    | 2020-07-15 |
> 
> +---------------+-------------+----------+------------+
> 
> Explanation: 
> 
> Winston has 4 orders, we discard the order of "2020-06-10" because it is the oldest order.
> 
> Annabelle has only 2 orders, we return them.
> 
> Jonathan has exactly 3 orders.
> 
> Marwan ordered only one time.
> 
> We sort the result table by customer_name in ascending order, by customer_id in ascending order, and by order_date in descending order in case of a tie.
> 
> 



**Follow up:** Could you write a general solution for the most recent `n`
orders?


## é¢˜ç›®å¤§æ„

è¡¨ï¼š`Customers`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | customer_id   | int> 
>  |
> 
> | name> 
> > 
>   | varchar |
> 
> +---------------+---------+
> 
> customer_id æ˜¯è¯¥è¡¨å…·æœ‰å”¯ä¸€å€¼çš„åˆ—
> 
> è¯¥è¡¨åŒ…å«æ¶ˆè´¹è€…çš„ä¿¡æ¯
> 
> 



è¡¨ï¼š`Orders`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | order_id> 
>   | int> 
>  |
> 
> | order_date> 
> | date> 
> |
> 
> | customer_id   | int> 
>  |
> 
> | cost> 
> > 
>   | int> 
>  |
> 
> +---------------+---------+
> 
> order_id æ˜¯è¯¥è¡¨å…·æœ‰å”¯ä¸€å€¼çš„åˆ—
> 
> è¯¥è¡¨åŒ…å« id ä¸º customer_id çš„æ¶ˆè´¹è€…çš„è®¢å•ä¿¡æ¯
> 
> æ¯ä¸€ä¸ªæ¶ˆè´¹è€…**æ¯å¤©ä¸€ç¬”è®¢å•**
> 
> 



å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œæ‰¾åˆ°æ¯ä¸ªç”¨æˆ·çš„æœ€è¿‘ä¸‰ç¬”è®¢å•ã€‚å¦‚æœç”¨æˆ·çš„è®¢å•å°‘äº 3 ç¬”ï¼Œåˆ™è¿”å›ä»–çš„å…¨éƒ¨è®¢å•ã€‚

è¿”å›çš„ç»“æœæŒ‰ç…§ `customer_name` **å‡åº  **æ’åˆ—ã€‚å¦‚æœæœ‰ç›¸åŒçš„æ’åï¼Œåˆ™æŒ‰ç…§ `customer_id` **å‡åº
**æ’åˆ—ã€‚å¦‚æœæ’åè¿˜æœ‰ç›¸åŒï¼Œåˆ™æŒ‰ç…§ `order_date` **é™åº  **æ’åˆ—ã€‚

ç»“æœæ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼š



**ç¤ºä¾‹ 1:**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š**
> 
> Customers
> 
> +-------------+-----------+
> 
> | customer_id | name> 
>   |
> 
> +-------------+-----------+
> 
> | 1> 
> > 
>    | Winston   |
> 
> | 2> 
> > 
>    | Jonathan  |
> 
> | 3> 
> > 
>    | Annabelle |
> 
> | 4> 
> > 
>    | Marwan> 
> |
> 
> | 5> 
> > 
>    | Khaled> 
> |
> 
> +-------------+-----------+
> 
> 
> 
> Orders
> 
> +----------+------------+-------------+------+
> 
> | order_id | order_date | customer_id | cost |
> 
> +----------+------------+-------------+------+
> 
> | 1> 
> > 
> | 2020-07-31 | 1> 
> > 
>    | 30   |
> 
> | 2> 
> > 
> | 2020-07-30 | 2> 
> > 
>    | 40   |
> 
> | 3> 
> > 
> | 2020-07-31 | 3> 
> > 
>    | 70   |
> 
> | 4> 
> > 
> | 2020-07-29 | 4> 
> > 
>    | 100  |
> 
> | 5> 
> > 
> | 2020-06-10 | 1> 
> > 
>    | 1010 |
> 
> | 6> 
> > 
> | 2020-08-01 | 2> 
> > 
>    | 102  |
> 
> | 7> 
> > 
> | 2020-08-01 | 3> 
> > 
>    | 111  |
> 
> | 8> 
> > 
> | 2020-08-03 | 1> 
> > 
>    | 99   |
> 
> | 9> 
> > 
> | 2020-08-07 | 2> 
> > 
>    | 32   |
> 
> | 10> 
>    | 2020-07-15 | 1> 
> > 
>    | 2> 
> |
> 
> +----------+------------+-------------+------+
> 
> **è¾“å‡ºï¼š**
> 
> +---------------+-------------+----------+------------+
> 
> | customer_name | customer_id | order_id | order_date |
> 
> +---------------+-------------+----------+------------+
> 
> | Annabelle> 
>  | 3> 
> > 
>    | 7> 
> > 
> | 2020-08-01 |
> 
> | Annabelle> 
>  | 3> 
> > 
>    | 3> 
> > 
> | 2020-07-31 |
> 
> | Jonathan> 
>   | 2> 
> > 
>    | 9> 
> > 
> | 2020-08-07 |
> 
> | Jonathan> 
>   | 2> 
> > 
>    | 6> 
> > 
> | 2020-08-01 |
> 
> | Jonathan> 
>   | 2> 
> > 
>    | 2> 
> > 
> | 2020-07-30 |
> 
> | Marwan> 
> > 
> | 4> 
> > 
>    | 4> 
> > 
> | 2020-07-29 |
> 
> | Winston> 
>    | 1> 
> > 
>    | 8> 
> > 
> | 2020-08-03 |
> 
> | Winston> 
>    | 1> 
> > 
>    | 1> 
> > 
> | 2020-07-31 |
> 
> | Winston> 
>    | 1> 
> > 
>    | 10> 
>    | 2020-07-15 |
> 
> +---------------+-------------+----------+------------+
> 
> **è§£é‡Šï¼š**
> 
> Winston æœ‰ 4 ç¬”è®¢å•, æ’é™¤äº† "2020-06-10" çš„è®¢å•, å› ä¸ºå®ƒæ˜¯æœ€è€çš„è®¢å•ã€‚
> 
> Annabelle åªæœ‰ 2 ç¬”è®¢å•, å…¨éƒ¨è¿”å›ã€‚
> 
> Jonathan æ°å¥½æœ‰ 3 ç¬”è®¢å•ã€‚
> 
> Marwan åªæœ‰ 1 ç¬”è®¢å•ã€‚
> 
> ç»“æœè¡¨æˆ‘ä»¬æŒ‰ç…§ customer_name å‡åºæ’åˆ—ï¼Œcustomer_id å‡åºæ’åˆ—ï¼Œorder_date é™åºæ’åˆ—ã€‚
> 
> 



**è¿›é˜¶ï¼š**

  * ä½ èƒ½å†™å‡ºæœ€è¿‘ `n` ç¬”è®¢å•çš„é€šç”¨è§£å†³æ–¹æ¡ˆå—?


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 1549 | [æ¯ä»¶å•†å“çš„æœ€æ–°è®¢å• ğŸ”’](https://leetcode.com/problems/the-most-recent-orders-for-each-product) |  |  [`æ•°æ®åº“`](/tag/database.md) | <font color=#ffb800>Medium</font> |