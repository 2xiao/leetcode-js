---
title: 591. æ ‡ç­¾éªŒè¯å™¨
description: LeetCode,591. æ ‡ç­¾éªŒè¯å™¨,æ ‡ç­¾éªŒè¯å™¨,Tag Validator,è§£é¢˜æ€è·¯,æ ˆ,å­—ç¬¦ä¸²
keywords:
  - LeetCode
  - 591. æ ‡ç­¾éªŒè¯å™¨
  - æ ‡ç­¾éªŒè¯å™¨
  - Tag Validator
  - è§£é¢˜æ€è·¯
  - æ ˆ
  - å­—ç¬¦ä¸²
---

# 591. æ ‡ç­¾éªŒè¯å™¨

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ ˆ`](/tag/stack.md) [`å­—ç¬¦ä¸²`](/tag/string.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/tag-validator) [`LeetCode`](https://leetcode.com/problems/tag-validator)

## é¢˜ç›®

Given a string representing a code snippet, implement a tag validator to parse
the code and return whether it is valid.

A code snippet is valid if all the following rules hold:

  1. The code must be wrapped in a **valid closed tag**. Otherwise, the code is invalid.
  2. A **closed tag** (not necessarily valid) has exactly the following format : `<TAG_NAME>TAG_CONTENT</TAG_NAME>`. Among them, `<TAG_NAME>` is the start tag, and `</TAG_NAME>` is the end tag. The TAG_NAME in start and end tags should be the same. A closed tag is **valid** if and only if the TAG_NAME and TAG_CONTENT are valid.
  3. A **valid** `TAG_NAME` only contain **upper-case letters** , and has length in range [1,9]. Otherwise, the `TAG_NAME` is **invalid**.
  4. A **valid** `TAG_CONTENT` may contain other **valid closed tags** , **cdata** and any characters (see note1) **EXCEPT** unmatched `<`, unmatched start and end tag, and unmatched or closed tags with invalid TAG_NAME. Otherwise, the `TAG_CONTENT` is **invalid**.
  5. A start tag is unmatched if no end tag exists with the same TAG_NAME, and vice versa. However, you also need to consider the issue of unbalanced when tags are nested.
  6. A `<` is unmatched if you cannot find a subsequent `>`. And when you find a `<` or `</`, all the subsequent characters until the next `>` should be parsed as TAG_NAME (not necessarily valid).
  7. The cdata has the following format : `<![CDATA[CDATA_CONTENT]]>`. The range of `CDATA_CONTENT` is defined as the characters between `<![CDATA[` and the **first subsequent** `]]>`.
  8. `CDATA_CONTENT` may contain **any characters**. The function of cdata is to forbid the validator to parse `CDATA_CONTENT`, so even it has some characters that can be parsed as tag (no matter valid or invalid), you should treat it as **regular characters**.



**Example 1:**

> Input: code = "<DIV>This is the first line <![CDATA[<div>]]></DIV>"
> 
> Output: true
> 
> Explanation: 
> 
> The code is wrapped in a closed tag : <DIV> and </DIV>. 
> 
> The TAG_NAME is valid, the TAG_CONTENT consists of some characters and cdata. 
> 
> Although CDATA_CONTENT has an unmatched start tag with invalid TAG_NAME, it should be considered as plain text, not parsed as a tag.
> 
> So TAG_CONTENT is valid, and then the code is valid. Thus return true.

**Example 2:**

> Input: code = "<DIV>>>  ![cdata[]] <![CDATA[<div>]>]]>]]>>]</DIV>"
> 
> Output: true
> 
> Explanation:
> 
> We first separate the code into : start_tag|tag_content|end_tag.
> 
> start_tag -> **" <DIV>"**
> 
> end_tag -> **" </DIV>"**
> 
> tag_content could also be separated into : text1|cdata|text2.
> 
> text1 -> **" >>  ![cdata[]] "**
> 
> cdata -> **" <![CDATA[<div>]>]]>"**, where the CDATA_CONTENT is **" <div>]>"**
> 
> text2 -> **"]]>>]"**
> 
> The reason why start_tag is NOT **" <DIV>>>"** is because of the rule 6.
> 
> The reason why cdata is NOT **" <![CDATA[<div>]>]]>]]>"** is because of the rule 7.

**Example 3:**

> Input: code = "<A>  <B> </A>   </B>"
> 
> Output: false
> 
> Explanation: Unbalanced. If "<A>" is closed, then "<B>" must be unmatched, and vice versa.

**Constraints:**

  * `1 <= code.length <= 500`
  * `code` consists of English letters, digits, `'<'`, `'>'`, `'/'`, `'!'`, `'['`, `']'`, `'.'`, and `' '`.


## é¢˜ç›®å¤§æ„

ç»™å®šä¸€ä¸ªè¡¨ç¤ºä»£ç ç‰‡æ®µçš„å­—ç¬¦ä¸²ï¼Œä½ éœ€è¦å®ç°ä¸€ä¸ªéªŒè¯å™¨æ¥è§£æè¿™æ®µä»£ç ï¼Œå¹¶è¿”å›å®ƒæ˜¯å¦åˆæ³•ã€‚åˆæ³•çš„ä»£ç ç‰‡æ®µéœ€è¦éµå®ˆä»¥ä¸‹çš„æ‰€æœ‰è§„åˆ™ï¼š

  1. ä»£ç å¿…é¡»è¢«**åˆæ³•çš„é—­åˆæ ‡ç­¾** åŒ…å›´ã€‚å¦åˆ™ï¼Œä»£ç æ˜¯æ— æ•ˆçš„ã€‚
  2. **é—­åˆæ ‡ç­¾** ï¼ˆä¸ä¸€å®šåˆæ³•ï¼‰è¦ä¸¥æ ¼ç¬¦åˆæ ¼å¼ï¼š`<TAG_NAME>TAG_CONTENT</TAG_NAME>`ã€‚å…¶ä¸­ï¼Œ`<TAG_NAME>`æ˜¯èµ·å§‹æ ‡ç­¾ï¼Œ`</TAG_NAME>`æ˜¯ç»“æŸæ ‡ç­¾ã€‚èµ·å§‹å’Œç»“æŸæ ‡ç­¾ä¸­çš„ TAG_NAME åº”å½“ç›¸åŒã€‚å½“ä¸”ä»…å½“ TAG_NAME å’Œ TAG_CONTENT éƒ½æ˜¯åˆæ³•çš„ï¼Œé—­åˆæ ‡ç­¾æ‰æ˜¯**åˆæ³•çš„** ã€‚
  3. **åˆæ³•çš„**  `TAG_NAME` ä»…å«æœ‰**å¤§å†™å­—æ¯** ï¼Œé•¿åº¦åœ¨èŒƒå›´ [1,9] ä¹‹é—´ã€‚å¦åˆ™ï¼Œè¯¥ `TAG_NAME` æ˜¯**ä¸åˆæ³•çš„** ã€‚
  4. **åˆæ³•çš„**  `TAG_CONTENT` å¯ä»¥åŒ…å«å…¶ä»–**åˆæ³•çš„é—­åˆæ ‡ç­¾** ï¼Œ**cdata**  ï¼ˆè¯·å‚è€ƒè§„åˆ™7ï¼‰å’Œä»»æ„å­—ç¬¦ï¼ˆæ³¨æ„å‚è€ƒè§„åˆ™1ï¼‰**é™¤äº†** ä¸åŒ¹é…çš„`<`ã€ä¸åŒ¹é…çš„èµ·å§‹å’Œç»“æŸæ ‡ç­¾ã€ä¸åŒ¹é…çš„æˆ–å¸¦æœ‰ä¸åˆæ³• TAG_NAME çš„é—­åˆæ ‡ç­¾ã€‚å¦åˆ™ï¼Œ`TAG_CONTENT` æ˜¯**ä¸åˆæ³•çš„** ã€‚
  5. ä¸€ä¸ªèµ·å§‹æ ‡ç­¾ï¼Œå¦‚æœæ²¡æœ‰å…·æœ‰ç›¸åŒ TAG_NAME çš„ç»“æŸæ ‡ç­¾ä¸ä¹‹åŒ¹é…ï¼Œæ˜¯ä¸åˆæ³•çš„ã€‚åä¹‹äº¦ç„¶ã€‚ä¸è¿‡ï¼Œä½ ä¹Ÿéœ€è¦è€ƒè™‘æ ‡ç­¾åµŒå¥—çš„é—®é¢˜ã€‚
  6. ä¸€ä¸ª`<`ï¼Œå¦‚æœä½ æ‰¾ä¸åˆ°ä¸€ä¸ªåç»­çš„`>`ä¸ä¹‹åŒ¹é…ï¼Œæ˜¯ä¸åˆæ³•çš„ã€‚å¹¶ä¸”å½“ä½ æ‰¾åˆ°ä¸€ä¸ª`<`æˆ–`</`æ—¶ï¼Œæ‰€æœ‰ç›´åˆ°ä¸‹ä¸€ä¸ª`>`çš„å‰çš„å­—ç¬¦ï¼Œéƒ½åº”å½“è¢«è§£æä¸º TAG_NAMEï¼ˆä¸ä¸€å®šåˆæ³•ï¼‰ã€‚
  7. cdata æœ‰å¦‚ä¸‹æ ¼å¼ï¼š`<![CDATA[CDATA_CONTENT]]>`ã€‚`CDATA_CONTENT` çš„èŒƒå›´è¢«å®šä¹‰æˆ `<![CDATA[` å’Œ**åç»­çš„ç¬¬ä¸€ä¸ª**  `]]>`ä¹‹é—´çš„å­—ç¬¦ã€‚
  8. `CDATA_CONTENT` å¯ä»¥åŒ…å«**ä»»æ„å­—ç¬¦** ã€‚cdata çš„åŠŸèƒ½æ˜¯é˜»æ­¢éªŒè¯å™¨è§£æ`CDATA_CONTENT`ï¼Œæ‰€ä»¥å³ä½¿å…¶ä¸­æœ‰ä¸€äº›å­—ç¬¦å¯ä»¥è¢«è§£æä¸ºæ ‡ç­¾ï¼ˆæ— è®ºåˆæ³•è¿˜æ˜¯ä¸åˆæ³•ï¼‰ï¼Œä¹Ÿåº”è¯¥å°†å®ƒä»¬è§†ä¸º**å¸¸è§„å­—ç¬¦** ã€‚

**åˆæ³•ä»£ç çš„ä¾‹å­:**

> 
> 
> 
> 
> 
> **è¾“å…¥:** "<DIV>This is the first line <![CDATA[<div>]]></DIV>"
> 
> 
> 
> **è¾“å‡º:** True
> 
> 
> 
> **è§£é‡Š:** 
> 
> 
> 
> ä»£ç è¢«åŒ…å«åœ¨äº†é—­åˆçš„æ ‡ç­¾å†…ï¼š <DIV> å’Œ </DIV> ã€‚
> 
> 
> 
> TAG_NAME æ˜¯åˆæ³•çš„ï¼ŒTAG_CONTENT åŒ…å«äº†ä¸€äº›å­—ç¬¦å’Œ cdata ã€‚ 
> 
> 
> 
> å³ä½¿ CDATA_CONTENT å«æœ‰ä¸åŒ¹é…çš„èµ·å§‹æ ‡ç­¾å’Œä¸åˆæ³•çš„ TAG_NAMEï¼Œå®ƒåº”è¯¥è¢«è§†ä¸ºæ™®é€šçš„æ–‡æœ¬ï¼Œè€Œä¸æ˜¯æ ‡ç­¾ã€‚
> 
> 
> 
> æ‰€ä»¥ TAG_CONTENT æ˜¯åˆæ³•çš„ï¼Œå› æ­¤ä»£ç æ˜¯åˆæ³•çš„ã€‚æœ€ç»ˆè¿”å›Trueã€‚
> 
> 
> 
> 
> 
> **è¾“å…¥:** "<DIV>>>  ![cdata[]] <![CDATA[<div>]>]]>]]>>]</DIV>"
> 
> 
> 
> **è¾“å‡º:** True
> 
> 
> 
> **è§£é‡Š:**
> 
> 
> 
> æˆ‘ä»¬é¦–å…ˆå°†ä»£ç åˆ†å‰²ä¸ºï¼š start_tag|tag_content|end_tag ã€‚
> 
> 
> 
> start_tag -> **" <DIV>"**
> 
> 
> 
> end_tag -> **" </DIV>"**
> 
> 
> 
> tag_content ä¹Ÿå¯è¢«åˆ†å‰²ä¸ºï¼š text1|cdata|text2 ã€‚
> 
> 
> 
> text1 -> **" >>  ![cdata[]] "**
> 
> 
> 
> cdata -> **" <![CDATA[<div>]>]]>"** ï¼Œå…¶ä¸­ CDATA_CONTENT ä¸º **" <div>]>"**
> 
> 
> 
> text2 -> **"]]>>]"**
> 
> 
> 
> 
> 
> start_tag **ä¸** æ˜¯ **" <DIV>>>"** çš„åŸå› å‚ç…§è§„åˆ™ 6 ã€‚
> 
> cdata **ä¸** æ˜¯ **" <![CDATA[<div>]>]]>]]>"** çš„åŸå› å‚ç…§è§„åˆ™ 7 ã€‚
> 
> 

**ä¸åˆæ³•ä»£ç çš„ä¾‹å­:**

> 
> 
> 
> 
> 
> **è¾“å…¥:** "<A>  <B> </A>   </B>"
> 
> **è¾“å‡º:** False
> 
> **è§£é‡Š:** ä¸åˆæ³•ã€‚å¦‚æœ "<A>" æ˜¯é—­åˆçš„ï¼Œé‚£ä¹ˆ "<B>" ä¸€å®šæ˜¯ä¸åŒ¹é…çš„ï¼Œåä¹‹äº¦ç„¶ã€‚
> 
> 
> 
> **è¾“å…¥:** "<DIV>  div tag is not closed  <DIV>"
> 
> **è¾“å‡º:** False
> 
> 
> 
> **è¾“å…¥:** "<DIV>  unmatched <  </DIV>"
> 
> **è¾“å‡º:** False
> 
> 
> 
> **è¾“å…¥:** "<DIV> closed tags with invalid tag name  <b>123</b> </DIV>"
> 
> **è¾“å‡º:** False
> 
> 
> 
> **è¾“å…¥:** "<DIV> unmatched tags with invalid tag name  </1234567890> and <CDATA[[]]>  </DIV>"
> 
> **è¾“å‡º:** False
> 
> 
> 
> **è¾“å…¥:** "<DIV>  unmatched start tag <B>  and unmatched end tag </C>  </DIV>"
> 
> **è¾“å‡º:** False
> 
> 

**æ³¨æ„:**

  1. ä¸ºç®€æ˜èµ·è§ï¼Œä½ å¯ä»¥å‡è®¾è¾“å…¥çš„ä»£ç ï¼ˆåŒ…æ‹¬æåˆ°çš„**ä»»æ„å­—ç¬¦** ï¼‰åªåŒ…å«`æ•°å­—`, å­—æ¯, `'<'`,`'>'`,`'/'`,`'!'`,`'['`,`']'`å’Œ`' '`ã€‚


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ | åŠ›æ‰£ |
| :------: | :------ | :------: | :------ | :------ | :------: |
| 616 | ç»™å­—ç¬¦ä¸²æ·»åŠ åŠ ç²—æ ‡ç­¾ ğŸ”’ |  |  [`å­—å…¸æ ‘`](/tag/trie.md) [`æ•°ç»„`](/tag/array.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) `2+` | <font color=#ffb800>Medium</font> | [ğŸ€„ï¸](https://leetcode.cn/problems/add-bold-tag-in-string) [ğŸ”—](https://leetcode.com/problems/add-bold-tag-in-string) |