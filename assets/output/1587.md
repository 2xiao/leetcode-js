# [1587. é“¶è¡Œè´¦æˆ·æ¦‚è¦ II](https://leetcode.com/problems/bank-account-summary-ii)

ğŸŸ¢ <font color=#15bd66>Easy</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/bank-account-summary-ii)

## é¢˜ç›®

Table: `Users`

> 
> 
> 
> 
> 
> +--------------+---------+
> 
> | Column Name  | Type> 
> |
> 
> +--------------+---------+
> 
> | account> 
>   | int> 
>  |
> 
> | name> 
> > 
>  | varchar |
> 
> +--------------+---------+
> 
> account is the primary key (column with unique values) for this table.
> 
> Each row of this table contains the account number of each user in the bank.
> 
> There will be no two users having the same name in the table.
> 
> 



Table: `Transactions`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | trans_id> 
>   | int> 
>  |
> 
> | account> 
>    | int> 
>  |
> 
> | amount> 
> > 
> | int> 
>  |
> 
> | transacted_on | date> 
> |
> 
> +---------------+---------+
> 
> trans_id is the primary key (column with unique values) for this table.
> 
> Each row of this table contains all changes made to all accounts.
> 
> amount is positive if the user received money and negative if they transferred money.
> 
> All accounts start with a balance of 0.
> 
> 



Write a solution to report the name and balance of users with a balance higher
than `10000`. The balance of an account is equal to the sum of the amounts of
all transactions involving that account.

Return the result table in **any order**.

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Users table:
> 
> +------------+--------------+
> 
> | account> 
> | name> 
> > 
>  |
> 
> +------------+--------------+
> 
> | 900001> 
>  | Alice> 
> > 
> |
> 
> | 900002> 
>  | Bob> 
> > 
>   |
> 
> | 900003> 
>  | Charlie> 
>   |
> 
> +------------+--------------+
> 
> Transactions table:
> 
> +------------+------------+------------+---------------+
> 
> | trans_id   | account> 
> | amount> 
>  | transacted_on |
> 
> +------------+------------+------------+---------------+
> 
> | 1> 
> > 
>   | 900001> 
>  | 7000> 
>    |  2020-08-01   |
> 
> | 2> 
> > 
>   | 900001> 
>  | 7000> 
>    |  2020-09-01   |
> 
> | 3> 
> > 
>   | 900001> 
>  | -3000> 
>   |  2020-09-02   |
> 
> | 4> 
> > 
>   | 900002> 
>  | 1000> 
>    |  2020-09-12   |
> 
> | 5> 
> > 
>   | 900003> 
>  | 6000> 
>    |  2020-08-07   |
> 
> | 6> 
> > 
>   | 900003> 
>  | 6000> 
>    |  2020-09-07   |
> 
> | 7> 
> > 
>   | 900003> 
>  | -4000> 
>   |  2020-09-11   |
> 
> +------------+------------+------------+---------------+
> 
> Output: 
> 
> +------------+------------+
> 
> | name> 
>    | balance> 
> |
> 
> +------------+------------+
> 
> | Alice> 
>   | 11000> 
>   |
> 
> +------------+------------+
> 
> Explanation: 
> 
> Alice's balance is (7000 + 7000 - 3000) = 11000.
> 
> Bob's balance is 1000.
> 
> Charlie's balance is (6000 + 6000 - 4000) = 8000.
> 
> 


## é¢˜ç›®å¤§æ„

è¡¨: `Users`

> 
> 
> 
> 
> 
> +--------------+---------+
> 
> | Column Name  | Type> 
> |
> 
> +--------------+---------+
> 
> | account> 
>   | int> 
>  |
> 
> | name> 
> > 
>  | varchar |
> 
> +--------------+---------+
> 
> account æ˜¯è¯¥è¡¨çš„ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚
> 
> è¯¥è¡¨çš„æ¯ä¸€è¡Œéƒ½åŒ…å«é“¶è¡Œä¸­æ¯ä¸ªç”¨æˆ·çš„å¸å·ã€‚
> 
> è¡¨ä¸­ä¸ä¼šæœ‰ä¸¤ä¸ªç”¨æˆ·å…·æœ‰ç›¸åŒçš„åç§°ã€‚
> 
> 



è¡¨: `Transactions`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | trans_id> 
>   | int> 
>  |
> 
> | account> 
>    | int> 
>  |
> 
> | amount> 
> > 
> | int> 
>  |
> 
> | transacted_on | date> 
> |
> 
> +---------------+---------+
> 
> trans_id æ˜¯è¯¥è¡¨ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚
> 
> è¯¥è¡¨çš„æ¯ä¸€è¡ŒåŒ…å«äº†æ‰€æœ‰è´¦æˆ·çš„äº¤æ˜“æ”¹å˜æƒ…å†µã€‚
> 
> å¦‚æœç”¨æˆ·æ”¶åˆ°äº†é’±, é‚£ä¹ˆé‡‘é¢æ˜¯æ­£çš„; å¦‚æœç”¨æˆ·è½¬äº†é’±, é‚£ä¹ˆé‡‘é¢æ˜¯è´Ÿçš„ã€‚
> 
> æ‰€æœ‰è´¦æˆ·çš„èµ·å§‹ä½™é¢ä¸º 0ã€‚
> 
> 



ç¼–å†™è§£å†³æ–¹æ¡ˆ,  æŠ¥å‘Šä½™é¢é«˜äº 10000 çš„æ‰€æœ‰ç”¨æˆ·çš„åå­—å’Œä½™é¢. è´¦æˆ·çš„ä½™é¢ç­‰äºåŒ…å«è¯¥è´¦æˆ·çš„æ‰€æœ‰äº¤æ˜“çš„æ€»å’Œã€‚

è¿”å›ç»“æœè¡¨å• **æ— é¡ºåºè¦æ±‚** ã€‚

æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š**
> 
> Users table:
> 
> +------------+--------------+
> 
> | account> 
> | name> 
> > 
>  |
> 
> +------------+--------------+
> 
> | 900001> 
>  | Alice> 
> > 
> |
> 
> | 900002> 
>  | Bob> 
> > 
>   |
> 
> | 900003> 
>  | Charlie> 
>   |
> 
> +------------+--------------+
> 
> 
> 
> Transactions table:
> 
> +------------+------------+------------+---------------+
> 
> | trans_id   | account> 
> | amount> 
>  | transacted_on |
> 
> +------------+------------+------------+---------------+
> 
> | 1> 
> > 
>   | 900001> 
>  | 7000> 
>    |  2020-08-01   |
> 
> | 2> 
> > 
>   | 900001> 
>  | 7000> 
>    |  2020-09-01   |
> 
> | 3> 
> > 
>   | 900001> 
>  | -3000> 
>   |  2020-09-02   |
> 
> | 4> 
> > 
>   | 900002> 
>  | 1000> 
>    |  2020-09-12   |
> 
> | 5> 
> > 
>   | 900003> 
>  | 6000> 
>    |  2020-08-07   |
> 
> | 6> 
> > 
>   | 900003> 
>  | 6000> 
>    |  2020-09-07   |
> 
> | 7> 
> > 
>   | 900003> 
>  | -4000> 
>   |  2020-09-11   |
> 
> +------------+------------+------------+---------------+
> 
> **è¾“å‡ºï¼š**
> 
> +------------+------------+
> 
> | name> 
>    | balance> 
> |
> 
> +------------+------------+
> 
> | Alice> 
>   | 11000> 
>   |
> 
> +------------+------------+
> 
> **è§£é‡Šï¼š**
> 
> Alice çš„ä½™é¢ä¸º(7000 + 7000 - 3000) = 11000.
> 
> Bob çš„ä½™é¢ä¸º1000.
> 
> Charlie çš„ä½™é¢ä¸º(6000 + 6000 - 4000) = 8000.
> 
> 


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```