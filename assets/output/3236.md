# [3236. é¦–å¸­æ‰§è¡Œå®˜ä¸‹å±å±‚çº§](https://leetcode.com/problems/ceo-subordinate-hierarchy)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/ceo-subordinate-hierarchy)

## é¢˜ç›®

Table: `Employees`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | employee_id   | int> 
>  |
> 
> | employee_name | varchar |
> 
> | manager_id> 
> | int> 
>  |
> 
> | salary> 
> > 
> | int> 
>  |
> 
> +---------------+---------+
> 
> employee_id is the unique identifier for this table.
> 
> manager_id is the employee_id of the employee's manager. The CEO has a NULL manager_id.
> 
> 

Write a solution to find subordinates of the CEO (both **direct** and
**indirect**), along with their **level in the hierarchy** and their **salary
difference** from the CEO.

The result should have the following columns:

The query result format is in the following example.

  * `subordinate_id`: The employee_id of the subordinate
  * `subordinate_name`: The name of the subordinate
  * `hierarchy_level`: The level of the subordinate in the hierarchy (`1` for **direct** reports, `2` for **their direct** reports, and **so on**)
  * `salary_difference`: The difference between the subordinate's salary and the CEO's salary

Return _the result table ordered by_ `hierarchy_level` _**ascending**_ , _and
then by_ `subordinate_id` _**ascending**_.

The query result format is in the following example.



**Example:**

**Input:**

`Employees` table:

> 
> 
> 
> 
> 
> +-------------+----------------+------------+---------+
> 
> | employee_id | employee_name  | manager_id | salary  |
> 
> +-------------+----------------+------------+---------+
> 
> | 1> 
> > 
>    | Alice> 
> > 
>   | NULL> 
>    | 150000  |
> 
> | 2> 
> > 
>    | Bob> 
> > 
> > 
> | 1> 
> > 
>   | 120000  |
> 
> | 3> 
> > 
>    | Charlie> 
> > 
> | 1> 
> > 
>   | 110000  |
> 
> | 4> 
> > 
>    | David> 
> > 
>   | 2> 
> > 
>   | 105000  |
> 
> | 5> 
> > 
>    | Eve> 
> > 
> > 
> | 2> 
> > 
>   | 100000  |
> 
> | 6> 
> > 
>    | Frank> 
> > 
>   | 3> 
> > 
>   | 95000   |
> 
> | 7> 
> > 
>    | Grace> 
> > 
>   | 3> 
> > 
>   | 98000   |
> 
> | 8> 
> > 
>    | Helen> 
> > 
>   | 5> 
> > 
>   | 90000   |
> 
> +-------------+----------------+------------+---------+
> 
> 

**Output:**

> 
> 
> 
> 
> 
> +----------------+------------------+------------------+-------------------+
> 
> | subordinate_id | subordinate_name | hierarchy_level  | salary_difference |
> 
> +----------------+------------------+------------------+-------------------+
> 
> | 2> 
> > 
> > 
>   | Bob> 
> > 
> > 
>   | 1> 
> > 
> > 
> > 
> | -30000> 
> > 
> > 
> |
> 
> | 3> 
> > 
> > 
>   | Charlie> 
> > 
>   | 1> 
> > 
> > 
> > 
> | -40000> 
> > 
> > 
> |
> 
> | 4> 
> > 
> > 
>   | David> 
> > 
> > 
> | 2> 
> > 
> > 
> > 
> | -45000> 
> > 
> > 
> |
> 
> | 5> 
> > 
> > 
>   | Eve> 
> > 
> > 
>   | 2> 
> > 
> > 
> > 
> | -50000> 
> > 
> > 
> |
> 
> | 6> 
> > 
> > 
>   | Frank> 
> > 
> > 
> | 2> 
> > 
> > 
> > 
> | -55000> 
> > 
> > 
> |
> 
> | 7> 
> > 
> > 
>   | Grace> 
> > 
> > 
> | 2> 
> > 
> > 
> > 
> | -52000> 
> > 
> > 
> |
> 
> | 8> 
> > 
> > 
>   | Helen> 
> > 
> > 
> | 3> 
> > 
> > 
> > 
> | -60000> 
> > 
> > 
> |
> 
> +----------------+------------------+------------------+-------------------+
> 
> 

**Explanation:**

  * Bob and Charlie are direct subordinates of Alice (CEO) and thus have a hierarchy_level of 1.
  * David and Eve report to Bob, while Frank and Grace report to Charlie, making them second-level subordinates (hierarchy_level 2).
  * Helen reports to Eve, making Helen a third-level subordinate (hierarchy_level 3).
  * Salary differences are calculated relative to Alice's salary of 150000.
  * The result is ordered by hierarchy_level ascending, and then by subordinate_id ascending.

**Note:** The output is ordered first by hierarchy_level in ascending order,
then by subordinate_id in ascending order.


## é¢˜ç›®å¤§æ„

è¡¨ï¼š`Employees`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | employee_id   | int> 
>  |
> 
> | employee_name | varchar |
> 
> | manager_id> 
> | int> 
>  |
> 
> | salary> 
> > 
> | int> 
>  |
> 
> +---------------+---------+
> 
> employee_id æ˜¯è¿™å¼ è¡¨çš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚
> 
> manager_id æ˜¯ employee_id å¯¹åº”å‘˜å·¥çš„ç»ç†ã€‚é¦–å¸­æ‰§è¡Œå®˜çš„ manager_id ä¸º NULLã€‚
> 
> 

ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ¥æ‰¾åˆ°é¦–å¸­æ‰§è¡Œå®˜çš„ä¸‹å±ï¼ˆ**ç›´æ¥** å’Œ **éç›´æ¥** ï¼‰ï¼Œä»¥åŠä»–ä»¬åœ¨ **ç­‰çº§åˆ¶åº¦ä¸­çš„çº§åˆ«** ä»¥åŠä¸é¦–å¸­æ‰§è¡Œå®˜çš„ **è–ªèµ„å·®å¼‚**
ã€‚ç»“æœåº”è¯¥åŒ…å«ä¸‹é¢çš„åˆ—ï¼š

æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚

  * `subordinate_id`ï¼šä¸‹å±çš„ employee_idã€‚
  * `subordinate_name`ï¼šä¸‹å±çš„åå­—ã€‚
  * `hierarchy_level`ï¼šä¸‹å±åœ¨ç­‰çº§åˆ¶åº¦ä¸­çš„çº§åˆ«ï¼ˆ`1` è¡¨ç¤ºç›´æ¥ä¸‹å±ï¼Œ`2` è¡¨ç¤º **ä»–ä»¬çš„ç›´æ¥ä¸‹å±** ï¼Œ**ä»¥æ­¤ç±»æ¨** ã€‚ï¼‰
  * `salary_difference`ï¼šä¸‹å±ä¸é¦–å¸­æ‰§è¡Œå®˜çš„è–ªèµ„å·®å¼‚ã€‚

è¿”å›ç»“æœè¡¨ä»¥ `hierarchy_level` **å‡åºæ’åº** ï¼Œç„¶åæŒ‰ `subordinate_id` **å‡åºæ’åº** ã€‚

æŸ¥è¯¢æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ï¼š**

**è¾“å…¥ï¼š**

`Employees` è¡¨ï¼š

> 
> 
> 
> 
> 
> +-------------+----------------+------------+---------+
> 
> | employee_id | employee_name  | manager_id | salary  |
> 
> +-------------+----------------+------------+---------+
> 
> | 1> 
> > 
>    | Alice> 
> > 
>   | NULL> 
>    | 150000  |
> 
> | 2> 
> > 
>    | Bob> 
> > 
> > 
> | 1> 
> > 
>   | 120000  |
> 
> | 3> 
> > 
>    | Charlie> 
> > 
> | 1> 
> > 
>   | 110000  |
> 
> | 4> 
> > 
>    | David> 
> > 
>   | 2> 
> > 
>   | 105000  |
> 
> | 5> 
> > 
>    | Eve> 
> > 
> > 
> | 2> 
> > 
>   | 100000  |
> 
> | 6> 
> > 
>    | Frank> 
> > 
>   | 3> 
> > 
>   | 95000   |
> 
> | 7> 
> > 
>    | Grace> 
> > 
>   | 3> 
> > 
>   | 98000   |
> 
> | 8> 
> > 
>    | Helen> 
> > 
>   | 5> 
> > 
>   | 90000   |
> 
> +-------------+----------------+------------+---------+
> 
> 

**è¾“å‡ºï¼š**

> 
> 
> 
> 
> 
> +----------------+------------------+------------------+-------------------+
> 
> | subordinate_id | subordinate_name | hierarchy_level  | salary_difference |
> 
> +----------------+------------------+------------------+-------------------+
> 
> | 2> 
> > 
> > 
>   | Bob> 
> > 
> > 
>   | 1> 
> > 
> > 
> > 
> | -30000> 
> > 
> > 
> |
> 
> | 3> 
> > 
> > 
>   | Charlie> 
> > 
>   | 1> 
> > 
> > 
> > 
> | -40000> 
> > 
> > 
> |
> 
> | 4> 
> > 
> > 
>   | David> 
> > 
> > 
> | 2> 
> > 
> > 
> > 
> | -45000> 
> > 
> > 
> |
> 
> | 5> 
> > 
> > 
>   | Eve> 
> > 
> > 
>   | 2> 
> > 
> > 
> > 
> | -50000> 
> > 
> > 
> |
> 
> | 6> 
> > 
> > 
>   | Frank> 
> > 
> > 
> | 2> 
> > 
> > 
> > 
> | -55000> 
> > 
> > 
> |
> 
> | 7> 
> > 
> > 
>   | Grace> 
> > 
> > 
> | 2> 
> > 
> > 
> > 
> | -52000> 
> > 
> > 
> |
> 
> | 8> 
> > 
> > 
>   | Helen> 
> > 
> > 
> | 3> 
> > 
> > 
> > 
> | -60000> 
> > 
> > 
> |
> 
> +----------------+------------------+------------------+-------------------+
> 
> 

**è§£é‡Šï¼š**

  * Bob å’Œ Charlie æ˜¯ Alice çš„ç›´æ¥ä¸‹å±ï¼ˆé¦–å¸­æ‰§è¡Œå®˜ï¼‰å› æ­¤ï¼Œhierarchy_level ä¸º 1ã€‚
  * David å’Œ Eve ä¸‹å±äº Bobï¼Œè€Œ Frank å’Œ Grace ä¸‹å±äº Charlieï¼Œå› æ­¤ä»–ä»¬æ˜¯äºŒçº§ä¸‹å±ï¼ˆhierarchy_level ä¸º 2ï¼‰ã€‚
  * Helen ä¸‹å±äº Eveï¼Œå› æ­¤ Helen ä¸ºä¸‰çº§ä¸‹å±ï¼ˆhierarchy_level ä¸º 3ï¼‰ã€‚
  * è–ªèµ„å·®å¼‚æ˜¯ç›¸å¯¹äº Alice çš„è–ªèµ„ 150000 è®¡ç®—çš„ã€‚
  * ç»“æœå…ˆä»¥ hierarchy_level å‡åºæ’åºï¼Œç„¶åä»¥ subordinate_id å‡åºæ’åºã€‚

**æ³¨æ„ï¼š** è¾“å‡ºè¡¨å…ˆä»¥ hierarchy_level å‡åºæ’åºï¼Œç„¶åä»¥ subordinate_id å‡åºæ’åºã€‚


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```