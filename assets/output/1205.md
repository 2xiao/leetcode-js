---
title: 1205. æ¯æœˆäº¤æ˜“ II ğŸ”’
description: LeetCode 1205. æ¯æœˆäº¤æ˜“ II ğŸ”’é¢˜è§£ï¼ŒMonthly Transactions IIï¼ŒåŒ…å«è§£é¢˜æ€è·¯ã€å¤æ‚åº¦åˆ†æä»¥åŠå®Œæ•´çš„ JavaScript ä»£ç å®ç°ã€‚
keywords:
  - LeetCode
  - 1205. æ¯æœˆäº¤æ˜“ II ğŸ”’
  - æ¯æœˆäº¤æ˜“ II
  - Monthly Transactions II
  - è§£é¢˜æ€è·¯
  - æ•°æ®åº“
---

# 1205. æ¯æœˆäº¤æ˜“ II ğŸ”’

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/monthly-transactions-ii) [`LeetCode`](https://leetcode.com/problems/monthly-transactions-ii)

## é¢˜ç›®

Table: `Transactions`

> 
> 
> 
> 
> 
> +----------------+---------+
> 
> | Column Name> 
> | Type> 
> |
> 
> +----------------+---------+
> 
> | id> 
> > 
> > 
>  | int> 
>  |
> 
> | country> 
> > 
> | varchar |
> 
> | state> 
> > 
>   | enum> 
> |
> 
> | amount> 
> > 
>  | int> 
>  |
> 
> | trans_date> 
>  | date> 
> |
> 
> +----------------+---------+
> 
> id is the column of unique values of this table.
> 
> The table has information about incoming transactions.
> 
> The state column is an ENUM (category) of type ["approved", "declined"].
> 
> 

Table: `Chargebacks`

> 
> 
> 
> 
> 
> +----------------+---------+
> 
> | Column Name> 
> | Type> 
> |
> 
> +----------------+---------+
> 
> | trans_id> 
>    | int> 
>  |
> 
> | trans_date> 
>  | date> 
> |
> 
> +----------------+---------+
> 
> Chargebacks contains basic information regarding incoming chargebacks from some transactions placed in Transactions table.
> 
> trans_id is a foreign key (reference column) to the id column of Transactions table.
> 
> Each chargeback corresponds to a transaction made previously even if they were not approved.



Write a solution to find for each month and country: the number of approved
transactions and their total amount, the number of chargebacks, and their
total amount.

**Note** : In your solution, given the month and country, ignore rows with all
zeros.

Return the result table in **any order**.

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Transactions table:
> 
> +-----+---------+----------+--------+------------+
> 
> | id  | country | state> 
> | amount | trans_date |
> 
> +-----+---------+----------+--------+------------+
> 
> | 101 | US> 
>   | approved | 1000   | 2019-05-18 |
> 
> | 102 | US> 
>   | declined | 2000   | 2019-05-19 |
> 
> | 103 | US> 
>   | approved | 3000   | 2019-06-10 |
> 
> | 104 | US> 
>   | declined | 4000   | 2019-06-13 |
> 
> | 105 | US> 
>   | approved | 5000   | 2019-06-15 |
> 
> +-----+---------+----------+--------+------------+
> 
> Chargebacks table:
> 
> +----------+------------+
> 
> | trans_id | trans_date |
> 
> +----------+------------+
> 
> | 102> 
>   | 2019-05-29 |
> 
> | 101> 
>   | 2019-06-30 |
> 
> | 105> 
>   | 2019-09-18 |
> 
> +----------+------------+
> 
> Output: 
> 
> +---------+---------+----------------+-----------------+------------------+-------------------+
> 
> | month   | country | approved_count | approved_amount | chargeback_count | chargeback_amount |
> 
> +---------+---------+----------------+-----------------+------------------+-------------------+
> 
> | 2019-05 | US> 
>   | 1> 
> > 
> > 
>   | 1000> 
> > 
> > 
> | 1> 
> > 
> > 
> > 
> | 2000> 
> > 
> > 
>   |
> 
> | 2019-06 | US> 
>   | 2> 
> > 
> > 
>   | 8000> 
> > 
> > 
> | 1> 
> > 
> > 
> > 
> | 1000> 
> > 
> > 
>   |
> 
> | 2019-09 | US> 
>   | 0> 
> > 
> > 
>   | 0> 
> > 
> > 
>    | 1> 
> > 
> > 
> > 
> | 5000> 
> > 
> > 
>   |
> 
> +---------+---------+----------------+-----------------+------------------+-------------------+
> 
> 


## é¢˜ç›®å¤§æ„

`Transactions` è®°å½•è¡¨

> 
> 
> 
> 
> 
> +----------------+---------+
> 
> | Column Name> 
> | Type> 
> |
> 
> +----------------+---------+
> 
> | id> 
> > 
> > 
>  | int> 
>  |
> 
> | country> 
> > 
> | varchar |
> 
> | state> 
> > 
>   | enum> 
> |
> 
> | amount> 
> > 
>  | int> 
>  |
> 
> | trans_date> 
>  | date> 
> |
> 
> +----------------+---------+
> 
> id æ˜¯è¿™ä¸ªè¡¨çš„ä¸»é”®ã€‚
> 
> è¯¥è¡¨åŒ…å«æœ‰å…³ä¼ å…¥äº‹åŠ¡çš„ä¿¡æ¯ã€‚
> 
> çŠ¶æ€åˆ—æ˜¯æšä¸¾ç±»å‹ï¼Œå€¼ä¸º [approvedã€declined] å…¶ä¸­ä¹‹ä¸€çš„åˆ—ã€‚

`Chargebacks` è¡¨

> 
> 
> 
> 
> 
> +----------------+---------+
> 
> | Column Name> 
> | Type> 
> |
> 
> +----------------+---------+
> 
> | trans_id> 
>    | int> 
>  |
> 
> | trans_date> 
>  | date> 
> |
> 
> +----------------+---------+
> 
> é€€å•åŒ…å«æœ‰å…³æ”¾ç½®åœ¨äº‹åŠ¡è¡¨ä¸­çš„æŸäº›äº‹åŠ¡çš„ä¼ å…¥é€€å•çš„åŸºæœ¬ä¿¡æ¯ã€‚
> 
> trans_id æ˜¯ transactions è¡¨çš„ id åˆ—çš„å¤–é”®ï¼ˆreference åˆ—ï¼‰ã€‚
> 
> æ¯é¡¹é€€å•éƒ½å¯¹åº”äºä¹‹å‰è¿›è¡Œçš„äº¤æ˜“ï¼Œå³ä½¿æœªç»æ‰¹å‡†ã€‚



ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œæ‰¾å‡ºæ¯ä¸ªå›½å®¶/åœ°åŒºçš„æ¯æœˆäº¤æ˜“ä¿¡æ¯ï¼šå·²æ‰¹å‡†äº¤æ˜“çš„æ•°é‡åŠå…¶æ€»é‡‘é¢ã€é€€å•çš„æ•°é‡åŠå…¶æ€»é‡‘é¢ã€‚

**æ³¨æ„ï¼š** åœ¨ä½ çš„è§£å†³æ–¹æ¡ˆä¸­ï¼Œåªéœ€æ˜¾ç¤ºç»™å®šæœˆä»½å’Œå›½å®¶ï¼Œå¿½ç•¥æ‰€æœ‰ä¸ºé›¶çš„è¡Œã€‚

ä»¥ **ä»»æ„é¡ºåº** è¿”å›ç»“æœè¡¨ã€‚

ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1:**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š**
> 
> Transactions è¡¨ï¼š
> 
> +-----+---------+----------+--------+------------+
> 
> | id  | country | state> 
> | amount | trans_date |
> 
> +-----+---------+----------+--------+------------+
> 
> | 101 | US> 
>   | approved | 1000   | 2019-05-18 |
> 
> | 102 | US> 
>   | declined | 2000   | 2019-05-19 |
> 
> | 103 | US> 
>   | approved | 3000   | 2019-06-10 |
> 
> | 104 | US> 
>   | declined | 4000   | 2019-06-13 |
> 
> | 105 | US> 
>   | approved | 5000   | 2019-06-15 |
> 
> +-----+---------+----------+--------+------------+
> 
> Chargebacks è¡¨ï¼š
> 
> +----------+------------+
> 
> | trans_id | trans_date |
> 
> +----------+------------+
> 
> | 102> 
>   | 2019-05-29 |
> 
> | 101> 
>   | 2019-06-30 |
> 
> | 105> 
>   | 2019-09-18 |
> 
> +----------+------------+
> 
> **è¾“å‡ºï¼š**
> 
> +---------+---------+----------------+-----------------+------------------+-------------------+
> 
> | month   | country | approved_count | approved_amount | chargeback_count | chargeback_amount |
> 
> +---------+---------+----------------+-----------------+------------------+-------------------+
> 
> | 2019-05 | US> 
>   | 1> 
> > 
> > 
>   | 1000> 
> > 
> > 
> | 1> 
> > 
> > 
> > 
> | 2000> 
> > 
> > 
>   |
> 
> | 2019-06 | US> 
>   | 2> 
> > 
> > 
>   | 8000> 
> > 
> > 
> | 1> 
> > 
> > 
> > 
> | 1000> 
> > 
> > 
>   |
> 
> | 2019-09 | US> 
>   | 0> 
> > 
> > 
>   | 0> 
> > 
> > 
>    | 1> 
> > 
> > 
> > 
> | 5000> 
> > 
> > 
>   |
> 
> +---------+---------+----------------+-----------------+------------------+-------------------+


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ | åŠ›æ‰£ |
| :------: | :------ | :------: | :------ | :------: | :------: |
| 1193 | æ¯æœˆäº¤æ˜“ I |  |  [`æ•°æ®åº“`](/tag/database.md) | ğŸŸ  | [ğŸ€„ï¸](https://leetcode.cn/problems/monthly-transactions-i) [ğŸ”—](https://leetcode.com/problems/monthly-transactions-i) |