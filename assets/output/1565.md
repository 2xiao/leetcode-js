# [1565. æŒ‰æœˆç»Ÿè®¡è®¢å•æ•°ä¸é¡¾å®¢æ•°](https://leetcode.com/problems/unique-orders-and-customers-per-month)

ğŸŸ¢ <font color=#15bd66>Easy</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/unique-orders-and-customers-per-month)

## é¢˜ç›®

Table: `Orders`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | order_id> 
>   | int> 
>  |
> 
> | order_date> 
> | date> 
> |
> 
> | customer_id   | int> 
>  |
> 
> | invoice> 
>    | int> 
>  |
> 
> +---------------+---------+
> 
> order_id is the column with unique values for this table.
> 
> This table contains information about the orders made by customer_id.
> 
> 



Write a solution to find the number of **unique orders** and the number of
**unique customers** with invoices **> $20** for each **different month**.

Return the result table sorted in **any order**.

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Orders table:
> 
> +----------+------------+-------------+------------+
> 
> | order_id | order_date | customer_id | invoice> 
> |
> 
> +----------+------------+-------------+------------+
> 
> | 1> 
> > 
> | 2020-09-15 | 1> 
> > 
>    | 30> 
> > 
>  |
> 
> | 2> 
> > 
> | 2020-09-17 | 2> 
> > 
>    | 90> 
> > 
>  |
> 
> | 3> 
> > 
> | 2020-10-06 | 3> 
> > 
>    | 20> 
> > 
>  |
> 
> | 4> 
> > 
> | 2020-10-20 | 3> 
> > 
>    | 21> 
> > 
>  |
> 
> | 5> 
> > 
> | 2020-11-10 | 1> 
> > 
>    | 10> 
> > 
>  |
> 
> | 6> 
> > 
> | 2020-11-21 | 2> 
> > 
>    | 15> 
> > 
>  |
> 
> | 7> 
> > 
> | 2020-12-01 | 4> 
> > 
>    | 55> 
> > 
>  |
> 
> | 8> 
> > 
> | 2020-12-03 | 4> 
> > 
>    | 77> 
> > 
>  |
> 
> | 9> 
> > 
> | 2021-01-07 | 3> 
> > 
>    | 31> 
> > 
>  |
> 
> | 10> 
>    | 2021-01-15 | 2> 
> > 
>    | 20> 
> > 
>  |
> 
> +----------+------------+-------------+------------+
> 
> Output: 
> 
> +---------+-------------+----------------+
> 
> | month   | order_count | customer_count |
> 
> +---------+-------------+----------------+
> 
> | 2020-09 | 2> 
> > 
>    | 2> 
> > 
> > 
>   |
> 
> | 2020-10 | 1> 
> > 
>    | 1> 
> > 
> > 
>   |
> 
> | 2020-12 | 2> 
> > 
>    | 1> 
> > 
> > 
>   |
> 
> | 2021-01 | 1> 
> > 
>    | 1> 
> > 
> > 
>   |
> 
> +---------+-------------+----------------+
> 
> Explanation: 
> 
> In September 2020 we have two orders from 2 different customers with invoices > $20.
> 
> In October 2020 we have two orders from 1 customer, and only one of the two orders has invoice > $20.
> 
> In November 2020 we have two orders from 2 different customers but invoices < $20, so we don't include that month.
> 
> In December 2020 we have two orders from 1 customer both with invoices > $20.
> 
> In January 2021 we have two orders from 2 different customers, but only one of them with invoice > $20.
> 
> 


## é¢˜ç›®å¤§æ„

è¡¨ï¼š`Orders`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | order_id> 
>   | int> 
>  |
> 
> | order_date> 
> | date> 
> |
> 
> | customer_id   | int> 
>  |
> 
> | invoice> 
>    | int> 
>  |
> 
> +---------------+---------+
> 
> order_id æ˜¯è¯¥è¡¨å…·æœ‰å”¯ä¸€å€¼çš„åˆ—ã€‚
> 
> è¿™å¼ è¡¨åŒ…å«é¡¾å®¢(customer_id)æ‰€ä¸‹è®¢å•çš„ä¿¡æ¯ã€‚
> 
> 



å†™ä¸€ä¸ªæŸ¥è¯¢è¯­å¥æ¥ **æŒ‰æœˆ** ç»Ÿè®¡é‡‘é¢ï¼ˆinvoiceï¼‰**å¤§äº $20** çš„å”¯ä¸€ **è®¢å•æ•°** å’Œå”¯ä¸€ **é¡¾å®¢æ•° ã€‚**

æŸ¥è¯¢ç»“æœæ— æ’åºè¦æ±‚ã€‚

æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š**
> 
> Orders
> 
> +----------+------------+-------------+------------+
> 
> | order_id | order_date | customer_id | invoice> 
> |
> 
> +----------+------------+-------------+------------+
> 
> | 1> 
> > 
> | 2020-09-15 | 1> 
> > 
>    | 30> 
> > 
>  |
> 
> | 2> 
> > 
> | 2020-09-17 | 2> 
> > 
>    | 90> 
> > 
>  |
> 
> | 3> 
> > 
> | 2020-10-06 | 3> 
> > 
>    | 20> 
> > 
>  |
> 
> | 4> 
> > 
> | 2020-10-20 | 3> 
> > 
>    | 21> 
> > 
>  |
> 
> | 5> 
> > 
> | 2020-11-10 | 1> 
> > 
>    | 10> 
> > 
>  |
> 
> | 6> 
> > 
> | 2020-11-21 | 2> 
> > 
>    | 15> 
> > 
>  |
> 
> | 7> 
> > 
> | 2020-12-01 | 4> 
> > 
>    | 55> 
> > 
>  |
> 
> | 8> 
> > 
> | 2020-12-03 | 4> 
> > 
>    | 77> 
> > 
>  |
> 
> | 9> 
> > 
> | 2021-01-07 | 3> 
> > 
>    | 31> 
> > 
>  |
> 
> | 10> 
>    | 2021-01-15 | 2> 
> > 
>    | 20> 
> > 
>  |
> 
> +----------+------------+-------------+------------+
> 
> **è¾“å‡ºï¼š**
> 
> +---------+-------------+----------------+
> 
> | month   | order_count | customer_count |
> 
> +---------+-------------+----------------+
> 
> | 2020-09 | 2> 
> > 
>    | 2> 
> > 
> > 
>   |
> 
> | 2020-10 | 1> 
> > 
>    | 1> 
> > 
> > 
>   |
> 
> | 2020-12 | 2> 
> > 
>    | 1> 
> > 
> > 
>   |
> 
> | 2021-01 | 1> 
> > 
>    | 1> 
> > 
> > 
>   |
> 
> +---------+-------------+----------------+
> 
> **è§£é‡Šï¼š**
> 
> åœ¨ 2020 å¹´ 09 æœˆï¼Œæœ‰ 2 ä»½æ¥è‡ª 2 ä½ä¸åŒé¡¾å®¢çš„é‡‘é¢å¤§äº $20 çš„è®¢å•ã€‚
> 
> åœ¨ 2020 å¹´ 10 æœˆï¼Œæœ‰ 2 ä»½æ¥è‡ª 1 ä½é¡¾å®¢çš„è®¢å•ï¼Œå¹¶ä¸”åªæœ‰å…¶ä¸­çš„ 1 ä»½è®¢å•é‡‘é¢å¤§äº $20 ã€‚
> 
> åœ¨ 2020 å¹´ 11 æœˆï¼Œæœ‰ 2 ä»½æ¥è‡ª 2 ä½ä¸åŒé¡¾å®¢çš„è®¢å•ï¼Œä½†ç”±äºé‡‘é¢éƒ½å°äº $20 ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„æŸ¥è¯¢ç»“æœä¸­ä¸åŒ…å«è¿™ä¸ªæœˆçš„æ•°æ®ã€‚
> 
> åœ¨ 2020 å¹´ 12 æœˆï¼Œæœ‰ 2 ä»½æ¥è‡ª 1 ä½é¡¾å®¢çš„è®¢å•ï¼Œä¸” 2 ä»½è®¢å•é‡‘é¢éƒ½å¤§äº $20 ã€‚
> 
> åœ¨ 2021 å¹´ 01 æœˆï¼Œæœ‰ 2 ä»½æ¥è‡ª 2 ä½ä¸åŒé¡¾å®¢çš„è®¢å•ï¼Œä½†åªæœ‰å…¶ä¸­ä¸€ä»½è®¢å•é‡‘é¢å¤§äº $20 ã€‚


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```