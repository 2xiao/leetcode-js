# [1731. æ¯ä½ç»ç†çš„ä¸‹å±å‘˜å·¥æ•°é‡](https://leetcode.com/problems/the-number-of-employees-which-report-to-each-employee)

ğŸŸ¢ <font color=#15bd66>Easy</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/outline/tag/database.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/the-number-of-employees-which-report-to-each-employee)

## é¢˜ç›®

Table: `Employees`

> 
> 
> 
> 
> 
> +-------------+----------+
> 
> | Column Name | Type> 
>  |
> 
> +-------------+----------+
> 
> | employee_id | int> 
>   |
> 
> | name> 
> > 
> | varchar  |
> 
> | reports_to  | int> 
>   |
> 
> | age> 
> > 
>  | int> 
>   |
> 
> +-------------+----------+
> 
> employee_id is the column with unique values for this table.
> 
> This table contains information about the employees and the id of the manager they report to. Some employees do not report to anyone (reports_to is null). 
> 
> 



For this problem, we will consider a **manager** an employee who has at least
1 other employee reporting to them.

Write a solution to report the ids and the names of all **managers** , the
number of employees who report **directly** to them, and the average age of
the reports rounded to the nearest integer.

Return the result table ordered by `employee_id`.

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Employees table:
> 
> +-------------+---------+------------+-----+
> 
> | employee_id | name> 
> | reports_to | age |
> 
> +-------------+---------+------------+-----+
> 
> | 9> 
> > 
>    | Hercy   | null> 
>    | 43  |
> 
> | 6> 
> > 
>    | Alice   | 9> 
> > 
>   | 41  |
> 
> | 4> 
> > 
>    | Bob> 
>  | 9> 
> > 
>   | 36  |
> 
> | 2> 
> > 
>    | Winston | null> 
>    | 37  |
> 
> +-------------+---------+------------+-----+
> 
> Output: 
> 
> +-------------+-------+---------------+-------------+
> 
> | employee_id | name  | reports_count | average_age |
> 
> +-------------+-------+---------------+-------------+
> 
> | 9> 
> > 
>    | Hercy | 2> 
> > 
> > 
>  | 39> 
> > 
>   |
> 
> +-------------+-------+---------------+-------------+
> 
> Explanation: Hercy has 2 people report directly to him, Alice and Bob. Their average age is (41+36)/2 = 38.5, which is 39 after rounding it to the nearest integer.

**Example 2:**

> Input: 
> 
> Employees table:
> 
> +-------------+---------+------------+-----+ 
> 
> | employee_id | name> 
> | reports_to | age |
> 
> |-------------|---------|------------|-----|
> 
> | 1> 
> > 
>    | Michael | null> 
>    | 45  |
> 
> | 2> 
> > 
>    | Alice   | 1> 
> > 
>   | 38  |
> 
> | 3> 
> > 
>    | Bob> 
>  | 1> 
> > 
>   | 42  |
> 
> | 4> 
> > 
>    | Charlie | 2> 
> > 
>   | 34  |
> 
> | 5> 
> > 
>    | David   | 2> 
> > 
>   | 40  |
> 
> | 6> 
> > 
>    | Eve> 
>  | 3> 
> > 
>   | 37  |
> 
> | 7> 
> > 
>    | Frank   | null> 
>    | 50  |
> 
> | 8> 
> > 
>    | Grace   | null> 
>    | 48  |
> 
> +-------------+---------+------------+-----+ 
> 
> Output: 
> 
> +-------------+---------+---------------+-------------+
> 
> | employee_id | name> 
> | reports_count | average_age |
> 
> | ----------- | ------- | ------------- | ----------- |
> 
> | 1> 
> > 
>    | Michael | 2> 
> > 
> > 
>  | 40> 
> > 
>   |
> 
> | 2> 
> > 
>    | Alice   | 2> 
> > 
> > 
>  | 37> 
> > 
>   |
> 
> | 3> 
> > 
>    | Bob> 
>  | 1> 
> > 
> > 
>  | 37> 
> > 
>   |
> 
> +-------------+---------+---------------+-------------+
> 
> 
> 
> 


## é¢˜ç›®å¤§æ„

è¡¨ï¼š`Employees`

> 
> 
> 
> 
> 
> +-------------+----------+
> 
> | Column Name | Type> 
>  |
> 
> +-------------+----------+
> 
> | employee_id | int> 
>   |
> 
> | name> 
> > 
> | varchar  |
> 
> | reports_to  | int> 
>   |
> 
> | age> 
> > 
>  | int> 
>   |
> 
> +-------------+----------+
> 
> employee_id æ˜¯è¿™ä¸ªè¡¨ä¸­å…·æœ‰ä¸åŒå€¼çš„åˆ—ã€‚
> 
> è¯¥è¡¨åŒ…å«å‘˜å·¥ä»¥åŠéœ€è¦å¬å–ä»–ä»¬æ±‡æŠ¥çš„ä¸Šçº§ç»ç†çš„ ID çš„ä¿¡æ¯ã€‚ æœ‰äº›å‘˜å·¥ä¸éœ€è¦å‘ä»»ä½•äººæ±‡æŠ¥ï¼ˆreports_to ä¸ºç©ºï¼‰ã€‚
> 
> 



å¯¹äºæ­¤é—®é¢˜ï¼Œæˆ‘ä»¬å°†è‡³å°‘æœ‰ä¸€ä¸ªå…¶ä»–å‘˜å·¥éœ€è¦å‘ä»–æ±‡æŠ¥çš„å‘˜å·¥ï¼Œè§†ä¸ºä¸€ä¸ªç»ç†ã€‚

ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ¥è¿”å›éœ€è¦å¬å–æ±‡æŠ¥çš„æ‰€æœ‰ç»ç†çš„ IDã€åç§°ã€ç›´æ¥å‘è¯¥ç»ç†æ±‡æŠ¥çš„å‘˜å·¥äººæ•°ï¼Œä»¥åŠè¿™äº›å‘˜å·¥çš„å¹³å‡å¹´é¾„ï¼Œå…¶ä¸­è¯¥å¹³å‡å¹´é¾„éœ€è¦å››èˆäº”å…¥åˆ°æœ€æ¥è¿‘çš„æ•´æ•°ã€‚

è¿”å›çš„ç»“æœé›†éœ€è¦æŒ‰ç…§ `employee_id` è¿›è¡Œæ’åºã€‚

ç»“æœçš„æ ¼å¼å¦‚ä¸‹ï¼š



**ç¤ºä¾‹ 1:**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š**
> 
> Employees è¡¨ï¼š
> 
> +-------------+---------+------------+-----+
> 
> | employee_id | name> 
> | reports_to | age |
> 
> +-------------+---------+------------+-----+
> 
> | 9> 
> > 
>    | Hercy   | null> 
>    | 43  |
> 
> | 6> 
> > 
>    | Alice   | 9> 
> > 
>   | 41  |
> 
> | 4> 
> > 
>    | Bob> 
>  | 9> 
> > 
>   | 36  |
> 
> | 2> 
> > 
>    | Winston | null> 
>    | 37  |
> 
> +-------------+---------+------------+-----+
> 
> **è¾“å‡ºï¼š**
> 
> +-------------+-------+---------------+-------------+
> 
> | employee_id | name  | reports_count | average_age |
> 
> +-------------+-------+---------------+-------------+
> 
> | 9> 
> > 
>    | Hercy | 2> 
> > 
> > 
>  | 39> 
> > 
>   |
> 
> +-------------+-------+---------------+-------------+
> 
> **è§£é‡Šï¼š** Hercy æœ‰ä¸¤ä¸ªéœ€è¦å‘ä»–æ±‡æŠ¥çš„å‘˜å·¥, ä»–ä»¬æ˜¯ Alice and Bob. ä»–ä»¬çš„å¹³å‡å¹´é¾„æ˜¯ (41+36)/2 = 38.5, å››èˆäº”å…¥çš„ç»“æœæ˜¯ 39.
> 
> 

**ç¤ºä¾‹ 2:**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** 
> 
> Employees è¡¨ï¼š
> 
> +-------------+---------+------------+-----+ 
> 
> | employee_id | name> 
> | reports_to | age |
> 
> |-------------|---------|------------|-----|
> 
> | 1> 
> > 
>    | Michael | null> 
>    | 45  |
> 
> | 2> 
> > 
>    | Alice   | 1> 
> > 
>   | 38  |
> 
> | 3> 
> > 
>    | Bob> 
>  | 1> 
> > 
>   | 42  |
> 
> | 4> 
> > 
>    | Charlie | 2> 
> > 
>   | 34  |
> 
> | 5> 
> > 
>    | David   | 2> 
> > 
>   | 40  |
> 
> | 6> 
> > 
>    | Eve> 
>  | 3> 
> > 
>   | 37  |
> 
> | 7> 
> > 
>    | Frank   | null> 
>    | 50  |
> 
> | 8> 
> > 
>    | Grace   | null> 
>    | 48  |
> 
> +-------------+---------+------------+-----+ 
> 
> **è¾“å‡ºï¼š** 
> 
> +-------------+---------+---------------+-------------+
> 
> | employee_id | name> 
> | reports_count | average_age |
> 
> | ----------- | ------- | ------------- | ----------- |
> 
> | 1> 
> > 
>    | Michael | 2> 
> > 
> > 
>  | 40> 
> > 
>   |
> 
> | 2> 
> > 
>    | Alice   | 2> 
> > 
> > 
>  | 37> 
> > 
>   |
> 
> | 3> 
> > 
>    | Bob> 
>  | 1> 
> > 
> > 
>  | 37> 
> > 
>   |
> 
> +-------------+---------+---------------+-------------+


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```