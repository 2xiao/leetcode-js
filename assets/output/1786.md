# [1786. ä»ç¬¬ä¸€ä¸ªèŠ‚ç‚¹å‡ºå‘åˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹çš„å—é™è·¯å¾„æ•°](https://leetcode.com/problems/number-of-restricted-paths-from-first-to-last-node)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`å›¾`](/leetcode/outline/tag/graph.md) [`æ‹“æ‰‘æ’åº`](/leetcode/outline/tag/topological-sort.md) [`åŠ¨æ€è§„åˆ’`](/leetcode/outline/tag/dynamic-programming.md) [`æœ€çŸ­è·¯`](/leetcode/outline/tag/shortest-path.md) [`å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰`](/leetcode/outline/tag/heap-priority-queue.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/number-of-restricted-paths-from-first-to-last-node)


## é¢˜ç›®

There is an undirected weighted connected graph. You are given a positive
integer `n` which denotes that the graph has `n` nodes labeled from `1` to
`n`, and an array `edges` where each `edges[i] = [ui, vi, weighti]` denotes
that there is an edge between nodes `ui` and `vi` with weight equal to
`weighti`.

A path from node `start` to node `end` is a sequence of nodes `[z0, z1, z2,
..., zk]` such that `z0 = start` and `zk = end` and there is an edge between
`zi` and `zi+1` where `0 <= i <= k-1`.

The distance of a path is the sum of the weights on the edges of the path. Let
`distanceToLastNode(x)` denote the shortest distance of a path between node
`n` and node `x`. A **restricted path** is a path that also satisfies that
`distanceToLastNode(zi) > distanceToLastNode(zi+1)` where `0 <= i <= k-1`.

Return _the number of restricted paths from node_ `1` _to node_ `n`. Since
that number may be too large, return it **modulo** `109 + 7`.



**Example 1:**

![](https://assets.leetcode.com/uploads/2021/02/17/restricted_paths_ex1.png)

> Input: n = 5, edges = [[1,2,3],[1,3,3],[2,3,1],[1,4,2],[5,2,2],[3,5,1],[5,4,10]]
> 
> Output: 3
> 
> Explanation: Each circle contains the node number in black and its distanceToLastNode value in blue. The three restricted paths are:
> 
> 1) 1 --> 2 --> 5
> 
> 2) 1 --> 2 --> 3 --> 5
> 
> 3) 1 --> 3 --> 5

**Example 2:**

![](https://assets.leetcode.com/uploads/2021/02/17/restricted_paths_ex22.png)

> Input: n = 7, edges = [[1,3,1],[4,1,2],[7,3,4],[2,5,3],[5,6,1],[6,7,2],[7,5,3],[2,6,4]]
> 
> Output: 1
> 
> Explanation: Each circle contains the node number in black and its distanceToLastNode value in blue. The only restricted path is 1 --> 3 --> 7.

**Constraints:**

  * `1 <= n <= 2 * 10^4`
  * `n - 1 <= edges.length <= 4 * 10^4`
  * `edges[i].length == 3`
  * `1 <= ui, vi <= n`
  * `ui != vi`
  * `1 <= weighti <= 10^5`
  * There is at most one edge between any two nodes.
  * There is at least one path between any two nodes.


## é¢˜ç›®å¤§æ„

ç°æœ‰ä¸€ä¸ªåŠ æƒæ— å‘è¿é€šå›¾ã€‚ç»™ä½ ä¸€ä¸ªæ­£æ•´æ•° `n` ï¼Œè¡¨ç¤ºå›¾ä¸­æœ‰ `n` ä¸ªèŠ‚ç‚¹ï¼Œå¹¶æŒ‰ä» `1` åˆ° `n` ç»™èŠ‚ç‚¹ç¼–å·ï¼›å¦ç»™ä½ ä¸€ä¸ªæ•°ç»„ `edges`
ï¼Œå…¶ä¸­æ¯ä¸ª `edges[i] = [ui, vi, weighti]` è¡¨ç¤ºå­˜åœ¨ä¸€æ¡ä½äºèŠ‚ç‚¹ `ui` å’Œ `vi` ä¹‹é—´çš„è¾¹ï¼Œè¿™æ¡è¾¹çš„æƒé‡ä¸º
`weighti` ã€‚

ä»èŠ‚ç‚¹ `start` å‡ºå‘åˆ°èŠ‚ç‚¹ `end` çš„è·¯å¾„æ˜¯ä¸€ä¸ªå½¢å¦‚ `[z0, z1, z2, ..., zk]` çš„èŠ‚ç‚¹åºåˆ—ï¼Œæ»¡è¶³ `z0 = start`
ã€`zk = end` ä¸”åœ¨æ‰€æœ‰ç¬¦åˆ `0 <= i <= k-1` çš„èŠ‚ç‚¹ `zi` å’Œ `zi+1` ä¹‹é—´å­˜åœ¨ä¸€æ¡è¾¹ã€‚

è·¯å¾„çš„è·ç¦»å®šä¹‰ä¸ºè¿™æ¡è·¯å¾„ä¸Šæ‰€æœ‰è¾¹çš„æƒé‡æ€»å’Œã€‚ç”¨ `distanceToLastNode(x)` è¡¨ç¤ºèŠ‚ç‚¹ `n` å’Œ `x`
ä¹‹é—´è·¯å¾„çš„æœ€çŸ­è·ç¦»ã€‚**å—é™è·¯å¾„** ä¸ºæ»¡è¶³ `distanceToLastNode(zi) > distanceToLastNode(zi+1)`
çš„ä¸€æ¡è·¯å¾„ï¼Œå…¶ä¸­ `0 <= i <= k-1` ã€‚

è¿”å›ä»èŠ‚ç‚¹ `1` å‡ºå‘åˆ°èŠ‚ç‚¹ `n` çš„ **å—é™è·¯å¾„æ•°** ã€‚ç”±äºæ•°å­—å¯èƒ½å¾ˆå¤§ï¼Œè¯·è¿”å›å¯¹ `109 + 7` **å–ä½™** çš„ç»“æœã€‚

**ç¤ºä¾‹ 1ï¼š**

![](https://assets.leetcode-cn.com/aliyun-lc-
upload/uploads/2021/03/07/restricted_paths_ex1.png)

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** n = 5, edges = [[1,2,3],[1,3,3],[2,3,1],[1,4,2],[5,2,2],[3,5,1],[5,4,10]]
> 
> **è¾“å‡ºï¼š** 3
> 
> **è§£é‡Šï¼š** æ¯ä¸ªåœ†åŒ…å«é»‘è‰²çš„èŠ‚ç‚¹ç¼–å·å’Œè“è‰²çš„ distanceToLastNode å€¼ã€‚ä¸‰æ¡å—é™è·¯å¾„åˆ†åˆ«æ˜¯ï¼š
> 
> 1) 1 --> 2 --> 5
> 
> 2) 1 --> 2 --> 3 --> 5
> 
> 3) 1 --> 3 --> 5
> 
> 

**ç¤ºä¾‹ 2ï¼š**

![](https://assets.leetcode-cn.com/aliyun-lc-
upload/uploads/2021/03/07/restricted_paths_ex22.png)

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** n = 7, edges = [[1,3,1],[4,1,2],[7,3,4],[2,5,3],[5,6,1],[6,7,2],[7,5,3],[2,6,4]]
> 
> **è¾“å‡ºï¼š** 1
> 
> **è§£é‡Šï¼š** æ¯ä¸ªåœ†åŒ…å«é»‘è‰²çš„èŠ‚ç‚¹ç¼–å·å’Œè“è‰²çš„ distanceToLastNode å€¼ã€‚å”¯ä¸€ä¸€æ¡å—é™è·¯å¾„æ˜¯ï¼š1 --> 3 --> 7 ã€‚

**æç¤ºï¼š**

  * `1 <= n <= 2 * 10^4`
  * `n - 1 <= edges.length <= 4 * 10^4`
  * `edges[i].length == 3`
  * `1 <= ui, vi <= n`
  * `ui != vi`
  * `1 <= weighti <= 10^5`
  * ä»»æ„ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´è‡³å¤šå­˜åœ¨ä¸€æ¡è¾¹
  * ä»»æ„ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´è‡³å°‘å­˜åœ¨ä¸€æ¡è·¯å¾„


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

:::: md-demo ç›¸å…³é¢˜ç›®
- [2192. æœ‰å‘æ— ç¯å›¾ä¸­ä¸€ä¸ªèŠ‚ç‚¹çš„æ‰€æœ‰ç¥–å…ˆ](https://leetcode.com/problems/all-ancestors-of-a-node-in-a-directed-acyclic-graph)
- [2642. è®¾è®¡å¯ä»¥æ±‚æœ€çŸ­è·¯å¾„çš„å›¾ç±»](https://leetcode.com/problems/design-graph-with-shortest-path-calculator)
- [2662. å‰å¾€ç›®æ ‡çš„æœ€å°ä»£ä»·](https://leetcode.com/problems/minimum-cost-of-a-path-with-special-roads)

::::
