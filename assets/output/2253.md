---
title: 2253. åŠ¨æ€å–æ¶ˆè¡¨çš„æ—‹è½¬ ğŸ”’
description: LeetCode,2253. åŠ¨æ€å–æ¶ˆè¡¨çš„æ—‹è½¬ ğŸ”’,åŠ¨æ€å–æ¶ˆè¡¨çš„æ—‹è½¬,Dynamic Unpivoting of a Table,è§£é¢˜æ€è·¯,æ•°æ®åº“
keywords:
  - LeetCode
  - 2253. åŠ¨æ€å–æ¶ˆè¡¨çš„æ—‹è½¬ ğŸ”’
  - åŠ¨æ€å–æ¶ˆè¡¨çš„æ—‹è½¬
  - Dynamic Unpivoting of a Table
  - è§£é¢˜æ€è·¯
  - æ•°æ®åº“
---

# 2253. åŠ¨æ€å–æ¶ˆè¡¨çš„æ—‹è½¬ ğŸ”’

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/dynamic-unpivoting-of-a-table) [`LeetCode`](https://leetcode.com/problems/dynamic-unpivoting-of-a-table)

## é¢˜ç›®

Table: `Products`

> 
> 
> 
> 
> 
> +-------------+---------+
> 
> | Column Name | Type> 
> |
> 
> +-------------+---------+
> 
> | product_id  | int> 
>  |
> 
> | store_name1 | int> 
>  |
> 
> | store_name2 | int> 
>  |
> 
> |> 
>   :> 
>   | int> 
>  |
> 
> |> 
>   :> 
>   | int> 
>  |
> 
> |> 
>   :> 
>   | int> 
>  |
> 
> | store_namen | int> 
>  |
> 
> +-------------+---------+
> 
> product_id is the primary key for this table.
> 
> Each row in this table indicates the product's price in n different stores.
> 
> If the product is not available in a store, the price will be null in that store's column.
> 
> The names of the stores may change from one testcase to another. There will be at least 1 store and at most 30 stores.
> 
> 



**Important note:** This problem targets those who have a good experience with
SQL. If you are a beginner, we recommend that you skip it for now.

Implement the procedure `UnpivotProducts` to reorganize the `Products` table
so that each row has the id of one product, the name of a store where it is
sold, and its price in that store. If a product is not available in a store,
do **not** include a row with that `product_id` and `store` combination in the
result table. There should be three columns: `product_id`, `store`, and
`price`.

The procedure should return the table after reorganizing it.

Return the result table in **any order**.

The query result format is in the following example.



**Example 1:**

> Input: 
> 
> Products table:
> 
> +------------+----------+--------+------+------+
> 
> | product_id | LC_Store | Nozama | Shop | Souq |
> 
> +------------+----------+--------+------+------+
> 
> | 1> 
> > 
>   | 100> 
>   | null   | 110  | null |
> 
> | 2> 
> > 
>   | null> 
>  | 200> 
> | null | 190  |
> 
> | 3> 
> > 
>   | null> 
>  | null   | 1000 | 1900 |
> 
> +------------+----------+--------+------+------+
> 
> Output: 
> 
> +------------+----------+-------+
> 
> | product_id | store> 
> | price |
> 
> +------------+----------+-------+
> 
> | 1> 
> > 
>   | LC_Store | 100   |
> 
> | 1> 
> > 
>   | Shop> 
>  | 110   |
> 
> | 2> 
> > 
>   | Nozama   | 200   |
> 
> | 2> 
> > 
>   | Souq> 
>  | 190   |
> 
> | 3> 
> > 
>   | Shop> 
>  | 1000  |
> 
> | 3> 
> > 
>   | Souq> 
>  | 1900  |
> 
> +------------+----------+-------+
> 
> Explanation: 
> 
> Product 1 is sold in LC_Store and Shop with prices of 100 and 110 respectively.
> 
> Product 2 is sold in Nozama and Souq with prices of 200 and 190.
> 
> Product 3 is sold in Shop and Souq with prices of 1000 and 1900.
> 
> 


## é¢˜ç›®å¤§æ„

è¡¨: `Products`

> 
> 
> 
> 
> 
> +-------------+---------+
> 
> | Column Name | Type> 
> |
> 
> +-------------+---------+
> 
> | product_id  | int> 
>  |
> 
> | store_name1 | int> 
>  |
> 
> | store_name2 | int> 
>  |
> 
> |> 
>   :> 
>   | int> 
>  |
> 
> |> 
>   :> 
>   | int> 
>  |
> 
> |> 
>   :> 
>   | int> 
>  |
> 
> | store_namen | int> 
>  |
> 
> +-------------+---------+
> 
> product_id æ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚
> 
> è¯¥è¡¨ä¸­çš„æ¯ä¸€è¡Œéƒ½è¡¨ç¤ºè¯¥å•†å“åœ¨ n ä¸ªä¸åŒå•†åº—ä¸­çš„ä»·æ ¼ã€‚
> 
> å¦‚æœå•†åº—ä¸­æ²¡æœ‰è¯¥å•†å“ï¼Œåˆ™è¯¥å•†åº—åˆ—ä¸­çš„ä»·æ ¼å°†ä¸º nullã€‚
> 
> ä¸åŒæµ‹è¯•ç”¨ä¾‹çš„å•†åº—åç§°å¯èƒ½ä¼šä¸åŒã€‚è‡³å°‘æœ‰1å®¶åº—ï¼Œæœ€å¤š30å®¶åº—ã€‚
> 
> 



**é‡è¦æç¤º:** è¿™ä¸ªé—®é¢˜é’ˆå¯¹çš„æ˜¯é‚£äº›å¯¹ SQL æœ‰ä¸°å¯Œç»éªŒçš„äººã€‚å¦‚æœä½ æ˜¯åˆå­¦è€…ï¼Œæˆ‘ä»¬å»ºè®®ä½ ç°åœ¨è·³è¿‡å®ƒã€‚

å®ç° `UnpivotProducts` è¿‡ç¨‹æ¥é‡æ–°ç»„ç»‡ `Products` è¡¨ï¼Œä½¿æ¯ä¸€è¡Œéƒ½æœ‰ä¸€ä¸ªäº§å“çš„
idã€é”€å”®è¯¥å•†å“çš„å•†åº—åç§°ä»¥åŠè¯¥å•†å“åœ¨è¯¥å•†åº—ä¸­çš„ä»·æ ¼ã€‚å¦‚æœæŸä¸ªå•†å“åœ¨æŸä¸ªå•†åº—ä¸­ä¸å¯ç”¨ï¼Œåˆ™ä¸è¦åœ¨ç»“æœè¡¨ä¸­åŒ…å«è¯¥ `product_id` å’Œ `store`
ç»„åˆçš„è¡Œã€‚ç»“æœåº”è¯¥æœ‰ä¸‰åˆ—:`product_id`ã€`store` å’Œ `price`ã€‚

è¿‡ç¨‹åº”è¯¥åœ¨é‡æ–°ç»„ç»‡è¡¨ä¹‹åè¿”å›å®ƒã€‚

ä»¥ **ä»»æ„é¡ºåº  **è¿”å›ç»“æœè¡¨ã€‚

æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1:**

> 
> 
> 
> 
> 
> **è¾“å…¥:** 
> 
> Products è¡¨:
> 
> +------------+----------+--------+------+------+
> 
> | product_id | LC_Store | Nozama | Shop | Souq |
> 
> +------------+----------+--------+------+------+
> 
> | 1> 
> > 
>   | 100> 
>   | null   | 110  | null |
> 
> | 2> 
> > 
>   | null> 
>  | 200> 
> | null | 190  |
> 
> | 3> 
> > 
>   | null> 
>  | null   | 1000 | 1900 |
> 
> +------------+----------+--------+------+------+
> 
> **è¾“å‡º:** 
> 
> +------------+----------+-------+
> 
> | product_id | store> 
> | price |
> 
> +------------+----------+-------+
> 
> | 1> 
> > 
>   | LC_Store | 100   |
> 
> | 1> 
> > 
>   | Shop> 
>  | 110   |
> 
> | 2> 
> > 
>   | Nozama   | 200   |
> 
> | 2> 
> > 
>   | Souq> 
>  | 190   |
> 
> | 3> 
> > 
>   | Shop> 
>  | 1000  |
> 
> | 3> 
> > 
>   | Souq> 
>  | 1900  |
> 
> +------------+----------+-------+
> 
> **è§£é‡Š:** 
> 
> å•†å“ 1 åœ¨ LC_Store å’Œ Shop é”€å”®ï¼Œä»·æ ¼åˆ†åˆ«ä¸º 100 å’Œ 110ã€‚
> 
> å•†å“ 2 åœ¨ Nozama å’Œ Souq é”€å”®ï¼Œä»·æ ¼åˆ†åˆ«ä¸º 200 å’Œ 190ã€‚
> 
> å•†å“ 3 åœ¨ Shop å’Œ Souq å‡ºå”®ï¼Œä»·æ ¼åˆ†åˆ«ä¸º 1000 å’Œ 1900ã€‚


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ | åŠ›æ‰£ |
| :------: | :------ | :------: | :------ | :------ | :------: |
| 1795 | æ¯ä¸ªäº§å“åœ¨ä¸åŒå•†åº—çš„ä»·æ ¼ |  |  [`æ•°æ®åº“`](/tag/database.md) | <font color=#15bd66>Easy</font> | [ğŸ€„ï¸](https://leetcode.cn/problems/rearrange-products-table) [ğŸ”—](https://leetcode.com/problems/rearrange-products-table) |