# [3188. æŸ¥æ‰¾å¾—åˆ†æœ€é«˜çš„å­¦ç”Ÿ II](https://leetcode.com/problems/find-top-scoring-students-ii)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/find-top-scoring-students-ii)

## é¢˜ç›®

Table: `students`

> 
> 
> 
> 
> 
> +-------------+----------+
> 
> | Column Name | Type> 
>  | 
> 
> +-------------+----------+
> 
> | student_id  | int> 
>   |
> 
> | name> 
> > 
> | varchar  |
> 
> | major> 
>    | varchar  |
> 
> +-------------+----------+
> 
> student_id is the primary key for this table. 
> 
> Each row contains the student ID, student name, and their major.
> 
> 

Table: `courses`

> 
> 
> 
> 
> 
> +-------------+-------------------+
> 
> | Column Name | Type> 
> > 
> > 
>   |> 
>    
> 
> +-------------+-------------------+
> 
> | course_id   | int> 
> > 
> > 
>    |> 
> 
> 
> | name> 
> > 
> | varchar> 
> > 
>    |> 
>   
> 
> | credits> 
>  | int> 
> > 
> > 
>    |> 
> > 
>    
> 
> | major> 
>    | varchar> 
> > 
>    |> 
>    
> 
> | mandatory   | enum> 
> > 
> > 
>   |> 
>   
> 
> +-------------+-------------------+
> 
> course_id is the primary key for this table. 
> 
> mandatory is an enum type of ('Yes', 'No').
> 
> Each row contains the course ID, course name, credits, major it belongs to, and whether the course is mandatory.
> 
> 

Table: `enrollments`

> 
> 
> 
> 
> 
> +-------------+----------+
> 
> | Column Name | Type> 
>  | 
> 
> +-------------+----------+
> 
> | student_id  | int> 
>   |
> 
> | course_id   | int> 
>   |
> 
> | semester> 
> | varchar  |
> 
> | grade> 
>    | varchar  |
> 
> | GPA> 
> > 
>  | decimal  | 
> 
> +-------------+----------+
> 
> (student_id, course_id, semester) is the primary key (combination of columns with unique values) for this table.
> 
> Each row contains the student ID, course ID, semester, and grade received.
> 
> 

Write a solution to find the students who meet the following criteria:

  * Have**taken all mandatory courses** and **at least two** elective courses offered in **their major.**
  * Achieved a grade of **A**  in **all mandatory courses** and at least **B**  in**elective courses**.
  * Maintained an average `GPA` of at least `2.5` across all their courses (including those outside their major).

Return _the result table ordered by_ `student_id` _in**ascending** order_.



**Example:**

**Input:**

students table:

> 
> 
> 
> 
> 
>  +------------+------------------+------------------+
> 
>  | student_id | name> 
> > 
> > 
>  | major> 
> > 
> > 
> |
> 
>  +------------+------------------+------------------+
> 
>  | 1> 
> > 
>   | Alice> 
> > 
> > 
> | Computer Science |
> 
>  | 2> 
> > 
>   | Bob> 
> > 
> > 
>   | Computer Science |
> 
>  | 3> 
> > 
>   | Charlie> 
> > 
>   | Mathematics> 
>   |
> 
>  | 4> 
> > 
>   | David> 
> > 
> > 
> | Mathematics> 
>   |
> 
>  +------------+------------------+------------------+
> 
>  

courses table:

> 
> 
> 
> 
> 
>  +-----------+-------------------+---------+------------------+----------+
> 
>  | course_id | name> 
> > 
> > 
>   | credits | major> 
> > 
> > 
> | mandatory|
> 
>  +-----------+-------------------+---------+------------------+----------+
> 
>  | 101> 
>    | Algorithms> 
> > 
> | 3> 
>    | Computer Science | yes> 
>   |
> 
>  | 102> 
>    | Data Structures   | 3> 
>    | Computer Science | yes> 
>   |
> 
>  | 103> 
>    | Calculus> 
> > 
>   | 4> 
>    | Mathematics> 
>   | yes> 
>   |
> 
>  | 104> 
>    | Linear Algebra> 
> | 4> 
>    | Mathematics> 
>   | yes> 
>   |
> 
>  | 105> 
>    | Machine Learning  | 3> 
>    | Computer Science | no> 
>    |
> 
>  | 106> 
>    | Probability> 
>    | 3> 
>    | Mathematics> 
>   | no> 
>    |
> 
>  | 107> 
>    | Operating Systems | 3> 
>    | Computer Science | no> 
>    |
> 
>  | 108> 
>    | Statistics> 
> > 
> | 3> 
>    | Mathematics> 
>   | no> 
>    |
> 
>  +-----------+-------------------+---------+------------------+----------+
> 
>  

enrollments table:

> 
> 
> 
> 
> 
>  +------------+-----------+-------------+-------+-----+
> 
>  | student_id | course_id | semester> 
> | grade | GPA |
> 
>  +------------+-----------+-------------+-------+-----+
> 
>  | 1> 
> > 
>   | 101> 
>    | Fall 2023   | A> 
>  | 4.0 |
> 
>  | 1> 
> > 
>   | 102> 
>    | Spring 2023 | A> 
>  | 4.0 |
> 
>  | 1> 
> > 
>   | 105> 
>    | Spring 2023 | A> 
>  | 4.0 |
> 
>  | 1> 
> > 
>   | 107> 
>    | Fall 2023   | B> 
>  | 3.5 |
> 
>  | 2> 
> > 
>   | 101> 
>    | Fall 2023   | A> 
>  | 4.0 |
> 
>  | 2> 
> > 
>   | 102> 
>    | Spring 2023 | B> 
>  | 3.0 |
> 
>  | 3> 
> > 
>   | 103> 
>    | Fall 2023   | A> 
>  | 4.0 |
> 
>  | 3> 
> > 
>   | 104> 
>    | Spring 2023 | A> 
>  | 4.0 |
> 
>  | 3> 
> > 
>   | 106> 
>    | Spring 2023 | A> 
>  | 4.0 |
> 
>  | 3> 
> > 
>   | 108> 
>    | Fall 2023   | B> 
>  | 3.5 |
> 
>  | 4> 
> > 
>   | 103> 
>    | Fall 2023   | B> 
>  | 3.0 |
> 
>  | 4> 
> > 
>   | 104> 
>    | Spring 2023 | B> 
>  | 3.0 |
> 
>  +------------+-----------+-------------+-------+-----+
> 
>  

**Output:**

> 
> 
> 
> 
> 
>  +------------+
> 
>  | student_id |
> 
>  +------------+
> 
>  | 1> 
> > 
>   |
> 
>  | 3> 
> > 
>   |
> 
>  +------------+
> 
>  

**Explanation:**

  * Alice (student_id 1) is a Computer Science major and has taken both Algorithms and Data Structures, receiving an A in both. She has also taken Machine Learning and Operating Systems as electives, receiving an A and B respectively.
  * Bob (student_id 2) is a Computer Science major but did not receive an A in all required courses.
  * Charlie (student_id 3) is a Mathematics major and has taken both Calculus and Linear Algebra, receiving an A in both. He has also taken Probability and Statistics as electives, receiving an A and B respectively.
  * David (student_id 4) is a Mathematics major but did not receive an A in all required courses.

**Note:** Output table is ordered by student_id in ascending order.


## é¢˜ç›®å¤§æ„

è¡¨ï¼š`students`

> 
> 
> 
> 
> 
> +-------------+----------+
> 
> | Column Name | Type> 
>  | 
> 
> +-------------+----------+
> 
> | student_id  | int> 
>   |
> 
> | name> 
> > 
> | varchar  |
> 
> | major> 
>    | varchar  |
> 
> +-------------+----------+
> 
> student_id æ˜¯è¿™å¼ è¡¨çš„ä¸»é”®ï¼ˆæœ‰ä¸åŒå€¼çš„åˆ—çš„ç»„åˆï¼‰ã€‚
> 
> è¿™å¼ è¡¨çš„æ¯ä¸€è¡ŒåŒ…å«å­¦ç”Ÿ IDï¼Œå­¦ç”Ÿå§“åå’Œä»–ä»¬çš„ä¸“ä¸šã€‚
> 
> 

è¡¨ï¼š`courses`

> 
> 
> 
> 
> 
> +-------------+-------------------+
> 
> | Column Name | Type> 
> > 
> > 
>   |> 
>    
> 
> +-------------+-------------------+
> 
> | course_id   | int> 
> > 
> > 
>    |> 
> 
> 
> | name> 
> > 
> | varchar> 
> > 
>    |> 
>   
> 
> | credits> 
>  | int> 
> > 
> > 
>    |> 
> > 
>    
> 
> | major> 
>    | varchar> 
> > 
>    |> 
>    
> 
> | mandatory   | enum> 
> > 
> > 
>   |> 
>   
> 
> +-------------+-------------------+
> 
> course_id æ˜¯è¿™å¼ è¡¨çš„ä¸»é”®ã€‚ 
> 
> mandatory æ˜¯ ('Yes', 'No') çš„æšä¸¾ç±»å‹ã€‚
> 
> æ¯ä¸€è¡ŒåŒ…å«è¯¾ç¨‹ IDï¼Œè¯¾ç¨‹åï¼Œå­¦åˆ†ï¼Œæ‰€å±ä¸“ä¸šï¼Œä»¥åŠè¯¥è¯¾ç¨‹æ˜¯å¦å¿…ä¿®ã€‚
> 
> 

è¡¨ï¼š`enrollments`

> 
> 
> 
> 
> 
> +-------------+----------+
> 
> | Column Name | Type> 
>  | 
> 
> +-------------+----------+
> 
> | student_id  | int> 
>   |
> 
> | course_id   | int> 
>   |
> 
> | semester> 
> | varchar  |
> 
> | grade> 
>    | varchar  |
> 
> | GPA> 
> > 
>  | decimal  | 
> 
> +-------------+----------+
> 
> (student_id, course_id, semester) æ˜¯è¿™å¼ è¡¨çš„ä¸»é”®ï¼ˆæœ‰ä¸åŒå€¼çš„åˆ—çš„ç»„åˆï¼‰ã€‚
> 
> è¿™å¼ è¡¨çš„æ¯ä¸€è¡ŒåŒ…å«å­¦ç”Ÿ IDï¼Œè¯¾ç¨‹ IDï¼Œå­¦æœŸå’Œè·å¾—çš„å­¦åˆ†ã€‚
> 
> 

ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ¥æŸ¥æ‰¾æ»¡è¶³ä¸‹è¿°æ ‡å‡†çš„å­¦ç”Ÿï¼š

  * å·²ç» **ä¿®å®Œä»–ä»¬ä¸“ä¸šä¸­æ‰€æœ‰çš„å¿…ä¿®è¯¾ç¨‹** å’Œ **è‡³å°‘ä¸¤ä¸ª  **é€‰ä¿®è¯¾ç¨‹ã€‚
  * åœ¨ **æ‰€æœ‰å¿…ä¿®è¯¾ç¨‹** ä¸­å–å¾—ç­‰çº§ **A** å¹¶ä¸” **é€‰ä¿®è¯¾ç¨‹** è‡³å°‘å–å¾— **B** ã€‚
  * ä¿æŒä»–ä»¬æ‰€æœ‰è¯¾ç¨‹ï¼ˆåŒ…æ‹¬ä¸å±äºä»–ä»¬ä¸“ä¸šçš„ï¼‰çš„å¹³å‡ `GPA` è‡³å°‘åœ¨ `2.5` ä»¥ä¸Šã€‚

è¿”å›ç»“æœè¡¨ä»¥ `student_id` **å‡åº  **æ’åºã€‚



**ç¤ºä¾‹ï¼š**

**è¾“å…¥ï¼š**

students è¡¨ï¼š

> 
> 
> 
> 
> 
>  +------------+------------------+------------------+
> 
>  | student_id | name> 
> > 
> > 
>  | major> 
> > 
> > 
> |
> 
>  +------------+------------------+------------------+
> 
>  | 1> 
> > 
>   | Alice> 
> > 
> > 
> | Computer Science |
> 
>  | 2> 
> > 
>   | Bob> 
> > 
> > 
>   | Computer Science |
> 
>  | 3> 
> > 
>   | Charlie> 
> > 
>   | Mathematics> 
>   |
> 
>  | 4> 
> > 
>   | David> 
> > 
> > 
> | Mathematics> 
>   |
> 
>  +------------+------------------+------------------+
> 
>  

courses è¡¨ï¼š

> 
> 
> 
> 
> 
>  +-----------+-------------------+---------+------------------+----------+
> 
>  | course_id | name> 
> > 
> > 
>   | credits | major> 
> > 
> > 
> | mandatory|
> 
>  +-----------+-------------------+---------+------------------+----------+
> 
>  | 101> 
>    | Algorithms> 
> > 
> | 3> 
>    | Computer Science | yes> 
>   |
> 
>  | 102> 
>    | Data Structures   | 3> 
>    | Computer Science | yes> 
>   |
> 
>  | 103> 
>    | Calculus> 
> > 
>   | 4> 
>    | Mathematics> 
>   | yes> 
>   |
> 
>  | 104> 
>    | Linear Algebra> 
> | 4> 
>    | Mathematics> 
>   | yes> 
>   |
> 
>  | 105> 
>    | Machine Learning  | 3> 
>    | Computer Science | no> 
>    |
> 
>  | 106> 
>    | Probability> 
>    | 3> 
>    | Mathematics> 
>   | no> 
>    |
> 
>  | 107> 
>    | Operating Systems | 3> 
>    | Computer Science | no> 
>    |
> 
>  | 108> 
>    | Statistics> 
> > 
> | 3> 
>    | Mathematics> 
>   | no> 
>    |
> 
>  +-----------+-------------------+---------+------------------+----------+
> 
>  

enrollments è¡¨ï¼š

> 
> 
> 
> 
> 
>  +------------+-----------+-------------+-------+-----+
> 
>  | student_id | course_id | semester> 
> | grade | GPA |
> 
>  +------------+-----------+-------------+-------+-----+
> 
>  | 1> 
> > 
>   | 101> 
>    | Fall 2023   | A> 
>  | 4.0 |
> 
>  | 1> 
> > 
>   | 102> 
>    | Spring 2023 | A> 
>  | 4.0 |
> 
>  | 1> 
> > 
>   | 105> 
>    | Spring 2023 | A> 
>  | 4.0 |
> 
>  | 1> 
> > 
>   | 107> 
>    | Fall 2023   | B> 
>  | 3.5 |
> 
>  | 2> 
> > 
>   | 101> 
>    | Fall 2023   | A> 
>  | 4.0 |
> 
>  | 2> 
> > 
>   | 102> 
>    | Spring 2023 | B> 
>  | 3.0 |
> 
>  | 3> 
> > 
>   | 103> 
>    | Fall 2023   | A> 
>  | 4.0 |
> 
>  | 3> 
> > 
>   | 104> 
>    | Spring 2023 | A> 
>  | 4.0 |
> 
>  | 3> 
> > 
>   | 106> 
>    | Spring 2023 | A> 
>  | 4.0 |
> 
>  | 3> 
> > 
>   | 108> 
>    | Fall 2023   | B> 
>  | 3.5 |
> 
>  | 4> 
> > 
>   | 103> 
>    | Fall 2023   | B> 
>  | 3.0 |
> 
>  | 4> 
> > 
>   | 104> 
>    | Spring 2023 | B> 
>  | 3.0 |
> 
>  +------------+-----------+-------------+-------+-----+
> 
>  

**è¾“å‡ºï¼š**

> 
> 
> 
> 
> 
>  +------------+
> 
>  | student_id |
> 
>  +------------+
> 
>  | 1> 
> > 
>   |
> 
>  | 3> 
> > 
>   |
> 
>  +------------+
> 
>  

**è§£é‡Šï¼š**

  * Alice (student_id 1) æ˜¯è®¡ç®—æœºç§‘å­¦ä¸“ä¸šå¹¶ä¸”ä¿®äº† Algorithms å’Œ Data Structuresï¼Œéƒ½å–å¾—äº† Aã€‚å¥¹åŒæ—¶é€‰ä¿®äº† Machine Learning å’Œ Operating Systemsï¼Œåˆ†åˆ«å–å¾—äº† A å’Œ Bã€‚
  * Bob (student_id 2) æ˜¯è®¡ç®—æœºç§‘å­¦ä¸“ä¸šä½†æ²¡æœ‰åœ¨æ‰€æœ‰éœ€æ±‚çš„è¯¾ç¨‹ä¸­å–å¾— Aã€‚
  * Charlie (student_id 3) æ˜¯æ•°å­¦ä¸“ä¸šå¹¶ä¸”ä¿®äº† Calculus å’Œ Linear Algebraï¼Œéƒ½å–å¾—äº† Aã€‚ä»–åŒæ—¶é€‰ä¿®äº† Probability å’Œ Statisticsï¼Œåˆ†åˆ«å–å¾—äº† A å’Œ Bã€‚
  * David (student_id 4) æ˜¯æ•°å­¦ä¸“ä¸šä½†æ²¡æœ‰åœ¨æ‰€æœ‰éœ€è¦çš„è¯¾ç¨‹ä¸­å–å¾— Aã€‚

**æ³¨æ„ï¼š** è¾“å‡ºè¡¨ä»¥ student_id å‡åºæ’åºã€‚


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```