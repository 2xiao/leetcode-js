# [1479. å‘¨å†…æ¯å¤©çš„é”€å”®æƒ…å†µ](https://leetcode.com/problems/sales-by-day-of-the-week)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/sales-by-day-of-the-week)

## é¢˜ç›®

Table: `Orders`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | order_id> 
>   | int> 
>  |
> 
> | customer_id   | int> 
>  |
> 
> | order_date> 
> | date> 
> | 
> 
> | item_id> 
>    | varchar |
> 
> | quantity> 
>   | int> 
>  |
> 
> +---------------+---------+
> 
> (ordered_id, item_id) is the primary key (combination of columns with unique values) for this table.
> 
> This table contains information on the orders placed.
> 
> order_date is the date item_id was ordered by the customer with id customer_id.
> 
> 



Table: `Items`

> 
> 
> 
> 
> 
> +---------------------+---------+
> 
> | Column Name> 
> > 
>  | Type> 
> |
> 
> +---------------------+---------+
> 
> | item_id> 
> > 
> > 
>  | varchar |
> 
> | item_name> 
> > 
>    | varchar |
> 
> | item_category> 
>    | varchar |
> 
> +---------------------+---------+
> 
> item_id is the primary key (column with unique values) for this table.
> 
> item_name is the name of the item.
> 
> item_category is the category of the item.
> 
> 



You are the business owner and would like to obtain a sales report for
category items and the day of the week.

Write a solution to report how many units in each category have been ordered
on each **day of the week**.

Return the result table **ordered** by `category`.

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Orders table:
> 
> +------------+--------------+-------------+--------------+-------------+
> 
> | order_id   | customer_id  | order_date  | item_id> 
>   | quantity> 
> |
> 
> +------------+--------------+-------------+--------------+-------------+
> 
> | 1> 
> > 
>   | 1> 
> > 
> > 
> | 2020-06-01  | 1> 
> > 
> > 
> | 10> 
> > 
>   |
> 
> | 2> 
> > 
>   | 1> 
> > 
> > 
> | 2020-06-08  | 2> 
> > 
> > 
> | 10> 
> > 
>   |
> 
> | 3> 
> > 
>   | 2> 
> > 
> > 
> | 2020-06-02  | 1> 
> > 
> > 
> | 5> 
> > 
>    |
> 
> | 4> 
> > 
>   | 3> 
> > 
> > 
> | 2020-06-03  | 3> 
> > 
> > 
> | 5> 
> > 
>    |
> 
> | 5> 
> > 
>   | 4> 
> > 
> > 
> | 2020-06-04  | 4> 
> > 
> > 
> | 1> 
> > 
>    |
> 
> | 6> 
> > 
>   | 4> 
> > 
> > 
> | 2020-06-05  | 5> 
> > 
> > 
> | 5> 
> > 
>    |
> 
> | 7> 
> > 
>   | 5> 
> > 
> > 
> | 2020-06-05  | 1> 
> > 
> > 
> | 10> 
> > 
>   |
> 
> | 8> 
> > 
>   | 5> 
> > 
> > 
> | 2020-06-14  | 4> 
> > 
> > 
> | 5> 
> > 
>    |
> 
> | 9> 
> > 
>   | 5> 
> > 
> > 
> | 2020-06-21  | 3> 
> > 
> > 
> | 5> 
> > 
>    |
> 
> +------------+--------------+-------------+--------------+-------------+
> 
> Items table:
> 
> +------------+----------------+---------------+
> 
> | item_id> 
> | item_name> 
>   | item_category |
> 
> +------------+----------------+---------------+
> 
> | 1> 
> > 
>   | LC Alg. Book   | Book> 
> > 
>   |
> 
> | 2> 
> > 
>   | LC DB. Book> 
> | Book> 
> > 
>   |
> 
> | 3> 
> > 
>   | LC SmarthPhone | Phone> 
> > 
>  |
> 
> | 4> 
> > 
>   | LC Phone 2020  | Phone> 
> > 
>  |
> 
> | 5> 
> > 
>   | LC SmartGlass  | Glasses> 
>    |
> 
> | 6> 
> > 
>   | LC T-Shirt XL  | T-Shirt> 
>    |
> 
> +------------+----------------+---------------+
> 
> Output: 
> 
> +------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+
> 
> | Category   | Monday> 
> | Tuesday   | Wednesday | Thursday  | Friday> 
> | Saturday  | Sunday> 
> |
> 
> +------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+
> 
> | Book> 
>    | 20> 
> > 
> | 5> 
> > 
>  | 0> 
> > 
>  | 0> 
> > 
>  | 10> 
> > 
> | 0> 
> > 
>  | 0> 
> > 
>  |
> 
> | Glasses> 
> | 0> 
> > 
>  | 0> 
> > 
>  | 0> 
> > 
>  | 0> 
> > 
>  | 5> 
> > 
>  | 0> 
> > 
>  | 0> 
> > 
>  |
> 
> | Phone> 
>   | 0> 
> > 
>  | 0> 
> > 
>  | 5> 
> > 
>  | 1> 
> > 
>  | 0> 
> > 
>  | 0> 
> > 
>  | 10> 
> > 
> |
> 
> | T-Shirt> 
> | 0> 
> > 
>  | 0> 
> > 
>  | 0> 
> > 
>  | 0> 
> > 
>  | 0> 
> > 
>  | 0> 
> > 
>  | 0> 
> > 
>  |
> 
> +------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+
> 
> Explanation: 
> 
> On Monday (2020-06-01, 2020-06-08) were sold a total of 20 units (10 + 10) in the category Book (ids: 1, 2).
> 
> On Tuesday (2020-06-02) were sold a total of 5 units in the category Book (ids: 1, 2).
> 
> On Wednesday (2020-06-03) were sold a total of 5 units in the category Phone (ids: 3, 4).
> 
> On Thursday (2020-06-04) were sold a total of 1 unit in the category Phone (ids: 3, 4).
> 
> On Friday (2020-06-05) were sold 10 units in the category Book (ids: 1, 2) and 5 units in Glasses (ids: 5).
> 
> On Saturday there are no items sold.
> 
> On Sunday (2020-06-14, 2020-06-21) were sold a total of 10 units (5 +5) in the category Phone (ids: 3, 4).
> 
> There are no sales of T-shirts.
> 
> 


## é¢˜ç›®å¤§æ„

è¡¨ï¼š`Orders`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | order_id> 
>   | int> 
>  |
> 
> | customer_id   | int> 
>  |
> 
> | order_date> 
> | date> 
> | 
> 
> | item_id> 
>    | varchar |
> 
> | quantity> 
>   | int> 
>  |
> 
> +---------------+---------+
> 
> (order_id, item_id) æ˜¯è¯¥è¡¨ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—çš„ç»„åˆ)
> 
> è¯¥è¡¨åŒ…å«äº†è®¢å•ä¿¡æ¯
> 
> order_date æ˜¯idä¸º item_id çš„å•†å“è¢«idä¸º customer_id çš„æ¶ˆè´¹è€…è®¢è´­çš„æ—¥æœŸ.

è¡¨ï¼š`Items`

> 
> 
> 
> 
> 
> +---------------------+---------+
> 
> | Column Name> 
> > 
>  | Type> 
> |
> 
> +---------------------+---------+
> 
> | item_id> 
> > 
> > 
>  | varchar |
> 
> | item_name> 
> > 
>    | varchar |
> 
> | item_category> 
>    | varchar |
> 
> +---------------------+---------+
> 
> item_id æ˜¯è¯¥è¡¨ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)
> 
> item_name æ˜¯å•†å“çš„åå­—
> 
> item_category æ˜¯å•†å“çš„ç±»åˆ«
> 
> 



ä½ æ˜¯ä¼ä¸šä¸»ï¼Œæƒ³è¦è·å¾—åˆ†ç±»å•†å“å’Œå‘¨å†…æ¯å¤©çš„é”€å”®æŠ¥å‘Šã€‚

ç¼–å†™è§£å†³æ–¹æ¡ˆï¼ŒæŠ¥å‘Š **å‘¨å†…æ¯å¤©** æ¯ä¸ªå•†å“ç±»åˆ«ä¸‹è®¢è´­äº†å¤šå°‘å•ä½ã€‚

è¿”å›ç»“æœè¡¨å•**æŒ‰å•†å“ç±»åˆ«æ’åº** ã€‚

ç»“æœæ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š**
> 
> Orders è¡¨ï¼š
> 
> +------------+--------------+-------------+--------------+-------------+
> 
> | order_id   | customer_id  | order_date  | item_id> 
>   | quantity> 
> |
> 
> +------------+--------------+-------------+--------------+-------------+
> 
> | 1> 
> > 
>   | 1> 
> > 
> > 
> | 2020-06-01  | 1> 
> > 
> > 
> | 10> 
> > 
>   |
> 
> | 2> 
> > 
>   | 1> 
> > 
> > 
> | 2020-06-08  | 2> 
> > 
> > 
> | 10> 
> > 
>   |
> 
> | 3> 
> > 
>   | 2> 
> > 
> > 
> | 2020-06-02  | 1> 
> > 
> > 
> | 5> 
> > 
>    |
> 
> | 4> 
> > 
>   | 3> 
> > 
> > 
> | 2020-06-03  | 3> 
> > 
> > 
> | 5> 
> > 
>    |
> 
> | 5> 
> > 
>   | 4> 
> > 
> > 
> | 2020-06-04  | 4> 
> > 
> > 
> | 1> 
> > 
>    |
> 
> | 6> 
> > 
>   | 4> 
> > 
> > 
> | 2020-06-05  | 5> 
> > 
> > 
> | 5> 
> > 
>    |
> 
> | 7> 
> > 
>   | 5> 
> > 
> > 
> | 2020-06-05  | 1> 
> > 
> > 
> | 10> 
> > 
>   |
> 
> | 8> 
> > 
>   | 5> 
> > 
> > 
> | 2020-06-14  | 4> 
> > 
> > 
> | 5> 
> > 
>    |
> 
> | 9> 
> > 
>   | 5> 
> > 
> > 
> | 2020-06-21  | 3> 
> > 
> > 
> | 5> 
> > 
>    |
> 
> +------------+--------------+-------------+--------------+-------------+
> 
> 
> 
> Items è¡¨ï¼š
> 
> +------------+----------------+---------------+
> 
> | item_id> 
> | item_name> 
>   | item_category |
> 
> +------------+----------------+---------------+
> 
> | 1> 
> > 
>   | LC Alg. Book   | Book> 
> > 
>   |
> 
> | 2> 
> > 
>   | LC DB. Book> 
> | Book> 
> > 
>   |
> 
> | 3> 
> > 
>   | LC SmarthPhone | Phone> 
> > 
>  |
> 
> | 4> 
> > 
>   | LC Phone 2020  | Phone> 
> > 
>  |
> 
> | 5> 
> > 
>   | LC SmartGlass  | Glasses> 
>    |
> 
> | 6> 
> > 
>   | LC T-Shirt XL  | T-Shirt> 
>    |
> 
> +------------+----------------+---------------+
> 
> **è¾“å‡ºï¼š**
> 
> +------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+
> 
> | Category   | Monday> 
> | Tuesday   | Wednesday | Thursday  | Friday> 
> | Saturday  | Sunday> 
> |
> 
> +------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+
> 
> | Book> 
>    | 20> 
> > 
> | 5> 
> > 
>  | 0> 
> > 
>  | 0> 
> > 
>  | 10> 
> > 
> | 0> 
> > 
>  | 0> 
> > 
>  |
> 
> | Glasses> 
> | 0> 
> > 
>  | 0> 
> > 
>  | 0> 
> > 
>  | 0> 
> > 
>  | 5> 
> > 
>  | 0> 
> > 
>  | 0> 
> > 
>  |
> 
> | Phone> 
>   | 0> 
> > 
>  | 0> 
> > 
>  | 5> 
> > 
>  | 1> 
> > 
>  | 0> 
> > 
>  | 0> 
> > 
>  | 10> 
> > 
> |
> 
> | T-Shirt> 
> | 0> 
> > 
>  | 0> 
> > 
>  | 0> 
> > 
>  | 0> 
> > 
>  | 0> 
> > 
>  | 0> 
> > 
>  | 0> 
> > 
>  |
> 
> +------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+
> 
> **è§£é‡Šï¼š**
> 
> åœ¨å‘¨ä¸€(2020-06-01, 2020-06-08)ï¼ŒBookåˆ†ç±»(ids: 1, 2)ä¸‹ï¼Œæ€»å…±é”€å”®äº†20ä¸ªå•ä½(10 + 10)
> 
> åœ¨å‘¨äºŒ(2020-06-02)ï¼ŒBookåˆ†ç±»(ids: 1, 2)ä¸‹ï¼Œæ€»å…±é”€å”®äº†5ä¸ªå•ä½
> 
> åœ¨å‘¨ä¸‰(2020-06-03)ï¼ŒPhoneåˆ†ç±»(ids: 3, 4)ä¸‹ï¼Œæ€»å…±é”€å”®äº†5ä¸ªå•ä½
> 
> åœ¨å‘¨å››(2020-06-04)ï¼ŒPhoneåˆ†ç±»(ids: 3, 4)ä¸‹ï¼Œæ€»å…±é”€å”®äº†1ä¸ªå•ä½
> 
> åœ¨å‘¨äº”(2020-06-05)ï¼ŒBookåˆ†ç±»(ids: 1, 2)ä¸‹ï¼Œæ€»å…±é”€å”®äº†10ä¸ªå•ä½ï¼ŒGlassesåˆ†ç±»(ids: 5)ä¸‹ï¼Œæ€»å…±é”€å”®äº†5ä¸ªå•ä½
> 
> åœ¨å‘¨å…­, æ²¡æœ‰å•†å“é”€å”®
> 
> åœ¨å‘¨å¤©(2020-06-14, 2020-06-21)ï¼ŒPhoneåˆ†ç±»(ids: 3, 4)ä¸‹ï¼Œæ€»å…±é”€å”®äº†10ä¸ªå•ä½(5 + 5)
> 
> æ²¡æœ‰é”€å”® T-Shirt ç±»åˆ«çš„å•†å“


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```