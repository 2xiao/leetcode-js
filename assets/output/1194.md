# [1194. é”¦æ ‡èµ›ä¼˜èƒœè€…](https://leetcode.com/problems/tournament-winners)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/tournament-winners)

## é¢˜ç›®

Table: `Players`

> 
> 
> 
> 
> 
> +-------------+-------+
> 
> | Column Name | Type  |
> 
> +-------------+-------+
> 
> | player_id   | int   |
> 
> | group_id> 
> | int   |
> 
> +-------------+-------+
> 
> player_id is the primary key (column with unique values) of this table.
> 
> Each row of this table indicates the group of each player.
> 
> 

Table: `Matches`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | match_id> 
>   | int> 
>  |
> 
> | first_player  | int> 
>  |
> 
> | second_player | int> 
>  | 
> 
> | first_score   | int> 
>  |
> 
> | second_score  | int> 
>  |
> 
> +---------------+---------+
> 
> match_id is the primary key (column with unique values) of this table.
> 
> Each row is a record of a match, first_player and second_player contain the player_id of each match.
> 
> first_score and second_score contain the number of points of the first_player and second_player respectively.
> 
> You may assume that, in each match, players belong to the same group.
> 
> 



The winner in each group is the player who scored the maximum total points
within the group. In the case of a tie, the **lowest** `player_id` wins.

Write a solution to find the winner in each group.

Return the result table in **any order**.

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Players table:
> 
> +-----------+------------+
> 
> | player_id | group_id   |
> 
> +-----------+------------+
> 
> | 15> 
> > 
> | 1> 
> > 
>   |
> 
> | 25> 
> > 
> | 1> 
> > 
>   |
> 
> | 30> 
> > 
> | 1> 
> > 
>   |
> 
> | 45> 
> > 
> | 1> 
> > 
>   |
> 
> | 10> 
> > 
> | 2> 
> > 
>   |
> 
> | 35> 
> > 
> | 2> 
> > 
>   |
> 
> | 50> 
> > 
> | 2> 
> > 
>   |
> 
> | 20> 
> > 
> | 3> 
> > 
>   |
> 
> | 40> 
> > 
> | 3> 
> > 
>   |
> 
> +-----------+------------+
> 
> Matches table:
> 
> +------------+--------------+---------------+-------------+--------------+
> 
> | match_id   | first_player | second_player | first_score | second_score |
> 
> +------------+--------------+---------------+-------------+--------------+
> 
> | 1> 
> > 
>   | 15> 
> > 
>    | 45> 
> > 
> > 
> | 3> 
> > 
>    | 0> 
> > 
> > 
> |
> 
> | 2> 
> > 
>   | 30> 
> > 
>    | 25> 
> > 
> > 
> | 1> 
> > 
>    | 2> 
> > 
> > 
> |
> 
> | 3> 
> > 
>   | 30> 
> > 
>    | 15> 
> > 
> > 
> | 2> 
> > 
>    | 0> 
> > 
> > 
> |
> 
> | 4> 
> > 
>   | 40> 
> > 
>    | 20> 
> > 
> > 
> | 5> 
> > 
>    | 2> 
> > 
> > 
> |
> 
> | 5> 
> > 
>   | 35> 
> > 
>    | 50> 
> > 
> > 
> | 1> 
> > 
>    | 1> 
> > 
> > 
> |
> 
> +------------+--------------+---------------+-------------+--------------+
> 
> Output: 
> 
> +-----------+------------+
> 
> | group_id  | player_id  |
> 
> +-----------+------------+ 
> 
> | 1> 
> > 
>  | 15> 
> > 
>  |
> 
> | 2> 
> > 
>  | 35> 
> > 
>  |
> 
> | 3> 
> > 
>  | 40> 
> > 
>  |
> 
> +-----------+------------+
> 
> 


## é¢˜ç›®å¤§æ„

`Players` ç©å®¶è¡¨

> 
> 
> 
> 
> 
> +-------------+-------+
> 
> | Column Name | Type  |
> 
> +-------------+-------+
> 
> | player_id   | int   |
> 
> | group_id> 
> | int   |
> 
> +-------------+-------+
> 
> player_id æ˜¯æ­¤è¡¨çš„ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚
> 
> æ­¤è¡¨çš„æ¯ä¸€è¡Œè¡¨ç¤ºæ¯ä¸ªç©å®¶çš„ç»„ã€‚
> 
> 

`Matches` èµ›äº‹è¡¨

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | match_id> 
>   | int> 
>  |
> 
> | first_player  | int> 
>  |
> 
> | second_player | int> 
>  | 
> 
> | first_score   | int> 
>  |
> 
> | second_score  | int> 
>  |
> 
> +---------------+---------+
> 
> match_id æ˜¯æ­¤è¡¨çš„ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚
> 
> æ¯ä¸€è¡Œæ˜¯ä¸€åœºæ¯”èµ›çš„è®°å½•ï¼Œfirst_player å’Œ second_player è¡¨ç¤ºè¯¥åœºæ¯”èµ›çš„çƒå‘˜ IDã€‚
> 
> first_score å’Œ second_score åˆ†åˆ«è¡¨ç¤º first_player å’Œ second_player çš„å¾—åˆ†ã€‚
> 
> ä½ å¯ä»¥å‡è®¾ï¼Œåœ¨æ¯ä¸€åœºæ¯”èµ›ä¸­ï¼Œçƒå‘˜éƒ½å±äºåŒä¸€ç»„ã€‚
> 
> 



æ¯ç»„çš„è·èƒœè€…æ˜¯åœ¨ç»„å†…ç´¯ç§¯å¾—åˆ†æœ€é«˜çš„é€‰æ‰‹ã€‚å¦‚æœå¹³å±€ï¼Œ`player_id` **æœ€å°  **çš„é€‰æ‰‹è·èƒœã€‚

ç¼–å†™è§£å†³æ–¹æ¡ˆæ¥æŸ¥æ‰¾æ¯ç»„ä¸­çš„è·èƒœè€…ã€‚

è¿”å›çš„ç»“æœè¡¨å• **æ²¡æœ‰é¡ºåºè¦æ±‚**  ã€‚

è¿”å›ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1:**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š**
> 
> Players è¡¨:
> 
> +-----------+------------+
> 
> | player_id | group_id   |
> 
> +-----------+------------+
> 
> | 15> 
> > 
> | 1> 
> > 
>   |
> 
> | 25> 
> > 
> | 1> 
> > 
>   |
> 
> | 30> 
> > 
> | 1> 
> > 
>   |
> 
> | 45> 
> > 
> | 1> 
> > 
>   |
> 
> | 10> 
> > 
> | 2> 
> > 
>   |
> 
> | 35> 
> > 
> | 2> 
> > 
>   |
> 
> | 50> 
> > 
> | 2> 
> > 
>   |
> 
> | 20> 
> > 
> | 3> 
> > 
>   |
> 
> | 40> 
> > 
> | 3> 
> > 
>   |
> 
> +-----------+------------+
> 
> Matches è¡¨:
> 
> +------------+--------------+---------------+-------------+--------------+
> 
> | match_id   | first_player | second_player | first_score | second_score |
> 
> +------------+--------------+---------------+-------------+--------------+
> 
> | 1> 
> > 
>   | 15> 
> > 
>    | 45> 
> > 
> > 
> | 3> 
> > 
>    | 0> 
> > 
> > 
> |
> 
> | 2> 
> > 
>   | 30> 
> > 
>    | 25> 
> > 
> > 
> | 1> 
> > 
>    | 2> 
> > 
> > 
> |
> 
> | 3> 
> > 
>   | 30> 
> > 
>    | 15> 
> > 
> > 
> | 2> 
> > 
>    | 0> 
> > 
> > 
> |
> 
> | 4> 
> > 
>   | 40> 
> > 
>    | 20> 
> > 
> > 
> | 5> 
> > 
>    | 2> 
> > 
> > 
> |
> 
> | 5> 
> > 
>   | 35> 
> > 
>    | 50> 
> > 
> > 
> | 1> 
> > 
>    | 1> 
> > 
> > 
> |
> 
> +------------+--------------+---------------+-------------+--------------+
> 
> **è¾“å‡ºï¼š**
> 
> +-----------+------------+
> 
> | group_id  | player_id  |
> 
> +-----------+------------+ 
> 
> | 1> 
> > 
>  | 15> 
> > 
>  |
> 
> | 2> 
> > 
>  | 35> 
> > 
>  |
> 
> | 3> 
> > 
>  | 40> 
> > 
>  |
> 
> +-----------+------------+


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```