# [LCP 05. å‘ LeetCoin](https://leetcode.cn/problems/coin-bonus)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ ‘çŠ¶æ•°ç»„`](/tag/binary-indexed-tree.md) [`çº¿æ®µæ ‘`](/tag/segment-tree.md) [`æ•°ç»„`](/tag/array.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.cn/problems/coin-bonus)

## é¢˜ç›®

English description is not available for the problem. Please switch to
Chinese.


## é¢˜ç›®å¤§æ„

åŠ›æ‰£å†³å®šç»™ä¸€ä¸ªåˆ·é¢˜å›¢é˜Ÿå‘`LeetCoin`ä½œä¸ºå¥–åŠ±ã€‚åŒæ—¶ï¼Œä¸ºäº†ç›‘æ§ç»™å¤§å®¶å‘äº†å¤šå°‘`LeetCoin`ï¼ŒåŠ›æ‰£æœ‰æ—¶å€™ä¹Ÿä¼šè¿›è¡ŒæŸ¥è¯¢ã€‚



è¯¥åˆ·é¢˜å›¢é˜Ÿçš„ç®¡ç†æ¨¡å¼å¯ä»¥ç”¨ä¸€æ£µæ ‘è¡¨ç¤ºï¼š

  1. å›¢é˜Ÿåªæœ‰ä¸€ä¸ªè´Ÿè´£äººï¼Œç¼–å·ä¸º1ã€‚é™¤äº†è¯¥è´Ÿè´£äººå¤–ï¼Œæ¯ä¸ªäººæœ‰ä¸”ä»…æœ‰ä¸€ä¸ªé¢†å¯¼ï¼ˆè´Ÿè´£äººæ²¡æœ‰é¢†å¯¼ï¼‰ï¼›
  2. ä¸å­˜åœ¨å¾ªç¯ç®¡ç†çš„æƒ…å†µï¼Œå¦‚Aç®¡ç†Bï¼ŒBç®¡ç†Cï¼ŒCç®¡ç†Aã€‚



åŠ›æ‰£æƒ³è¿›è¡Œçš„æ“ä½œæœ‰ä»¥ä¸‹ä¸‰ç§ï¼š

  1. ç»™å›¢é˜Ÿçš„ä¸€ä¸ªæˆå‘˜ï¼ˆä¹Ÿå¯ä»¥æ˜¯è´Ÿè´£äººï¼‰å‘ä¸€å®šæ•°é‡çš„`LeetCoin`ï¼›
  2. ç»™å›¢é˜Ÿçš„ä¸€ä¸ªæˆå‘˜ï¼ˆä¹Ÿå¯ä»¥æ˜¯è´Ÿè´£äººï¼‰ï¼Œä»¥åŠä»–/å¥¹ç®¡ç†çš„æ‰€æœ‰äººï¼ˆå³ä»–/å¥¹çš„ä¸‹å±ã€ä»–/å¥¹ä¸‹å±çš„ä¸‹å±ï¼Œâ€¦â€¦ï¼‰ï¼Œå‘ä¸€å®šæ•°é‡çš„`LeetCoin`ï¼›
  3. æŸ¥è¯¢æŸä¸€ä¸ªæˆå‘˜ï¼ˆä¹Ÿå¯ä»¥æ˜¯è´Ÿè´£äººï¼‰ï¼Œä»¥åŠä»–/å¥¹ç®¡ç†çš„æ‰€æœ‰äººè¢«å‘åˆ°çš„`LeetCoin`ä¹‹å’Œã€‚



**è¾“å…¥ï¼š**

  1. `N`è¡¨ç¤ºå›¢é˜Ÿæˆå‘˜çš„ä¸ªæ•°ï¼ˆç¼–å·ä¸º1ï½Nï¼Œè´Ÿè´£äººä¸º1ï¼‰ï¼›
  2. `leadership`æ˜¯å¤§å°ä¸º`(N - 1) * 2`çš„äºŒç»´æ•°ç»„ï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ `[a, b]`ä»£è¡¨`b`æ˜¯`a`çš„ä¸‹å±ï¼›
  3. `operations`æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º`Q`çš„äºŒç»´æ•°ç»„ï¼Œä»£è¡¨ä»¥æ—¶é—´æ’åºçš„æ“ä½œï¼Œæ ¼å¼å¦‚ä¸‹ï¼š 
> 
> 1. `operations[i][0] = 1`: ä»£è¡¨ç¬¬ä¸€ç§æ“ä½œï¼Œ`operations[i][1]`ä»£è¡¨æˆå‘˜çš„ç¼–å·ï¼Œ`operations[i][2]`ä»£è¡¨`LeetCoin`çš„æ•°é‡ï¼›
> 
> 2. `operations[i][0] = 2`: ä»£è¡¨ç¬¬äºŒç§æ“ä½œï¼Œ`operations[i][1]`ä»£è¡¨æˆå‘˜çš„ç¼–å·ï¼Œ`operations[i][2]`ä»£è¡¨`LeetCoin`çš„æ•°é‡ï¼›
> 
> 3. `operations[i][0] = 3`: ä»£è¡¨ç¬¬ä¸‰ç§æ“ä½œï¼Œ`operations[i][1]`ä»£è¡¨æˆå‘˜çš„ç¼–å·ï¼›

**è¾“å‡ºï¼š**

è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„é‡Œæ˜¯æ¯æ¬¡**æŸ¥è¯¢**
çš„è¿”å›å€¼ï¼ˆå‘`LeetCoin`çš„æ“ä½œä¸éœ€è¦ä»»ä½•è¿”å›å€¼ï¼‰ã€‚ç”±äºå‘çš„`LeetCoin`å¾ˆå¤šï¼Œè¯·æŠŠæ¯æ¬¡æŸ¥è¯¢çš„ç»“æœæ¨¡`1e9+7 (1000000007)`ã€‚



**ç¤ºä¾‹ 1ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** N = 6, leadership = [[1, 2], [1, 6], [2, 3], [2, 5], [1, 4]], operations = [[1, 1, 500], [2, 2, 50], [3, 1], [2, 6, 15], [3, 1]]
> 
> **è¾“å‡ºï¼š**[650, 665]
> 
> **è§£é‡Šï¼š** å›¢é˜Ÿçš„ç®¡ç†å…³ç³»è§ä¸‹å›¾ã€‚
> 
> ç¬¬ä¸€æ¬¡æŸ¥è¯¢æ—¶ï¼Œæ¯ä¸ªæˆå‘˜å¾—åˆ°çš„LeetCoinçš„æ•°é‡åˆ†åˆ«ä¸ºï¼ˆæŒ‰ç¼–å·é¡ºåºï¼‰ï¼š500, 50, 50, 0, 50, 0;
> 
> ç¬¬äºŒæ¬¡æŸ¥è¯¢æ—¶ï¼Œæ¯ä¸ªæˆå‘˜å¾—åˆ°çš„LeetCoinçš„æ•°é‡åˆ†åˆ«ä¸ºï¼ˆæŒ‰ç¼–å·é¡ºåºï¼‰ï¼š500, 50, 50, 0, 50, 15.
> 
> 

![](https://assets.leetcode-cn.com/aliyun-lc-
upload/uploads/2019/09/09/coin_example_1.jpg)



**é™åˆ¶ï¼š**

  1. `1 <= N <= 50000`
  2. `1 <= Q <= 50000`
  3. `operations[i][0] != 3 æ—¶ï¼Œ1 <= operations[i][2] <= 5000`


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```