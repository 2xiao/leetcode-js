# [2977. è½¬æ¢å­—ç¬¦ä¸²çš„æœ€å°æˆæœ¬ II](https://leetcode.com/problems/minimum-cost-to-convert-string-ii)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`å›¾`](/leetcode/outline/tag/graph.md) [`å­—å…¸æ ‘`](/leetcode/outline/tag/trie.md) [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`å­—ç¬¦ä¸²`](/leetcode/outline/tag/string.md) [`åŠ¨æ€è§„åˆ’`](/leetcode/outline/tag/dynamic-programming.md) [`æœ€çŸ­è·¯`](/leetcode/outline/tag/shortest-path.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/minimum-cost-to-convert-string-ii)


## é¢˜ç›®

You are given two **0-indexed** strings `source` and `target`, both of length
`n` and consisting of **lowercase** English characters. You are also given two
**0-indexed** string arrays `original` and `changed`, and an integer array
`cost`, where `cost[i]` represents the cost of converting the string
`original[i]` to the string `changed[i]`.

You start with the string `source`. In one operation, you can pick a
**substring** `x` from the string, and change it to `y` at a cost of `z`
**if** there exists **any** index `j` such that `cost[j] == z`, `original[j]
== x`, and `changed[j] == y`. You are allowed to do **any** number of
operations, but any pair of operations must satisfy **either** of these two
conditions:

  * The substrings picked in the operations are `source[a..b]` and `source[c..d]` with either `b < c` **or** `d < a`. In other words, the indices picked in both operations are **disjoint**.
  * The substrings picked in the operations are `source[a..b]` and `source[c..d]` with `a == c` **and** `b == d`. In other words, the indices picked in both operations are **identical**.

Return _the**minimum** cost to convert the string _`source` _to the
string_`target` _using**any** number of operations_. _If it is impossible to
convert_ `source` _to_ `target`,_return_ `-1`.

**Note** that there may exist indices `i`, `j` such that `original[j] ==
original[i]` and `changed[j] == changed[i]`.



**Example 1:**

> Input: source = "abcd", target = "acbe", original = ["a","b","c","c","e","d"], changed = ["b","c","b","e","b","e"], cost = [2,5,5,1,2,20]
> 
> Output: 28
> 
> Explanation: To convert "abcd" to "acbe", do the following operations:
> - Change substring source[1..1] from "b" to "c" at a cost of 5.
> - Change substring source[2..2] from "c" to "e" at a cost of 1.
> - Change substring source[2..2] from "e" to "b" at a cost of 2.
> - Change substring source[3..3] from "d" to "e" at a cost of 20.
> 
> The total cost incurred is 5 + 1 + 2 + 20 = 28. 
> 
> It can be shown that this is the minimum possible cost.

**Example 2:**

> Input: source = "abcdefgh", target = "acdeeghh", original = ["bcd","fgh","thh"], changed = ["cde","thh","ghh"], cost = [1,3,5]
> 
> Output: 9
> 
> Explanation: To convert "abcdefgh" to "acdeeghh", do the following operations:
> - Change substring source[1..3] from "bcd" to "cde" at a cost of 1.
> - Change substring source[5..7] from "fgh" to "thh" at a cost of 3. We can do this operation because indices [5,7] are disjoint with indices picked in the first operation.
> - Change substring source[5..7] from "thh" to "ghh" at a cost of 5. We can do this operation because indices [5,7] are disjoint with indices picked in the first operation, and identical with indices picked in the second operation.
> 
> The total cost incurred is 1 + 3 + 5 = 9.
> 
> It can be shown that this is the minimum possible cost.

**Example 3:**

> Input: source = "abcdefgh", target = "addddddd", original = ["bcd","defgh"], changed = ["ddd","ddddd"], cost = [100,1578]
> 
> Output: -1
> 
> Explanation: It is impossible to convert "abcdefgh" to "addddddd".
> 
> If you select substring source[1..3] as the first operation to change "abcdefgh" to "adddefgh", you cannot select substring source[3..7] as the second operation because it has a common index, 3, with the first operation.
> 
> If you select substring source[3..7] as the first operation to change "abcdefgh" to "abcddddd", you cannot select substring source[1..3] as the second operation because it has a common index, 3, with the first operation.

**Constraints:**

  * `1 <= source.length == target.length <= 1000`
  * `source`, `target` consist only of lowercase English characters.
  * `1 <= cost.length == original.length == changed.length <= 100`
  * `1 <= original[i].length == changed[i].length <= source.length`
  * `original[i]`, `changed[i]` consist only of lowercase English characters.
  * `original[i] != changed[i]`
  * `1 <= cost[i] <= 10^6`


## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸¤ä¸ªä¸‹æ ‡ä» **0** å¼€å§‹çš„å­—ç¬¦ä¸² `source` å’Œ `target` ï¼Œå®ƒä»¬çš„é•¿åº¦å‡ä¸º `n` å¹¶ä¸”ç”± **å°å†™** è‹±æ–‡å­—æ¯ç»„æˆã€‚

å¦ç»™ä½ ä¸¤ä¸ªä¸‹æ ‡ä» **0** å¼€å§‹çš„å­—ç¬¦ä¸²æ•°ç»„ `original` å’Œ `changed` ï¼Œä»¥åŠä¸€ä¸ªæ•´æ•°æ•°ç»„ `cost` ï¼Œå…¶ä¸­ `cost[i]`
ä»£è¡¨å°†å­—ç¬¦ä¸² `original[i]` æ›´æ”¹ä¸ºå­—ç¬¦ä¸² `changed[i]` çš„æˆæœ¬ã€‚

ä½ ä»å­—ç¬¦ä¸² `source` å¼€å§‹ã€‚åœ¨ä¸€æ¬¡æ“ä½œä¸­ï¼Œ**å¦‚æœ** å­˜åœ¨ **ä»»æ„** ä¸‹æ ‡ `j` æ»¡è¶³ `cost[j] == z`
ã€`original[j] == x` ä»¥åŠ `changed[j] == y` ï¼Œä½ å°±å¯ä»¥é€‰æ‹©å­—ç¬¦ä¸²ä¸­çš„ **å­ä¸²** `x` å¹¶ä»¥ `z`
çš„æˆæœ¬å°†å…¶æ›´æ”¹ä¸º `y` ã€‚ ä½ å¯ä»¥æ‰§è¡Œ **ä»»æ„æ•°é‡** çš„æ“ä½œï¼Œä½†æ˜¯ä»»ä¸¤æ¬¡æ“ä½œå¿…é¡»æ»¡è¶³**ä»¥ä¸‹ä¸¤ä¸ª** æ¡ä»¶ **ä¹‹ä¸€** ï¼š

  * åœ¨ä¸¤æ¬¡æ“ä½œä¸­é€‰æ‹©çš„å­ä¸²åˆ†åˆ«æ˜¯ `source[a..b]` å’Œ `source[c..d]` ï¼Œæ»¡è¶³ `b < c`  **æˆ–** `d < a` ã€‚æ¢å¥è¯è¯´ï¼Œä¸¤æ¬¡æ“ä½œä¸­é€‰æ‹©çš„ä¸‹æ ‡**ä¸ç›¸äº¤** ã€‚
  * åœ¨ä¸¤æ¬¡æ“ä½œä¸­é€‰æ‹©çš„å­ä¸²åˆ†åˆ«æ˜¯ `source[a..b]` å’Œ `source[c..d]` ï¼Œæ»¡è¶³ `a == c` **ä¸”** `b == d` ã€‚æ¢å¥è¯è¯´ï¼Œä¸¤æ¬¡æ“ä½œä¸­é€‰æ‹©çš„ä¸‹æ ‡**ç›¸åŒ** ã€‚

è¿”å›å°†å­—ç¬¦ä¸² `source` è½¬æ¢ä¸ºå­—ç¬¦ä¸² `target` æ‰€éœ€çš„**æœ€å°** æˆæœ¬ã€‚å¦‚æœä¸å¯èƒ½å®Œæˆè½¬æ¢ï¼Œåˆ™è¿”å› `-1` ã€‚

**æ³¨æ„** ï¼Œå¯èƒ½å­˜åœ¨ä¸‹æ ‡ `i` ã€`j` ä½¿å¾— `original[j] == original[i]` ä¸” `changed[j] ==
changed[i]` ã€‚



**ç¤ºä¾‹ 1ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** source = "abcd", target = "acbe", original = ["a","b","c","c","e","d"], changed = ["b","c","b","e","b","e"], cost = [2,5,5,1,2,20]
> 
> **è¾“å‡ºï¼š** 28
> 
> **è§£é‡Šï¼š** å°† "abcd" è½¬æ¢ä¸º "acbe"ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
> - å°†å­ä¸² source[1..1] ä» "b" æ”¹ä¸º "c" ï¼Œæˆæœ¬ä¸º 5 ã€‚
> - å°†å­ä¸² source[2..2] ä» "c" æ”¹ä¸º "e" ï¼Œæˆæœ¬ä¸º 1 ã€‚
> - å°†å­ä¸² source[2..2] ä» "e" æ”¹ä¸º "b" ï¼Œæˆæœ¬ä¸º 2 ã€‚
> - å°†å­ä¸² source[3..3] ä» "d" æ”¹ä¸º "e" ï¼Œæˆæœ¬ä¸º 20 ã€‚
> 
> äº§ç”Ÿçš„æ€»æˆæœ¬æ˜¯ 5 + 1 + 2 + 20 = 28 ã€‚ 
> 
> å¯ä»¥è¯æ˜è¿™æ˜¯å¯èƒ½çš„æœ€å°æˆæœ¬ã€‚
> 
> 

**ç¤ºä¾‹ 2ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** source = "abcdefgh", target = "acdeeghh", original = ["bcd","fgh","thh"], changed = ["cde","thh","ghh"], cost = [1,3,5]
> 
> **è¾“å‡ºï¼š** 9
> 
> **è§£é‡Šï¼š** å°† "abcdefgh" è½¬æ¢ä¸º "acdeeghh"ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
> - å°†å­ä¸² source[1..3] ä» "bcd" æ”¹ä¸º "cde" ï¼Œæˆæœ¬ä¸º 1 ã€‚
> - å°†å­ä¸² source[5..7] ä» "fgh" æ”¹ä¸º "thh" ï¼Œæˆæœ¬ä¸º 3 ã€‚å¯ä»¥æ‰§è¡Œæ­¤æ“ä½œï¼Œå› ä¸ºä¸‹æ ‡ [5,7] ä¸ç¬¬ä¸€æ¬¡æ“ä½œé€‰ä¸­çš„ä¸‹æ ‡ä¸ç›¸äº¤ã€‚
> - å°†å­ä¸² source[5..7] ä» "thh" æ”¹ä¸º "ghh" ï¼Œæˆæœ¬ä¸º 5 ã€‚å¯ä»¥æ‰§è¡Œæ­¤æ“ä½œï¼Œå› ä¸ºä¸‹æ ‡ [5,7] ä¸ç¬¬ä¸€æ¬¡æ“ä½œé€‰ä¸­çš„ä¸‹æ ‡ä¸ç›¸äº¤ï¼Œä¸”ä¸ç¬¬äºŒæ¬¡æ“ä½œé€‰ä¸­çš„ä¸‹æ ‡ç›¸åŒã€‚
> 
> äº§ç”Ÿçš„æ€»æˆæœ¬æ˜¯ 1 + 3 + 5 = 9 ã€‚
> 
> å¯ä»¥è¯æ˜è¿™æ˜¯å¯èƒ½çš„æœ€å°æˆæœ¬ã€‚
> 
> 

**ç¤ºä¾‹ 3ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** source = "abcdefgh", target = "addddddd", original = ["bcd","defgh"], changed = ["ddd","ddddd"], cost = [100,1578]
> 
> **è¾“å‡ºï¼š** -1
> 
> **è§£é‡Šï¼š** æ— æ³•å°† "abcdefgh" è½¬æ¢ä¸º "addddddd" ã€‚
> 
> å¦‚æœé€‰æ‹©å­ä¸² source[1..3] æ‰§è¡Œç¬¬ä¸€æ¬¡æ“ä½œï¼Œä»¥å°† "abcdefgh" æ”¹ä¸º "adddefgh" ï¼Œä½ æ— æ³•é€‰æ‹©å­ä¸² source[3..7] æ‰§è¡Œç¬¬äºŒæ¬¡æ“ä½œï¼Œå› ä¸ºä¸¤æ¬¡æ“ä½œæœ‰ä¸€ä¸ªå…±ç”¨ä¸‹æ ‡ 3 ã€‚
> 
> å¦‚æœé€‰æ‹©å­ä¸² source[3..7] æ‰§è¡Œç¬¬ä¸€æ¬¡æ“ä½œï¼Œä»¥å°† "abcdefgh" æ”¹ä¸º "abcddddd" ï¼Œä½ æ— æ³•é€‰æ‹©å­ä¸² source[1..3] æ‰§è¡Œç¬¬äºŒæ¬¡æ“ä½œï¼Œå› ä¸ºä¸¤æ¬¡æ“ä½œæœ‰ä¸€ä¸ªå…±ç”¨ä¸‹æ ‡ 3 ã€‚
> 
> 



**æç¤ºï¼š**

  * `1 <= source.length == target.length <= 1000`
  * `source`ã€`target` å‡ç”±å°å†™è‹±æ–‡å­—æ¯ç»„æˆ
  * `1 <= cost.length == original.length == changed.length <= 100`
  * `1 <= original[i].length == changed[i].length <= source.length`
  * `original[i]`ã€`changed[i]` å‡ç”±å°å†™è‹±æ–‡å­—æ¯ç»„æˆ
  * `original[i] != changed[i]`
  * `1 <= cost[i] <= 10^6`


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 1540 | [K æ¬¡æ“ä½œè½¬å˜å­—ç¬¦ä¸²](https://leetcode.com/problems/can-convert-string-in-k-moves) |  |  [`å“ˆå¸Œè¡¨`](/leetcode/outline/tag/hash-table.md) [`å­—ç¬¦ä¸²`](/leetcode/outline/tag/string.md) | <font color=#ffb800>Medium</font> |
| 2027 | [è½¬æ¢å­—ç¬¦ä¸²çš„æœ€å°‘æ“ä½œæ¬¡æ•°](https://leetcode.com/problems/minimum-moves-to-convert-string) |  |  [`è´ªå¿ƒ`](/leetcode/outline/tag/greedy.md) [`å­—ç¬¦ä¸²`](/leetcode/outline/tag/string.md) | <font color=#15bd66>Easy</font> |
| 3291 | [å½¢æˆç›®æ ‡å­—ç¬¦ä¸²éœ€è¦çš„æœ€å°‘å­—ç¬¦ä¸²æ•° I](https://leetcode.com/problems/minimum-number-of-valid-strings-to-form-target-i) |  |  [`å­—å…¸æ ‘`](/leetcode/outline/tag/trie.md) [`çº¿æ®µæ ‘`](/leetcode/outline/tag/segment-tree.md) [`æ•°ç»„`](/leetcode/outline/tag/array.md) `6+` | <font color=#ffb800>Medium</font> |
| 3292 | [å½¢æˆç›®æ ‡å­—ç¬¦ä¸²éœ€è¦çš„æœ€å°‘å­—ç¬¦ä¸²æ•° II](https://leetcode.com/problems/minimum-number-of-valid-strings-to-form-target-ii) |  |  [`çº¿æ®µæ ‘`](/leetcode/outline/tag/segment-tree.md) [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`å­—ç¬¦ä¸²`](/leetcode/outline/tag/string.md) `5+` | <font color=#ff334b>Hard</font> |

<style>
.blue {
    background-color: #096dd9;
    padding: 0.25rem 0.5rem;
    margin: 0;
    font-size: 0.85em;
    border-radius: 3px;
    color: white;
    font-weight: 500;
}
table th:first-of-type { width: 10%; }
table th:nth-of-type(2) { width: 35%; }
table th:nth-of-type(3) { width: 10%; }
table th:nth-of-type(4) { width: 35%; }
table th:nth-of-type(5) { width: 10%; }
</style>
