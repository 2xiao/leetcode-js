# [1896. åè½¬è¡¨è¾¾å¼å€¼çš„æœ€å°‘æ“ä½œæ¬¡æ•°](https://leetcode.com/problems/minimum-cost-to-change-the-final-value-of-expression)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ ˆ`](/outline/tag/stack.md) [`æ•°å­¦`](/outline/tag/math.md) [`å­—ç¬¦ä¸²`](/outline/tag/string.md) [`åŠ¨æ€è§„åˆ’`](/outline/tag/dynamic-programming.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/minimum-cost-to-change-the-final-value-of-expression)

## é¢˜ç›®

You are given a **valid** boolean expression as a string `expression`
consisting of the characters `'1'`,`'0'`,`'&'` (bitwise **AND**
operator),`'|'` (bitwise **OR** operator),`'('`, and `')'`.

  * For example, `"()1|1"` and `"(1)&()"` are **not valid** while `"1"`, `"(((1))|(0))"`, and `"1|(0&(1))"` are **valid** expressions.

Return _the**minimum cost** to change the final value of the expression_.

  * For example, if `expression = "1|1|(0&0)&1"`, its **value** is `1|1|(0&0)&1 = 1|1|0&1 = 1|0&1 = 1&1 = 1`. We want to apply operations so that the**new** expression evaluates to `0`.

The **cost** of changing the final value of an expression is the **number of
operations** performed on the expression. The types of **operations** are
described as follows:

  * Turn a `'1'` into a `'0'`.
  * Turn a `'0'` into a `'1'`.
  * Turn a `'&'` into a `'|'`.
  * Turn a `'|'` into a `'&'`.

**Note:** `'&'` does **not** take precedence over `'|'` in the **order of
calculation**. Evaluate parentheses **first** , then in **left-to-right**
order.



**Example 1:**

> Input: expression = "1&(0|1)"
> 
> Output: 1
> 
> Explanation: We can turn "1&(0 _**|**_ 1)" into "1&(0 _**&**_ 1)" by changing the '|' to a '&' using 1 operation.
> 
> The new expression evaluates to 0. 

**Example 2:**

> Input: expression = "(0&0)&(0&0&0)"
> 
> Output: 3
> 
> Explanation: We can turn "(0 _**& 0**_)**_&_**(0&0&0)" into "(0 _**|1**_)_**|**_(0&0&0)" using 3 operations.
> 
> The new expression evaluates to 1.

**Example 3:**

> Input: expression = "(0|(1|0&1))"
> 
> Output: 1
> 
> Explanation: We can turn "(0|(_**1**_ |0&1))" into "(0|(_**0**_ |0&1))" using 1 operation.
> 
> The new expression evaluates to 0.



**Constraints:**

  * `1 <= expression.length <= 10^5`
  * `expression` only contains `'1'`,`'0'`,`'&'`,`'|'`,`'('`, and `')'`
  * All parentheses are properly matched.
  * There will be no empty parentheses (i.e: `"()"` is not a substring of `expression`).


## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ª **æœ‰æ•ˆçš„** å¸ƒå°”è¡¨è¾¾å¼ï¼Œç”¨å­—ç¬¦ä¸² `expression` è¡¨ç¤ºã€‚è¿™ä¸ªå­—ç¬¦ä¸²åŒ…å«å­—ç¬¦ `'1'`ï¼Œ`'0'`ï¼Œ`'&'`ï¼ˆæŒ‰ä½ **ä¸**
è¿ç®—ï¼‰ï¼Œ`'|'`ï¼ˆæŒ‰ä½ **æˆ–** è¿ç®—ï¼‰ï¼Œ`'('` å’Œ `')'` ã€‚

  * æ¯”æ–¹è¯´ï¼Œ`"()1|1"` å’Œ `"(1)&()"` **ä¸æ˜¯æœ‰æ•ˆ** å¸ƒå°”è¡¨è¾¾å¼ã€‚è€Œ `"1"`ï¼Œ `"(((1))|(0))"` å’Œ `"1|(0&(1))"` æ˜¯ **æœ‰æ•ˆ** å¸ƒå°”è¡¨è¾¾å¼ã€‚

ä½ çš„ç›®æ ‡æ˜¯å°†å¸ƒå°”è¡¨è¾¾å¼çš„ **å€¼** **åè½¬** ï¼ˆä¹Ÿå°±æ˜¯å°† `0` å˜ä¸º `1` ï¼Œæˆ–è€…å°† `1` å˜ä¸º `0`ï¼‰ï¼Œè¯·ä½ è¿”å›è¾¾æˆç›®æ ‡éœ€è¦çš„
**æœ€å°‘æ“ä½œ** æ¬¡æ•°ã€‚

  * æ¯”æ–¹è¯´ï¼Œå¦‚æœè¡¨è¾¾å¼ `expression = "1|1|(0&0)&1"` ï¼Œå®ƒçš„ **å€¼** ä¸º `1|1|(0&0)&1 = 1|1|0&1 = 1|0&1 = 1&1 = 1` ã€‚æˆ‘ä»¬æƒ³è¦æ‰§è¡Œæ“ä½œå°† **æ–°çš„** è¡¨è¾¾å¼çš„å€¼å˜æˆ `0` ã€‚

å¯æ‰§è¡Œçš„ **æ“ä½œ** å¦‚ä¸‹ï¼š

  * å°†ä¸€ä¸ª `'1'` å˜æˆä¸€ä¸ª `'0'` ã€‚
  * å°†ä¸€ä¸ª `'0'` å˜æˆä¸€ä¸ª `'1'` ã€‚
  * å°†ä¸€ä¸ª `'&'` å˜æˆä¸€ä¸ª `'|'` ã€‚
  * å°†ä¸€ä¸ª `'|'` å˜æˆä¸€ä¸ª `'&'` ã€‚

**æ³¨æ„ï¼š**`'&'` çš„ **è¿ç®—ä¼˜å…ˆçº§** ä¸ `'|'` **ç›¸åŒ** ã€‚è®¡ç®—è¡¨è¾¾å¼æ—¶ï¼Œæ‹¬å·ä¼˜å…ˆçº§ **æœ€é«˜** ï¼Œç„¶åæŒ‰ç…§ **ä»å·¦åˆ°å³**
çš„é¡ºåºè¿ç®—ã€‚

**ç¤ºä¾‹ 1ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** expression = "1&(0|1)"
> 
> **è¾“å‡ºï¼š** 1
> 
> **è§£é‡Šï¼š** æˆ‘ä»¬å¯ä»¥å°† "1&(0**|** 1)" å˜æˆ "1&(0**&** 1)" ï¼Œæ‰§è¡Œçš„æ“ä½œä¸ºå°†ä¸€ä¸ª '|' å˜æˆä¸€ä¸ª '&' ï¼Œæ‰§è¡Œäº† 1 æ¬¡æ“ä½œã€‚
> 
> æ–°è¡¨è¾¾å¼çš„å€¼ä¸º 0 ã€‚
> 
> 

**ç¤ºä¾‹ 2ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** expression = "(0&0)&(0&0&0)"
> 
> **è¾“å‡ºï¼š** 3
> 
> **è§£é‡Šï¼š** æˆ‘ä»¬å¯ä»¥å°† "(0**& 0**)**&**(0&0&0)" å˜æˆ "(0**|1**)**|**(0&0&0)" ï¼Œæ‰§è¡Œäº† 3 æ¬¡æ“ä½œã€‚
> 
> æ–°è¡¨è¾¾å¼çš„å€¼ä¸º 1 ã€‚
> 
> 

**ç¤ºä¾‹ 3ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** expression = "(0|(1|0&1))"
> 
> **è¾“å‡ºï¼š** 1
> 
> **è§£é‡Šï¼š** æˆ‘ä»¬å¯ä»¥å°† "(0|(**1** |0&1))" å˜æˆ "(0|(**0** |0&1))" ï¼Œæ‰§è¡Œäº† 1 æ¬¡æ“ä½œã€‚
> 
> æ–°è¡¨è¾¾å¼çš„å€¼ä¸º 0 ã€‚

**æç¤ºï¼š**

  * `1 <= expression.length <= 10^5`
  * `expression` åªåŒ…å« `'1'`ï¼Œ`'0'`ï¼Œ`'&'`ï¼Œ`'|'`ï¼Œ`'('` å’Œ `')'`
  * æ‰€æœ‰æ‹¬å·éƒ½æœ‰ä¸ä¹‹åŒ¹é…çš„å¯¹åº”æ‹¬å·ã€‚
  * ä¸ä¼šæœ‰ç©ºçš„æ‹¬å·ï¼ˆä¹Ÿå°±æ˜¯è¯´ `"()"` ä¸æ˜¯ `expression` çš„å­å­—ç¬¦ä¸²ï¼‰ã€‚


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```