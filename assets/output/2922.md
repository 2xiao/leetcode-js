# [2922. å¸‚åœºåˆ†æ III ğŸ”’](https://2xiao.github.io/leetcode-js/problem/2922.html)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/market-analysis-iii) [`LeetCode`](https://leetcode.com/problems/market-analysis-iii)

## é¢˜ç›®

Table: `Users`

> 
> 
> 
> 
> 
> +----------------+---------+
> 
> | Column Name> 
> | Type> 
> |
> 
> +----------------+---------+
> 
> | seller_id> 
>   | int> 
>  |
> 
> | join_date> 
>   | date> 
> |
> 
> | favorite_brand | varchar |
> 
> +----------------+---------+
> 
> seller_id is column of unique values for this table.
> 
> This table contains seller id, join date, and favorite brand of sellers.
> 
> 

Table: `Items`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | item_id> 
>    | int> 
>  |
> 
> | item_brand> 
> | varchar |
> 
> +---------------+---------+
> 
> item_id is the column of unique values for this table.
> 
> This table contains item id and item brand.

Table: `Orders`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | order_id> 
>   | int> 
>  |
> 
> | order_date> 
> | date> 
> |
> 
> | item_id> 
>    | int> 
>  |
> 
> | seller_id> 
>  | int> 
>  |
> 
> +---------------+---------+
> 
> order_id is the column of unique values for this table.
> 
> item_id is a foreign key to the Items table.
> 
> seller_id is a foreign key to the Users table.
> 
> This table contains order id, order date, item id and seller id.

Write a solution to find the **top seller** who has sold the highest number
of**unique** items with a **different** brand than their favorite brand. If
there are multiple sellers with the same highest count, return all of them.

Return _the result table ordered by_ `seller_id` _in**ascending** order._

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Users table:
> 
> +-----------+------------+----------------+
> 
> | seller_id | join_date  | favorite_brand |
> 
> +-----------+------------+----------------+
> 
> | 1> 
> > 
>  | 2019-01-01 | Lenovo> 
> > 
>  |
> 
> | 2> 
> > 
>  | 2019-02-09 | Samsung> 
> > 
> |
> 
> | 3> 
> > 
>  | 2019-01-19 | LG> 
> > 
> > 
>  |
> 
> +-----------+------------+----------------+
> 
> Orders table:
> 
> +----------+------------+---------+-----------+
> 
> | order_id | order_date | item_id | seller_id |
> 
> +----------+------------+---------+-----------+
> 
> | 1> 
> > 
> | 2019-08-01 | 4> 
>    | 2> 
> > 
>  |
> 
> | 2> 
> > 
> | 2019-08-02 | 2> 
>    | 3> 
> > 
>  |
> 
> | 3> 
> > 
> | 2019-08-03 | 3> 
>    | 3> 
> > 
>  |
> 
> | 4> 
> > 
> | 2019-08-04 | 1> 
>    | 2> 
> > 
>  |
> 
> | 5> 
> > 
> | 2019-08-04 | 4> 
>    | 2> 
> > 
>  |
> 
> +----------+------------+---------+-----------+
> 
> Items table:
> 
> +---------+------------+
> 
> | item_id | item_brand |
> 
> +---------+------------+
> 
> | 1> 
>    | Samsung> 
> |
> 
> | 2> 
>    | Lenovo> 
>  |
> 
> | 3> 
>    | LG> 
> > 
>  |
> 
> | 4> 
>    | HP> 
> > 
>  |
> 
> +---------+------------+
> 
> Output: 
> 
> +-----------+-----------+
> 
> | seller_id | num_items |
> 
> +-----------+-----------+
> 
> | 2> 
> > 
>  | 1> 
> > 
>  |
> 
> | 3> 
> > 
>  | 1> 
> > 
>  |
> 
> +-----------+-----------+
> 
> Explanation: 
> - The user with seller_id 2 has sold three items, but only two of them are not marked as a favorite. We will include a unique count of 1 because both of these items are identical.
> - The user with seller_id 3 has sold two items, but only one of them is not marked as a favorite. We will include just that non-favorite item in our count.
> 
> Since seller_ids 2 and 3 have the same count of one item each, they both will be displayed in the output.


## é¢˜ç›®å¤§æ„

è¡¨ï¼š `Users`

> 
> 
> 
> 
> 
> +----------------+---------+
> 
> | Column Name> 
> | Type> 
> |
> 
> +----------------+---------+
> 
> | seller_id> 
>   | int> 
>  |
> 
> | join_date> 
>   | date> 
> |
> 
> | favorite_brand | varchar |
> 
> +----------------+---------+
> 
> seller_id æ˜¯è¯¥è¡¨å…·æœ‰å”¯ä¸€å€¼çš„åˆ—ã€‚
> 
> è¯¥è¡¨åŒ…å«å–å®¶çš„ ID, åŠ å…¥æ—¥æœŸä»¥åŠæœ€å–œæ¬¢çš„å“ç‰Œã€‚
> 
> 

è¡¨ï¼š `Items`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | item_id> 
>    | int> 
>  |
> 
> | item_brand> 
> | varchar |
> 
> +---------------+---------+
> 
> item_id æ˜¯è¯¥è¡¨å…·æœ‰å”¯ä¸€å€¼çš„åˆ—ã€‚
> 
> è¯¥è¡¨åŒ…å«å•†å“ ID å’Œå•†å“å“ç‰Œã€‚

è¡¨ï¼š `Orders`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | order_id> 
>   | int> 
>  |
> 
> | order_date> 
> | date> 
> |
> 
> | item_id> 
>    | int> 
>  |
> 
> | seller_id> 
>  | int> 
>  |
> 
> +---------------+---------+
> 
> order_id æ˜¯è¯¥è¡¨å…·æœ‰å”¯ä¸€å€¼çš„åˆ—ã€‚
> 
> item_id æ˜¯æŒ‡å‘ Items è¡¨çš„å¤–é”®ã€‚
> 
> seller_id æ˜¯æŒ‡å‘ Users è¡¨çš„å¤–é”®ã€‚
> 
> è¯¥è¡¨åŒ…å«è®¢å• IDã€ä¸‹å•æ—¥æœŸã€å•†å“ ID å’Œå–å®¶ IDã€‚

ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œæ‰¾åˆ°å–å‡ºéå–œçˆ±çš„å“ç‰Œæ•°é‡ **æœ€å¤š  **çš„ä¸€ä¸ªå–å®¶ã€‚å¦‚æœæœ‰å¤šä¸ªå–å®¶é”€å”®äº†åŒæ ·æ•°é‡çš„å•†å“ï¼Œåˆ™è¿”å›åŒ…æ‹¬æ‰€æœ‰å–å‡ºéå–œçˆ±å“ç‰Œæ•°é‡æœ€å¤šçš„å–å®¶åå•ã€‚

è¿”å›æŒ‰ `seller_id` _ **å‡åºæ’åº**  çš„ç»“æœè¡¨ã€‚_

ç»“æœæ ¼å¼å¦‚ä¸‹ç¤ºä¾‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1:**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š**
> 
> Users table:
> 
> +-----------+------------+----------------+
> 
> | seller_id | join_date  | favorite_brand |
> 
> +-----------+------------+----------------+
> 
> | 1> 
> > 
>  | 2019-01-01 | Lenovo> 
> > 
>  |
> 
> | 2> 
> > 
>  | 2019-02-09 | Samsung> 
> > 
> |
> 
> | 3> 
> > 
>  | 2019-01-19 | LG> 
> > 
> > 
>  |
> 
> +-----------+------------+----------------+
> 
> Orders table:
> 
> +----------+------------+---------+-----------+
> 
> | order_id | order_date | item_id | seller_id |
> 
> +----------+------------+---------+-----------+
> 
> | 1> 
> > 
> | 2019-08-01 | 4> 
>    | 2> 
> > 
>  |
> 
> | 2> 
> > 
> | 2019-08-02 | 2> 
>    | 3> 
> > 
>  |
> 
> | 3> 
> > 
> | 2019-08-03 | 3> 
>    | 3> 
> > 
>  |
> 
> | 4> 
> > 
> | 2019-08-04 | 1> 
>    | 2> 
> > 
>  |
> 
> | 5> 
> > 
> | 2019-08-04 | 4> 
>    | 2> 
> > 
>  |
> 
> +----------+------------+---------+-----------+
> 
> Items table:
> 
> +---------+------------+
> 
> | item_id | item_brand |
> 
> +---------+------------+
> 
> | 1> 
>    | Samsung> 
> |
> 
> | 2> 
>    | Lenovo> 
>  |
> 
> | 3> 
>    | LG> 
> > 
>  |
> 
> | 4> 
>    | HP> 
> > 
>  |
> 
> +---------+------------+
> 
> **è¾“å‡ºï¼š**
> 
> +-----------+-----------+
> 
> | seller_id | num_items |
> 
> +-----------+-----------+
> 
> | 2> 
> > 
>  | 1> 
> > 
>  |
> 
> | 3> 
> > 
>  | 1> 
> > 
>  |
> 
> +-----------+-----------+
> 
> **è§£é‡Šï¼š**
> - å–å®¶ ID ä¸º 2 çš„ç”¨æˆ·é”€å”®äº†ä¸‰ä»¶å•†å“ï¼Œä½†åªæœ‰ä¸¤ä»¶ä¸æ˜¯ä»–æœ€å–œæ¬¢çš„å•†å“ã€‚ç”±äºè¿™ä¸¤ä¸ªå•†å“å“ç‰Œç›¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬åªè®¡æ•° 1ã€‚ 
> - å–å®¶ ID ä¸º 3 çš„ç”¨æˆ·é”€å”®äº†ä¸¤ä»¶å•†å“ï¼Œä½†åªæœ‰ä¸€ä»¶ä¸æ˜¯ä»–æœ€å–œæ¬¢çš„å•†å“ã€‚æˆ‘ä»¬å°†åªæŠŠ ä¸è¢«æ ‡è®°ä¸ºæœ€å–œæ¬¢ çš„å•†å“åˆ—å…¥è®¡æ•°ä¸­ã€‚
> 
> å› ä¸ºå–å®¶ ID ä¸º 2 å’Œ 3 çš„å–å®¶éƒ½æœ‰ä¸€ä»¶å•†å“åˆ—å…¥è®¡æ•°ï¼Œæ‰€ä»¥ä»–ä»¬éƒ½å°†æ˜¾ç¤ºåœ¨è¾“å‡ºä¸­ã€‚
> 
> 


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```