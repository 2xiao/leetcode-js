# [3145. å¤§æ•°ç»„å…ƒç´ çš„ä¹˜ç§¯](https://leetcode.com/problems/find-products-of-elements-of-big-array)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`ä½è¿ç®—`](/tag/bit-manipulation.md) [`æ•°ç»„`](/tag/array.md) [`äºŒåˆ†æŸ¥æ‰¾`](/tag/binary-search.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/find-products-of-elements-of-big-array)

## é¢˜ç›®

The **powerful array** of a non-negative integer `x` is defined as the
shortest sorted array of powers of two that sum up to `x`. The table below
illustrates examples of how the **powerful array** is determined. It can be
proven that the powerful array of `x` is unique.

num | Binary Representation | powerful array  
---|---|---  
1 | 0000 _1_ | [1]  
8 | 0 _1_ 000 | [8]  
10 | 0 _1_ 0 _1_ 0 | [2, 8]  
13 | 0 _11_ 0 _1_ | [1, 4, 8]  
23 | _1_ 0 _111_ | [1, 2, 4, 16]  
  
The array `big_nums` is created by concatenating the **powerful arrays** for
every positive integer `i` in ascending order: 1, 2, 3, and so on. Thus,
`big_nums` begins as `[_1_ , _2_ , _1, 2_ , _4_ , _1, 4_ , _2, 4_ , _1, 2, 4_
, _8_ , ...]`.

You are given a 2D integer matrix `queries`, where for `queries[i] = [fromi,
toi, modi]` you should calculate `(big_nums[fromi] * big_nums[fromi + 1] * ...
* big_nums[toi]) % modi`.

Return an integer array `answer` such that `answer[i]` is the answer to the
`ith` query.



**Example 1:**

**Input:** queries = [[1,3,7]]

**Output:** [4]

**Explanation:**

There is one query.

`big_nums[1..3] = [2,1,2]`. The product of them is 4. The result is `4 % 7 =
4.`

**Example 2:**

**Input:** queries = [[2,5,3],[7,7,4]]

**Output:** [2,2]

**Explanation:**

There are two queries.

First query: `big_nums[2..5] = [1,2,4,1]`. The product of them is 8. The
result is `8 % 3 = 2`.

Second query: `big_nums[7] = 2`. The result is `2 % 4 = 2`.



**Constraints:**

  * `1 <= queries.length <= 500`
  * `queries[i].length == 3`
  * `0 <= queries[i][0] <= queries[i][1] <= 1015`
  * `1 <= queries[i][2] <= 10^5`


## é¢˜ç›®å¤§æ„

ä¸€ä¸ªéè´Ÿæ•´æ•° `x` çš„ **å¼ºæ•°ç»„**  æŒ‡çš„æ˜¯æ»¡è¶³å…ƒç´ ä¸º 2 çš„å¹‚ä¸”å…ƒç´ æ€»å’Œä¸º `x` çš„æœ€çŸ­æœ‰åºæ•°ç»„ã€‚ä¸‹è¡¨è¯´æ˜äº†å¦‚ä½•ç¡®å®š **å¼ºæ•°ç»„**
çš„ç¤ºä¾‹ã€‚å¯ä»¥è¯æ˜ï¼Œ`x` å¯¹åº”çš„å¼ºæ•°ç»„æ˜¯ç‹¬ä¸€æ— äºŒçš„ã€‚

æ•°å­— | äºŒè¿›åˆ¶è¡¨ç¤º | å¼ºæ•°ç»„  
---|---|---  
1 | 0000 _1_ | [1]  
8 | 0 _1_ 000 | [8]  
10 | 0 _1_ 0 _1_ 0 | [2, 8]  
13 | 0 _11_ 0 _1_ | [1, 4, 8]  
23 | _1_ 0 _111_ | [1, 2, 4, 16]  
  


æˆ‘ä»¬å°†æ¯ä¸€ä¸ªå‡åºçš„æ­£æ•´æ•° `i` ï¼ˆå³1ï¼Œ2ï¼Œ3ç­‰ç­‰ï¼‰çš„ **å¼ºæ•°ç»„**  è¿æ¥å¾—åˆ°æ•°ç»„ `big_nums` ï¼Œ`big_nums` å¼€å§‹éƒ¨åˆ†ä¸º
`[_1_ , _2_ , _1, 2_ , _4_ , _1, 4_ , _2, 4_ , _1, 2, 4_ , _8_ , ...]` ã€‚

ç»™ä½ ä¸€ä¸ªäºŒç»´æ•´æ•°æ•°ç»„ `queries` ï¼Œå…¶ä¸­ `queries[i] = [fromi, toi, modi]` ï¼Œä½ éœ€è¦è®¡ç®—
`(big_nums[fromi] * big_nums[fromi + 1] * ... * big_nums[toi]) % modi` ã€‚

è¯·ä½ è¿”å›ä¸€ä¸ªæ•´æ•°æ•°ç»„ `answer` ï¼Œå…¶ä¸­ `answer[i]` æ˜¯ç¬¬ `i` ä¸ªæŸ¥è¯¢çš„ç­”æ¡ˆã€‚



**ç¤ºä¾‹ 1ï¼š**

**è¾“å…¥ï¼š** queries = [[1,3,7]]

**è¾“å‡ºï¼š**[4]

**è§£é‡Šï¼š**

åªæœ‰ä¸€ä¸ªæŸ¥è¯¢ã€‚

`big_nums[1..3] = [2,1,2]` ã€‚å®ƒä»¬çš„ä¹˜ç§¯ä¸º 4ã€‚ç»“æœä¸º `4 % 7 = 4`ã€‚

**ç¤ºä¾‹ 2ï¼š**

**è¾“å…¥ï¼š** queries = [[2,5,3],[7,7,4]]

**è¾“å‡ºï¼š**[2,2]

**è§£é‡Šï¼š**

æœ‰ä¸¤ä¸ªæŸ¥è¯¢ã€‚

ç¬¬ä¸€ä¸ªæŸ¥è¯¢ï¼š`big_nums[2..5] = [1,2,4,1]` ã€‚å®ƒä»¬çš„ä¹˜ç§¯ä¸º 8 ã€‚ç»“æœä¸º  `8 % 3 = 2`ã€‚

ç¬¬äºŒä¸ªæŸ¥è¯¢ï¼š`big_nums[7] = 2` ã€‚ç»“æœä¸º `2 % 4 = 2`ã€‚



**æç¤ºï¼š**

  * `1 <= queries.length <= 500`
  * `queries[i].length == 3`
  * `0 <= queries[i][0] <= queries[i][1] <= 1015`
  * `1 <= queries[i][2] <= 10^5`




## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```