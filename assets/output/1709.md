# [1709. è®¿é—®æ—¥æœŸä¹‹é—´æœ€å¤§çš„ç©ºæ¡£æœŸ](https://leetcode.com/problems/biggest-window-between-visits)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/biggest-window-between-visits)

## é¢˜ç›®

Table: `UserVisits`

> 
> 
> 
> 
> 
> +-------------+------+
> 
> | Column Name | Type |
> 
> +-------------+------+
> 
> | user_id> 
>  | int  |
> 
> | visit_date  | date |
> 
> +-------------+------+
> 
> This table does not have a primary key, it might contain duplicate rows.
> 
> This table contains logs of the dates that users visited a certain retailer.
> 
> 



Assume today's date is `'2021-1-1'`.

Write a solution that will, for each `user_id`, find out the largest `window`
of days between each visit and the one right after it (or today if you are
considering the last visit).

Return the result table ordered by `user_id`.

The query result format is in the following example.



**Example 1:**

> Input: 
> 
> UserVisits table:
> 
> +---------+------------+
> 
> | user_id | visit_date |
> 
> +---------+------------+
> 
> | 1> 
>    | 2020-11-28 |
> 
> | 1> 
>    | 2020-10-20 |
> 
> | 1> 
>    | 2020-12-3  |
> 
> | 2> 
>    | 2020-10-5  |
> 
> | 2> 
>    | 2020-12-9  |
> 
> | 3> 
>    | 2020-11-11 |
> 
> +---------+------------+
> 
> Output: 
> 
> +---------+---------------+
> 
> | user_id | biggest_window|
> 
> +---------+---------------+
> 
> | 1> 
>    | 39> 
> > 
> > 
> |
> 
> | 2> 
>    | 65> 
> > 
> > 
> |
> 
> | 3> 
>    | 51> 
> > 
> > 
> |
> 
> +---------+---------------+
> 
> Explanation: 
> 
> For the first user, the windows in question are between dates:
> 
> > - 2020-10-20 and 2020-11-28 with a total of 39 days. 
> 
> > - 2020-11-28 and 2020-12-3 with a total of 5 days. 
> 
> > - 2020-12-3 and 2021-1-1 with a total of 29 days.
> 
> Making the biggest window the one with 39 days.
> 
> For the second user, the windows in question are between dates:
> 
> > - 2020-10-5 and 2020-12-9 with a total of 65 days.
> 
> > - 2020-12-9 and 2021-1-1 with a total of 23 days.
> 
> Making the biggest window the one with 65 days.
> 
> For the third user, the only window in question is between dates 2020-11-11 and 2021-1-1 with a total of 51 days.
> 
> 


## é¢˜ç›®å¤§æ„

è¡¨ï¼š `UserVisits`

> 
> 
> 
> 
> 
> +-------------+------+
> 
> | Column Name | Type |
> 
> +-------------+------+
> 
> | user_id> 
>  | int  |
> 
> | visit_date  | date |
> 
> +-------------+------+
> 
> è¯¥è¡¨æ²¡æœ‰ä¸»é”®ï¼Œå®ƒå¯èƒ½æœ‰é‡å¤çš„è¡Œ
> 
> è¯¥è¡¨åŒ…å«ç”¨æˆ·è®¿é—®æŸç‰¹å®šé›¶å”®å•†çš„æ—¥æœŸæ—¥å¿—ã€‚



å‡è®¾ä»Šå¤©çš„æ—¥æœŸæ˜¯ `'2021-1-1'` ã€‚

ç¼–å†™è§£å†³æ–¹æ¡ˆï¼Œå¯¹äºæ¯ä¸ª `user_id` ï¼Œæ±‚å‡ºæ¯æ¬¡è®¿é—®åŠå…¶ä¸‹ä¸€ä¸ªè®¿é—®ï¼ˆè‹¥è¯¥æ¬¡è®¿é—®æ˜¯æœ€åä¸€æ¬¡ï¼Œåˆ™ä¸ºä»Šå¤©ï¼‰ä¹‹é—´æœ€å¤§çš„ç©ºæ¡£æœŸå¤©æ•° `window` ã€‚

è¿”å›ç»“æœè¡¨ï¼ŒæŒ‰ç”¨æˆ·ç¼–å· `user_id` æ’åºã€‚

ç»“æœæ ¼å¼å¦‚ä¸‹ç¤ºä¾‹æ‰€ç¤ºï¼š



**ç¤ºä¾‹ 1ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š**
> 
> UserVisits è¡¨ï¼š
> 
> +---------+------------+
> 
> | user_id | visit_date |
> 
> +---------+------------+
> 
> | 1> 
>    | 2020-11-28 |
> 
> | 1> 
>    | 2020-10-20 |
> 
> | 1> 
>    | 2020-12-3  |
> 
> | 2> 
>    | 2020-10-5  |
> 
> | 2> 
>    | 2020-12-9  |
> 
> | 3> 
>    | 2020-11-11 |
> 
> +---------+------------+
> 
> **è¾“å‡ºï¼š**
> 
> +---------+---------------+
> 
> | user_id | biggest_window|
> 
> +---------+---------------+
> 
> | 1> 
>    | 39> 
> > 
> > 
> |
> 
> | 2> 
>    | 65> 
> > 
> > 
> |
> 
> | 3> 
>    | 51> 
> > 
> > 
> |
> 
> +---------+---------------+
> 
> **è§£é‡Šï¼š**
> 
> å¯¹äºç¬¬ä¸€ä¸ªç”¨æˆ·ï¼Œé—®é¢˜ä¸­çš„ç©ºæ¡£æœŸåœ¨ä»¥ä¸‹æ—¥æœŸä¹‹é—´ï¼š
> 
> > - 2020-10-20 è‡³ 2020-11-28 ï¼Œå…±è®¡ 39 å¤©ã€‚
> 
> > - 2020-11-28 è‡³ 2020-12-3 ï¼Œå…±è®¡ 5 å¤©ã€‚
> 
> > - 2020-12-3 è‡³ 2021-1-1 ï¼Œå…±è®¡ 29 å¤©ã€‚
> 
> ç”±æ­¤å¾—å‡ºï¼Œæœ€å¤§çš„ç©ºæ¡£æœŸä¸º 39 å¤©ã€‚
> 
> å¯¹äºç¬¬äºŒä¸ªç”¨æˆ·ï¼Œé—®é¢˜ä¸­çš„ç©ºæ¡£æœŸåœ¨ä»¥ä¸‹æ—¥æœŸä¹‹é—´ï¼š
> 
> > - 2020-10-5 è‡³ 2020-12-9 ï¼Œå…±è®¡ 65 å¤©ã€‚
> 
> > - 2020-12-9 è‡³ 2021-1-1 ï¼Œå…±è®¡ 23 å¤©ã€‚
> 
> ç”±æ­¤å¾—å‡ºï¼Œæœ€å¤§çš„ç©ºæ¡£æœŸä¸º 65 å¤©ã€‚
> 
> å¯¹äºç¬¬ä¸‰ä¸ªç”¨æˆ·ï¼Œé—®é¢˜ä¸­çš„å”¯ä¸€ç©ºæ¡£æœŸåœ¨ 2020-11-11 è‡³ 2021-1-1 ä¹‹é—´ï¼Œå…±è®¡ 51 å¤©ã€‚


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 2228 | [7 å¤©å†…ä¸¤æ¬¡è´­ä¹°çš„ç”¨æˆ·](https://leetcode.com/problems/users-with-two-purchases-within-seven-days) |  |  [`æ•°æ®åº“`](/tag/database.md) | <font color=#ffb800>Medium</font> |