# [2292. è¿ç»­ä¸¤å¹´æœ‰ 3 ä¸ªåŠä»¥ä¸Šè®¢å•çš„äº§å“](https://leetcode.com/problems/products-with-three-or-more-orders-in-two-consecutive-years)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/products-with-three-or-more-orders-in-two-consecutive-years)

## é¢˜ç›®

Table: `Orders`

> 
> 
> 
> 
> 
> +---------------+------+
> 
> | Column Name   | Type |
> 
> +---------------+------+
> 
> | order_id> 
>   | int  |
> 
> | product_id> 
> | int  |
> 
> | quantity> 
>   | int  |
> 
> | purchase_date | date |
> 
> +---------------+------+
> 
> order_id contains unique values.
> 
> Each row in this table contains the ID of an order, the id of the product purchased, the quantity, and the purchase date.
> 
> 



Write a solution to report the IDs of all the products that were ordered three
or more times in two consecutive years.

Return the result table in **any order**.

The result format is shown in the following example.



**Example 1:**

> Input: 
> 
> Orders table:
> 
> +----------+------------+----------+---------------+
> 
> | order_id | product_id | quantity | purchase_date |
> 
> +----------+------------+----------+---------------+
> 
> | 1> 
> > 
> | 1> 
> > 
>   | 7> 
> > 
> | 2020-03-16> 
> |
> 
> | 2> 
> > 
> | 1> 
> > 
>   | 4> 
> > 
> | 2020-12-02> 
> |
> 
> | 3> 
> > 
> | 1> 
> > 
>   | 7> 
> > 
> | 2020-05-10> 
> |
> 
> | 4> 
> > 
> | 1> 
> > 
>   | 6> 
> > 
> | 2021-12-23> 
> |
> 
> | 5> 
> > 
> | 1> 
> > 
>   | 5> 
> > 
> | 2021-05-21> 
> |
> 
> | 6> 
> > 
> | 1> 
> > 
>   | 6> 
> > 
> | 2021-10-11> 
> |
> 
> | 7> 
> > 
> | 2> 
> > 
>   | 6> 
> > 
> | 2022-10-11> 
> |
> 
> +----------+------------+----------+---------------+
> 
> Output: 
> 
> +------------+
> 
> | product_id |
> 
> +------------+
> 
> | 1> 
> > 
>   |
> 
> +------------+
> 
> Explanation: 
> 
> Product 1 was ordered in 2020 three times and in 2021 three times. Since it was ordered three times in two consecutive years, we include it in the answer.
> 
> Product 2 was ordered one time in 2022. We do not include it in the answer.
> 
> 


## é¢˜ç›®å¤§æ„

è¡¨: `Orders`

> 
> 
> 
> 
> 
> +---------------+------+
> 
> | Column Name   | Type |
> 
> +---------------+------+
> 
> | order_id> 
>   | int  |
> 
> | product_id> 
> | int  |
> 
> | quantity> 
>   | int  |
> 
> | purchase_date | date |
> 
> +---------------+------+
> 
> order_id åŒ…å«å”¯ä¸€å€¼ã€‚
> 
> è¯¥è¡¨ä¸­çš„æ¯ä¸€è¡Œéƒ½åŒ…å«è®¢å• IDã€è´­ä¹°çš„äº§å“ IDã€æ•°é‡å’Œè´­ä¹°æ—¥æœŸã€‚
> 
> 



ç¼–å†™è§£å†³æ–¹æ¡ˆï¼Œè·å–è¿ç»­ä¸¤å¹´è®¢è´­ä¸‰æ¬¡æˆ–ä¸‰æ¬¡ä»¥ä¸Šçš„æ‰€æœ‰äº§å“çš„ idã€‚

ä»¥ **ä»»æ„é¡ºåº  **è¿”å›ç»“æœè¡¨ã€‚

ç»“æœæ ¼å¼ç¤ºä¾‹å¦‚ä¸‹ã€‚



**ç¤ºä¾‹ 1:**

> 
> 
> 
> 
> 
> **è¾“å…¥:** 
> 
> Orders è¡¨:
> 
> +----------+------------+----------+---------------+
> 
> | order_id | product_id | quantity | purchase_date |
> 
> +----------+------------+----------+---------------+
> 
> | 1> 
> > 
> | 1> 
> > 
>   | 7> 
> > 
> | 2020-03-16> 
> |
> 
> | 2> 
> > 
> | 1> 
> > 
>   | 4> 
> > 
> | 2020-12-02> 
> |
> 
> | 3> 
> > 
> | 1> 
> > 
>   | 7> 
> > 
> | 2020-05-10> 
> |
> 
> | 4> 
> > 
> | 1> 
> > 
>   | 6> 
> > 
> | 2021-12-23> 
> |
> 
> | 5> 
> > 
> | 1> 
> > 
>   | 5> 
> > 
> | 2021-05-21> 
> |
> 
> | 6> 
> > 
> | 1> 
> > 
>   | 6> 
> > 
> | 2021-10-11> 
> |
> 
> | 7> 
> > 
> | 2> 
> > 
>   | 6> 
> > 
> | 2022-10-11> 
> |
> 
> +----------+------------+----------+---------------+
> 
> **è¾“å‡º:** 
> 
> +------------+
> 
> | product_id |
> 
> +------------+
> 
> | 1> 
> > 
>   |
> 
> +------------+
> 
> **è§£é‡Š:** 
> 
> äº§å“ 1 åœ¨ 2020 å¹´å’Œ 2021 å¹´éƒ½åˆ†åˆ«è®¢è´­äº†ä¸‰æ¬¡ã€‚ç”±äºè¿ç»­ä¸¤å¹´è®¢è´­äº†ä¸‰æ¬¡ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†å…¶åŒ…å«åœ¨ç­”æ¡ˆä¸­ã€‚
> 
> äº§å“ 2 åœ¨ 2022 å¹´è®¢è´­äº†ä¸€æ¬¡ã€‚æˆ‘ä»¬ä¸æŠŠå®ƒåŒ…æ‹¬åœ¨ç­”æ¡ˆä¸­ã€‚
> 
> 


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```