# [3068. æœ€å¤§èŠ‚ç‚¹ä»·å€¼ä¹‹å’Œ](https://2xiao.github.io/leetcode-js/problem/3068.html)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`è´ªå¿ƒ`](/tag/greedy.md) [`ä½è¿ç®—`](/tag/bit-manipulation.md) [`æ ‘`](/tag/tree.md) [`æ•°ç»„`](/tag/array.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md) [`æ’åº`](/tag/sorting.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/find-the-maximum-sum-of-node-values) [`LeetCode`](https://leetcode.com/problems/find-the-maximum-sum-of-node-values)

## é¢˜ç›®

There exists an **undirected** tree with `n` nodes numbered `0` to `n - 1`.
You are given a **0-indexed** 2D integer array `edges` of length `n - 1`,
where `edges[i] = [ui, vi]` indicates that there is an edge between nodes `ui`
and `vi` in the tree. You are also given a **positive** integer `k`, and a
**0-indexed** array of **non-negative** integers `nums` of length `n`, where
`nums[i]` represents the **value** of the node numbered `i`.

Alice wants the sum of values of tree nodes to be **maximum** , for which
Alice can perform the following operation **any** number of times (**including
zero**) on the tree:

  * Choose any edge `[u, v]` connecting the nodes `u` and `v`, and update their values as follows: 
> 
> * `nums[u] = nums[u] XOR k`
> 
> * `nums[v] = nums[v] XOR k`

Return _the**maximum** possible **sum** of the **values** Alice can achieve by
performing the operation **any** number of times_.



**Example 1:**

![](https://assets.leetcode.com/uploads/2023/11/09/screenshot-2023-11-10-012513.png)

> Input: nums = [1,2,1], k = 3, edges = [[0,1],[0,2]]
> 
> Output: 6
> 
> Explanation: Alice can achieve the maximum sum of 6 using a single operation:
> - Choose the edge [0,2]. nums[0] and nums[2] become: 1 XOR 3 = 2, and the array nums becomes: [1,2,1] -> [2,2,2].
> 
> The total sum of values is 2 + 2 + 2 = 6.
> 
> It can be shown that 6 is the maximum achievable sum of values.

**Example 2:**

![](https://assets.leetcode.com/uploads/2024/01/09/screenshot-2024-01-09-220017.png)

> Input: nums = [2,3], k = 7, edges = [[0,1]]
> 
> Output: 9
> 
> Explanation: Alice can achieve the maximum sum of 9 using a single operation:
> - Choose the edge [0,1]. nums[0] becomes: 2 XOR 7 = 5 and nums[1] become: 3 XOR 7 = 4, and the array nums becomes: [2,3] -> [5,4].
> 
> The total sum of values is 5 + 4 = 9.
> 
> It can be shown that 9 is the maximum achievable sum of values.

**Example 3:**

![](https://assets.leetcode.com/uploads/2023/11/09/screenshot-2023-11-10-012641.png)

> Input: nums = [7,7,7,7,7,7], k = 3, edges = [[0,1],[0,2],[0,3],[0,4],[0,5]]
> 
> Output: 42
> 
> Explanation: The maximum achievable sum is 42 which can be achieved by Alice performing no operations.

**Constraints:**

  * `2 <= n == nums.length <= 2 * 10^4`
  * `1 <= k <= 10^9`
  * `0 <= nums[i] <= 10^9`
  * `edges.length == n - 1`
  * `edges[i].length == 2`
  * `0 <= edges[i][0], edges[i][1] <= n - 1`
  * The input is generated such that `edges` represent a valid tree.


## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€æ£µ `n` ä¸ªèŠ‚ç‚¹çš„ **æ— å‘**  æ ‘ï¼ŒèŠ‚ç‚¹ä» `0` åˆ° `n - 1` ç¼–å·ã€‚æ ‘ä»¥é•¿åº¦ä¸º `n - 1` ä¸‹æ ‡ä» **0**
å¼€å§‹çš„äºŒç»´æ•´æ•°æ•°ç»„ `edges` çš„å½¢å¼ç»™ä½ ï¼Œå…¶ä¸­ `edges[i] = [ui, vi]` è¡¨ç¤ºæ ‘ä¸­èŠ‚ç‚¹ `ui` å’Œ `vi`
ä¹‹é—´æœ‰ä¸€æ¡è¾¹ã€‚åŒæ—¶ç»™ä½ ä¸€ä¸ª **æ­£**  æ•´æ•° `k` å’Œä¸€ä¸ªé•¿åº¦ä¸º `n` ä¸‹æ ‡ä» **0**  å¼€å§‹çš„ **éè´Ÿ**  æ•´æ•°æ•°ç»„ `nums` ï¼Œå…¶ä¸­
`nums[i]` è¡¨ç¤ºèŠ‚ç‚¹ `i` çš„ **ä»·å€¼**  ã€‚

Alice æƒ³ **æœ€å¤§åŒ–**  æ ‘ä¸­æ‰€æœ‰èŠ‚ç‚¹ä»·å€¼ä¹‹å’Œã€‚ä¸ºäº†å®ç°è¿™ä¸€ç›®æ ‡ï¼ŒAlice å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œ **ä»»æ„**  æ¬¡ï¼ˆ**åŒ…æ‹¬****  0
æ¬¡**ï¼‰ï¼š

  * é€‰æ‹©è¿æ¥èŠ‚ç‚¹ `u` å’Œ `v` çš„è¾¹ `[u, v]` ï¼Œå¹¶å°†å®ƒä»¬çš„å€¼æ›´æ–°ä¸ºï¼š 
> 
> * `nums[u] = nums[u] XOR k`
> 
> * `nums[v] = nums[v] XOR k`

è¯·ä½ è¿”å› Alice é€šè¿‡æ‰§è¡Œä»¥ä¸Šæ“ä½œ **ä»»æ„æ¬¡**  åï¼Œå¯ä»¥å¾—åˆ°æ‰€æœ‰èŠ‚ç‚¹ **ä»·å€¼ä¹‹å’Œ**  çš„ **æœ€å¤§å€¼**  ã€‚



**ç¤ºä¾‹ 1ï¼š**

![](https://assets.leetcode.com/uploads/2023/11/09/screenshot-2023-11-10-012513.png)

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** nums = [1,2,1], k = 3, edges = [[0,1],[0,2]]
> 
> **è¾“å‡ºï¼š** 6
> 
> **è§£é‡Šï¼š** Alice å¯ä»¥é€šè¿‡ä¸€æ¬¡æ“ä½œå¾—åˆ°æœ€å¤§ä»·å€¼å’Œ 6 ï¼š
> - é€‰æ‹©è¾¹ [0,2] ã€‚nums[0] å’Œ nums[2] éƒ½å˜ä¸ºï¼š1 XOR 3 = 2 ï¼Œæ•°ç»„ nums å˜ä¸ºï¼š[1,2,1] -> [2,2,2] ã€‚
> 
> æ‰€æœ‰èŠ‚ç‚¹ä»·å€¼ä¹‹å’Œä¸º 2 + 2 + 2 = 6 ã€‚
> 
> 6 æ˜¯å¯ä»¥å¾—åˆ°æœ€å¤§çš„ä»·å€¼ä¹‹å’Œã€‚
> 
> 

**ç¤ºä¾‹ 2ï¼š**

![](https://assets.leetcode.com/uploads/2024/01/09/screenshot-2024-01-09-220017.png)

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** nums = [2,3], k = 7, edges = [[0,1]]
> 
> **è¾“å‡ºï¼š** 9
> 
> **è§£é‡Šï¼š** Alice å¯ä»¥é€šè¿‡ä¸€æ¬¡æ“ä½œå¾—åˆ°æœ€å¤§å’Œ 9 ï¼š
> - é€‰æ‹©è¾¹ [0,1] ã€‚nums[0] å˜ä¸ºï¼š2 XOR 7 = 5 ï¼Œnums[1] å˜ä¸ºï¼š3 XOR 7 = 4 ï¼Œæ•°ç»„ nums å˜ä¸ºï¼š[2,3] -> [5,4] ã€‚
> 
> æ‰€æœ‰èŠ‚ç‚¹ä»·å€¼ä¹‹å’Œä¸º 5 + 4 = 9 ã€‚
> 
> 9 æ˜¯å¯ä»¥å¾—åˆ°æœ€å¤§çš„ä»·å€¼ä¹‹å’Œã€‚
> 
> 

**ç¤ºä¾‹ 3ï¼š**

![](https://assets.leetcode.com/uploads/2023/11/09/screenshot-2023-11-10-012641.png)

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** nums = [7,7,7,7,7,7], k = 3, edges = [[0,1],[0,2],[0,3],[0,4],[0,5]]
> 
> **è¾“å‡ºï¼š** 42
> 
> **è§£é‡Šï¼š** Alice ä¸éœ€è¦æ‰§è¡Œä»»ä½•æ“ä½œï¼Œå°±å¯ä»¥å¾—åˆ°æœ€å¤§ä»·å€¼ä¹‹å’Œ 42 ã€‚
> 
> 



**æç¤ºï¼š**

  * `2 <= n == nums.length <= 2 * 10^4`
  * `1 <= k <= 10^9`
  * `0 <= nums[i] <= 10^9`
  * `edges.length == n - 1`
  * `edges[i].length == 2`
  * `0 <= edges[i][0], edges[i][1] <= n - 1`
  * è¾“å…¥ä¿è¯ `edges` æ„æˆä¸€æ£µåˆæ³•çš„æ ‘ã€‚


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 2925 | [åœ¨æ ‘ä¸Šæ‰§è¡Œæ“ä½œä»¥åå¾—åˆ°çš„æœ€å¤§åˆ†æ•°](https://leetcode.com/problems/maximum-score-after-applying-operations-on-a-tree) |  |  [`æ ‘`](/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/tag/depth-first-search.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md) | <font color=#ffb800>Medium</font> |
| 2973 | [æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹æ”¾ç½®çš„é‡‘å¸æ•°ç›®](https://leetcode.com/problems/find-number-of-coins-to-place-in-tree-nodes) |  |  [`æ ‘`](/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/tag/depth-first-search.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md) `2+` | <font color=#ff334b>Hard</font> |