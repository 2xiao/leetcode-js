---
title: 1882. ä½¿ç”¨æœåŠ¡å™¨å¤„ç†ä»»åŠ¡
description: LeetCode,1882. ä½¿ç”¨æœåŠ¡å™¨å¤„ç†ä»»åŠ¡,ä½¿ç”¨æœåŠ¡å™¨å¤„ç†ä»»åŠ¡,Process Tasks Using Servers,è§£é¢˜æ€è·¯,æ•°ç»„,å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰
keywords:
  - LeetCode
  - 1882. ä½¿ç”¨æœåŠ¡å™¨å¤„ç†ä»»åŠ¡
  - ä½¿ç”¨æœåŠ¡å™¨å¤„ç†ä»»åŠ¡
  - Process Tasks Using Servers
  - è§£é¢˜æ€è·¯
  - æ•°ç»„
  - å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰
---

# 1882. ä½¿ç”¨æœåŠ¡å™¨å¤„ç†ä»»åŠ¡

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°ç»„`](/tag/array.md) [`å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰`](/tag/heap-priority-queue.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/process-tasks-using-servers) [`LeetCode`](https://leetcode.com/problems/process-tasks-using-servers)

## é¢˜ç›®

You are given two **0-indexed** integer arrays `servers` and `tasks` of
lengths `n`â€‹â€‹â€‹â€‹â€‹â€‹ and `m`â€‹â€‹â€‹â€‹â€‹â€‹ respectively. `servers[i]` is the **weight**
of the `iâ€‹â€‹â€‹â€‹â€‹â€‹th`â€‹â€‹â€‹â€‹ server, and `tasks[j]` is the **time needed** to
process the `jâ€‹â€‹â€‹â€‹â€‹â€‹th`â€‹â€‹â€‹â€‹ task **in seconds**.

Tasks are assigned to the servers using a **task queue**. Initially, all
servers are free, and the queue is **empty**.

At second `j`, the `jth` task is **inserted** into the queue (starting with
the `0th` task being inserted at second `0`). As long as there are free
servers and the queue is not empty, the task in the front of the queue will be
assigned to a free server with the **smallest weight** , and in case of a tie,
it is assigned to a free server with the **smallest index**.

If there are no free servers and the queue is not empty, we wait until a
server becomes free and immediately assign the next task. If multiple servers
become free at the same time, then multiple tasks from the queue will be
assigned **in order of insertion** following the weight and index priorities
above.

A server that is assigned task `j` at second `t` will be free again at second
`t + tasks[j]`.

Build an array `ans`â€‹â€‹â€‹â€‹ of length `m`, where `ans[j]` is the **index** of the
server the `jâ€‹â€‹â€‹â€‹â€‹â€‹th` task will be assigned to.

Return _the array_`ans`â€‹â€‹â€‹â€‹.



**Example 1:**

> Input: servers = [3,3,2], tasks = [1,2,3,2,1,2]
> 
> Output: [2,2,0,2,1,2]
> 
> Explanation: Events in chronological order go as follows:
> - At second 0, task 0 is added and processed using server 2 until second 1.
> - At second 1, server 2 becomes free. Task 1 is added and processed using server 2 until second 3.
> - At second 2, task 2 is added and processed using server 0 until second 5.
> - At second 3, server 2 becomes free. Task 3 is added and processed using server 2 until second 5.
> - At second 4, task 4 is added and processed using server 1 until second 5.
> - At second 5, all servers become free. Task 5 is added and processed using server 2 until second 7.

**Example 2:**

> Input: servers = [5,1,4,3,2], tasks = [2,1,2,4,5,2,1]
> 
> Output: [1,4,1,4,1,3,2]
> 
> Explanation: Events in chronological order go as follows: 
> - At second 0, task 0 is added and processed using server 1 until second 2.
> - At second 1, task 1 is added and processed using server 4 until second 2.
> - At second 2, servers 1 and 4 become free. Task 2 is added and processed using server 1 until second 4. 
> - At second 3, task 3 is added and processed using server 4 until second 7.
> - At second 4, server 1 becomes free. Task 4 is added and processed using server 1 until second 9. 
> - At second 5, task 5 is added and processed using server 3 until second 7.
> - At second 6, task 6 is added and processed using server 2 until second 7.

**Constraints:**

  * `servers.length == n`
  * `tasks.length == m`
  * `1 <= n, m <= 2 * 10^5`
  * `1 <= servers[i], tasks[j] <= 2 * 10^5`


## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸¤ä¸ª **ä¸‹æ ‡ä» 0 å¼€å§‹** çš„æ•´æ•°æ•°ç»„ `servers` å’Œ `tasks` ï¼Œé•¿åº¦åˆ†åˆ«ä¸º `n`â€‹â€‹â€‹â€‹â€‹â€‹ å’Œ `m`â€‹â€‹â€‹â€‹â€‹â€‹
ã€‚`servers[i]` æ˜¯ç¬¬ `iâ€‹â€‹â€‹â€‹â€‹â€‹`â€‹â€‹â€‹â€‹ å°æœåŠ¡å™¨çš„ **æƒé‡** ï¼Œè€Œ `tasks[j]` æ˜¯å¤„ç†ç¬¬ `jâ€‹â€‹â€‹â€‹â€‹â€‹` é¡¹ä»»åŠ¡
**æ‰€éœ€è¦çš„æ—¶é—´** ï¼ˆå•ä½ï¼šç§’ï¼‰ã€‚

ä½ æ­£åœ¨è¿è¡Œä¸€ä¸ªä»¿çœŸç³»ç»Ÿï¼Œåœ¨å¤„ç†å®Œæ‰€æœ‰ä»»åŠ¡åï¼Œè¯¥ç³»ç»Ÿå°†ä¼šå…³é—­ã€‚æ¯å°æœåŠ¡å™¨åªèƒ½åŒæ—¶å¤„ç†ä¸€é¡¹ä»»åŠ¡ã€‚ç¬¬ `0` é¡¹ä»»åŠ¡åœ¨ç¬¬ `0` ç§’å¯ä»¥å¼€å§‹å¤„ç†ï¼Œç›¸åº”åœ°ï¼Œç¬¬
`j` é¡¹ä»»åŠ¡åœ¨ç¬¬ `j` ç§’å¯ä»¥å¼€å§‹å¤„ç†ã€‚å¤„ç†ç¬¬ `j` é¡¹ä»»åŠ¡æ—¶ï¼Œä½ éœ€è¦ä¸ºå®ƒåˆ†é…ä¸€å° **æƒé‡æœ€å°**
çš„ç©ºé—²æœåŠ¡å™¨ã€‚å¦‚æœå­˜åœ¨å¤šå°ç›¸åŒæƒé‡çš„ç©ºé—²æœåŠ¡å™¨ï¼Œè¯·é€‰æ‹© **ä¸‹æ ‡æœ€å°** çš„æœåŠ¡å™¨ã€‚å¦‚æœä¸€å°ç©ºé—²æœåŠ¡å™¨åœ¨ç¬¬ `t` ç§’åˆ†é…åˆ°ç¬¬ `j` é¡¹ä»»åŠ¡ï¼Œé‚£ä¹ˆåœ¨ `t
+ tasks[j]` æ—¶å®ƒå°†æ¢å¤ç©ºé—²çŠ¶æ€ã€‚

å¦‚æœæ²¡æœ‰ç©ºé—²æœåŠ¡å™¨ï¼Œåˆ™å¿…é¡»ç­‰å¾…ï¼Œç›´åˆ°å‡ºç°ä¸€å°ç©ºé—²æœåŠ¡å™¨ï¼Œå¹¶ **å°½å¯èƒ½æ—©** åœ°å¤„ç†å‰©ä½™ä»»åŠ¡ã€‚ å¦‚æœæœ‰å¤šé¡¹ä»»åŠ¡ç­‰å¾…åˆ†é…ï¼Œåˆ™æŒ‰ç…§ **ä¸‹æ ‡é€’å¢**
çš„é¡ºåºå®Œæˆåˆ†é…ã€‚

å¦‚æœåŒä¸€æ—¶åˆ»å­˜åœ¨å¤šå°ç©ºé—²æœåŠ¡å™¨ï¼Œå¯ä»¥åŒæ—¶å°†å¤šé¡¹ä»»åŠ¡åˆ†åˆ«åˆ†é…ç»™å®ƒä»¬ã€‚

æ„å»ºé•¿åº¦ä¸º `m` çš„ç­”æ¡ˆæ•°ç»„ `ans` ï¼Œå…¶ä¸­ `ans[j]` æ˜¯ç¬¬ `j` é¡¹ä»»åŠ¡åˆ†é…çš„æœåŠ¡å™¨çš„ä¸‹æ ‡ã€‚

è¿”å›ç­”æ¡ˆæ•°ç»„ __`ans`â€‹â€‹â€‹â€‹ ã€‚

**ç¤ºä¾‹ 1ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** servers = [3,3,2], tasks = [1,2,3,2,1,2]
> 
> **è¾“å‡ºï¼š**[2,2,0,2,1,2]
> 
> **è§£é‡Šï¼š** äº‹ä»¶æŒ‰æ—¶é—´é¡ºåºå¦‚ä¸‹ï¼š
> - 0 ç§’æ—¶ï¼Œç¬¬ 0 é¡¹ä»»åŠ¡åŠ å…¥åˆ°ä»»åŠ¡é˜Ÿåˆ—ï¼Œä½¿ç”¨ç¬¬ 2 å°æœåŠ¡å™¨å¤„ç†åˆ° 1 ç§’ã€‚
> - 1 ç§’æ—¶ï¼Œç¬¬ 2 å°æœåŠ¡å™¨ç©ºé—²ï¼Œç¬¬ 1 é¡¹ä»»åŠ¡åŠ å…¥åˆ°ä»»åŠ¡é˜Ÿåˆ—ï¼Œä½¿ç”¨ç¬¬ 2 å°æœåŠ¡å™¨å¤„ç†åˆ° 3 ç§’ã€‚
> - 2 ç§’æ—¶ï¼Œç¬¬ 2 é¡¹ä»»åŠ¡åŠ å…¥åˆ°ä»»åŠ¡é˜Ÿåˆ—ï¼Œä½¿ç”¨ç¬¬ 0 å°æœåŠ¡å™¨å¤„ç†åˆ° 5 ç§’ã€‚
> - 3 ç§’æ—¶ï¼Œç¬¬ 2 å°æœåŠ¡å™¨ç©ºé—²ï¼Œç¬¬ 3 é¡¹ä»»åŠ¡åŠ å…¥åˆ°ä»»åŠ¡é˜Ÿåˆ—ï¼Œä½¿ç”¨ç¬¬ 2 å°æœåŠ¡å™¨å¤„ç†åˆ° 5 ç§’ã€‚
> - 4 ç§’æ—¶ï¼Œç¬¬ 4 é¡¹ä»»åŠ¡åŠ å…¥åˆ°ä»»åŠ¡é˜Ÿåˆ—ï¼Œä½¿ç”¨ç¬¬ 1 å°æœåŠ¡å™¨å¤„ç†åˆ° 5 ç§’ã€‚
> - 5 ç§’æ—¶ï¼Œæ‰€æœ‰æœåŠ¡å™¨éƒ½ç©ºé—²ï¼Œç¬¬ 5 é¡¹ä»»åŠ¡åŠ å…¥åˆ°ä»»åŠ¡é˜Ÿåˆ—ï¼Œä½¿ç”¨ç¬¬ 2 å°æœåŠ¡å™¨å¤„ç†åˆ° 7 ç§’ã€‚

**ç¤ºä¾‹ 2ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** servers = [5,1,4,3,2], tasks = [2,1,2,4,5,2,1]
> 
> **è¾“å‡ºï¼š**[1,4,1,4,1,3,2]
> 
> **è§£é‡Šï¼š** äº‹ä»¶æŒ‰æ—¶é—´é¡ºåºå¦‚ä¸‹ï¼š
> - 0 ç§’æ—¶ï¼Œç¬¬ 0 é¡¹ä»»åŠ¡åŠ å…¥åˆ°ä»»åŠ¡é˜Ÿåˆ—ï¼Œä½¿ç”¨ç¬¬ 1 å°æœåŠ¡å™¨å¤„ç†åˆ° 2 ç§’ã€‚
> - 1 ç§’æ—¶ï¼Œç¬¬ 1 é¡¹ä»»åŠ¡åŠ å…¥åˆ°ä»»åŠ¡é˜Ÿåˆ—ï¼Œä½¿ç”¨ç¬¬ 4 å°æœåŠ¡å™¨å¤„ç†åˆ° 2 ç§’ã€‚
> - 2 ç§’æ—¶ï¼Œç¬¬ 1 å°å’Œç¬¬ 4 å°æœåŠ¡å™¨ç©ºé—²ï¼Œç¬¬ 2 é¡¹ä»»åŠ¡åŠ å…¥åˆ°ä»»åŠ¡é˜Ÿåˆ—ï¼Œä½¿ç”¨ç¬¬ 1 å°æœåŠ¡å™¨å¤„ç†åˆ° 4 ç§’ã€‚
> - 3 ç§’æ—¶ï¼Œç¬¬ 3 é¡¹ä»»åŠ¡åŠ å…¥åˆ°ä»»åŠ¡é˜Ÿåˆ—ï¼Œä½¿ç”¨ç¬¬ 4 å°æœåŠ¡å™¨å¤„ç†åˆ° 7 ç§’ã€‚
> - 4 ç§’æ—¶ï¼Œç¬¬ 1 å°æœåŠ¡å™¨ç©ºé—²ï¼Œç¬¬ 4 é¡¹ä»»åŠ¡åŠ å…¥åˆ°ä»»åŠ¡é˜Ÿåˆ—ï¼Œä½¿ç”¨ç¬¬ 1 å°æœåŠ¡å™¨å¤„ç†åˆ° 9 ç§’ã€‚
> - 5 ç§’æ—¶ï¼Œç¬¬ 5 é¡¹ä»»åŠ¡åŠ å…¥åˆ°ä»»åŠ¡é˜Ÿåˆ—ï¼Œä½¿ç”¨ç¬¬ 3 å°æœåŠ¡å™¨å¤„ç†åˆ° 7 ç§’ã€‚
> - 6 ç§’æ—¶ï¼Œç¬¬ 6 é¡¹ä»»åŠ¡åŠ å…¥åˆ°ä»»åŠ¡é˜Ÿåˆ—ï¼Œä½¿ç”¨ç¬¬ 2 å°æœåŠ¡å™¨å¤„ç†åˆ° 7 ç§’ã€‚

**æç¤ºï¼š**

  * `servers.length == n`
  * `tasks.length == m`
  * `1 <= n, m <= 2 * 10^5`
  * `1 <= servers[i], tasks[j] <= 2 * 10^5`


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ | åŠ›æ‰£ |
| :------: | :------ | :------: | :------ | :------: | :------: |
| 2050 | å¹¶è¡Œè¯¾ç¨‹ III |  |  [`å›¾`](/tag/graph.md) [`æ‹“æ‰‘æ’åº`](/tag/topological-sort.md) [`æ•°ç»„`](/tag/array.md) `1+` | ğŸ”´ | [ğŸ€„ï¸](https://leetcode.cn/problems/parallel-courses-iii) [ğŸ”—](https://leetcode.com/problems/parallel-courses-iii) |