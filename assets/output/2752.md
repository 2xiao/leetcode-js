# [2752. åœ¨è¿ç»­å¤©æ•°ä¸Šè¿›è¡Œäº†æœ€å¤šäº¤æ˜“æ¬¡æ•°çš„é¡¾å®¢](https://leetcode.com/problems/customers-with-maximum-number-of-transactions-on-consecutive-days)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/customers-with-maximum-number-of-transactions-on-consecutive-days)

## é¢˜ç›®

Table: `Transactions`

> 
> 
> 
> 
> 
> +------------------+------+
> 
> | Column Name> 
>   | Type |
> 
> +------------------+------+
> 
> | transaction_id   | int  |
> 
> | customer_id> 
>   | int  |
> 
> | transaction_date | date |
> 
> | amount> 
> > 
>    | int  |
> 
> +------------------+------+
> 
> transaction_id is the column with unique values of this table.
> 
> Each row contains information about transactions that includes unique (customer_id, transaction_date) along with the corresponding customer_id and amount.   
> 
> 

Write a solution to find all `customer_id` who made the maximum number of
transactions on consecutive days.

Return all `customer_id` with the maximum number of consecutive transactions.
Order the result table by `customer_id` in **ascending** order.

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Transactions table:
> 
> +----------------+-------------+------------------+--------+
> 
> | transaction_id | customer_id | transaction_date | amount |
> 
> +----------------+-------------+------------------+--------+
> 
> | 1> 
> > 
> > 
>   | 101> 
> > 
>  | 2023-05-01> 
>    | 100> 
> |
> 
> | 2> 
> > 
> > 
>   | 101> 
> > 
>  | 2023-05-02> 
>    | 150> 
> |
> 
> | 3> 
> > 
> > 
>   | 101> 
> > 
>  | 2023-05-03> 
>    | 200> 
> |
> 
> | 4> 
> > 
> > 
>   | 102> 
> > 
>  | 2023-05-01> 
>    | 50> 
>  |
> 
> | 5> 
> > 
> > 
>   | 102> 
> > 
>  | 2023-05-03> 
>    | 100> 
> |
> 
> | 6> 
> > 
> > 
>   | 102> 
> > 
>  | 2023-05-04> 
>    | 200> 
> |
> 
> | 7> 
> > 
> > 
>   | 105> 
> > 
>  | 2023-05-01> 
>    | 100> 
> |
> 
> | 8> 
> > 
> > 
>   | 105> 
> > 
>  | 2023-05-02> 
>    | 150> 
> |
> 
> | 9> 
> > 
> > 
>   | 105> 
> > 
>  | 2023-05-03> 
>    | 200> 
> |
> 
> +----------------+-------------+------------------+--------+
> 
> Output: 
> 
> +-------------+
> 
> | customer_id | 
> 
> +-------------+
> 
> | 101> 
> > 
>  | 
> 
> | 105> 
> > 
>  | 
> 
> +-------------+
> 
> Explanation: 
> - customer_id 101 has a total of 3 transactions, and all of them are consecutive.
> - customer_id 102 has a total of 3 transactions, but only 2 of them are consecutive. 
> - customer_id 105 has a total of 3 transactions, and all of them are consecutive.
> 
> In total, the highest number of consecutive transactions is 3, achieved by customer_id 101 and 105. The customer_id are sorted in ascending order.
> 
> 


## é¢˜ç›®å¤§æ„

è¡¨ï¼š `Transactions`

> 
> 
> 
> 
> 
> +------------------+------+
> 
> | åˆ—å> 
> > 
> > 
>  | ç±»å‹ |
> 
> +------------------+------+
> 
> | transaction_id   | int  |
> 
> | customer_id> 
>   | int  |
> 
> | transaction_date | date |
> 
> | amount> 
> > 
>    | int  |
> 
> +------------------+------+
> 
> transaction_id æ˜¯è¿™ä¸ªè¡¨çš„å…·æœ‰å”¯ä¸€å€¼çš„åˆ—ã€‚ 
> 
> æ¯è¡ŒåŒ…å«æœ‰å…³äº¤æ˜“çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬å”¯ä¸€çš„ï¼ˆcustomer_idï¼Œtransaction_dateï¼‰ä»¥åŠç›¸åº”çš„ customer_id å’Œ amountã€‚
> 
> 

ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œæ‰¾åˆ°è¿ç»­å¤©æ•°ä¸Šè¿›è¡Œäº†æœ€å¤šäº¤æ˜“çš„æ‰€æœ‰ `customer_id` ã€‚

è¿”å›æ‰€æœ‰å…·æœ‰æœ€å¤§è¿ç»­äº¤æ˜“æ¬¡æ•°çš„ `customer_id` ã€‚ç»“æœè¡¨æŒ‰ `customer_id` çš„ **å‡åº** æ’åºã€‚

ç»“æœçš„æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š**
> 
> Transactions è¡¨:
> 
> +----------------+-------------+------------------+--------+
> 
> | transaction_id | customer_id | transaction_date | amount |
> 
> +----------------+-------------+------------------+--------+
> 
> | 1> 
> > 
> > 
>   | 101> 
> > 
>  | 2023-05-01> 
>    | 100> 
> |
> 
> | 2> 
> > 
> > 
>   | 101> 
> > 
>  | 2023-05-02> 
>    | 150> 
> |
> 
> | 3> 
> > 
> > 
>   | 101> 
> > 
>  | 2023-05-03> 
>    | 200> 
> |
> 
> | 4> 
> > 
> > 
>   | 102> 
> > 
>  | 2023-05-01> 
>    | 50> 
>  |
> 
> | 5> 
> > 
> > 
>   | 102> 
> > 
>  | 2023-05-03> 
>    | 100> 
> |
> 
> | 6> 
> > 
> > 
>   | 102> 
> > 
>  | 2023-05-04> 
>    | 200> 
> |
> 
> | 7> 
> > 
> > 
>   | 105> 
> > 
>  | 2023-05-01> 
>    | 100> 
> |
> 
> | 8> 
> > 
> > 
>   | 105> 
> > 
>  | 2023-05-02> 
>    | 150> 
> |
> 
> | 9> 
> > 
> > 
>   | 105> 
> > 
>  | 2023-05-03> 
>    | 200> 
> |
> 
> +----------------+-------------+------------------+--------+
> 
> **è¾“å‡ºï¼š**
> 
> +-------------+
> 
> | customer_id | 
> 
> +-------------+
> 
> | 101> 
> > 
>  | 
> 
> | 105> 
> > 
>  | 
> 
> +-------------+
> 
> **è§£é‡Šï¼š**
> - customer_id ä¸º 101 å…±æœ‰ 3 æ¬¡äº¤æ˜“ï¼Œä¸”å…¨éƒ¨æ˜¯è¿ç»­çš„ã€‚
> - customer_id ä¸º 102 å…±æœ‰ 3 æ¬¡äº¤æ˜“ï¼Œä½†åªæœ‰å…¶ä¸­ 2 æ¬¡æ˜¯è¿ç»­çš„ã€‚
> - customer_id ä¸º 105 å…±æœ‰ 3 æ¬¡äº¤æ˜“ï¼Œä¸”å…¨éƒ¨æ˜¯è¿ç»­çš„ã€‚ 
> 
> æ€»çš„æ¥è¯´ï¼Œæœ€å¤§è¿ç»­äº¤æ˜“æ¬¡æ•°ä¸º 3ï¼Œç”± customer_id ä¸º 101 å’Œ 105 çš„å®Œæˆã€‚customer_id æŒ‰å‡åºæ’åºã€‚


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```