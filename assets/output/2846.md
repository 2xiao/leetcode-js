# [2846. è¾¹æƒé‡å‡ç­‰æŸ¥è¯¢](https://leetcode.com/problems/minimum-edge-weight-equilibrium-queries-in-a-tree)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ ‘`](/leetcode/outline/tag/tree.md) [`å›¾`](/leetcode/outline/tag/graph.md) [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`å¼ºè¿é€šåˆ†é‡`](/leetcode/outline/tag/strongly-connected-component.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/minimum-edge-weight-equilibrium-queries-in-a-tree)


## é¢˜ç›®

There is an undirected tree with `n` nodes labeled from `0` to `n - 1`. You
are given the integer `n` and a 2D integer array `edges` of length `n - 1`,
where `edges[i] = [ui, vi, wi]` indicates that there is an edge between nodes
`ui` and `vi` with weight `wi` in the tree.

You are also given a 2D integer array `queries` of length `m`, where
`queries[i] = [ai, bi]`. For each query, find the **minimum number of
operations** required to make the weight of every edge on the path from `ai`
to `bi` equal. In one operation, you can choose any edge of the tree and
change its weight to any value.

**Note** that:

  * Queries are **independent** of each other, meaning that the tree returns to its **initial state** on each new query.
  * The path from `ai` to `bi` is a sequence of **distinct** nodes starting with node `ai` and ending with node `bi` such that every two adjacent nodes in the sequence share an edge in the tree.

Return _an array_`answer` _of length_`m` _where_ `answer[i]` _is the answer to
the_ `ith` _query._



**Example 1:**

![](https://assets.leetcode.com/uploads/2023/08/11/graph-6-1.png)

> Input: n = 7, edges = [[0,1,1],[1,2,1],[2,3,1],[3,4,2],[4,5,2],[5,6,2]], queries = [[0,3],[3,6],[2,6],[0,6]]
> 
> Output: [0,0,1,3]
> 
> Explanation: In the first query, all the edges in the path from 0 to 3 have a weight of 1. Hence, the answer is 0.
> 
> In the second query, all the edges in the path from 3 to 6 have a weight of 2. Hence, the answer is 0.
> 
> In the third query, we change the weight of edge [2,3] to 2. After this operation, all the edges in the path from 2 to 6 have a weight of 2. Hence, the answer is 1.
> 
> In the fourth query, we change the weights of edges [0,1], [1,2] and [2,3] to 2. After these operations, all the edges in the path from 0 to 6 have a weight of 2. Hence, the answer is 3.
> 
> For each queries[i], it can be shown that answer[i] is the minimum number of operations needed to equalize all the edge weights in the path from ai to bi.

**Example 2:**

![](https://assets.leetcode.com/uploads/2023/08/11/graph-9-1.png)

> Input: n = 8, edges = [[1,2,6],[1,3,4],[2,4,6],[2,5,3],[3,6,6],[3,0,8],[7,0,2]], queries = [[4,6],[0,4],[6,5],[7,4]]
> 
> Output: [1,2,2,3]
> 
> Explanation: In the first query, we change the weight of edge [1,3] to 6. After this operation, all the edges in the path from 4 to 6 have a weight of 6. Hence, the answer is 1.
> 
> In the second query, we change the weight of edges [0,3] and [3,1] to 6. After these operations, all the edges in the path from 0 to 4 have a weight of 6. Hence, the answer is 2.
> 
> In the third query, we change the weight of edges [1,3] and [5,2] to 6. After these operations, all the edges in the path from 6 to 5 have a weight of 6. Hence, the answer is 2.
> 
> In the fourth query, we change the weights of edges [0,7], [0,3] and [1,3] to 6. After these operations, all the edges in the path from 7 to 4 have a weight of 6. Hence, the answer is 3.
> 
> For each queries[i], it can be shown that answer[i] is the minimum number of operations needed to equalize all the edge weights in the path from ai to bi.

**Constraints:**

  * `1 <= n <= 10^4`
  * `edges.length == n - 1`
  * `edges[i].length == 3`
  * `0 <= ui, vi < n`
  * `1 <= wi <= 26`
  * The input is generated such that `edges` represents a valid tree.
  * `1 <= queries.length == m <= 2 * 10^4`
  * `queries[i].length == 2`
  * `0 <= ai, bi < n`


## é¢˜ç›®å¤§æ„

ç°æœ‰ä¸€æ£µç”± `n` ä¸ªèŠ‚ç‚¹ç»„æˆçš„æ— å‘æ ‘ï¼ŒèŠ‚ç‚¹æŒ‰ä» `0` åˆ° `n - 1` ç¼–å·ã€‚ç»™ä½ ä¸€ä¸ªæ•´æ•° `n` å’Œä¸€ä¸ªé•¿åº¦ä¸º `n - 1` çš„äºŒç»´æ•´æ•°æ•°ç»„
`edges` ï¼Œå…¶ä¸­ `edges[i] = [ui, vi, wi]` è¡¨ç¤ºæ ‘ä¸­å­˜åœ¨ä¸€æ¡ä½äºèŠ‚ç‚¹ `ui` å’ŒèŠ‚ç‚¹ `vi` ä¹‹é—´ã€æƒé‡ä¸º `wi`
çš„è¾¹ã€‚

å¦ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º `m` çš„äºŒç»´æ•´æ•°æ•°ç»„ `queries` ï¼Œå…¶ä¸­ `queries[i] = [ai, bi]` ã€‚å¯¹äºæ¯æ¡æŸ¥è¯¢ï¼Œè¯·ä½ æ‰¾å‡ºä½¿ä» `ai`
åˆ° `bi` è·¯å¾„ä¸Šæ¯æ¡è¾¹çš„æƒé‡ç›¸ç­‰æ‰€éœ€çš„ **æœ€å°æ“ä½œæ¬¡æ•°** ã€‚åœ¨ä¸€æ¬¡æ“ä½œä¸­ï¼Œä½ å¯ä»¥é€‰æ‹©æ ‘ä¸Šçš„ä»»æ„ä¸€æ¡è¾¹ï¼Œå¹¶å°†å…¶æƒé‡æ›´æ”¹ä¸ºä»»æ„å€¼ã€‚

**æ³¨æ„ï¼š**

  * æŸ¥è¯¢ä¹‹é—´ **ç›¸äº’ç‹¬ç«‹** çš„ï¼Œè¿™æ„å‘³ç€æ¯æ¡æ–°çš„æŸ¥è¯¢æ—¶ï¼Œæ ‘éƒ½ä¼šå›åˆ° **åˆå§‹çŠ¶æ€** ã€‚
  * ä» `ai` åˆ° `bi`çš„è·¯å¾„æ˜¯ä¸€ä¸ªç”± **ä¸åŒ** èŠ‚ç‚¹ç»„æˆçš„åºåˆ—ï¼Œä»èŠ‚ç‚¹ `ai` å¼€å§‹ï¼Œåˆ°èŠ‚ç‚¹ `bi` ç»“æŸï¼Œä¸”åºåˆ—ä¸­ç›¸é‚»çš„ä¸¤ä¸ªèŠ‚ç‚¹åœ¨æ ‘ä¸­å…±äº«ä¸€æ¡è¾¹ã€‚

è¿”å›ä¸€ä¸ªé•¿åº¦ä¸º `m` çš„æ•°ç»„ `answer` ï¼Œå…¶ä¸­ `answer[i]` æ˜¯ç¬¬ `i` æ¡æŸ¥è¯¢çš„ç­”æ¡ˆã€‚



**ç¤ºä¾‹ 1ï¼š**

![](https://assets.leetcode.com/uploads/2023/08/11/graph-6-1.png)

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** n = 7, edges = [[0,1,1],[1,2,1],[2,3,1],[3,4,2],[4,5,2],[5,6,2]], queries = [[0,3],[3,6],[2,6],[0,6]]
> 
> **è¾“å‡ºï¼š**[0,0,1,3]
> 
> **è§£é‡Šï¼š** ç¬¬ 1 æ¡æŸ¥è¯¢ï¼Œä»èŠ‚ç‚¹ 0 åˆ°èŠ‚ç‚¹ 3 çš„è·¯å¾„ä¸­çš„æ‰€æœ‰è¾¹çš„æƒé‡éƒ½æ˜¯ 1 ã€‚å› æ­¤ï¼Œç­”æ¡ˆä¸º 0 ã€‚
> 
> ç¬¬ 2 æ¡æŸ¥è¯¢ï¼Œä»èŠ‚ç‚¹ 3 åˆ°èŠ‚ç‚¹ 6 çš„è·¯å¾„ä¸­çš„æ‰€æœ‰è¾¹çš„æƒé‡éƒ½æ˜¯ 2 ã€‚å› æ­¤ï¼Œç­”æ¡ˆä¸º 0 ã€‚
> 
> ç¬¬ 3 æ¡æŸ¥è¯¢ï¼Œå°†è¾¹ [2,3] çš„æƒé‡å˜æ›´ä¸º 2 ã€‚åœ¨è¿™æ¬¡æ“ä½œä¹‹åï¼Œä»èŠ‚ç‚¹ 2 åˆ°èŠ‚ç‚¹ 6 çš„è·¯å¾„ä¸­çš„æ‰€æœ‰è¾¹çš„æƒé‡éƒ½æ˜¯ 2 ã€‚å› æ­¤ï¼Œç­”æ¡ˆä¸º 1 ã€‚
> 
> ç¬¬ 4 æ¡æŸ¥è¯¢ï¼Œå°†è¾¹ [0,1]ã€[1,2]ã€[2,3] çš„æƒé‡å˜æ›´ä¸º 2 ã€‚åœ¨è¿™æ¬¡æ“ä½œä¹‹åï¼Œä»èŠ‚ç‚¹ 0 åˆ°èŠ‚ç‚¹ 6 çš„è·¯å¾„ä¸­çš„æ‰€æœ‰è¾¹çš„æƒé‡éƒ½æ˜¯ 2 ã€‚å› æ­¤ï¼Œç­”æ¡ˆä¸º 3 ã€‚
> 
> å¯¹äºæ¯æ¡æŸ¥è¯¢ queries[i] ï¼Œå¯ä»¥è¯æ˜ answer[i] æ˜¯ä½¿ä» ai åˆ° bi çš„è·¯å¾„ä¸­çš„æ‰€æœ‰è¾¹çš„æƒé‡ç›¸ç­‰çš„æœ€å°æ“ä½œæ¬¡æ•°ã€‚
> 
> 

**ç¤ºä¾‹ 2ï¼š**

![](https://assets.leetcode.com/uploads/2023/08/11/graph-9-1.png)

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** n = 8, edges = [[1,2,6],[1,3,4],[2,4,6],[2,5,3],[3,6,6],[3,0,8],[7,0,2]], queries = [[4,6],[0,4],[6,5],[7,4]]
> 
> **è¾“å‡ºï¼š**[1,2,2,3]
> 
> **è§£é‡Šï¼š** ç¬¬ 1 æ¡æŸ¥è¯¢ï¼Œå°†è¾¹ [1,3] çš„æƒé‡å˜æ›´ä¸º 6 ã€‚åœ¨è¿™æ¬¡æ“ä½œä¹‹åï¼Œä»èŠ‚ç‚¹ 4 åˆ°èŠ‚ç‚¹ 6 çš„è·¯å¾„ä¸­çš„æ‰€æœ‰è¾¹çš„æƒé‡éƒ½æ˜¯ 6 ã€‚å› æ­¤ï¼Œç­”æ¡ˆä¸º 1 ã€‚
> 
> ç¬¬ 2 æ¡æŸ¥è¯¢ï¼Œå°†è¾¹ [0,3]ã€[3,1] çš„æƒé‡å˜æ›´ä¸º 6 ã€‚åœ¨è¿™æ¬¡æ“ä½œä¹‹åï¼Œä»èŠ‚ç‚¹ 0 åˆ°èŠ‚ç‚¹ 4 çš„è·¯å¾„ä¸­çš„æ‰€æœ‰è¾¹çš„æƒé‡éƒ½æ˜¯ 6 ã€‚å› æ­¤ï¼Œç­”æ¡ˆä¸º 2 ã€‚
> 
> ç¬¬ 3 æ¡æŸ¥è¯¢ï¼Œå°†è¾¹ [1,3]ã€[5,2] çš„æƒé‡å˜æ›´ä¸º 6 ã€‚åœ¨è¿™æ¬¡æ“ä½œä¹‹åï¼Œä»èŠ‚ç‚¹ 6 åˆ°èŠ‚ç‚¹ 5 çš„è·¯å¾„ä¸­çš„æ‰€æœ‰è¾¹çš„æƒé‡éƒ½æ˜¯ 6 ã€‚å› æ­¤ï¼Œç­”æ¡ˆä¸º 2 ã€‚
> 
> ç¬¬ 4 æ¡æŸ¥è¯¢ï¼Œå°†è¾¹ [0,7]ã€[0,3]ã€[1,3] çš„æƒé‡å˜æ›´ä¸º 6 ã€‚åœ¨è¿™æ¬¡æ“ä½œä¹‹åï¼Œä»èŠ‚ç‚¹ 7 åˆ°èŠ‚ç‚¹ 4 çš„è·¯å¾„ä¸­çš„æ‰€æœ‰è¾¹çš„æƒé‡éƒ½æ˜¯ 6 ã€‚å› æ­¤ï¼Œç­”æ¡ˆä¸º 3 ã€‚
> 
> å¯¹äºæ¯æ¡æŸ¥è¯¢ queries[i] ï¼Œå¯ä»¥è¯æ˜ answer[i] æ˜¯ä½¿ä» ai åˆ° bi çš„è·¯å¾„ä¸­çš„æ‰€æœ‰è¾¹çš„æƒé‡ç›¸ç­‰çš„æœ€å°æ“ä½œæ¬¡æ•°ã€‚ 
> 
> 



**æç¤ºï¼š**

  * `1 <= n <= 10^4`
  * `edges.length == n - 1`
  * `edges[i].length == 3`
  * `0 <= ui, vi < n`
  * `1 <= wi <= 26`
  * ç”Ÿæˆçš„è¾“å…¥æ»¡è¶³ `edges` è¡¨ç¤ºä¸€æ£µæœ‰æ•ˆçš„æ ‘
  * `1 <= queries.length == m <= 2 * 10^4`
  * `queries[i].length == 2`
  * `0 <= ai, bi < n`


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 1483 | [æ ‘èŠ‚ç‚¹çš„ç¬¬ K ä¸ªç¥–å…ˆ](https://leetcode.com/problems/kth-ancestor-of-a-tree-node) |  |  [`æ ‘`](/leetcode/outline/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/leetcode/outline/tag/depth-first-search.md) [`å¹¿åº¦ä¼˜å…ˆæœç´¢`](/leetcode/outline/tag/breadth-first-search.md) `3+` | <font color=#ff334b>Hard</font> |

<style>
.blue {
    background-color: #096dd9;
    padding: 0.25rem 0.5rem;
    margin: 0;
    font-size: 0.85em;
    border-radius: 3px;
    color: white;
    font-weight: 500;
}
table th:first-of-type { width: 10%; }
table th:nth-of-type(2) { width: 35%; }
table th:nth-of-type(3) { width: 10%; }
table th:nth-of-type(4) { width: 35%; }
table th:nth-of-type(5) { width: 10%; }
</style>
