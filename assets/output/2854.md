# [2854. æ»šåŠ¨å¹³å‡æ­¥æ•°](https://leetcode.com/problems/rolling-average-steps)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/rolling-average-steps)

## é¢˜ç›®

Table: `Steps`

> 
> 
> 
> 
> 
> +-------------+------+ 
> 
> | Column Name | Type | 
> 
> +-------------+------+ 
> 
> | user_id> 
>  | int  | 
> 
> | steps_count | int  |
> 
> | steps_date  | date |
> 
> +-------------+------+
> 
> (user_id, steps_date) is the primary key for this table.
> 
> Each row of this table contains user_id, steps_count, and steps_date.
> 
> 

Write a solution to calculate `3-day` **rolling averages** of steps for each
user.

We calculate the `n-day` **rolling average** this way:

  * For each day, we calculate the average of `n` consecutive days of step counts ending on that day if available, otherwise, `n-day` rolling average is not defined for it.

Output the `user_id`, `steps_date`, and rolling average. Round the rolling
average to **two decimal places**.

Return _the result table ordered by_`user_id` _,_`steps_date` _in**ascending**
order._

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Steps table:
> 
> +---------+-------------+------------+
> 
> | user_id | steps_count | steps_date |
> 
> +---------+-------------+------------+
> 
> | 1> 
>    | 687> 
> > 
>  | 2021-09-02 |
> 
> | 1> 
>    | 395> 
> > 
>  | 2021-09-04 |
> 
> | 1> 
>    | 499> 
> > 
>  | 2021-09-05 |
> 
> | 1> 
>    | 712> 
> > 
>  | 2021-09-06 |
> 
> | 1> 
>    | 576> 
> > 
>  | 2021-09-07 |
> 
> | 2> 
>    | 153> 
> > 
>  | 2021-09-06 |
> 
> | 2> 
>    | 171> 
> > 
>  | 2021-09-07 |
> 
> | 2> 
>    | 530> 
> > 
>  | 2021-09-08 |
> 
> | 3> 
>    | 945> 
> > 
>  | 2021-09-04 |
> 
> | 3> 
>    | 120> 
> > 
>  | 2021-09-07 |
> 
> | 3> 
>    | 557> 
> > 
>  | 2021-09-08 |
> 
> | 3> 
>    | 840> 
> > 
>  | 2021-09-09 |
> 
> | 3> 
>    | 627> 
> > 
>  | 2021-09-10 |
> 
> | 5> 
>    | 382> 
> > 
>  | 2021-09-05 |
> 
> | 6> 
>    | 480> 
> > 
>  | 2021-09-01 |
> 
> | 6> 
>    | 191> 
> > 
>  | 2021-09-02 |
> 
> | 6> 
>    | 303> 
> > 
>  | 2021-09-05 |
> 
> +---------+-------------+------------+
> 
> Output: 
> 
> +---------+------------+-----------------+
> 
> | user_id | steps_date | rolling_average | 
> 
> +---------+------------+-----------------+
> 
> | 1> 
>    | 2021-09-06 | 535.33> 
> > 
>   | 
> 
> | 1> 
>    | 2021-09-07 | 595.67> 
> > 
>   | 
> 
> | 2> 
>    | 2021-09-08 | 284.67> 
> > 
>   |
> 
> | 3> 
>    | 2021-09-09 | 505.67> 
> > 
>   |
> 
> | 3> 
>    | 2021-09-10 | 674.67> 
> > 
>   |> 
> 
> 
> +---------+------------+-----------------+
> 
> Explanation: 
> - For user id 1, the step counts for the three consecutive days up to 2021-09-06 are available. Consequently, the rolling average for this particular date is computed as (395 + 499 + 712) / 3 = 535.33.
> - For user id 1, the step counts for the three consecutive days up to 2021-09-07 are available. Consequently, the rolling average for this particular date is computed as (499 + 712 + 576) / 3 = 595.67.
> - For user id 2, the step counts for the three consecutive days up to 2021-09-08 are available. Consequently, the rolling average for this particular date is computed as (153 + 171 + 530) / 3 = 284.67.
> - For user id 3, the step counts for the three consecutive days up to 2021-09-09 are available. Consequently, the rolling average for this particular date is computed as (120 + 557 + 840) / 3 = 505.67.
> - For user id 3, the step counts for the three consecutive days up to 2021-09-10 are available. Consequently, the rolling average for this particular date is computed as (557 + 840 + 627) / 3 = 674.67.
> - For user id 4 and 5, the calculation of the rolling average is not viable as there is insufficient data for the consecutive three days. Output table ordered by user_id and steps_date in ascending order.


## é¢˜ç›®å¤§æ„

è¡¨ï¼š `Steps`

> 
> 
> 
> 
> 
> +-------------+------+ 
> 
> | Column Name | Type | 
> 
> +-------------+------+ 
> 
> | user_id> 
>  | int  | 
> 
> | steps_count | int  |
> 
> | steps_date  | date |
> 
> +-------------+------+
> 
> (user_id, steps_date) æ˜¯æ­¤è¡¨çš„ä¸»é”®ã€‚
> 
> è¯¥è¡¨çš„æ¯ä¸€è¡ŒåŒ…å« user_idã€steps_count å’Œ steps_dateã€‚
> 
> 

ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œè®¡ç®—å‡ºæ¯ä¸ªç”¨æˆ·çš„ `3-day` **æ»šåŠ¨å¹³å‡æ­¥æ•°  **ã€‚

è®¡ç®— `n-day` **æ»šåŠ¨å¹³å‡å€¼** çš„è®¡ç®—æ–¹å¼å¦‚ä¸‹ï¼š

  * å¯¹äºæ¯ä¸€å¤©ï¼Œå¦‚æœæœ‰å¯ç”¨æ•°æ®çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šè®¡ç®—ä»¥è¯¥å¤©ä¸ºç»“æŸçš„ `n` å¤©è¿ç»­æ­¥æ•°çš„å¹³å‡å€¼ï¼Œå¦åˆ™ï¼Œå¯¹äºè¯¥å¤©æ¥è¯´ï¼Œ`n` å¤©æ»šåŠ¨å¹³å‡æ­¥æ•°æ˜¯æœªå®šä¹‰çš„ã€‚

è¾“å‡º `user_id` ã€ `steps_date` __ å’Œæ»šåŠ¨å¹³å‡å€¼ã€‚å¹¶å°†æ»šåŠ¨å¹³å‡å€¼å››èˆäº”å…¥åˆ° **ä¸¤ä½å°æ•°** ã€‚

è¿”å›ç»“æœè¡¨ä»¥`user_id` _ _ å’Œ `steps_date` _ _**å‡åº** _ _ æ’åºã€‚

ç»“æœçš„æ ¼å¼å¦‚ä¸‹ç¤ºä¾‹ã€‚



**ç¤ºä¾‹ 1:**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š**
> 
> Steps table:
> 
> +---------+-------------+------------+
> 
> | user_id | steps_count | steps_date |
> 
> +---------+-------------+------------+
> 
> | 1> 
>    | 687> 
> > 
>  | 2021-09-02 |
> 
> | 1> 
>    | 395> 
> > 
>  | 2021-09-04 |
> 
> | 1> 
>    | 499> 
> > 
>  | 2021-09-05 |
> 
> | 1> 
>    | 712> 
> > 
>  | 2021-09-06 |
> 
> | 1> 
>    | 576> 
> > 
>  | 2021-09-07 |
> 
> | 2> 
>    | 153> 
> > 
>  | 2021-09-06 |
> 
> | 2> 
>    | 171> 
> > 
>  | 2021-09-07 |
> 
> | 2> 
>    | 530> 
> > 
>  | 2021-09-08 |
> 
> | 3> 
>    | 945> 
> > 
>  | 2021-09-04 |
> 
> | 3> 
>    | 120> 
> > 
>  | 2021-09-07 |
> 
> | 3> 
>    | 557> 
> > 
>  | 2021-09-08 |
> 
> | 3> 
>    | 840> 
> > 
>  | 2021-09-09 |
> 
> | 3> 
>    | 627> 
> > 
>  | 2021-09-10 |
> 
> | 5> 
>    | 382> 
> > 
>  | 2021-09-05 |
> 
> | 6> 
>    | 480> 
> > 
>  | 2021-09-01 |
> 
> | 6> 
>    | 191> 
> > 
>  | 2021-09-02 |
> 
> | 6> 
>    | 303> 
> > 
>  | 2021-09-05 |
> 
> +---------+-------------+------------+
> 
> **è¾“å‡ºï¼š**
> 
> +---------+------------+-----------------+
> 
> | user_id | steps_date | rolling_average | 
> 
> +---------+------------+-----------------+
> 
> | 1> 
>    | 2021-09-06 | 535.33> 
> > 
>   | 
> 
> | 1> 
>    | 2021-09-07 | 595.67> 
> > 
>   | 
> 
> | 2> 
>    | 2021-09-08 | 284.67> 
> > 
>   |
> 
> | 3> 
>    | 2021-09-09 | 505.67> 
> > 
>   |
> 
> | 3> 
>    | 2021-09-10 | 674.67> 
> > 
>   |> 
> 
> 
> +---------+------------+-----------------+
> 
> **è§£é‡Šï¼š**
> - å¯¹äº ID ä¸º 1 çš„ç”¨æˆ·ï¼Œæˆªæ­¢åˆ° 2021-09-06 çš„ä¸‰å¤©è¿ç»­çš„æ­¥æ•°å¯ç”¨ã€‚å› æ­¤ï¼Œè¯¥æ—¥æœŸçš„æ»šåŠ¨å¹³å‡å€¼è®¡ç®—ä¸º (395 + 499 + 712) / 3 = 535.33ã€‚
> - å¯¹äº ID ä¸º 1 çš„ç”¨æˆ·ï¼Œæˆªæ­¢åˆ° 2021-09-07 çš„ä¸‰å¤©è¿ç»­çš„æ­¥æ•°å¯ç”¨ã€‚å› æ­¤ï¼Œè¯¥æ—¥æœŸçš„æ»šåŠ¨å¹³å‡å€¼è®¡ç®—ä¸º (499 + 712 + 576) / 3 = 595.67ã€‚
> - å¯¹äº ID ä¸º 2 çš„ç”¨æˆ·ï¼Œæˆªæ­¢åˆ° 2021-09-08 çš„ä¸‰å¤©è¿ç»­çš„æ­¥æ•°å¯ç”¨ã€‚å› æ­¤ï¼Œè¯¥æ—¥æœŸçš„æ»šåŠ¨å¹³å‡å€¼è®¡ç®—ä¸º (153 + 171 + 530) / 3 = 284.67ã€‚
> - å¯¹äº ID ä¸º 3 çš„ç”¨æˆ·ï¼Œæˆªæ­¢åˆ° 2021-09-09 çš„ä¸‰å¤©è¿ç»­çš„æ­¥æ•°å¯ç”¨ã€‚å› æ­¤ï¼Œè¯¥æ—¥æœŸçš„æ»šåŠ¨å¹³å‡å€¼è®¡ç®—ä¸º (120 + 557 + 840) / 3 = 505.67ã€‚
> - å¯¹äº ID ä¸º 3 çš„ç”¨æˆ·ï¼Œæˆªæ­¢åˆ° 2021-09-10 çš„ä¸‰å¤©è¿ç»­çš„æ­¥æ•°å¯ç”¨ã€‚å› æ­¤ï¼Œè¯¥æ—¥æœŸçš„æ»šåŠ¨å¹³å‡å€¼è®¡ç®—ä¸º (557 + 840 + 627) / 3 = 674.67ã€‚
> - å¯¹äº ID ä¸º 4 å’Œ 5 çš„ç”¨æˆ·ï¼Œç”±äºè¿ç»­ä¸‰å¤©çš„æ•°æ®ä¸è¶³ï¼Œæ— æ³•è®¡ç®—æ»šåŠ¨å¹³å‡å€¼ã€‚ç»“æœè¡¨æŒ‰ user_id å’Œ steps_date å‡åºæ’åºã€‚


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```