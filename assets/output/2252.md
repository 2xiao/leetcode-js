# [2252. è¡¨çš„åŠ¨æ€æ—‹è½¬](https://leetcode.com/problems/dynamic-pivoting-of-a-table)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/dynamic-pivoting-of-a-table)

## é¢˜ç›®

Table: `Products`

> 
> 
> 
> 
> 
> +-------------+---------+
> 
> | Column Name | Type> 
> |
> 
> +-------------+---------+
> 
> | product_id  | int> 
>  |
> 
> | store> 
>    | varchar |
> 
> | price> 
>    | int> 
>  |
> 
> +-------------+---------+
> 
> (product_id, store) is the primary key (combination of columns with unique values) for this table.
> 
> Each row of this table indicates the price of product_id in store.
> 
> There will be at most 30 different stores in the table.
> 
> price is the price of the product at this store.
> 
> 



**Important note:** This problem targets those who have a good experience with
SQL. If you are a beginner, we recommend that you skip it for now.

Implement the procedure `PivotProducts` to reorganize the `Products` table so
that each row has the id of one product and its price in each store. The price
should be `null` if the product is not sold in a store. The columns of the
table should contain each store and they should be sorted in **lexicographical
order**.

The procedure should return the table after reorganizing it.

Return the result table in **any order**.

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Products table:
> 
> +------------+----------+-------+
> 
> | product_id | store> 
> | price |
> 
> +------------+----------+-------+
> 
> | 1> 
> > 
>   | Shop> 
>  | 110   |
> 
> | 1> 
> > 
>   | LC_Store | 100   |
> 
> | 2> 
> > 
>   | Nozama   | 200   |
> 
> | 2> 
> > 
>   | Souq> 
>  | 190   |
> 
> | 3> 
> > 
>   | Shop> 
>  | 1000  |
> 
> | 3> 
> > 
>   | Souq> 
>  | 1900  |
> 
> +------------+----------+-------+
> 
> Output: 
> 
> +------------+----------+--------+------+------+
> 
> | product_id | LC_Store | Nozama | Shop | Souq |
> 
> +------------+----------+--------+------+------+
> 
> | 1> 
> > 
>   | 100> 
>   | null   | 110  | null |
> 
> | 2> 
> > 
>   | null> 
>  | 200> 
> | null | 190  |
> 
> | 3> 
> > 
>   | null> 
>  | null   | 1000 | 1900 |
> 
> +------------+----------+--------+------+------+
> 
> Explanation: 
> 
> We have 4 stores: Shop, LC_Store, Nozama, and Souq. We first order them lexicographically to be: LC_Store, Nozama, Shop, and Souq.
> 
> Now, for product 1, the price in LC_Store is 100 and in Shop is 110. For the other two stores, the product is not sold so we set the price as null.
> 
> Similarly, product 2 has a price of 200 in Nozama and 190 in Souq. It is not sold in the other two stores.
> 
> For product 3, the price is 1000 in Shop and 1900 in Souq. It is not sold in the other two stores.
> 
> 


## é¢˜ç›®å¤§æ„

è¡¨: `Products`

> 
> 
> 
> 
> 
> +-------------+---------+
> 
> | Column Name | Type> 
> |
> 
> +-------------+---------+
> 
> | product_id  | int> 
>  |
> 
> | store> 
>    | varchar |
> 
> | price> 
>    | int> 
>  |
> 
> +-------------+---------+
> 
> (product_id, store) æ˜¯è¯¥è¡¨çš„ä¸»é”®ï¼ˆå…·æœ‰å”¯ä¸€å€¼çš„åˆ—çš„ç»„åˆï¼‰ã€‚
> 
> è¯¥è¡¨çš„æ¯ä¸€è¡Œéƒ½è¡¨ç¤ºå•†åº—ä¸­çš„ product_id çš„ä»·æ ¼ã€‚
> 
> è¡¨ä¸­æœ€å¤šæœ‰ 30 ä¸ªä¸åŒçš„å•†åº— storeã€‚
> 
> price å°±æ˜¯è¿™å®¶åº—å•†å“çš„ä»·æ ¼ã€‚
> 
> 



**é‡è¦æç¤ºï¼š** è¿™ä¸ªé—®é¢˜é’ˆå¯¹çš„æ˜¯é‚£äº›å¯¹ SQL æœ‰ä¸°å¯Œç»éªŒçš„äººã€‚å¦‚æœä½ æ˜¯åˆå­¦è€…ï¼Œæˆ‘ä»¬å»ºè®®ä½ ç°åœ¨è·³è¿‡å®ƒã€‚

å®ç° `PivotProducts` è¿‡ç¨‹æ¥é‡æ–°ç»„ç»‡ `Products` è¡¨ï¼Œä»¥ä¾¿æ¯è¡Œéƒ½æœ‰ä¸€ä¸ªå•†å“çš„ id
åŠå…¶åœ¨æ¯ä¸ªå•†åº—ä¸­çš„ä»·æ ¼ã€‚å¦‚æœå•†å“ä¸åœ¨å•†åº—å‡ºå”®ï¼Œä»·æ ¼åº”ä¸º `null`ã€‚è¡¨çš„åˆ—åº”è¯¥åŒ…å«æ¯ä¸ªå•†åº—ï¼Œå¹¶ä¸”å®ƒä»¬åº”è¯¥æŒ‰ **å­—å…¸é¡ºåºæ’åº** ã€‚

è¿‡ç¨‹åº”è¯¥åœ¨é‡æ–°ç»„ç»‡è¡¨ä¹‹åè¿”å›å®ƒã€‚

ä»¥ **ä»»æ„é¡ºåº  **è¿”å›ç»“æœè¡¨ã€‚

è¿”å›ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1:**

> 
> 
> 
> 
> 
> **è¾“å…¥:** 
> 
> Products è¡¨:
> 
> +------------+----------+-------+
> 
> | product_id | store> 
> | price |
> 
> +------------+----------+-------+
> 
> | 1> 
> > 
>   | Shop> 
>  | 110   |
> 
> | 1> 
> > 
>   | LC_Store | 100   |
> 
> | 2> 
> > 
>   | Nozama   | 200   |
> 
> | 2> 
> > 
>   | Souq> 
>  | 190   |
> 
> | 3> 
> > 
>   | Shop> 
>  | 1000  |
> 
> | 3> 
> > 
>   | Souq> 
>  | 1900  |
> 
> +------------+----------+-------+
> 
> **è¾“å‡º:** 
> 
> +------------+----------+--------+------+------+
> 
> | product_id | LC_Store | Nozama | Shop | Souq |
> 
> +------------+----------+--------+------+------+
> 
> | 1> 
> > 
>   | 100> 
>   | null   | 110  | null |
> 
> | 2> 
> > 
>   | null> 
>  | 200> 
> | null | 190  |
> 
> | 3> 
> > 
>   | null> 
>  | null   | 1000 | 1900 |
> 
> +------------+----------+--------+------+------+
> 
> **è§£é‡Š:** 
> 
> æœ‰ 4 ä¸ªå•†åº—: Shop, LC_Store, Nozama, Souqã€‚ æˆ‘ä»¬é¦–å…ˆæŒ‰å­—å…¸é¡ºåºæ’åˆ—: LC_Store, Nozama, Shop, Souq.
> 
> ç°åœ¨, å¯¹äºå•†å“ 1, LC_Store çš„ä»·æ ¼æ˜¯ 100ï¼ŒShop çš„ä»·æ ¼æ˜¯ 110ã€‚å¦å¤–ä¸¤ä¸ªå•†åº—æ²¡æœ‰è¯¥å•†å“é”€å”®ï¼Œå› æ­¤æˆ‘ä»¬å°†ä»·æ ¼è®¾ç½®ä¸º nullã€‚
> 
> åŒæ ·, å•†å“ 2 åœ¨ Nozama ä¸­çš„ä»·æ ¼æ˜¯ 200ï¼ŒSouq ä¸­çš„ä»·æ ¼æ˜¯ 190ã€‚å…¶ä»–ä¸¤å®¶åº—éƒ½ä¸å–ã€‚
> 
> å•†å“ 3, Shop ä¸­çš„ä»·æ ¼æ˜¯ 1000,Souq ä¸­çš„ä»·æ ¼æ˜¯1900ã€‚å…¶ä»–ä¸¤å®¶åº—éƒ½ä¸å–ã€‚


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 1777 | [æ¯å®¶å•†åº—çš„äº§å“ä»·æ ¼](https://leetcode.com/problems/products-price-for-each-store) |  |  [`æ•°æ®åº“`](/tag/database.md) | <font color=#15bd66>Easy</font> |