---
title: 2050. å¹¶è¡Œè¯¾ç¨‹ III
description: LeetCode,2050. å¹¶è¡Œè¯¾ç¨‹ III,å¹¶è¡Œè¯¾ç¨‹ III,Parallel Courses III,è§£é¢˜æ€è·¯,å›¾,æ‹“æ‰‘æ’åº,æ•°ç»„,åŠ¨æ€è§„åˆ’
keywords:
  - LeetCode
  - 2050. å¹¶è¡Œè¯¾ç¨‹ III
  - å¹¶è¡Œè¯¾ç¨‹ III
  - Parallel Courses III
  - è§£é¢˜æ€è·¯
  - å›¾
  - æ‹“æ‰‘æ’åº
  - æ•°ç»„
  - åŠ¨æ€è§„åˆ’
---

# 2050. å¹¶è¡Œè¯¾ç¨‹ III

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`å›¾`](/tag/graph.md) [`æ‹“æ‰‘æ’åº`](/tag/topological-sort.md) [`æ•°ç»„`](/tag/array.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/parallel-courses-iii) [`LeetCode`](https://leetcode.com/problems/parallel-courses-iii)

## é¢˜ç›®

You are given an integer `n`, which indicates that there are `n` courses
labeled from `1` to `n`. You are also given a 2D integer array `relations`
where `relations[j] = [prevCoursej, nextCoursej]` denotes that course
`prevCoursej` has to be completed **before** course `nextCoursej`
(prerequisite relationship). Furthermore, you are given a **0-indexed**
integer array `time` where `time[i]` denotes how many **months** it takes to
complete the `(i+1)th` course.

You must find the **minimum** number of months needed to complete all the
courses following these rules:

  * You may start taking a course at **any time** if the prerequisites are met.
  * **Any number of courses** can be taken at the **same time**.

Return _the**minimum** number of months needed to complete all the courses_.

**Note:** The test cases are generated such that it is possible to complete
every course (i.e., the graph is a directed acyclic graph).



**Example 1:**

**![](https://assets.leetcode.com/uploads/2021/10/07/ex1.png)**

> Input: n = 3, relations = [[1,3],[2,3]], time = [3,2,5]
> 
> Output: 8
> 
> Explanation: The figure above represents the given graph and the time required to complete each course. 
> 
> We start course 1 and course 2 simultaneously at month 0.
> 
> Course 1 takes 3 months and course 2 takes 2 months to complete respectively.
> 
> Thus, the earliest time we can start course 3 is at month 3, and the total time required is 3 + 5 = 8 months.

**Example 2:**

**![](https://assets.leetcode.com/uploads/2021/10/07/ex2.png)**

> Input: n = 5, relations = [[1,5],[2,5],[3,5],[3,4],[4,5]], time = [1,2,3,4,5]
> 
> Output: 12
> 
> Explanation: The figure above represents the given graph and the time required to complete each course.
> 
> You can start courses 1, 2, and 3 at month 0.
> 
> You can complete them after 1, 2, and 3 months respectively.
> 
> Course 4 can be taken only after course 3 is completed, i.e., after 3 months. It is completed after 3 + 4 = 7 months.
> 
> Course 5 can be taken only after courses 1, 2, 3, and 4 have been completed, i.e., after max(1,2,3,7) = 7 months.
> 
> Thus, the minimum time needed to complete all the courses is 7 + 5 = 12 months.

**Constraints:**

  * `1 <= n <= 5 * 10^4`
  * `0 <= relations.length <= min(n * (n - 1) / 2, 5 * 104)`
  * `relations[j].length == 2`
  * `1 <= prevCoursej, nextCoursej <= n`
  * `prevCoursej != nextCoursej`
  * All the pairs `[prevCoursej, nextCoursej]` are **unique**.
  * `time.length == n`
  * `1 <= time[i] <= 10^4`
  * The given graph is a directed acyclic graph.


## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªæ•´æ•° `n` ï¼Œè¡¨ç¤ºæœ‰ `n` èŠ‚è¯¾ï¼Œè¯¾ç¨‹ç¼–å·ä» `1` åˆ° `n` ã€‚åŒæ—¶ç»™ä½ ä¸€ä¸ªäºŒç»´æ•´æ•°æ•°ç»„ `relations` ï¼Œå…¶ä¸­
`relations[j] = [prevCoursej, nextCoursej]` ï¼Œè¡¨ç¤ºè¯¾ç¨‹ `prevCoursej` å¿…é¡»åœ¨è¯¾ç¨‹
`nextCoursej` **ä¹‹å‰**  å®Œæˆï¼ˆå…ˆä¿®è¯¾çš„å…³ç³»ï¼‰ã€‚åŒæ—¶ç»™ä½ ä¸€ä¸ªä¸‹æ ‡ä» **0**  å¼€å§‹çš„æ•´æ•°æ•°ç»„ `time` ï¼Œå…¶ä¸­ `time[i]`
è¡¨ç¤ºå®Œæˆç¬¬ `(i+1)` é—¨è¯¾ç¨‹éœ€è¦èŠ±è´¹çš„ **æœˆä»½**  æ•°ã€‚

è¯·ä½ æ ¹æ®ä»¥ä¸‹è§„åˆ™ç®—å‡ºå®Œæˆæ‰€æœ‰è¯¾ç¨‹æ‰€éœ€è¦çš„ **æœ€å°‘**  æœˆä»½æ•°ï¼š

  * å¦‚æœä¸€é—¨è¯¾çš„æ‰€æœ‰å…ˆä¿®è¯¾éƒ½å·²ç»å®Œæˆï¼Œä½ å¯ä»¥åœ¨ **ä»»æ„**  æ—¶é—´å¼€å§‹è¿™é—¨è¯¾ç¨‹ã€‚
  * ä½ å¯ä»¥ **åŒæ—¶**  ä¸Š **ä»»æ„é—¨è¯¾ç¨‹**  ã€‚

è¯·ä½ è¿”å›å®Œæˆæ‰€æœ‰è¯¾ç¨‹æ‰€éœ€è¦çš„ **æœ€å°‘**  æœˆä»½æ•°ã€‚

**æ³¨æ„ï¼š** æµ‹è¯•æ•°æ®ä¿è¯ä¸€å®šå¯ä»¥å®Œæˆæ‰€æœ‰è¯¾ç¨‹ï¼ˆä¹Ÿå°±æ˜¯å…ˆä¿®è¯¾çš„å…³ç³»æ„æˆä¸€ä¸ªæœ‰å‘æ— ç¯å›¾ï¼‰ã€‚



**ç¤ºä¾‹  1:**

**![](https://assets.leetcode.com/uploads/2021/10/07/ex1.png)**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** n = 3, relations = [[1,3],[2,3]], time = [3,2,5]
> 
> **è¾“å‡ºï¼š** 8
> 
> **è§£é‡Šï¼š** ä¸Šå›¾å±•ç¤ºäº†è¾“å…¥æ•°æ®æ‰€è¡¨ç¤ºçš„å…ˆä¿®å…³ç³»å›¾ï¼Œä»¥åŠå®Œæˆæ¯é—¨è¯¾ç¨‹éœ€è¦èŠ±è´¹çš„æ—¶é—´ã€‚
> 
> ä½ å¯ä»¥åœ¨æœˆä»½ 0 åŒæ—¶å¼€å§‹è¯¾ç¨‹ 1 å’Œ 2 ã€‚
> 
> è¯¾ç¨‹ 1 èŠ±è´¹ 3 ä¸ªæœˆï¼Œè¯¾ç¨‹ 2 èŠ±è´¹ 2 ä¸ªæœˆã€‚
> 
> æ‰€ä»¥ï¼Œæœ€æ—©å¼€å§‹è¯¾ç¨‹ 3 çš„æ—¶é—´æ˜¯æœˆä»½ 3 ï¼Œå®Œæˆæ‰€æœ‰è¯¾ç¨‹æ‰€éœ€æ—¶é—´ä¸º 3 + 5 = 8 ä¸ªæœˆã€‚
> 
> 

**ç¤ºä¾‹ 2ï¼š**

**![](https://assets.leetcode.com/uploads/2021/10/07/ex2.png)**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** n = 5, relations = [[1,5],[2,5],[3,5],[3,4],[4,5]], time = [1,2,3,4,5]
> 
> **è¾“å‡ºï¼š** 12
> 
> **è§£é‡Šï¼š** ä¸Šå›¾å±•ç¤ºäº†è¾“å…¥æ•°æ®æ‰€è¡¨ç¤ºçš„å…ˆä¿®å…³ç³»å›¾ï¼Œä»¥åŠå®Œæˆæ¯é—¨è¯¾ç¨‹éœ€è¦èŠ±è´¹çš„æ—¶é—´ã€‚
> 
> ä½ å¯ä»¥åœ¨æœˆä»½ 0 åŒæ—¶å¼€å§‹è¯¾ç¨‹ 1 ï¼Œ2 å’Œ 3 ã€‚
> 
> åœ¨æœˆä»½ 1ï¼Œ2 å’Œ 3 åˆ†åˆ«å®Œæˆè¿™ä¸‰é—¨è¯¾ç¨‹ã€‚
> 
> è¯¾ç¨‹ 4 éœ€åœ¨è¯¾ç¨‹ 3 ä¹‹åå¼€å§‹ï¼Œä¹Ÿå°±æ˜¯ 3 ä¸ªæœˆåã€‚è¯¾ç¨‹ 4 åœ¨ 3 + 4 = 7 æœˆå®Œæˆã€‚
> 
> è¯¾ç¨‹ 5 éœ€åœ¨è¯¾ç¨‹ 1ï¼Œ2ï¼Œ3 å’Œ 4 ä¹‹åå¼€å§‹ï¼Œä¹Ÿå°±æ˜¯åœ¨ max(1,2,3,7) = 7 æœˆå¼€å§‹ã€‚
> 
> æ‰€ä»¥å®Œæˆæ‰€æœ‰è¯¾ç¨‹æ‰€éœ€çš„æœ€å°‘æ—¶é—´ä¸º 7 + 5 = 12 ä¸ªæœˆã€‚
> 
> 



**æç¤ºï¼š**

  * `1 <= n <= 5 * 10^4`
  * `0 <= relations.length <= min(n * (n - 1) / 2, 5 * 104)`
  * `relations[j].length == 2`
  * `1 <= prevCoursej, nextCoursej <= n`
  * `prevCoursej != nextCoursej`
  * æ‰€æœ‰çš„å…ˆä¿®è¯¾ç¨‹å¯¹ `[prevCoursej, nextCoursej]` éƒ½æ˜¯ **äº’ä¸ç›¸åŒ**  çš„ã€‚
  * `time.length == n`
  * `1 <= time[i] <= 10^4`
  * å…ˆä¿®è¯¾ç¨‹å›¾æ˜¯ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾ã€‚


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ | åŠ›æ‰£ |
| :------: | :------ | :------: | :------ | :------ | :------: |
| 630 | è¯¾ç¨‹è¡¨ III |  |  [`è´ªå¿ƒ`](/tag/greedy.md) [`æ•°ç»„`](/tag/array.md) [`æ’åº`](/tag/sorting.md) `1+` | <font color=#ff334b>Hard</font> | [ğŸ€„ï¸](https://leetcode.cn/problems/course-schedule-iii) [ğŸ”—](https://leetcode.com/problems/course-schedule-iii) |
| 1136 | å¹¶è¡Œè¯¾ç¨‹ ğŸ”’ |  |  [`å›¾`](/tag/graph.md) [`æ‹“æ‰‘æ’åº`](/tag/topological-sort.md) | <font color=#ffb800>Medium</font> | [ğŸ€„ï¸](https://leetcode.cn/problems/parallel-courses) [ğŸ”—](https://leetcode.com/problems/parallel-courses) |
| 1834 | å•çº¿ç¨‹ CPU |  |  [`æ•°ç»„`](/tag/array.md) [`æ’åº`](/tag/sorting.md) [`å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰`](/tag/heap-priority-queue.md) | <font color=#ffb800>Medium</font> | [ğŸ€„ï¸](https://leetcode.cn/problems/single-threaded-cpu) [ğŸ”—](https://leetcode.com/problems/single-threaded-cpu) |
| 1882 | ä½¿ç”¨æœåŠ¡å™¨å¤„ç†ä»»åŠ¡ |  |  [`æ•°ç»„`](/tag/array.md) [`å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰`](/tag/heap-priority-queue.md) | <font color=#ffb800>Medium</font> | [ğŸ€„ï¸](https://leetcode.cn/problems/process-tasks-using-servers) [ğŸ”—](https://leetcode.com/problems/process-tasks-using-servers) |
| 2127 | å‚åŠ ä¼šè®®çš„æœ€å¤šå‘˜å·¥æ•° |  |  [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/tag/depth-first-search.md) [`å›¾`](/tag/graph.md) [`æ‹“æ‰‘æ’åº`](/tag/topological-sort.md) | <font color=#ff334b>Hard</font> | [ğŸ€„ï¸](https://leetcode.cn/problems/maximum-employees-to-be-invited-to-a-meeting) [ğŸ”—](https://leetcode.com/problems/maximum-employees-to-be-invited-to-a-meeting) |