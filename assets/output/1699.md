---
title: 1699. ä¸¤äººä¹‹é—´çš„é€šè¯æ¬¡æ•° ğŸ”’
description: LeetCode 1699. ä¸¤äººä¹‹é—´çš„é€šè¯æ¬¡æ•° ğŸ”’é¢˜è§£ï¼ŒNumber of Calls Between Two Personsï¼ŒåŒ…å«è§£é¢˜æ€è·¯ã€å¤æ‚åº¦åˆ†æä»¥åŠå®Œæ•´çš„ JavaScript ä»£ç å®ç°ã€‚
keywords:
  - LeetCode
  - 1699. ä¸¤äººä¹‹é—´çš„é€šè¯æ¬¡æ•° ğŸ”’
  - ä¸¤äººä¹‹é—´çš„é€šè¯æ¬¡æ•°
  - Number of Calls Between Two Persons
  - è§£é¢˜æ€è·¯
  - æ•°æ®åº“
---

# 1699. ä¸¤äººä¹‹é—´çš„é€šè¯æ¬¡æ•° ğŸ”’

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/number-of-calls-between-two-persons) [`LeetCode`](https://leetcode.com/problems/number-of-calls-between-two-persons)

## é¢˜ç›®

Table: `Calls`

> 
> 
> 
> 
> 
> +-------------+---------+
> 
> | Column Name | Type> 
> |
> 
> +-------------+---------+
> 
> | from_id> 
>  | int> 
>  |
> 
> | to_id> 
>    | int> 
>  |
> 
> | duration> 
> | int> 
>  |
> 
> +-------------+---------+
> 
> This table does not have a primary key (column with unique values), it may contain duplicates.
> 
> This table contains the duration of a phone call between from_id and to_id.
> 
> from_id != to_id
> 
> 



Write a solution to report the number of calls and the total call duration
between each pair of distinct persons `(person1, person2)` where `person1 <
person2`.

Return the result table in **any order**.

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Calls table:
> 
> +---------+-------+----------+
> 
> | from_id | to_id | duration |
> 
> +---------+-------+----------+
> 
> | 1> 
>    | 2> 
>  | 59> 
>    |
> 
> | 2> 
>    | 1> 
>  | 11> 
>    |
> 
> | 1> 
>    | 3> 
>  | 20> 
>    |
> 
> | 3> 
>    | 4> 
>  | 100> 
>   |
> 
> | 3> 
>    | 4> 
>  | 200> 
>   |
> 
> | 3> 
>    | 4> 
>  | 200> 
>   |
> 
> | 4> 
>    | 3> 
>  | 499> 
>   |
> 
> +---------+-------+----------+
> 
> Output: 
> 
> +---------+---------+------------+----------------+
> 
> | person1 | person2 | call_count | total_duration |
> 
> +---------+---------+------------+----------------+
> 
> | 1> 
>    | 2> 
>    | 2> 
> > 
>   | 70> 
> > 
> > 
>  |
> 
> | 1> 
>    | 3> 
>    | 1> 
> > 
>   | 20> 
> > 
> > 
>  |
> 
> | 3> 
>    | 4> 
>    | 4> 
> > 
>   | 999> 
> > 
> > 
> |
> 
> +---------+---------+------------+----------------+
> 
> Explanation: 
> 
> Users 1 and 2 had 2 calls and the total duration is 70 (59 + 11).
> 
> Users 1 and 3 had 1 call and the total duration is 20.
> 
> Users 3 and 4 had 4 calls and the total duration is 999 (100 + 200 + 200 + 499).
> 
> 


## é¢˜ç›®å¤§æ„

è¡¨ï¼š `Calls`

> 
> 
> 
> 
> 
> +-------------+---------+
> 
> | Column Name | Type> 
> |
> 
> +-------------+---------+
> 
> | from_id> 
>  | int> 
>  |
> 
> | to_id> 
>    | int> 
>  |
> 
> | duration> 
> | int> 
>  |
> 
> +-------------+---------+
> 
> è¯¥è¡¨æ²¡æœ‰ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ï¼Œå®ƒå¯èƒ½åŒ…å«é‡å¤é¡¹ã€‚
> 
> è¯¥è¡¨åŒ…å« from_id ä¸ to_id é—´çš„ä¸€æ¬¡ç”µè¯çš„æ—¶é•¿ã€‚
> 
> from_id != to_id
> 
> 



ç¼–å†™è§£å†³æ–¹æ¡ˆï¼Œç»Ÿè®¡æ¯ä¸€å¯¹ç”¨æˆ· `(person1, person2)` ä¹‹é—´çš„é€šè¯æ¬¡æ•°å’Œé€šè¯æ€»æ—¶é•¿ï¼Œå…¶ä¸­ `person1 < person2` ã€‚

ä»¥ **ä»»æ„é¡ºåº** è¿”å›ç»“æœè¡¨ã€‚

è¿”å›ç»“æœæ ¼å¼å¦‚ä¸‹ç¤ºä¾‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š**
> 
> Calls è¡¨ï¼š
> 
> +---------+-------+----------+
> 
> | from_id | to_id | duration |
> 
> +---------+-------+----------+
> 
> | 1> 
>    | 2> 
>  | 59> 
>    |
> 
> | 2> 
>    | 1> 
>  | 11> 
>    |
> 
> | 1> 
>    | 3> 
>  | 20> 
>    |
> 
> | 3> 
>    | 4> 
>  | 100> 
>   |
> 
> | 3> 
>    | 4> 
>  | 200> 
>   |
> 
> | 3> 
>    | 4> 
>  | 200> 
>   |
> 
> | 4> 
>    | 3> 
>  | 499> 
>   |
> 
> +---------+-------+----------+
> 
> **è¾“å‡ºï¼š**
> 
> +---------+---------+------------+----------------+
> 
> | person1 | person2 | call_count | total_duration |
> 
> +---------+---------+------------+----------------+
> 
> | 1> 
>    | 2> 
>    | 2> 
> > 
>   | 70> 
> > 
> > 
>  |
> 
> | 1> 
>    | 3> 
>    | 1> 
> > 
>   | 20> 
> > 
> > 
>  |
> 
> | 3> 
>    | 4> 
>    | 4> 
> > 
>   | 999> 
> > 
> > 
> |
> 
> +---------+---------+------------+----------------+
> 
> **è§£é‡Šï¼š**
> 
> ç”¨æˆ· 1 å’Œ 2 æ‰“è¿‡ 2 æ¬¡ç”µè¯ï¼Œæ€»æ—¶é•¿ä¸º 70 (59 + 11)ã€‚
> 
> ç”¨æˆ· 1 å’Œ 3 æ‰“è¿‡ 1 æ¬¡ç”µè¯ï¼Œæ€»æ—¶é•¿ä¸º 20ã€‚
> 
> ç”¨æˆ· 3 å’Œ 4 æ‰“è¿‡ 4 æ¬¡ç”µè¯ï¼Œæ€»æ—¶é•¿ä¸º 999 (100 + 200 + 200 + 499)ã€‚


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```