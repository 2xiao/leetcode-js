---
title: 3408. 设计任务管理器
description: LeetCode 3408. 设计任务管理器题解，Design Task Manager，包含解题思路、复杂度分析以及完整的 JavaScript 代码实现。
keywords:
  - LeetCode
  - 3408. 设计任务管理器
  - 设计任务管理器
  - Design Task Manager
  - 解题思路
  - 设计
  - 哈希表
  - 有序集合
  - 堆（优先队列）
---

# 3408. 设计任务管理器

🟠 <font color=#ffb800>Medium</font>&emsp; 🔖&ensp; [`设计`](/tag/design.md) [`哈希表`](/tag/hash-table.md) [`有序集合`](/tag/ordered-set.md) [`堆（优先队列）`](/tag/heap-priority-queue.md)&emsp; 🔗&ensp;[`力扣`](https://leetcode.cn/problems/design-task-manager) [`LeetCode`](https://leetcode.com/problems/design-task-manager)

## 题目

There is a task management system that allows users to manage their tasks,
each associated with a priority. The system should efficiently handle adding,
modifying, executing, and removing tasks.

Implement the `TaskManager` class:

  * `TaskManager(vector<vector<int>>& tasks)` initializes the task manager with a list of user-task-priority triples. Each element in the input list is of the form `[userId, taskId, priority]`, which adds a task to the specified user with the given priority.

  * `void add(int userId, int taskId, int priority)` adds a task with the specified `taskId` and `priority` to the user with `userId`. It is **guaranteed** that `taskId` does not _exist_ in the system.

  * `void edit(int taskId, int newPriority)` updates the priority of the existing `taskId` to `newPriority`. It is **guaranteed** that `taskId` _exists_ in the system.

  * `void rmv(int taskId)` removes the task identified by `taskId` from the system. It is **guaranteed** that `taskId` _exists_ in the system.

  * `int execTop()` executes the task with the **highest** priority across all users. If there are multiple tasks with the same **highest** priority, execute the one with the highest `taskId`. After executing, the****`taskId`**** is **removed** from the system. Return the `userId` associated with the executed task. If no tasks are available, return -1.

**Note** that a user may be assigned multiple tasks.



**Example 1:**

**Input:**  
["TaskManager", "add", "edit", "execTop", "rmv", "add", "execTop"]  
[[[[1, 101, 10], [2, 102, 20], [3, 103, 15]]], [4, 104, 5], [102, 8], [],
[101], [5, 105, 15], []]

**Output:**  
[null, null, null, 3, null, null, 5]

**Explanation**

TaskManager taskManager = new TaskManager([[1, 101, 10], [2, 102, 20], [3,
103, 15]]); // Initializes with three tasks for Users 1, 2, and 3.  
taskManager.add(4, 104, 5); // Adds task 104 with priority 5 for User 4.  
taskManager.edit(102, 8); // Updates priority of task 102 to 8.  
taskManager.execTop(); // return 3. Executes task 103 for User 3.  
taskManager.rmv(101); // Removes task 101 from the system.  
taskManager.add(5, 105, 15); // Adds task 105 with priority 15 for User 5.  
taskManager.execTop(); // return 5. Executes task 105 for User 5.



**Constraints:**

  * `1 <= tasks.length <= 10^5`
  * `0 <= userId <= 10^5`
  * `0 <= taskId <= 10^5`
  * `0 <= priority <= 10^9`
  * `0 <= newPriority <= 10^9`
  * At most `2 * 10^5` calls will be made in **total** to `add`, `edit`, `rmv`, and `execTop` methods.
  * The input is generated such that `taskId` will be valid.


## 题目大意

一个任务管理器系统可以让用户管理他们的任务，每个任务有一个优先级。这个系统需要高效地处理添加、修改、执行和删除任务的操作。

请你设计一个 `TaskManager` 类：

  * `TaskManager(vector<vector<int>>& tasks)` 初始化任务管理器，初始化的数组格式为 `[userId, taskId, priority]` ，表示给 `userId` 添加一个优先级为 `priority` 的任务 `taskId` 。

  * `void add(int userId, int taskId, int priority)` 表示给用户 `userId` 添加一个优先级为 `priority` 的任务 `taskId` ，输入 **保证  **`taskId` 不在系统中。

  * `void edit(int taskId, int newPriority)` 更新已经存在的任务 `taskId` 的优先级为 `newPriority` 。输入 **保证**  `taskId` 存在于系统中。

  * `void rmv(int taskId)` 从系统中删除任务 `taskId` 。输入 **保证**  `taskId` 存在于系统中。

  * `int execTop()` 执行所有用户的任务中优先级 **最高**  的任务，如果有多个任务优先级相同且都为 **最高**  ，执行 `taskId` 最大的一个任务。执行完任务后，`taskId`** ** 从系统中 **删除**  。同时请你返回这个任务所属的用户 `userId` 。如果不存在任何任务，返回 -1 。

**注意** ，一个用户可能被安排多个任务。



**示例 1：**

**输入：**  
["TaskManager", "add", "edit", "execTop", "rmv", "add", "execTop"]  
[[[[1, 101, 10], [2, 102, 20], [3, 103, 15]]], [4, 104, 5], [102, 8], [],
[101], [5, 105, 15], []]

**输出：**  
[null, null, null, 3, null, null, 5]

**解释：**

TaskManager taskManager = new TaskManager([[1, 101, 10], [2, 102, 20], [3,
103, 15]]); // 分别给用户 1 ，2 和 3 初始化一个任务。  
taskManager.add(4, 104, 5); // 给用户 4 添加优先级为 5 的任务 104 。  
taskManager.edit(102, 8); // 更新任务 102 的优先级为 8 。  
taskManager.execTop(); // 返回 3 。执行用户 3 的任务 103 。  
taskManager.rmv(101); // 将系统中的任务 101 删除。  
taskManager.add(5, 105, 15); // 给用户 5 添加优先级为 15 的任务 105 。  
taskManager.execTop(); // 返回 5 。执行用户 5 的任务 105 。



**提示：**

  * `1 <= tasks.length <= 10^5`
  * `0 <= userId <= 10^5`
  * `0 <= taskId <= 10^5`
  * `0 <= priority <= 10^9`
  * `0 <= newPriority <= 10^9`
  * `add` ，`edit` ，`rmv` 和 `execTop` 的总操作次数 **加起来**  不超过 `2 * 10^5` 次。
  * 输入保证 `taskId` 是合法的。


## 解题思路

#### 复杂度分析

- **时间复杂度**：`O()`，
- **空间复杂度**：`O()`，

## 代码

```javascript

```