# [2991. æœ€å¥½çš„ä¸‰å®¶é…’åº„ ğŸ”’](https://2xiao.github.io/leetcode-js/problem/2991.html)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/top-three-wineries) [`LeetCode`](https://leetcode.com/problems/top-three-wineries)

## é¢˜ç›®

Table: `Wineries`

> 
> 
> 
> 
> 
> +-------------+----------+
> 
> | Column Name | Type> 
>  |
> 
> +-------------+----------+
> 
> | id> 
> > 
>   | int> 
>   |
> 
> | country> 
>  | varchar  |
> 
> | points> 
>   | int> 
>   |
> 
> | winery> 
>   | varchar  |
> 
> +-------------+----------+
> 
> id is column of unique values for this table.
> 
> This table contains id, country, points, and winery.
> 
> 

Write a solution to find the **top three wineries** in **each** **country**
based on their **total points**. If **multiple wineries** have the **same**
total points, order them by `winery` name in **ascending** order. If there's
**no second winery** , output 'No second winery,' and if there's **no third
winery** , output 'No third winery.'

Return _the result table ordered by_`country` _in**ascending** order_ _._

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Wineries table:
> 
> +-----+-----------+--------+-----------------+
> 
> | id  | country   | points | winery> 
> > 
>   | 
> 
> +-----+-----------+--------+-----------------+
> 
> | 103 | Australia | 84> 
>  | WhisperingPines | 
> 
> | 737 | Australia | 85> 
>  | GrapesGalore> 
> |> 
> 
> 
> | 848 | Australia | 100> 
> | HarmonyHill> 
>  | 
> 
> | 222 | Hungary   | 60> 
>  | MoonlitCellars  | 
> 
> | 116 | USA> 
>    | 47> 
>  | RoyalVines> 
>   | 
> 
> | 124 | USA> 
>    | 45> 
>  | Eagle'sNest> 
>  | 
> 
> | 648 | India> 
>  | 69> 
>  | SunsetVines> 
>  | 
> 
> | 894 | USA> 
>    | 39> 
>  | RoyalVines> 
>   |  
> 
> | 677 | USA> 
>    | 9> 
>   | PacificCrest> 
> |  
> 
> +-----+-----------+--------+-----------------+
> 
> Output: 
> 
> +-----------+---------------------+-------------------+----------------------+
> 
> | country   | top_winery> 
> > 
>   | second_winery> 
>  | third_winery> 
> > 
>  |
> 
> +-----------+---------------------+-------------------+----------------------+
> 
> | Australia | HarmonyHill (100)   | GrapesGalore (85) | WhisperingPines (84) |
> 
> | Hungary   | MoonlitCellars (60) | No second winery  | No third winery> 
>   | 
> 
> | India> 
>  | SunsetVines (69)> 
> | No second winery  | No third winery> 
>   |  
> 
> | USA> 
>    | RoyalVines (86)> 
>  | Eagle'sNest (45)  | PacificCrest (9)> 
>  | 
> 
> +-----------+---------------------+-------------------+----------------------+
> 
> **Explanation**
> 
> For Australia
 > - HarmonyHill Winery accumulates the highest score of 100 points in Australia.
 > - GrapesGalore Winery has a total of 85 points, securing the second-highest position in Australia.
 > - WhisperingPines Winery has a total of 80 points, ranking as the third-highest.
> 
> For Hungary
 > - MoonlitCellars is the sole winery, accruing 60 points, automatically making it the highest. There is no second or third winery.
> 
> For India
 > - SunsetVines is the sole winery, earning 69 points, making it the top winery. There is no second or third winery.
> 
> For the USA
 > - RoyalVines Wines accumulates a total of 47 + 39 = 86 points, claiming the highest position in the USA.
 > - Eagle'sNest has a total of 45 points, securing the second-highest position in the USA.
 > - PacificCrest accumulates 9 points, ranking as the third-highest winery in the USA
> 
> Output table is ordered by country in ascending order.
> 
> 


## é¢˜ç›®å¤§æ„

è¡¨ï¼š `Wineries`

> 
> 
> 
> 
> 
> +-------------+----------+
> 
> | Column Name | Type> 
>  |
> 
> +-------------+----------+
> 
> | id> 
> > 
>   | int> 
>   |
> 
> | country> 
>  | varchar  |
> 
> | points> 
>   | int> 
>   |
> 
> | winery> 
>   | varchar  |
> 
> +-------------+----------+
> 
> id æ˜¯è¿™å¼ è¡¨å…·æœ‰å”¯ä¸€å€¼çš„åˆ—ã€‚
> 
> è¿™å¼ è¡¨åŒ…å« id, country, points,å’Œ wineryã€‚
> 
> 

ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œæ ¹æ®æ¯å®¶é…’åº„çš„ **æ€»åˆ†** æ‰¾å‡º **æ¯ä¸ªå›½å®¶** çš„ **å‰ä¸‰åé…’åº„** ã€‚å¦‚æœæœ‰ **å¤šä¸ªé…’åº„** çš„æ€»åˆ† **ç›¸åŒ** ï¼Œåˆ™æŒ‰
`winery` åç§°å‡åºæ’åˆ—ã€‚å¦‚æœæ²¡æœ‰ **åˆ†æ•°æ’åœ¨ç¬¬äºŒçš„é…’åº„** ï¼Œåˆ™è¾“å‡º 'No Second Winery'ï¼Œå¦‚æœæ²¡æœ‰ **åˆ†æ•°æ’åœ¨ç¬¬ä¸‰çš„é…’åº„**
ï¼Œåˆ™è¾“å‡º 'No Third Winery'ã€‚

è¿”å›ç»“æœè¡¨æŒ‰ _ _`country` _ _**å‡åº** æ’åˆ—ã€‚

ç»“æœè¡¨æ ¼æ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1:**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š**
> 
> Wineries table:
> 
> +-----+-----------+--------+-----------------+
> 
> | id  | country   | points | winery> 
> > 
>   | 
> 
> +-----+-----------+--------+-----------------+
> 
> | 103 | Australia | 84> 
>  | WhisperingPines | 
> 
> | 737 | Australia | 85> 
>  | GrapesGalore> 
> |> 
> 
> 
> | 848 | Australia | 100> 
> | HarmonyHill> 
>  | 
> 
> | 222 | Hungary   | 60> 
>  | MoonlitCellars  | 
> 
> | 116 | USA> 
>    | 47> 
>  | RoyalVines> 
>   | 
> 
> | 124 | USA> 
>    | 45> 
>  | Eagle'sNest> 
>  | 
> 
> | 648 | India> 
>  | 69> 
>  | SunsetVines> 
>  | 
> 
> | 894 | USA> 
>    | 39> 
>  | RoyalVines> 
>   |  
> 
> | 677 | USA> 
>    | 9> 
>   | PacificCrest> 
> |  
> 
> +-----+-----------+--------+-----------------+
> 
> **è¾“å‡ºï¼š**
> 
> +-----------+---------------------+-------------------+----------------------+
> 
> | country   | top_winery> 
> > 
>   | second_winery> 
>  | third_winery> 
> > 
>  |
> 
> +-----------+---------------------+-------------------+----------------------+
> 
> | Australia | HarmonyHill (100)   | GrapesGalore (85) | WhisperingPines (84) |
> 
> | Hungary   | MoonlitCellars (60) | No second winery  | No third winery> 
>   | 
> 
> | India> 
>  | SunsetVines (69)> 
> | No second winery  | No third winery> 
>   |  
> 
> | USA> 
>    | RoyalVines (86)> 
>  | Eagle'sNest (45)  | PacificCrest (9)> 
>  | 
> 
> +-----------+---------------------+-------------------+----------------------+
> 
> **è§£é‡Šï¼š**
> 
> å¯¹äº Australia
 > - HarmonyHill é…’åº„è·å¾—äº† Australia çš„æœ€é«˜åˆ†æ•°ï¼Œä¸º 100 åˆ†ã€‚
 > - GrapesGalore é…’åº„æ€»å…±è·å¾— 85 åˆ†ï¼Œä½åˆ— Australia çš„ç¬¬äºŒä½ã€‚
 > - WhisperingPines é…’åº„æ€»å…±è·å¾— 80 åˆ†ï¼Œä½åˆ— Australia çš„ç¬¬ä¸‰ä½ã€‚
> 
> å¯¹äº Hungary
 > - MoonlitCellars æ˜¯å”¯ä¸€çš„é…’åº„ï¼Œè·å¾— 60 åˆ†ï¼Œè‡ªåŠ¨æˆä¸ºæœ€é«˜åˆ†æ•°çš„é…’åº„ã€‚æ²¡æœ‰ç¬¬äºŒæˆ–ç¬¬ä¸‰å®¶é…’åº„ã€‚
> 
> å¯¹äº India
 > - SunsetVines æ˜¯å”¯ä¸€çš„é…’åº„ï¼Œè·å¾— 69 åˆ†ï¼Œæˆä¸ºæœ€é«˜çš„é…’åº„ã€‚æ²¡æœ‰ç¬¬äºŒæˆ–ç¬¬ä¸‰å®¶é…’åº„ã€‚
> 
> å¯¹äº USA
 > - RoyalVines Wines ç´¯è®¡äº†æ€»åˆ† 47 + 39 = 86 åˆ†ï¼Œå æ®äº† USA çš„æœ€é«˜ä½ç½®ã€‚
 > - Eagle'sNest æ€»å…±è·å¾— 45 åˆ†ï¼Œä½åˆ— USA çš„ç¬¬äºŒé«˜ä½ç½®ã€‚
 > - PacificCrest ç´¯è®¡äº† 9 åˆ†ï¼Œä½åˆ— USA çš„ç¬¬ä¸‰é«˜é…’åº„ã€‚
> 
> è¾“å‡ºè¡¨æŒ‰å›½å®¶é¦–å­—æ¯å‡åºæ’åˆ—ã€‚
> 
> 


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```