# [3056. å¿«ç…§åˆ†æ](https://leetcode.com/problems/snaps-analysis)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/snaps-analysis)

## é¢˜ç›®

Table: `Activities`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | activity_id   | int> 
>  |
> 
> | user_id> 
>    | int> 
>  |
> 
> | activity_type | enum> 
> |
> 
> | time_spent> 
> | decimal |
> 
> +---------------+---------+
> 
> activity_id is column of unique values for this table.
> 
> activity_type is an ENUM (category) type of ('send', 'open'). 
> 
> This table contains activity id, user id, activity type and time spent.
> 
> 

Table: `Age`

> 
> 
> 
> 
> 
> +-------------+------+
> 
> | Column Name | Type |
> 
> +-------------+------+
> 
> | user_id> 
>  | int  |
> 
> | age_bucket  | enum |
> 
> +-------------+------+
> 
> user_id is the column of unique values for this table.
> 
> age_bucket is an ENUM (category) type of ('21-25', '26-30', '31-35'). 
> 
> This table contains user id and age group.

Write a solution to calculate the **percentage** of the total time spent on
**sending** and **opening snaps** for **each age group**. Precentage should be
**rounded** to `2` decimal places.

Return _the result table_ _in**any** order._

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Activities table:
> 
> +-------------+---------+---------------+------------+
> 
> | activity_id | user_id | activity_type | time_spent |
> 
> +-------------+---------+---------------+------------+
> 
> | 7274> 
> > 
> | 123> 
>  | open> 
> > 
>   | 4.50> 
>    | 
> 
> | 2425> 
> > 
> | 123> 
>  | send> 
> > 
>   | 3.50> 
>    | 
> 
> | 1413> 
> > 
> | 456> 
>  | send> 
> > 
>   | 5.67> 
>    | 
> 
> | 2536> 
> > 
> | 456> 
>  | open> 
> > 
>   | 3.00> 
>    | 
> 
> | 8564> 
> > 
> | 456> 
>  | send> 
> > 
>   | 8.24> 
>    | 
> 
> | 5235> 
> > 
> | 789> 
>  | send> 
> > 
>   | 6.24> 
>    | 
> 
> | 4251> 
> > 
> | 123> 
>  | open> 
> > 
>   | 1.25> 
>    | 
> 
> | 1435> 
> > 
> | 789> 
>  | open> 
> > 
>   | 5.25> 
>    | 
> 
> +-------------+---------+---------------+------------+
> 
> Age table:
> 
> +---------+------------+
> 
> | user_id | age_bucket | 
> 
> +---------+------------+
> 
> | 123> 
>  | 31-35> 
>   | 
> 
> | 789> 
>  | 21-25> 
>   | 
> 
> | 456> 
>  | 26-30> 
>   | 
> 
> +---------+------------+
> 
> Output: 
> 
> +------------+-----------+-----------+
> 
> | age_bucket | send_perc | open_perc |
> 
> +------------+-----------+-----------+
> 
> | 31-35> 
>   | 37.84> 
>  | 62.16> 
>  |
> 
> | 26-30> 
>   | 82.26> 
>  | 17.74> 
>  |
> 
> | 21-25> 
>   | 54.31> 
>  | 45.69> 
>  |
> 
> +------------+-----------+-----------+
> 
> Explanation: 
> 
> For age group 31-35:
  > - There is only one user belonging to this group with the user ID 123.
  > - The total time spent on sending snaps by this user is 3.50, and the time spent on opening snaps is 4.50 + 1.25 = 5.75.
  > - The overall time spent by this user is 3.50 + 5.75 = 9.25.
  > - Therefore, the sending snap percentage will be (3.50 / 9.25) * 100 = 37.84, and the opening snap percentage will be (5.75 / 9.25) * 100 = 62.16.
> 
> For age group 26-30: 
  > - There is only one user belonging to this group with the user ID 456. 
  > - The total time spent on sending snaps by this user is 5.67 + 8.24 = 13.91, and the time spent on opening snaps is 3.00. 
  > - The overall time spent by this user is 13.91 + 3.00 = 16.91. 
  > - Therefore, the sending snap percentage will be (13.91 / 16.91) * 100 = 82.26, and the opening snap percentage will be (3.00 / 16.91) * 100 = 17.74.
> 
> For age group 21-25: 
  > - There is only one user belonging to this group with the user ID 789. 
  > - The total time spent on sending snaps by this user is 6.24, and the time spent on opening snaps is 5.25. 
  > - The overall time spent by this user is 6.24 + 5.25 = 11.49. 
  > - Therefore, the sending snap percentage will be (6.24 / 11.49) * 100 = 54.31, and the opening snap percentage will be (5.25 / 11.49) * 100 = 45.69.
> 
> All percentages in output table rounded to the two decimal places.
> 
> 


## é¢˜ç›®å¤§æ„

è¡¨ï¼š`Activities`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | activity_id   | int> 
>  |
> 
> | user_id> 
>    | int> 
>  |
> 
> | activity_type | enum> 
> |
> 
> | time_spent> 
> | decimal |
> 
> +---------------+---------+
> 
> activity_id æ˜¯è¿™å¼ è¡¨ä¸­å€¼äº’ä¸ç›¸åŒçš„åˆ—ã€‚
> 
> activity_type æ˜¯ä¸€ä¸ª ('send', 'open') çš„ ENUM (category)ã€‚
> 
> è¿™å¼ è¡¨åŒ…å« activity idï¼Œuser idï¼Œactivity type å’Œ time spentã€‚
> 
> 

è¡¨ï¼š`Age`

> 
> 
> 
> 
> 
> +-------------+------+
> 
> | Column Name | Type |
> 
> +-------------+------+
> 
> | user_id> 
>  | int  |
> 
> | age_bucket  | enum |
> 
> +-------------+------+
> 
> user_id æ˜¯è¿™å¼ è¡¨ä¸­æœ‰ä¸åŒå€¼çš„åˆ—ã€‚
> 
> age_bucket æ˜¯ä¸€ä¸ª ('21-25', '26-30', '31-35') çš„ ENUM (category)ã€‚
> 
> è¿™å¼ è¡¨åŒ…å« user id å’Œ age ç»„ã€‚

ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ¥è®¡ç®— **æ¯ä¸ªå¹´é¾„ç»„** **å‘é€** å’Œ **æ‰“å¼€å¿«ç…§** æ‰€èŠ±è´¹çš„æ€»æ—¶é—´ **ç™¾åˆ†æ¯”** ã€‚ç™¾åˆ†æ¯”åº” **å››èˆäº”å…¥** è‡³å°æ•°ç‚¹å
`2` ä½ã€‚

ä»¥ **ä»»ä½•** é¡ºåºè¿”å›ç»“æœè¡¨ã€‚

ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** 
> 
> Activities è¡¨ï¼š
> 
> +-------------+---------+---------------+------------+
> 
> | activity_id | user_id | activity_type | time_spent |
> 
> +-------------+---------+---------------+------------+
> 
> | 7274> 
> > 
> | 123> 
>  | open> 
> > 
>   | 4.50> 
>    | 
> 
> | 2425> 
> > 
> | 123> 
>  | send> 
> > 
>   | 3.50> 
>    | 
> 
> | 1413> 
> > 
> | 456> 
>  | send> 
> > 
>   | 5.67> 
>    | 
> 
> | 2536> 
> > 
> | 456> 
>  | open> 
> > 
>   | 3.00> 
>    | 
> 
> | 8564> 
> > 
> | 456> 
>  | send> 
> > 
>   | 8.24> 
>    | 
> 
> | 5235> 
> > 
> | 789> 
>  | send> 
> > 
>   | 6.24> 
>    | 
> 
> | 4251> 
> > 
> | 123> 
>  | open> 
> > 
>   | 1.25> 
>    | 
> 
> | 1435> 
> > 
> | 789> 
>  | open> 
> > 
>   | 5.25> 
>    | 
> 
> +-------------+---------+---------------+------------+
> 
> Age è¡¨ï¼š
> 
> +---------+------------+
> 
> | user_id | age_bucket | 
> 
> +---------+------------+
> 
> | 123> 
>  | 31-35> 
>   | 
> 
> | 789> 
>  | 21-25> 
>   | 
> 
> | 456> 
>  | 26-30> 
>   | 
> 
> +---------+------------+
> 
> **è¾“å‡ºï¼š** 
> 
> +------------+-----------+-----------+
> 
> | age_bucket | send_perc | open_perc |
> 
> +------------+-----------+-----------+
> 
> | 31-35> 
>   | 37.84> 
>  | 62.16> 
>  |
> 
> | 26-30> 
>   | 82.26> 
>  | 17.74> 
>  |
> 
> | 21-25> 
>   | 54.31> 
>  | 45.69> 
>  |
> 
> +------------+-----------+-----------+
> 
> **è§£é‡Šï¼š** 
> 
> å¯¹äºå¹´é¾„ç»„ 31-35ï¼š
  > - åªæœ‰ä¸€ä¸ªç”¨æˆ·å±äºè¯¥ç»„ï¼Œç”¨æˆ· ID ä¸º 123ã€‚
  > - è¯¥ç”¨æˆ·èŠ±è´¹åœ¨å‘é€å¿«ç…§ä¸Šçš„æ€»æ—¶é—´ä¸º 3.50ï¼Œå¹¶ä¸”èŠ±è´¹åœ¨æ‰“å¼€å¿«ç…§ä¸Šçš„æ—¶é—´ä¸º 4.50 + 1.25 = 5.75ã€‚
  > - ç”¨æˆ·èŠ±è´¹çš„æ€»æ—¶é—´ä¸º 3.50 + 5.75 = 9.25ã€‚
  > - å› æ­¤ï¼Œå‘é€å¿«ç…§ç™¾åˆ†æ¯”ä¸º (3.50 / 9.25) * 100 = 37.84ï¼Œå¹¶ä¸”æ‰“å¼€å¿«ç…§ç™¾åˆ†æ¯”ä¸º (5.75 / 9.25) * 100 = 62.16ã€‚
> 
> å¯¹äºå¹´é¾„ç»„ 26-30ï¼š
  > - åªæœ‰ä¸€ä¸ªç”¨æˆ·å±äºè¯¥ç»„ï¼Œç”¨æˆ· ID ä¸º 456ã€‚
  > - è¯¥ç”¨æˆ·èŠ±è´¹åœ¨å‘é€å¿«ç…§ä¸Šçš„æ€»æ—¶é—´ä¸º 5.67 + 8.24 = 13.91ï¼Œå¹¶ä¸”èŠ±è´¹åœ¨æ‰“å¼€å¿«ç…§ä¸Šçš„æ—¶é—´ä¸º 3.00ã€‚
  > - ç”¨æˆ·èŠ±è´¹çš„æ€»æ—¶é—´ä¸º 13.91 + 3.00 = 16.91ã€‚
  > - å› æ­¤ï¼Œå‘é€å¿«ç…§ç™¾åˆ†æ¯”ä¸º (13.91 / 16.91) * 100 = 82.26ï¼Œå¹¶ä¸”æ‰“å¼€å¿«ç…§ç™¾åˆ†æ¯”ä¸º (3.00 / 16.91) * 100 = 17.74ã€‚
> 
> å¯¹äºå¹´é¾„ç»„ 21-25ï¼š
  > - åªæœ‰ä¸€ä¸ªç”¨æˆ·å±äºè¯¥ç»„ï¼Œç”¨æˆ· ID ä¸º 789ã€‚
  > - è¯¥ç”¨æˆ·èŠ±è´¹åœ¨å‘é€å¿«ç…§ä¸Šçš„æ€»æ—¶é—´ä¸º 6.24ï¼Œå¹¶ä¸”èŠ±è´¹åœ¨æ‰“å¼€å¿«ç…§ä¸Šçš„æ—¶é—´ä¸º 5.25ã€‚
  > - ç”¨æˆ·èŠ±è´¹çš„æ€»æ—¶é—´ä¸º 6.24 + 5.25 = 11.49ã€‚
  > - å› æ­¤ï¼Œå‘é€å¿«ç…§ç™¾åˆ†æ¯”ä¸º (6.24 / 11.49) * 100 = 54.31ï¼Œå¹¶ä¸”æ‰“å¼€å¿«ç…§ç™¾åˆ†æ¯”ä¸º (5.25 / 11.49) * 100 = 45.69ã€‚
> 
> è¾“å‡ºè¡¨ä¸­çš„æ‰€æœ‰ç™¾åˆ†æ¯”èˆå…¥åˆ°ä¸¤ä½ã€‚
> 
> 


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```