---
title: 631. è®¾è®¡ Excel æ±‚å’Œå…¬å¼ ğŸ”’
description: LeetCode,631. è®¾è®¡ Excel æ±‚å’Œå…¬å¼ ğŸ”’,è®¾è®¡ Excel æ±‚å’Œå…¬å¼,Design Excel Sum Formula,è§£é¢˜æ€è·¯,å›¾,è®¾è®¡,æ‹“æ‰‘æ’åº,æ•°ç»„,çŸ©é˜µ
keywords:
  - LeetCode
  - 631. è®¾è®¡ Excel æ±‚å’Œå…¬å¼ ğŸ”’
  - è®¾è®¡ Excel æ±‚å’Œå…¬å¼
  - Design Excel Sum Formula
  - è§£é¢˜æ€è·¯
  - å›¾
  - è®¾è®¡
  - æ‹“æ‰‘æ’åº
  - æ•°ç»„
  - çŸ©é˜µ
---

# 631. è®¾è®¡ Excel æ±‚å’Œå…¬å¼ ğŸ”’

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`å›¾`](/tag/graph.md) [`è®¾è®¡`](/tag/design.md) [`æ‹“æ‰‘æ’åº`](/tag/topological-sort.md) [`æ•°ç»„`](/tag/array.md) [`çŸ©é˜µ`](/tag/matrix.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/design-excel-sum-formula) [`LeetCode`](https://leetcode.com/problems/design-excel-sum-formula)

## é¢˜ç›®

Design the basic function of **Excel** and implement the function of the sum
formula.

Implement the `Excel` class:

  * `Excel(int height, char width)` Initializes the object with the `height` and the `width` of the sheet. The sheet is an integer matrix `mat` of size `height x width` with the row index in the range `[1, height]` and the column index in the range `['A', width]`. All the values should be **zero** initially.
  * `void set(int row, char column, int val)` Changes the value at `mat[row][column]` to be `val`.
  * `int get(int row, char column)` Returns the value at `mat[row][column]`.
  * `int sum(int row, char column, List<String> numbers)` Sets the value at `mat[row][column]` to be the sum of cells represented by `numbers` and returns the value at `mat[row][column]`. This sum formula **should exist** until this cell is overlapped by another value or another sum formula. `numbers[i]` could be on the format: 
> 
> * `"ColRow"` that represents a single cell. 
> 
>   * For example, `"F7"` represents the cell `mat[7]['F']`.
> 
> * `"ColRow1:ColRow2"` that represents a range of cells. The range will always be a rectangle where `"ColRow1"` represent the position of the top-left cell, and `"ColRow2"` represents the position of the bottom-right cell. 
> 
>   * For example, `"B3:F7"` represents the cells `mat[i][j]` for `3 <= i <= 7` and `'B' <= j <= 'F'`.

**Note:** You could assume that there will not be any circular sum reference.

  * For example, `mat[1]['A'] == sum(1, "B")` and `mat[1]['B'] == sum(1, "A")`.



**Example 1:**

> 
> 
> 
> 
> 
> **Input**
> 
> ["Excel", "set", "sum", "set", "get"]
> 
> [[3, "C"], [1, "A", 2], [3, "C", ["A1", "A1:B2"]], [2, "B", 2], [3, "C"]]
> 
> **Output**
> 
> [null, null, 4, null, 6]
> 
> 
> 
> **Explanation**
> 
> Excel excel = new Excel(3, "C");
> 
>  // construct a 3*3 2D array with all zero.
> 
>  //   A B C
> 
>  // 1 0 0 0
> 
>  // 2 0 0 0
> 
>  // 3 0 0 0
> 
> excel.set(1, "A", 2);
> 
>  // set mat[1]["A"] to be 2.
> 
>  //   A B C
> 
>  // 1 2 0 0
> 
>  // 2 0 0 0
> 
>  // 3 0 0 0
> 
> excel.sum(3, "C", ["A1", "A1:B2"]); // return 4
> 
>  // set mat[3]["C"] to be the sum of value at mat[1]["A"] and the values sum of the rectangle range whose top-left cell is mat[1]["A"] and bottom-right cell is mat[2]["B"].
> 
>  //   A B C
> 
>  // 1 2 0 0
> 
>  // 2 0 0 0
> 
>  // 3 0 0 4
> 
> excel.set(2, "B", 2);
> 
>  // set mat[2]["B"] to be 2. Note mat[3]["C"] should also be changed.
> 
>  //   A B C
> 
>  // 1 2 0 0
> 
>  // 2 0 2 0
> 
>  // 3 0 0 6
> 
> excel.get(3, "C"); // return 6

**Constraints:**

  * `1 <= height <= 26`
  * `'A' <= width <= 'Z'`
  * `1 <= row <= height`
  * `'A' <= column <= width`
  * `-100 <= val <= 100`
  * `1 <= numbers.length <= 5`
  * `numbers[i]` has the format `"ColRow"` or `"ColRow1:ColRow2"`.
  * At most `100` calls will be made to `set`, `get`, and `sum`.


## é¢˜ç›®å¤§æ„

è¯·ä½ è®¾è®¡ **Excel** ä¸­çš„åŸºæœ¬åŠŸèƒ½ï¼Œå¹¶å®ç°æ±‚å’Œå…¬å¼ã€‚

å®ç° `Excel` ç±»ï¼š

  * `Excel(int height, char width)`ï¼šç”¨é«˜åº¦ `height` å’Œå®½åº¦ `width` åˆå§‹åŒ–å¯¹è±¡ã€‚è¯¥è¡¨æ ¼æ˜¯ä¸€ä¸ªå¤§å°ä¸º `height x width` çš„æ•´æ•°çŸ©é˜µ `mat`ï¼Œå…¶ä¸­è¡Œä¸‹æ ‡èŒƒå›´æ˜¯ `[1, height]` ï¼Œåˆ—ä¸‹æ ‡èŒƒå›´æ˜¯ `['A', width]` ã€‚åˆå§‹æƒ…å†µä¸‹ï¼Œæ‰€æœ‰çš„å€¼éƒ½åº”è¯¥ä¸º **é›¶** ã€‚
  * `void set(int row, char column, int val)`ï¼šå°† `mat[row][column]` çš„å€¼æ›´æ”¹ä¸º `val` ã€‚
  * `int get(int row, char column)`ï¼šè¿”å› `mat[row][column]` çš„å€¼ã€‚
  * `int sum(int row, char column, List<String> numbers)`ï¼šå°† `mat[row][column]` çš„å€¼è®¾ä¸ºç”± `numbers` è¡¨ç¤ºçš„å•å…ƒæ ¼çš„å’Œï¼Œå¹¶è¿”å› `mat[row][column]` çš„å€¼ã€‚æ­¤æ±‚å’Œå…¬å¼åº”è¯¥ **é•¿æœŸä½œç”¨äº** è¯¥å•å…ƒæ ¼ï¼Œç›´åˆ°è¯¥å•å…ƒæ ¼è¢«å¦ä¸€ä¸ªå€¼æˆ–å¦ä¸€ä¸ªæ±‚å’Œå…¬å¼è¦†ç›–ã€‚å…¶ä¸­ï¼Œ`numbers[i]` çš„æ ¼å¼å¯ä»¥ä¸ºï¼š 
> 
> * `"ColRow"`ï¼šè¡¨ç¤ºæŸä¸ªå•å…ƒæ ¼ã€‚ 
> 
>   * ä¾‹å¦‚ï¼Œ`"F7"` è¡¨ç¤ºå•å…ƒæ ¼ `mat[7]['F']` ã€‚
> 
> * `"ColRow1:ColRow2"`ï¼šè¡¨ç¤ºä¸€ç»„å•å…ƒæ ¼ã€‚è¯¥èŒƒå›´å°†å§‹ç»ˆä¸ºä¸€ä¸ªçŸ©å½¢ï¼Œå…¶ä¸­ `"ColRow1"` è¡¨ç¤ºå·¦ä¸Šè§’å•å…ƒæ ¼çš„ä½ç½®ï¼Œ`"ColRow2"` è¡¨ç¤ºå³ä¸‹è§’å•å…ƒæ ¼çš„ä½ç½®ã€‚ 
> 
>   * ä¾‹å¦‚ï¼Œ`"B3:F7"` è¡¨ç¤º `3 <= i <= 7` å’Œ `'B' <= j <= 'F'` çš„å•å…ƒæ ¼ `mat[i][j]` ã€‚

**æ³¨æ„ï¼š** å¯ä»¥å‡è®¾ä¸ä¼šå‡ºç°å¾ªç¯æ±‚å’Œå¼•ç”¨ã€‚

  * ä¾‹å¦‚ï¼Œ`mat[1]['A'] == sum(1, "B")`ï¼Œä¸” `mat[1]['B'] == sum(1, "A")` ã€‚



**ç¤ºä¾‹ 1ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š**["Excel", "set", "sum", "set", "get"]
> 
> [[3, "C"], [1, "A", 2], [3, "C", ["A1", "A1:B2"]], [2, "B", 2], [3, "C"]]
> 
> **è¾“å‡ºï¼š**
> 
> [null, null, 4, null, 6]
> 
> 
> 
> **è§£é‡Šï¼š**
> 
> æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
> 
> Excel excel = new Excel(3, "C");
> 
>  // æ„é€ ä¸€ä¸ª 3 * 3 çš„äºŒç»´æ•°ç»„ï¼Œæ‰€æœ‰å€¼åˆå§‹åŒ–ä¸ºé›¶ã€‚
> 
>  //   A B C
> 
>  // 1 0 0 0
> 
>  // 2 0 0 0
> 
>  // 3 0 0 0
> 
> excel.set(1, "A", 2);
> 
>  // å°† mat[1]["A"] è®¾ç½®ä¸º 2 ã€‚
> 
>  //   A B C
> 
>  // 1 2 0 0
> 
>  // 2 0 0 0
> 
>  // 3 0 0 0
> 
> excel.sum(3, "C", ["A1", "A1:B2"]); // è¿”å› 4
> 
>  // å°† mat[3]["C"] è®¾ç½®ä¸º mat[1]["A"] çš„å€¼ä¸çŸ©å½¢èŒƒå›´çš„å•å…ƒæ ¼å’Œçš„å’Œï¼Œè¯¥èŒƒå›´çš„å·¦ä¸Šè§’å•å…ƒæ ¼ä½ç½®ä¸º mat[1]["A"] ï¼Œå³ä¸‹è§’å•å…ƒæ ¼ä½ç½®ä¸º mat[2]["B"] ã€‚
> 
>  //   A B C
> 
>  // 1 2 0 0
> 
>  // 2 0 0 0
> 
>  // 3 0 0 4
> 
> excel.set(2, "B", 2);
> 
>  // å°† mat[2]["B"] è®¾ç½®ä¸º 2 ã€‚æ³¨æ„ mat[3]["C"] ä¹Ÿåº”è¯¥æ›´æ”¹ã€‚
> 
>  //   A B C
> 
>  // 1 2 0 0
> 
>  // 2 0 2 0
> 
>  // 3 0 0 6
> 
> excel.get(3, "C"); // è¿”å› 6
> 
> 



**æç¤ºï¼š**

  * `1 <= height <= 26`
  * `'A' <= width <= 'Z'`
  * `1 <= row <= height`
  * `'A' <= column <= width`
  * `-100 <= val <= 100`
  * `1 <= numbers.length <= 5`
  * `numbers[i]` çš„æ ¼å¼ä¸º `"ColRow"` æˆ– `"ColRow1:ColRow2"` ã€‚
  * æœ€å¤šä¼šå¯¹ `set` ã€`get` å’Œ `sum` è¿›è¡Œ `100` æ¬¡è°ƒç”¨ã€‚


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```