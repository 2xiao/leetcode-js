# [2701. è¿ç»­é€’å¢äº¤æ˜“](https://leetcode.com/problems/consecutive-transactions-with-increasing-amounts)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/consecutive-transactions-with-increasing-amounts)

## é¢˜ç›®

Table: `Transactions`

> 
> 
> 
> 
> 
> +------------------+------+
> 
> | Column Name> 
>   | Type |
> 
> +------------------+------+
> 
> | transaction_id   | int  |
> 
> | customer_id> 
>   | int  |
> 
> | transaction_date | date |
> 
> | amount> 
> > 
>    | int  |
> 
> +------------------+------+
> 
> transaction_id is the primary key of this table. 
> 
> Each row contains information about transactions that includes unique (customer_id, transaction_date) along with the corresponding customer_id and amount.  
> 
> 

Write an SQL query to find the customers who have made consecutive
transactions with increasing `amount` for at least three consecutive days.
Include the `customer_id`, start date of the consecutive transactions period
and the end date of the consecutive transactions period. There can be multiple
consecutive transactions by a customer.

Return _the result table ordered by_ `customer_id` _in**ascending** order._

The query result format is in the following example.



**Example 1:**

> Input:  
> 
> Transactions table:
> 
> +----------------+-------------+------------------+--------+
> 
> | transaction_id | customer_id | transaction_date | amount |
> 
> +----------------+-------------+------------------+--------+
> 
> | 1> 
> > 
> > 
>   | 101> 
> > 
>  | 2023-05-01> 
>    | 100> 
> |
> 
> | 2> 
> > 
> > 
>   | 101> 
> > 
>  | 2023-05-02> 
>    | 150> 
> |
> 
> | 3> 
> > 
> > 
>   | 101> 
> > 
>  | 2023-05-03> 
>    | 200> 
> |
> 
> | 4> 
> > 
> > 
>   | 102> 
> > 
>  | 2023-05-01> 
>    | 50> 
>  |
> 
> | 5> 
> > 
> > 
>   | 102> 
> > 
>  | 2023-05-03> 
>    | 100> 
> |
> 
> | 6> 
> > 
> > 
>   | 102> 
> > 
>  | 2023-05-04> 
>    | 200> 
> |
> 
> | 7> 
> > 
> > 
>   | 105> 
> > 
>  | 2023-05-01> 
>    | 100> 
> |
> 
> | 8> 
> > 
> > 
>   | 105> 
> > 
>  | 2023-05-02> 
>    | 150> 
> |
> 
> | 9> 
> > 
> > 
>   | 105> 
> > 
>  | 2023-05-03> 
>    | 200> 
> |
> 
> | 10> 
> > 
> > 
>  | 105> 
> > 
>  | 2023-05-04> 
>    | 300> 
> |
> 
> | 11> 
> > 
> > 
>  | 105> 
> > 
>  | 2023-05-12> 
>    | 250> 
> |
> 
> | 12> 
> > 
> > 
>  | 105> 
> > 
>  | 2023-05-13> 
>    | 260> 
> |
> 
> | 13> 
> > 
> > 
>  | 105> 
> > 
>  | 2023-05-14> 
>    | 270> 
> |
> 
> +----------------+-------------+------------------+--------+
> 
> Output:  
> 
> +-------------+-------------------+-----------------+
> 
> | customer_id | consecutive_start | consecutive_end | 
> 
> +-------------+-------------------+-----------------+
> 
> | 101> 
> > 
>  |  2023-05-01> 
>    | 2023-05-03> 
>   | 
> 
> | 105> 
> > 
>  |  2023-05-01> 
>    | 2023-05-04> 
>   |
> 
> | 105> 
> > 
>  |  2023-05-12> 
>    | 2023-05-14> 
>   | 
> 
> +-------------+-------------------+-----------------+
> 
> Explanation:  
> - customer_id 101 has made consecutive transactions with increasing amounts from May 1st, 2023, to May 3rd, 2023
> - customer_id 102 does not have any consecutive transactions for at least 3 days. 
> - customer_id 105 has two sets of consecutive transactions: from May 1st, 2023, to May 4th, 2023, and from May 12th, 2023, to May 14th, 2023. 
> 
> customer_id is sorted in ascending order.
> 
> 




## é¢˜ç›®å¤§æ„

è¡¨: `Transactions`

> 
> 
> 
> 
> 
> +------------------+------+
> 
> | å­—æ®µå> 
> > 
> > 
> | ç±»å‹ |
> 
> +------------------+------+
> 
> | transaction_id   | int  |
> 
> | customer_id> 
>   | int  |
> 
> | transaction_date | date |
> 
> | amount> 
> > 
>    | int  |
> 
> +------------------+------+
> 
> transaction_id æ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚ 
> 
> æ¯è¡ŒåŒ…å«æœ‰å…³äº¤æ˜“çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬å”¯ä¸€çš„ (customer_id, transaction_date)ï¼Œä»¥åŠç›¸åº”çš„ customer_id å’Œ amountã€‚ 
> 
> 

ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼Œæ‰¾å‡ºè‡³å°‘è¿ç»­ä¸‰å¤© `amount` é€’å¢çš„å®¢æˆ·ã€‚å¹¶åŒ…æ‹¬ `customer_id`
ã€è¿ç»­äº¤æ˜“æœŸçš„èµ·å§‹æ—¥æœŸå’Œç»“æŸæ—¥æœŸã€‚ä¸€ä¸ªå®¢æˆ·å¯ä»¥æœ‰å¤šä¸ªè¿ç»­çš„äº¤æ˜“ã€‚

è¿”å›ç»“æœå¹¶æŒ‰ç…§ `customer_id` **å‡åº  **æ’åˆ—ã€‚

æŸ¥è¯¢ç»“æœçš„æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š**
> 
> Transactions è¡¨:
> 
> +----------------+-------------+------------------+--------+
> 
> | transaction_id | customer_id | transaction_date | amount |
> 
> +----------------+-------------+------------------+--------+
> 
> | 1> 
> > 
> > 
>   | 101> 
> > 
>  | 2023-05-01> 
>    | 100> 
> |
> 
> | 2> 
> > 
> > 
>   | 101> 
> > 
>  | 2023-05-02> 
>    | 150> 
> |
> 
> | 3> 
> > 
> > 
>   | 101> 
> > 
>  | 2023-05-03> 
>    | 200> 
> |
> 
> | 4> 
> > 
> > 
>   | 102> 
> > 
>  | 2023-05-01> 
>    | 50> 
>  |
> 
> | 5> 
> > 
> > 
>   | 102> 
> > 
>  | 2023-05-03> 
>    | 100> 
> |
> 
> | 6> 
> > 
> > 
>   | 102> 
> > 
>  | 2023-05-04> 
>    | 200> 
> |
> 
> | 7> 
> > 
> > 
>   | 105> 
> > 
>  | 2023-05-01> 
>    | 100> 
> |
> 
> | 8> 
> > 
> > 
>   | 105> 
> > 
>  | 2023-05-02> 
>    | 150> 
> |
> 
> | 9> 
> > 
> > 
>   | 105> 
> > 
>  | 2023-05-03> 
>    | 200> 
> |
> 
> | 10> 
> > 
> > 
>  | 105> 
> > 
>  | 2023-05-04> 
>    | 300> 
> |
> 
> | 11> 
> > 
> > 
>  | 105> 
> > 
>  | 2023-05-12> 
>    | 250> 
> |
> 
> | 12> 
> > 
> > 
>  | 105> 
> > 
>  | 2023-05-13> 
>    | 260> 
> |
> 
> | 13> 
> > 
> > 
>  | 105> 
> > 
>  | 2023-05-14> 
>    | 270> 
> |
> 
> +----------------+-------------+------------------+--------+
> 
> **è¾“å‡ºï¼š**
> 
> +-------------+-------------------+-----------------+
> 
> | customer_id | consecutive_start | consecutive_end | 
> 
> +-------------+-------------------+-----------------+
> 
> | 101> 
> > 
>  |  2023-05-01> 
>    | 2023-05-03> 
>   | 
> 
> | 105> 
> > 
>  |  2023-05-01> 
>    | 2023-05-04> 
>   |
> 
> | 105> 
> > 
>  |  2023-05-12> 
>    | 2023-05-14> 
>   | 
> 
> +-------------+-------------------+-----------------+
> 
> **è§£é‡Šï¼š**  
> - customer_id ä¸º 101 çš„å®¢æˆ·åœ¨ 2023å¹´5æœˆ1æ—¥ è‡³ 2023å¹´5æœˆ3æ—¥ æœŸé—´è¿›è¡Œäº†è¿ç»­é€’å¢é‡‘é¢çš„äº¤æ˜“ã€‚
> - customer_id ä¸º 102 çš„å®¢æˆ·æ²¡æœ‰è‡³å°‘è¿ç»­ä¸‰å¤©çš„äº¤æ˜“ã€‚
> - customer_id ä¸º 105 çš„å®¢æˆ·æœ‰ä¸¤ç»„è¿ç»­äº¤æ˜“ï¼šä» 2023å¹´5æœˆ1æ—¥ è‡³ 2023å¹´5æœˆ4æ—¥ï¼Œä»¥åŠ 2023å¹´5æœˆ12æ—¥ è‡³ 2023å¹´5æœˆ14æ—¥ã€‚ç»“æœæŒ‰ customer_id å‡åºæ’åº
> 
> 


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```