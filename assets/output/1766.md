# [1766. äº’è´¨æ ‘](https://leetcode.com/problems/tree-of-coprimes)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ ‘`](/leetcode/outline/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/leetcode/outline/tag/depth-first-search.md) [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`æ•°å­¦`](/leetcode/outline/tag/math.md) [`æ•°è®º`](/leetcode/outline/tag/number-theory.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/tree-of-coprimes)


## é¢˜ç›®

There is a tree (i.e., a connected, undirected graph that has no cycles)
consisting of `n` nodes numbered from `0` to `n - 1` and exactly `n - 1`
edges. Each node has a value associated with it, and the **root** of the tree
is node `0`.

To represent this tree, you are given an integer array `nums` and a 2D array
`edges`. Each `nums[i]` represents the `ith` node's value, and each `edges[j]
= [uj, vj]` represents an edge between nodes `uj` and `vj` in the tree.

Two values `x` and `y` are **coprime** if `gcd(x, y) == 1` where `gcd(x, y)`
is the **greatest common divisor** of `x` and `y`.

An ancestor of a node `i` is any other node on the shortest path from node `i`
to the **root**. A node is **not** considered an ancestor of itself.

Return _an array_`ans` _of size_`n`, _where_`ans[i]`_is the closest ancestor
to node_`i` _such that_`nums[i]` _and_`nums[ans[i]]` are **coprime** , or `-1`
_if there is no such ancestor_.



**Example 1:**

**![](https://assets.leetcode.com/uploads/2021/01/06/untitled-diagram.png)**

> Input: nums = [2,3,3,2], edges = [[0,1],[1,2],[1,3]]
> 
> Output: [-1,0,0,1]
> 
> Explanation: In the above figure, each node's value is in parentheses.
> - Node 0 has no coprime ancestors.
> - Node 1 has only one ancestor, node 0. Their values are coprime (gcd(2,3) == 1).
> - Node 2 has two ancestors, nodes 1 and 0. Node 1's value is not coprime (gcd(3,3) == 3), but node 0's
> 
>   value is (gcd(2,3) == 1), so node 0 is the closest valid ancestor.
> - Node 3 has two ancestors, nodes 1 and 0. It is coprime with node 1 (gcd(3,2) == 1), so node 1 is its
> 
>   closest valid ancestor.

**Example 2:**

![](https://assets.leetcode.com/uploads/2021/01/06/untitled-diagram1.png)

> Input: nums = [5,6,10,2,3,6,15], edges = [[0,1],[0,2],[1,3],[1,4],[2,5],[2,6]]
> 
> Output: [-1,0,-1,0,0,0,-1]

**Constraints:**

  * `nums.length == n`
  * `1 <= nums[i] <= 50`
  * `1 <= n <= 10^5`
  * `edges.length == n - 1`
  * `edges[j].length == 2`
  * `0 <= uj, vj < n`
  * `uj != vj`


## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ª `n` ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼ˆä¹Ÿå°±æ˜¯ä¸€ä¸ªæ— ç¯è¿é€šæ— å‘å›¾ï¼‰ï¼ŒèŠ‚ç‚¹ç¼–å·ä» `0` åˆ° `n - 1` ï¼Œä¸”æ°å¥½æœ‰ `n - 1` æ¡è¾¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹æœ‰ä¸€ä¸ªå€¼ã€‚æ ‘çš„
**æ ¹èŠ‚ç‚¹** ä¸º 0 å·ç‚¹ã€‚

ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums` å’Œä¸€ä¸ªäºŒç»´æ•°ç»„ `edges` æ¥è¡¨ç¤ºè¿™æ£µæ ‘ã€‚`nums[i]` è¡¨ç¤ºç¬¬ `i` ä¸ªç‚¹çš„å€¼ï¼Œ`edges[j] = [uj,
vj]` è¡¨ç¤ºèŠ‚ç‚¹ `uj` å’ŒèŠ‚ç‚¹ `vj` åœ¨æ ‘ä¸­æœ‰ä¸€æ¡è¾¹ã€‚

å½“ `gcd(x, y) == 1` ï¼Œæˆ‘ä»¬ç§°ä¸¤ä¸ªæ•° `x` å’Œ `y` æ˜¯ **äº’è´¨çš„** ï¼Œå…¶ä¸­ `gcd(x, y)` æ˜¯ `x` å’Œ `y` çš„
**æœ€å¤§å…¬çº¦æ•°** ã€‚

ä»èŠ‚ç‚¹ `i` åˆ° **æ ¹** æœ€çŸ­è·¯å¾„ä¸Šçš„ç‚¹éƒ½æ˜¯èŠ‚ç‚¹ `i` çš„ç¥–å…ˆèŠ‚ç‚¹ã€‚ä¸€ä¸ªèŠ‚ç‚¹ **ä¸æ˜¯** å®ƒè‡ªå·±çš„ç¥–å…ˆèŠ‚ç‚¹ã€‚

è¯·ä½ è¿”å›ä¸€ä¸ªå¤§å°ä¸º `n` çš„æ•°ç»„ `ans` ï¼Œå…¶ä¸­ __`ans[i]`æ˜¯ç¦»èŠ‚ç‚¹ `i` æœ€è¿‘çš„ç¥–å…ˆèŠ‚ç‚¹ä¸”æ»¡è¶³ __`nums[i]` å’Œ
__`nums[ans[i]]` æ˜¯ **äº’è´¨çš„** ï¼Œå¦‚æœä¸å­˜åœ¨è¿™æ ·çš„ç¥–å…ˆèŠ‚ç‚¹ï¼Œ`ans[i]` ä¸º `-1` ã€‚

**ç¤ºä¾‹ 1ï¼š**

**![](https://assets.leetcode-cn.com/aliyun-lc-
upload/uploads/2021/02/20/untitled-diagram.png)**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** nums = [2,3,3,2], edges = [[0,1],[1,2],[1,3]]
> 
> **è¾“å‡ºï¼š**[-1,0,0,1]
> 
> **è§£é‡Šï¼š** ä¸Šå›¾ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„å€¼åœ¨æ‹¬å·ä¸­è¡¨ç¤ºã€‚
> - èŠ‚ç‚¹ 0 æ²¡æœ‰äº’è´¨ç¥–å…ˆã€‚
> - èŠ‚ç‚¹ 1 åªæœ‰ä¸€ä¸ªç¥–å…ˆèŠ‚ç‚¹ 0 ã€‚å®ƒä»¬çš„å€¼æ˜¯äº’è´¨çš„ï¼ˆgcd(2,3) == 1ï¼‰ã€‚
> - èŠ‚ç‚¹ 2 æœ‰ä¸¤ä¸ªç¥–å…ˆèŠ‚ç‚¹ï¼Œåˆ†åˆ«æ˜¯èŠ‚ç‚¹ 1 å’ŒèŠ‚ç‚¹ 0 ã€‚èŠ‚ç‚¹ 1 çš„å€¼ä¸å®ƒçš„å€¼ä¸æ˜¯äº’è´¨çš„ï¼ˆgcd(3,3) == 3ï¼‰ä½†èŠ‚ç‚¹ 0 çš„å€¼æ˜¯äº’è´¨çš„(gcd(2,3) == 1)ï¼Œæ‰€ä»¥èŠ‚ç‚¹ 0 æ˜¯æœ€è¿‘çš„ç¬¦åˆè¦æ±‚çš„ç¥–å…ˆèŠ‚ç‚¹ã€‚
> - èŠ‚ç‚¹ 3 æœ‰ä¸¤ä¸ªç¥–å…ˆèŠ‚ç‚¹ï¼Œåˆ†åˆ«æ˜¯èŠ‚ç‚¹ 1 å’ŒèŠ‚ç‚¹ 0 ã€‚å®ƒä¸èŠ‚ç‚¹ 1 äº’è´¨ï¼ˆgcd(3,2) == 1ï¼‰ï¼Œæ‰€ä»¥èŠ‚ç‚¹ 1 æ˜¯ç¦»å®ƒæœ€è¿‘çš„ç¬¦åˆè¦æ±‚çš„ç¥–å…ˆèŠ‚ç‚¹ã€‚
> 
> 

**ç¤ºä¾‹ 2ï¼š**

![](https://assets.leetcode-cn.com/aliyun-lc-
upload/uploads/2021/02/20/untitled-diagram1.png)

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** nums = [5,6,10,2,3,6,15], edges = [[0,1],[0,2],[1,3],[1,4],[2,5],[2,6]]
> 
> **è¾“å‡ºï¼š**[-1,0,-1,0,0,0,-1]
> 
> 

**æç¤ºï¼š**

  * `nums.length == n`
  * `1 <= nums[i] <= 50`
  * `1 <= n <= 10^5`
  * `edges.length == n - 1`
  * `edges[j].length == 2`
  * `0 <= uj, vj < n`
  * `uj != vj`


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```