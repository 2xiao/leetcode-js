# [2088. ç»Ÿè®¡å†œåœºä¸­è‚¥æ²ƒé‡‘å­—å¡”çš„æ•°ç›®](https://leetcode.com/problems/count-fertile-pyramids-in-a-land)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ•°ç»„`](/outline/tag/array.md) [`åŠ¨æ€è§„åˆ’`](/outline/tag/dynamic-programming.md) [`çŸ©é˜µ`](/outline/tag/matrix.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/count-fertile-pyramids-in-a-land)

## é¢˜ç›®

A farmer has a **rectangular grid** of land with `m` rows and `n` columns that
can be divided into unit cells. Each cell is either **fertile** (represented
by a `1`) or **barren** (represented by a `0`). All cells outside the grid are
considered barren.

A **pyramidal plot** of land can be defined as a set of cells with the
following criteria:

  1. The number of cells in the set has to be **greater than**`1` and all cells must be **fertile**.
  2. The **apex** of a pyramid is the **topmost** cell of the pyramid. The **height** of a pyramid is the number of rows it covers. Let `(r, c)` be the apex of the pyramid, and its height be `h`. Then, the plot comprises of cells `(i, j)` where `r <= i <= r + h - 1` **and** `c - (i - r) <= j <= c + (i - r)`.

An **inverse pyramidal plot** of land can be defined as a set of cells with
similar criteria:

  1. The number of cells in the set has to be **greater than**`1` and all cells must be **fertile**.
  2. The **apex** of an inverse pyramid is the **bottommost** cell of the inverse pyramid. The **height** of an inverse pyramid is the number of rows it covers. Let `(r, c)` be the apex of the pyramid, and its height be `h`. Then, the plot comprises of cells `(i, j)` where `r - h + 1 <= i <= r` **and** `c - (r - i) <= j <= c + (r - i)`.

Some examples of valid and invalid pyramidal (and inverse pyramidal) plots are
shown below. Black cells indicate fertile cells.

![](https://assets.leetcode.com/uploads/2021/11/08/image.png)

Given a **0-indexed** `m x n` binary matrix `grid` representing the farmland,
return _the**total number** of pyramidal and inverse pyramidal plots that can
be found in_ `grid`.



**Example 1:**

![](https://assets.leetcode.com/uploads/2021/12/22/1.JPG)

> Input: grid = [[0,1,1,0],[1,1,1,1]]
> 
> Output: 2
> 
> Explanation: The 2 possible pyramidal plots are shown in blue and red respectively.
> 
> There are no inverse pyramidal plots in this grid. 
> 
> Hence total number of pyramidal and inverse pyramidal plots is 2 + 0 = 2.

**Example 2:**

![](https://assets.leetcode.com/uploads/2021/12/22/2.JPG)

> Input: grid = [[1,1,1],[1,1,1]]
> 
> Output: 2
> 
> Explanation: The pyramidal plot is shown in blue, and the inverse pyramidal plot is shown in red. 
> 
> Hence the total number of plots is 1 + 1 = 2.

**Example 3:**

![](https://assets.leetcode.com/uploads/2021/12/22/3.JPG)

> Input: grid = [[1,1,1,1,0],[1,1,1,1,1],[1,1,1,1,1],[0,1,0,0,1]]
> 
> Output: 13
> 
> Explanation: There are 7 pyramidal plots, 3 of which are shown in the 2nd and 3rd figures.
> 
> There are 6 inverse pyramidal plots, 2 of which are shown in the last figure.
> 
> The total number of plots is 7 + 6 = 13.

**Constraints:**

  * `m == grid.length`
  * `n == grid[i].length`
  * `1 <= m, n <= 1000`
  * `1 <= m * n <= 10^5`
  * `grid[i][j]` is either `0` or `1`.


## é¢˜ç›®å¤§æ„

æœ‰ä¸€ä¸ª **çŸ©å½¢ç½‘æ ¼**  çŠ¶çš„å†œåœºï¼Œåˆ’åˆ†ä¸º `m` è¡Œ `n` åˆ—çš„å•å…ƒæ ¼ã€‚æ¯ä¸ªæ ¼å­è¦ä¹ˆæ˜¯ **è‚¥æ²ƒçš„**  ï¼ˆç”¨ `1` è¡¨ç¤ºï¼‰ï¼Œè¦ä¹ˆæ˜¯ **è´«ç˜ **
çš„ï¼ˆç”¨ `0` è¡¨ç¤ºï¼‰ã€‚ç½‘æ ¼å›¾ä»¥å¤–çš„æ‰€æœ‰ä¸æ ¼å­éƒ½è§†ä¸ºè´«ç˜ çš„ã€‚

å†œåœºä¸­çš„ **é‡‘å­—å¡”**  åŒºåŸŸå®šä¹‰å¦‚ä¸‹ï¼š

  1. åŒºåŸŸå†…æ ¼å­æ•°ç›® **å¤§äº  **`1` ä¸”æ‰€æœ‰æ ¼å­éƒ½æ˜¯ **è‚¥æ²ƒçš„**  ã€‚
  2. é‡‘å­—å¡” **é¡¶ç«¯**  æ˜¯è¿™ä¸ªé‡‘å­—å¡” **æœ€ä¸Šæ–¹**  çš„æ ¼å­ã€‚é‡‘å­—å¡”çš„é«˜åº¦æ˜¯å®ƒæ‰€è¦†ç›–çš„è¡Œæ•°ã€‚ä»¤ `(r, c)` ä¸ºé‡‘å­—å¡”çš„é¡¶ç«¯ä¸”é«˜åº¦ä¸º `h` ï¼Œé‚£ä¹ˆé‡‘å­—å¡”åŒºåŸŸå†…åŒ…å«çš„ä»»ä¸€æ ¼å­ `(i, j)` éœ€æ»¡è¶³ `r <= i <= r + h - 1` **ä¸”**  `c - (i - r) <= j <= c + (i - r)` ã€‚

ä¸€ä¸ª **å€’é‡‘å­—å¡”**  ç±»ä¼¼å®šä¹‰å¦‚ä¸‹ï¼š

  1. åŒºåŸŸå†…æ ¼å­æ•°ç›® **å¤§äº**  `1` ä¸”æ‰€æœ‰æ ¼å­éƒ½æ˜¯ **è‚¥æ²ƒçš„**  ã€‚
  2. å€’é‡‘å­—å¡”çš„ **é¡¶ç«¯**  æ˜¯è¿™ä¸ªå€’é‡‘å­—å¡” **æœ€ä¸‹æ–¹**  çš„æ ¼å­ã€‚å€’é‡‘å­—å¡”çš„é«˜åº¦æ˜¯å®ƒæ‰€è¦†ç›–çš„è¡Œæ•°ã€‚ä»¤ `(r, c)` ä¸ºé‡‘å­—å¡”çš„é¡¶ç«¯ä¸”é«˜åº¦ä¸º `h` ï¼Œé‚£ä¹ˆé‡‘å­—å¡”åŒºåŸŸå†…åŒ…å«çš„ä»»ä¸€æ ¼å­ `(i, j)` éœ€æ»¡è¶³ `r - h + 1 <= i <= r` **ä¸”** `c - (r - i) <= j <= c + (r - i)` ã€‚

ä¸‹å›¾å±•ç¤ºäº†éƒ¨åˆ†ç¬¦åˆå®šä¹‰å’Œä¸ç¬¦åˆå®šä¹‰çš„é‡‘å­—å¡”åŒºåŸŸã€‚é»‘è‰²åŒºåŸŸè¡¨ç¤ºè‚¥æ²ƒçš„æ ¼å­ã€‚

![](https://assets.leetcode.com/uploads/2021/11/08/image.png)

ç»™ä½ ä¸€ä¸ªä¸‹æ ‡ä» **0**  å¼€å§‹ä¸”å¤§å°ä¸º `m x n` çš„äºŒè¿›åˆ¶çŸ©é˜µ `grid` ï¼Œå®ƒè¡¨ç¤ºå†œåœºï¼Œè¯·ä½ è¿”å› `grid` ä¸­é‡‘å­—å¡”å’Œå€’é‡‘å­—å¡”çš„
**æ€»æ•°ç›®**  ã€‚



**ç¤ºä¾‹ 1ï¼š**

![](https://assets.leetcode.com/uploads/2021/10/23/eg11.png)
![](https://assets.leetcode.com/uploads/2021/10/23/exa12.png)
![](https://assets.leetcode.com/uploads/2021/10/23/exa13.png)

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** grid = [[0,1,1,0],[1,1,1,1]]
> 
> **è¾“å‡ºï¼š** 2
> 
> **è§£é‡Šï¼š**
> 
> 2 ä¸ªå¯èƒ½çš„é‡‘å­—å¡”åŒºåŸŸåˆ†åˆ«å¦‚ä¸Šå›¾è“è‰²å’Œçº¢è‰²åŒºåŸŸæ‰€ç¤ºã€‚
> 
> è¿™ä¸ªç½‘æ ¼å›¾ä¸­æ²¡æœ‰å€’é‡‘å­—å¡”åŒºåŸŸã€‚
> 
> æ‰€ä»¥é‡‘å­—å¡”åŒºåŸŸæ€»æ•°ä¸º 2 + 0 = 2 ã€‚
> 
> 

**ç¤ºä¾‹ 2ï¼š**

![](https://assets.leetcode.com/uploads/2021/10/23/eg21.png)
![](https://assets.leetcode.com/uploads/2021/10/23/exa22.png)
![](https://assets.leetcode.com/uploads/2021/10/23/exa23.png)

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** grid = [[1,1,1],[1,1,1]]
> 
> **è¾“å‡ºï¼š** 2
> 
> **è§£é‡Šï¼š**
> 
> é‡‘å­—å¡”åŒºåŸŸå¦‚ä¸Šå›¾è“è‰²åŒºåŸŸæ‰€ç¤ºï¼Œå€’é‡‘å­—å¡”å¦‚ä¸Šå›¾çº¢è‰²åŒºåŸŸæ‰€ç¤ºã€‚
> 
> æ‰€ä»¥é‡‘å­—å¡”åŒºåŸŸæ€»æ•°ç›®ä¸º 1 + 1 = 2 ã€‚
> 
> 

**ç¤ºä¾‹ 3ï¼š**

![](https://assets.leetcode.com/uploads/2021/10/23/eg3.png)

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** grid = [[1,0,1],[0,0,0],[1,0,1]]
> 
> **è¾“å‡ºï¼š** 0
> 
> **è§£é‡Šï¼š**
> 
> ç½‘æ ¼å›¾ä¸­æ²¡æœ‰ä»»ä½•é‡‘å­—å¡”æˆ–å€’é‡‘å­—å¡”åŒºåŸŸã€‚
> 
> 

**ç¤ºä¾‹ 4ï¼š**

![](https://assets.leetcode.com/uploads/2021/10/23/eg41.png)
![](https://assets.leetcode.com/uploads/2021/10/23/eg42.png)
![](https://assets.leetcode.com/uploads/2021/10/23/eg43.png)
![](https://assets.leetcode.com/uploads/2021/10/23/eg44.png)

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** grid = [[1,1,1,1,0],[1,1,1,1,1],[1,1,1,1,1],[0,1,0,0,1]]
> 
> **è¾“å‡ºï¼š** 13
> 
> **è§£é‡Šï¼š**
> 
> æœ‰ 7 ä¸ªé‡‘å­—å¡”åŒºåŸŸã€‚ä¸Šå›¾ç¬¬äºŒå’Œç¬¬ä¸‰å¼ å›¾ä¸­å±•ç¤ºäº†å®ƒä»¬ä¸­çš„ 3 ä¸ªã€‚
> 
> æœ‰ 6 ä¸ªå€’é‡‘å­—å¡”åŒºåŸŸã€‚ä¸Šå›¾ä¸­æœ€åä¸€å¼ å›¾å±•ç¤ºäº†å®ƒä»¬ä¸­çš„ 2 ä¸ªã€‚
> 
> æ‰€ä»¥é‡‘å­—å¡”åŒºåŸŸæ€»æ•°ç›®ä¸º 7 + 6 = 13.
> 
> 



**æç¤ºï¼š**

  * `m == grid.length`
  * `n == grid[i].length`
  * `1 <= m, n <= 1000`
  * `1 <= m * n <= 10^5`
  * `grid[i][j]` è¦ä¹ˆæ˜¯ `0` ï¼Œè¦ä¹ˆæ˜¯ `1` ã€‚


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 1277 | [ç»Ÿè®¡å…¨ä¸º 1 çš„æ­£æ–¹å½¢å­çŸ©é˜µ](https://leetcode.com/problems/count-square-submatrices-with-all-ones) |  |  [`æ•°ç»„`](/outline/tag/array.md) [`åŠ¨æ€è§„åˆ’`](/outline/tag/dynamic-programming.md) [`çŸ©é˜µ`](/outline/tag/matrix.md) | <font color=#ffb800>Medium</font> |
| 1878 | [çŸ©é˜µä¸­æœ€å¤§çš„ä¸‰ä¸ªè±å½¢å’Œ](https://leetcode.com/problems/get-biggest-three-rhombus-sums-in-a-grid) |  |  [`æ•°ç»„`](/outline/tag/array.md) [`æ•°å­¦`](/outline/tag/math.md) [`çŸ©é˜µ`](/outline/tag/matrix.md) `3+` | <font color=#ffb800>Medium</font> |

<style>
.blue {
    background-color: #096dd9;
    padding: 0.25rem 0.5rem;
    margin: 0;
    font-size: 0.85em;
    border-radius: 3px;
    color: white;
    font-weight: 500;
}
table th:first-of-type { width: 10%; }
table th:nth-of-type(2) { width: 35%; }
table th:nth-of-type(3) { width: 10%; }
table th:nth-of-type(4) { width: 35%; }
table th:nth-of-type(5) { width: 10%; }
</style>
