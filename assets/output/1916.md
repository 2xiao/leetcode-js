# [1916. ç»Ÿè®¡ä¸ºèšç¾¤æ„ç­‘æˆ¿é—´çš„ä¸åŒé¡ºåº](https://leetcode.com/problems/count-ways-to-build-rooms-in-an-ant-colony)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ ‘`](/leetcode/outline/tag/tree.md) [`å›¾`](/leetcode/outline/tag/graph.md) [`æ‹“æ‰‘æ’åº`](/leetcode/outline/tag/topological-sort.md) [`æ•°å­¦`](/leetcode/outline/tag/math.md) [`åŠ¨æ€è§„åˆ’`](/leetcode/outline/tag/dynamic-programming.md) [`ç»„åˆæ•°å­¦`](/leetcode/outline/tag/combinatorics.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/count-ways-to-build-rooms-in-an-ant-colony)

## é¢˜ç›®

You are an ant tasked with adding `n` new rooms numbered `0` to `n-1` to your
colony. You are given the expansion plan as a **0-indexed** integer array of
length `n`, `prevRoom`, where `prevRoom[i]` indicates that you must build room
`prevRoom[i]` before building room `i`, and these two rooms must be connected
**directly**. Room `0` is already built, so `prevRoom[0] = -1`. The expansion
plan is given such that once all the rooms are built, every room will be
reachable from room `0`.

You can only build **one room** at a time, and you can travel freely between
rooms you have **already built** only if they are **connected**. You can
choose to build **any room** as long as its **previous room**  is already
built.

Return _the**number of different orders** you can build all the rooms in_.
Since the answer may be large, return it **modulo** `109 + 7`.



**Example 1:**

![](https://assets.leetcode.com/uploads/2021/06/19/d1.JPG)

> 
> 
> 
> 
> 
> **Input:** prevRoom = [-1,0,1]
> 
> Output: 1
> 
> Explanation:  There is only one way to build the additional rooms: 0 -> 1 -> 2

**Example 2:**

**![](https://assets.leetcode.com/uploads/2021/06/19/d2.JPG)**

> 
> 
> 
> 
> 
> **Input:** prevRoom = [-1,0,0,1,2]
> 
> Output: 6
> 
> Explanation: The 6 ways are:
> 
> 0 -> 1 -> 3 -> 2 -> 4
> 
> 0 -> 2 -> 4 -> 1 -> 3
> 
> 0 -> 1 -> 2 -> 3 -> 4
> 
> 0 -> 1 -> 2 -> 4 -> 3
> 
> 0 -> 2 -> 1 -> 3 -> 4
> 
> 0 -> 2 -> 1 -> 4 -> 3

**Constraints:**

  * `n == prevRoom.length`
  * `2 <= n <= 10^5`
  * `prevRoom[0] == -1`
  * `0 <= prevRoom[i] < n` for all `1 <= i < n`
  * Every room is reachable from room `0` once all the rooms are built.


## é¢˜ç›®å¤§æ„

ä½ æ˜¯ä¸€åªèš‚èšï¼Œè´Ÿè´£ä¸ºèšç¾¤æ„ç­‘ `n` é—´ç¼–å·ä» `0` åˆ° `n-1` çš„æ–°æˆ¿é—´ã€‚ç»™ä½ ä¸€ä¸ª **ä¸‹æ ‡ä» 0 å¼€å§‹** ä¸”é•¿åº¦ä¸º `n` çš„æ•´æ•°æ•°ç»„
`prevRoom` ä½œä¸ºæ‰©å»ºè®¡åˆ’ã€‚å…¶ä¸­ï¼Œ`prevRoom[i]` è¡¨ç¤ºåœ¨æ„ç­‘æˆ¿é—´ `i` ä¹‹å‰ï¼Œä½ å¿…é¡»å…ˆæ„ç­‘æˆ¿é—´ `prevRoom[i]`
ï¼Œå¹¶ä¸”è¿™ä¸¤ä¸ªæˆ¿é—´å¿…é¡» **ç›´æ¥** ç›¸è¿ã€‚æˆ¿é—´ `0` å·²ç»æ„ç­‘å®Œæˆï¼Œæ‰€ä»¥ `prevRoom[0] = -1`
ã€‚æ‰©å»ºè®¡åˆ’ä¸­è¿˜æœ‰ä¸€æ¡ç¡¬æ€§è¦æ±‚ï¼Œåœ¨å®Œæˆæ‰€æœ‰æˆ¿é—´çš„æ„ç­‘ä¹‹åï¼Œä»æˆ¿é—´ `0` å¯ä»¥è®¿é—®åˆ°æ¯ä¸ªæˆ¿é—´ã€‚

ä½ ä¸€æ¬¡åªèƒ½æ„ç­‘ **ä¸€ä¸ª** æˆ¿é—´ã€‚ä½ å¯ä»¥åœ¨ **å·²ç»æ„ç­‘å¥½çš„** æˆ¿é—´ä¹‹é—´è‡ªç”±ç©¿è¡Œï¼Œåªè¦è¿™äº›æˆ¿é—´æ˜¯ **ç›¸è¿çš„** ã€‚å¦‚æœæˆ¿é—´ `prevRoom[i]`
å·²ç»æ„ç­‘å®Œæˆï¼Œé‚£ä¹ˆä½ å°±å¯ä»¥æ„ç­‘æˆ¿é—´ `i`ã€‚

è¿”å›ä½ æ„ç­‘æ‰€æœ‰æˆ¿é—´çš„ **ä¸åŒé¡ºåºçš„æ•°ç›®** ã€‚ç”±äºç­”æ¡ˆå¯èƒ½å¾ˆå¤§ï¼Œè¯·è¿”å›å¯¹ `109 + 7` **å–ä½™** çš„ç»“æœã€‚



**ç¤ºä¾‹ 1ï¼š**

![](https://assets.leetcode.com/uploads/2021/06/19/d1.JPG)

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š**prevRoom = [-1,0,1]
> 
> **è¾“å‡ºï¼š** 1
> 
> **è§£é‡Šï¼š** ä»…æœ‰ä¸€ç§æ–¹æ¡ˆå¯ä»¥å®Œæˆæ‰€æœ‰æˆ¿é—´çš„æ„ç­‘ï¼š0 â†’ 1 â†’ 2
> 
> 

**ç¤ºä¾‹ 2ï¼š**

**![](https://assets.leetcode.com/uploads/2021/06/19/d2.JPG)**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š**prevRoom = [-1,0,0,1,2]
> 
> **è¾“å‡ºï¼š** 6
> 
> **è§£é‡Šï¼š** æœ‰ 6 ç§ä¸åŒé¡ºåºï¼š
> 
> 0 â†’ 1 â†’ 3 â†’ 2 â†’ 4
> 
> 0 â†’ 2 â†’ 4 â†’ 1 â†’ 3
> 
> 0 â†’ 1 â†’ 2 â†’ 3 â†’ 4
> 
> 0 â†’ 1 â†’ 2 â†’ 4 â†’ 3
> 
> 0 â†’ 2 â†’ 1 â†’ 3 â†’ 4
> 
> 0 â†’ 2 â†’ 1 â†’ 4 â†’ 3
> 
> 



**æç¤ºï¼š**

  * `n == prevRoom.length`
  * `2 <= n <= 10^5`
  * `prevRoom[0] == -1`
  * å¯¹äºæ‰€æœ‰çš„ `1 <= i < n` ï¼Œéƒ½æœ‰ `0 <= prevRoom[i] < n`
  * é¢˜ç›®ä¿è¯æ‰€æœ‰æˆ¿é—´éƒ½æ„ç­‘å®Œæˆåï¼Œä»æˆ¿é—´ `0` å¯ä»¥è®¿é—®åˆ°æ¯ä¸ªæˆ¿é—´


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 2514 | [ç»Ÿè®¡åŒä½å¼‚æ„å­—ç¬¦ä¸²æ•°ç›®](https://leetcode.com/problems/count-anagrams) |  |  [`å“ˆå¸Œè¡¨`](/leetcode/outline/tag/hash-table.md) [`æ•°å­¦`](/leetcode/outline/tag/math.md) [`å­—ç¬¦ä¸²`](/leetcode/outline/tag/string.md) `2+` | <font color=#ff334b>Hard</font> |
| 2539 | [å¥½å­åºåˆ—çš„ä¸ªæ•°](https://leetcode.com/problems/count-the-number-of-good-subsequences) |  |  [`å“ˆå¸Œè¡¨`](/leetcode/outline/tag/hash-table.md) [`æ•°å­¦`](/leetcode/outline/tag/math.md) [`å­—ç¬¦ä¸²`](/leetcode/outline/tag/string.md) `2+` | <font color=#ffb800>Medium</font> |

<style>
.blue {
    background-color: #096dd9;
    padding: 0.25rem 0.5rem;
    margin: 0;
    font-size: 0.85em;
    border-radius: 3px;
    color: white;
    font-weight: 500;
}
table th:first-of-type { width: 10%; }
table th:nth-of-type(2) { width: 35%; }
table th:nth-of-type(3) { width: 10%; }
table th:nth-of-type(4) { width: 35%; }
table th:nth-of-type(5) { width: 10%; }
</style>
