# [1174. å³æ—¶é£Ÿç‰©é…é€ II](https://leetcode.com/problems/immediate-food-delivery-ii)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/outline/tag/database.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/immediate-food-delivery-ii)

## é¢˜ç›®

Table: `Delivery`

> 
> 
> 
> 
> 
> +-----------------------------+---------+
> 
> | Column Name> 
> > 
> > 
> > 
>  | Type> 
> |
> 
> +-----------------------------+---------+
> 
> | delivery_id> 
> > 
> > 
> > 
>  | int> 
>  |
> 
> | customer_id> 
> > 
> > 
> > 
>  | int> 
>  |
> 
> | order_date> 
> > 
> > 
> > 
>   | date> 
> |
> 
> | customer_pref_delivery_date | date> 
> |
> 
> +-----------------------------+---------+
> 
> delivery_id is the column of unique values of this table.
> 
> The table holds information about food delivery to customers that make orders at some date and specify a preferred delivery date (on the same order date or after it).
> 
> 



If the customer's preferred delivery date is the same as the order date, then
the order is called **immediate;** otherwise, it is called **scheduled**.

The **first order** of a customer is the order with the earliest order date
that the customer made. It is guaranteed that a customer has precisely one
first order.

Write a solution to find the percentage of immediate orders in the first
orders of all customers, **rounded to 2 decimal places**.

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Delivery table:
> 
> +-------------+-------------+------------+-----------------------------+
> 
> | delivery_id | customer_id | order_date | customer_pref_delivery_date |
> 
> +-------------+-------------+------------+-----------------------------+
> 
> | 1> 
> > 
>    | 1> 
> > 
>    | 2019-08-01 | 2019-08-02> 
> > 
> > 
> > 
>   |
> 
> | 2> 
> > 
>    | 2> 
> > 
>    | 2019-08-02 | 2019-08-02> 
> > 
> > 
> > 
>   |
> 
> | 3> 
> > 
>    | 1> 
> > 
>    | 2019-08-11 | 2019-08-12> 
> > 
> > 
> > 
>   |
> 
> | 4> 
> > 
>    | 3> 
> > 
>    | 2019-08-24 | 2019-08-24> 
> > 
> > 
> > 
>   |
> 
> | 5> 
> > 
>    | 3> 
> > 
>    | 2019-08-21 | 2019-08-22> 
> > 
> > 
> > 
>   |
> 
> | 6> 
> > 
>    | 2> 
> > 
>    | 2019-08-11 | 2019-08-13> 
> > 
> > 
> > 
>   |
> 
> | 7> 
> > 
>    | 4> 
> > 
>    | 2019-08-09 | 2019-08-09> 
> > 
> > 
> > 
>   |
> 
> +-------------+-------------+------------+-----------------------------+
> 
> Output: 
> 
> +----------------------+
> 
> | immediate_percentage |
> 
> +----------------------+
> 
> | 50.00> 
> > 
> > 
> > 
> |
> 
> +----------------------+
> 
> Explanation: 
> 
> The customer id 1 has a first order with delivery id 1 and it is scheduled.
> 
> The customer id 2 has a first order with delivery id 2 and it is immediate.
> 
> The customer id 3 has a first order with delivery id 5 and it is scheduled.
> 
> The customer id 4 has a first order with delivery id 7 and it is immediate.
> 
> Hence, half the customers have immediate first orders.
> 
> 


## é¢˜ç›®å¤§æ„

é…é€è¡¨: `Delivery`

> 
> 
> 
> 
> 
> +-----------------------------+---------+
> 
> | Column Name> 
> > 
> > 
> > 
>  | Type> 
> |
> 
> +-----------------------------+---------+
> 
> | delivery_id> 
> > 
> > 
> > 
>  | int> 
>  |
> 
> | customer_id> 
> > 
> > 
> > 
>  | int> 
>  |
> 
> | order_date> 
> > 
> > 
> > 
>   | date> 
> |
> 
> | customer_pref_delivery_date | date> 
> |
> 
> +-----------------------------+---------+
> 
> delivery_id æ˜¯è¯¥è¡¨ä¸­å…·æœ‰å”¯ä¸€å€¼çš„åˆ—ã€‚
> 
> è¯¥è¡¨ä¿å­˜ç€é¡¾å®¢çš„é£Ÿç‰©é…é€ä¿¡æ¯ï¼Œé¡¾å®¢åœ¨æŸä¸ªæ—¥æœŸä¸‹äº†è®¢å•ï¼Œå¹¶æŒ‡å®šäº†ä¸€ä¸ªæœŸæœ›çš„é…é€æ—¥æœŸï¼ˆå’Œä¸‹å•æ—¥æœŸç›¸åŒæˆ–è€…åœ¨é‚£ä¹‹åï¼‰ã€‚
> 
> 



å¦‚æœé¡¾å®¢æœŸæœ›çš„é…é€æ—¥æœŸå’Œä¸‹å•æ—¥æœŸç›¸åŒï¼Œåˆ™è¯¥è®¢å•ç§°ä¸º ã€Œ**å³æ—¶è®¢å•** ã€ï¼Œå¦åˆ™ç§°ä¸ºã€Œ**è®¡åˆ’è®¢å•** ã€ã€‚

ã€Œ**é¦–æ¬¡è®¢å•** ã€æ˜¯é¡¾å®¢æœ€æ—©åˆ›å»ºçš„è®¢å•ã€‚æˆ‘ä»¬ä¿è¯ä¸€ä¸ªé¡¾å®¢åªä¼šæœ‰ä¸€ä¸ªã€Œé¦–æ¬¡è®¢å•ã€ã€‚

ç¼–å†™è§£å†³æ–¹æ¡ˆä»¥è·å–å³æ—¶è®¢å•åœ¨æ‰€æœ‰ç”¨æˆ·çš„é¦–æ¬¡è®¢å•ä¸­çš„æ¯”ä¾‹ã€‚**ä¿ç•™ä¸¤ä½å°æ•°ã€‚**

ç»“æœç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š



**ç¤ºä¾‹ 1ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š**
> 
> Delivery è¡¨ï¼š
> 
> +-------------+-------------+------------+-----------------------------+
> 
> | delivery_id | customer_id | order_date | customer_pref_delivery_date |
> 
> +-------------+-------------+------------+-----------------------------+
> 
> | 1> 
> > 
>    | 1> 
> > 
>    | 2019-08-01 | 2019-08-02> 
> > 
> > 
> > 
>   |
> 
> | 2> 
> > 
>    | 2> 
> > 
>    | 2019-08-02 | 2019-08-02> 
> > 
> > 
> > 
>   |
> 
> | 3> 
> > 
>    | 1> 
> > 
>    | 2019-08-11 | 2019-08-12> 
> > 
> > 
> > 
>   |
> 
> | 4> 
> > 
>    | 3> 
> > 
>    | 2019-08-24 | 2019-08-24> 
> > 
> > 
> > 
>   |
> 
> | 5> 
> > 
>    | 3> 
> > 
>    | 2019-08-21 | 2019-08-22> 
> > 
> > 
> > 
>   |
> 
> | 6> 
> > 
>    | 2> 
> > 
>    | 2019-08-11 | 2019-08-13> 
> > 
> > 
> > 
>   |
> 
> | 7> 
> > 
>    | 4> 
> > 
>    | 2019-08-09 | 2019-08-09> 
> > 
> > 
> > 
>   |
> 
> +-------------+-------------+------------+-----------------------------+
> 
> **è¾“å‡ºï¼š**
> 
> +----------------------+
> 
> | immediate_percentage |
> 
> +----------------------+
> 
> | 50.00> 
> > 
> > 
> > 
> |
> 
> +----------------------+
> 
> **è§£é‡Šï¼š**
> 
> 1 å·é¡¾å®¢çš„ 1 å·è®¢å•æ˜¯é¦–æ¬¡è®¢å•ï¼Œå¹¶ä¸”æ˜¯è®¡åˆ’è®¢å•ã€‚
> 
> 2 å·é¡¾å®¢çš„ 2 å·è®¢å•æ˜¯é¦–æ¬¡è®¢å•ï¼Œå¹¶ä¸”æ˜¯å³æ—¶è®¢å•ã€‚
> 
> 3 å·é¡¾å®¢çš„ 5 å·è®¢å•æ˜¯é¦–æ¬¡è®¢å•ï¼Œå¹¶ä¸”æ˜¯è®¡åˆ’è®¢å•ã€‚
> 
> 4 å·é¡¾å®¢çš„ 7 å·è®¢å•æ˜¯é¦–æ¬¡è®¢å•ï¼Œå¹¶ä¸”æ˜¯å³æ—¶è®¢å•ã€‚
> 
> å› æ­¤ï¼Œä¸€åŠé¡¾å®¢çš„é¦–æ¬¡è®¢å•æ˜¯å³æ—¶çš„ã€‚
> 
> 


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```