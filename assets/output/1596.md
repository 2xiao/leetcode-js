# [1596. æ¯ä½é¡¾å®¢æœ€ç»å¸¸è®¢è´­çš„å•†å“ ğŸ”’](https://2xiao.github.io/leetcode-js/problem/1596.html)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/the-most-frequently-ordered-products-for-each-customer) [`LeetCode`](https://leetcode.com/problems/the-most-frequently-ordered-products-for-each-customer)

## é¢˜ç›®

Table: `Customers`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | customer_id   | int> 
>  |
> 
> | name> 
> > 
>   | varchar |
> 
> +---------------+---------+
> 
> customer_id is the column with unique values for this table.
> 
> This table contains information about the customers.
> 
> 



Table: `Orders`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | order_id> 
>   | int> 
>  |
> 
> | order_date> 
> | date> 
> |
> 
> | customer_id   | int> 
>  |
> 
> | product_id> 
> | int> 
>  |
> 
> +---------------+---------+
> 
> order_id is the column with unique values for this table.
> 
> This table contains information about the orders made by customer_id.
> 
> No customer will order the same product **more than once** in a single day.



Table: `Products`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | product_id> 
> | int> 
>  |
> 
> | product_name  | varchar |
> 
> | price> 
> > 
>  | int> 
>  |
> 
> +---------------+---------+
> 
> product_id is the column with unique values for this table.
> 
> This table contains information about the products.
> 
> 



Write a solution to find the most frequently ordered product(s) for each
customer.

The result table should have the `product_id` and `product_name` for each
`customer_id` who ordered at least one order.

Return the result table in **any order**.

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Customers table:
> 
> +-------------+-------+
> 
> | customer_id | name  |
> 
> +-------------+-------+
> 
> | 1> 
> > 
>    | Alice |
> 
> | 2> 
> > 
>    | Bob   |
> 
> | 3> 
> > 
>    | Tom   |
> 
> | 4> 
> > 
>    | Jerry |
> 
> | 5> 
> > 
>    | John  |
> 
> +-------------+-------+
> 
> Orders table:
> 
> +----------+------------+-------------+------------+
> 
> | order_id | order_date | customer_id | product_id |
> 
> +----------+------------+-------------+------------+
> 
> | 1> 
> > 
> | 2020-07-31 | 1> 
> > 
>    | 1> 
> > 
>   |
> 
> | 2> 
> > 
> | 2020-07-30 | 2> 
> > 
>    | 2> 
> > 
>   |
> 
> | 3> 
> > 
> | 2020-08-29 | 3> 
> > 
>    | 3> 
> > 
>   |
> 
> | 4> 
> > 
> | 2020-07-29 | 4> 
> > 
>    | 1> 
> > 
>   |
> 
> | 5> 
> > 
> | 2020-06-10 | 1> 
> > 
>    | 2> 
> > 
>   |
> 
> | 6> 
> > 
> | 2020-08-01 | 2> 
> > 
>    | 1> 
> > 
>   |
> 
> | 7> 
> > 
> | 2020-08-01 | 3> 
> > 
>    | 3> 
> > 
>   |
> 
> | 8> 
> > 
> | 2020-08-03 | 1> 
> > 
>    | 2> 
> > 
>   |
> 
> | 9> 
> > 
> | 2020-08-07 | 2> 
> > 
>    | 3> 
> > 
>   |
> 
> | 10> 
>    | 2020-07-15 | 1> 
> > 
>    | 2> 
> > 
>   |
> 
> +----------+------------+-------------+------------+
> 
> Products table:
> 
> +------------+--------------+-------+
> 
> | product_id | product_name | price |
> 
> +------------+--------------+-------+
> 
> | 1> 
> > 
>   | keyboard> 
>  | 120   |
> 
> | 2> 
> > 
>   | mouse> 
> > 
> | 80> 
> |
> 
> | 3> 
> > 
>   | screen> 
>    | 600   |
> 
> | 4> 
> > 
>   | hard disk> 
> | 450   |
> 
> +------------+--------------+-------+
> 
> Output: 
> 
> +-------------+------------+--------------+
> 
> | customer_id | product_id | product_name |
> 
> +-------------+------------+--------------+
> 
> | 1> 
> > 
>    | 2> 
> > 
>   | mouse> 
> > 
> |
> 
> | 2> 
> > 
>    | 1> 
> > 
>   | keyboard> 
>  |
> 
> | 2> 
> > 
>    | 2> 
> > 
>   | mouse> 
> > 
> |
> 
> | 2> 
> > 
>    | 3> 
> > 
>   | screen> 
>    |
> 
> | 3> 
> > 
>    | 3> 
> > 
>   | screen> 
>    |
> 
> | 4> 
> > 
>    | 1> 
> > 
>   | keyboard> 
>  |
> 
> +-------------+------------+--------------+
> 
> Explanation: 
> 
> Alice (customer 1) ordered the mouse three times and the keyboard one time, so the mouse is the most frequently ordered product for them.
> 
> Bob (customer 2) ordered the keyboard, the mouse, and the screen one time, so those are the most frequently ordered products for them.
> 
> Tom (customer 3) only ordered the screen (two times), so that is the most frequently ordered product for them.
> 
> Jerry (customer 4) only ordered the keyboard (one time), so that is the most frequently ordered product for them.
> 
> John (customer 5) did not order anything, so we do not include them in the result table.
> 
> 


## é¢˜ç›®å¤§æ„

è¡¨ï¼š`Customers`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | customer_id   | int> 
>  |
> 
> | name> 
> > 
>   | varchar |
> 
> +---------------+---------+
> 
> customer_id æ˜¯è¯¥è¡¨å…·æœ‰å”¯ä¸€å€¼çš„åˆ—
> 
> è¯¥è¡¨åŒ…å«æ‰€æœ‰é¡¾å®¢çš„ä¿¡æ¯
> 
> 



è¡¨ï¼š`Orders`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | order_id> 
>   | int> 
>  |
> 
> | order_date> 
> | date> 
> |
> 
> | customer_id   | int> 
>  |
> 
> | product_id> 
> | int> 
>  |
> 
> +---------------+---------+
> 
> order_id æ˜¯è¯¥è¡¨å…·æœ‰å”¯ä¸€å€¼çš„åˆ—
> 
> è¯¥è¡¨åŒ…å«é¡¾å®¢ customer_id çš„è®¢å•ä¿¡æ¯
> 
> æ²¡æœ‰é¡¾å®¢ä¼šåœ¨ä¸€å¤©å†…è®¢è´­ç›¸åŒçš„å•†å“**å¤šäºä¸€æ¬¡**



è¡¨ï¼š`Products`

> 
> 
> 
> 
> 
> +---------------+---------+
> 
> | Column Name   | Type> 
> |
> 
> +---------------+---------+
> 
> | product_id> 
> | int> 
>  |
> 
> | product_name  | varchar |
> 
> | price> 
> > 
>  | int> 
>  |
> 
> +---------------+---------+
> 
> product_id æ˜¯è¯¥è¡¨å…·æœ‰å”¯ä¸€å€¼çš„åˆ—
> 
> è¯¥è¡¨åŒ…å«äº†æ‰€æœ‰å•†å“çš„ä¿¡æ¯
> 
> 



å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œæ‰¾åˆ°æ¯ä¸€ä¸ªé¡¾å®¢æœ€ç»å¸¸è®¢è´­çš„å•†å“ã€‚

ç»“æœè¡¨å•åº”è¯¥æœ‰æ¯ä¸€ä½è‡³å°‘ä¸‹è¿‡ä¸€æ¬¡å•çš„é¡¾å®¢ `customer_id` , ä»–æœ€ç»å¸¸è®¢è´­çš„å•†å“çš„ `product_id` å’Œ `product_name`ã€‚

è¿”å›ç»“æœ**æ²¡æœ‰é¡ºåºè¦æ±‚** ã€‚

æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š**
> 
> Customersè¡¨ï¼š
> 
> +-------------+-------+
> 
> | customer_id | name  |
> 
> +-------------+-------+
> 
> | 1> 
> > 
>    | Alice |
> 
> | 2> 
> > 
>    | Bob   |
> 
> | 3> 
> > 
>    | Tom   |
> 
> | 4> 
> > 
>    | Jerry |
> 
> | 5> 
> > 
>    | John  |
> 
> +-------------+-------+
> 
> Ordersè¡¨ï¼š
> 
> +----------+------------+-------------+------------+
> 
> | order_id | order_date | customer_id | product_id |
> 
> +----------+------------+-------------+------------+
> 
> | 1> 
> > 
> | 2020-07-31 | 1> 
> > 
>    | 1> 
> > 
>   |
> 
> | 2> 
> > 
> | 2020-07-30 | 2> 
> > 
>    | 2> 
> > 
>   |
> 
> | 3> 
> > 
> | 2020-08-29 | 3> 
> > 
>    | 3> 
> > 
>   |
> 
> | 4> 
> > 
> | 2020-07-29 | 4> 
> > 
>    | 1> 
> > 
>   |
> 
> | 5> 
> > 
> | 2020-06-10 | 1> 
> > 
>    | 2> 
> > 
>   |
> 
> | 6> 
> > 
> | 2020-08-01 | 2> 
> > 
>    | 1> 
> > 
>   |
> 
> | 7> 
> > 
> | 2020-08-01 | 3> 
> > 
>    | 3> 
> > 
>   |
> 
> | 8> 
> > 
> | 2020-08-03 | 1> 
> > 
>    | 2> 
> > 
>   |
> 
> | 9> 
> > 
> | 2020-08-07 | 2> 
> > 
>    | 3> 
> > 
>   |
> 
> | 10> 
>    | 2020-07-15 | 1> 
> > 
>    | 2> 
> > 
>   |
> 
> +----------+------------+-------------+------------+
> 
> Productsè¡¨ï¼š
> 
> +------------+--------------+-------+
> 
> | product_id | product_name | price |
> 
> +------------+--------------+-------+
> 
> | 1> 
> > 
>   | keyboard> 
>  | 120   |
> 
> | 2> 
> > 
>   | mouse> 
> > 
> | 80> 
> |
> 
> | 3> 
> > 
>   | screen> 
>    | 600   |
> 
> | 4> 
> > 
>   | hard disk> 
> | 450   |
> 
> +------------+--------------+-------+
> 
> **è¾“å‡ºï¼š**
> 
> +-------------+------------+--------------+
> 
> | customer_id | product_id | product_name |
> 
> +-------------+------------+--------------+
> 
> | 1> 
> > 
>    | 2> 
> > 
>   | mouse> 
> > 
> |
> 
> | 2> 
> > 
>    | 1> 
> > 
>   | keyboard> 
>  |
> 
> | 2> 
> > 
>    | 2> 
> > 
>   | mouse> 
> > 
> |
> 
> | 2> 
> > 
>    | 3> 
> > 
>   | screen> 
>    |
> 
> | 3> 
> > 
>    | 3> 
> > 
>   | screen> 
>    |
> 
> | 4> 
> > 
>    | 1> 
> > 
>   | keyboard> 
>  |
> 
> +-------------+------------+--------------+
> 
> **è§£é‡Šï¼š**
> 
> Alice (customer 1) ä¸‰æ¬¡è®¢è´­é¼ æ ‡, ä¸€æ¬¡è®¢è´­é”®ç›˜, æ‰€ä»¥é¼ æ ‡æ˜¯ Alice æœ€ç»å¸¸è®¢è´­çš„å•†å“.
> 
> Bob (customer 2) ä¸€æ¬¡è®¢è´­é”®ç›˜, ä¸€æ¬¡è®¢è´­é¼ æ ‡, ä¸€æ¬¡è®¢è´­æ˜¾ç¤ºå™¨, æ‰€ä»¥è¿™äº›éƒ½æ˜¯ Bob æœ€ç»å¸¸è®¢è´­çš„å•†å“.
> 
> Tom (customer 3) åªä¸¤æ¬¡è®¢è´­æ˜¾ç¤ºå™¨, æ‰€ä»¥æ˜¾ç¤ºå™¨æ˜¯ Tom æœ€ç»å¸¸è®¢è´­çš„å•†å“.
> 
> Jerry (customer 4) åªä¸€æ¬¡è®¢è´­é”®ç›˜, æ‰€ä»¥é”®ç›˜æ˜¯ Jerry æœ€ç»å¸¸è®¢è´­çš„å•†å“.
> 
> John (customer 5) æ²¡æœ‰è®¢è´­è¿‡å•†å“, æ‰€ä»¥æˆ‘ä»¬å¹¶æ²¡æœ‰æŠŠ John åŒ…å«åœ¨ç»“æœè¡¨ä¸­.


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 1549 | [æ¯ä»¶å•†å“çš„æœ€æ–°è®¢å• ğŸ”’](https://leetcode.com/problems/the-most-recent-orders-for-each-product) |  |  [`æ•°æ®åº“`](/tag/database.md) | <font color=#ffb800>Medium</font> |