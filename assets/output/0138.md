# [138. éšæœºé“¾è¡¨çš„å¤åˆ¶](https://leetcode.com/problems/copy-list-with-random-pointer)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`å“ˆå¸Œè¡¨`](/leetcode/outline/tag/hash-table.md) [`é“¾è¡¨`](/leetcode/outline/tag/linked-list.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/copy-list-with-random-pointer)


## é¢˜ç›®

A linked list of length `n` is given such that each node contains an
additional random pointer, which could point to any node in the list, or
`null`.

Construct a [**deep
copy**](https://en.wikipedia.org/wiki/Object_copying#Deep_copy) of the list.
The deep copy should consist of exactly `n` **brand new** nodes, where each
new node has its value set to the value of its corresponding original node.
Both the `next` and `random` pointer of the new nodes should point to new
nodes in the copied list such that the pointers in the original list and
copied list represent the same list state. **None of the pointers in the new
list should point to nodes in the original list**.

For example, if there are two nodes `X` and `Y` in the original list, where
`X.random --> Y`, then for the corresponding two nodes `x` and `y` in the
copied list, `x.random --> y`.

Return _the head of the copied linked list_.

The linked list is represented in the input/output as a list of `n` nodes.
Each node is represented as a pair of `[val, random_index]` where:

  * `val`: an integer representing `Node.val`
  * `random_index`: the index of the node (range from `0` to `n-1`) that the `random` pointer points to, or `null` if it does not point to any node.

Your code will **only** be given the `head` of the original linked list.



**Example 1:**

![](https://assets.leetcode.com/uploads/2019/12/18/e1.png)

> Input: head = [[7,null],[13,0],[11,4],[10,2],[1,0]]
> 
> Output: [[7,null],[13,0],[11,4],[10,2],[1,0]]

**Example 2:**

![](https://assets.leetcode.com/uploads/2019/12/18/e2.png)

> Input: head = [[1,1],[2,1]]
> 
> Output: [[1,1],[2,1]]

**Example 3:**

**![](https://assets.leetcode.com/uploads/2019/12/18/e3.png)**

> Input: head = [[3,null],[3,0],[3,null]]
> 
> Output: [[3,null],[3,0],[3,null]]

**Constraints:**

  * `0 <= n <= 1000`
  * `-10^4 <= Node.val <= 10^4`
  * `Node.random` is `null` or is pointing to some node in the linked list.


## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º `n` çš„é“¾è¡¨ï¼Œæ¯ä¸ªèŠ‚ç‚¹åŒ…å«ä¸€ä¸ªé¢å¤–å¢åŠ çš„éšæœºæŒ‡é’ˆ `random` ï¼Œè¯¥æŒ‡é’ˆå¯ä»¥æŒ‡å‘é“¾è¡¨ä¸­çš„ä»»ä½•èŠ‚ç‚¹æˆ–ç©ºèŠ‚ç‚¹ã€‚

æ„é€ è¿™ä¸ªé“¾è¡¨çš„ **[æ·±æ‹·è´](https://baike.baidu.com/item/æ·±æ‹·è´/22785317?fr=aladdin)** ã€‚
æ·±æ‹·è´åº”è¯¥æ­£å¥½ç”± `n` ä¸ª **å…¨æ–°** èŠ‚ç‚¹ç»„æˆï¼Œå…¶ä¸­æ¯ä¸ªæ–°èŠ‚ç‚¹çš„å€¼éƒ½è®¾ä¸ºå…¶å¯¹åº”çš„åŸèŠ‚ç‚¹çš„å€¼ã€‚æ–°èŠ‚ç‚¹çš„ `next` æŒ‡é’ˆå’Œ `random`
æŒ‡é’ˆä¹Ÿéƒ½åº”æŒ‡å‘å¤åˆ¶é“¾è¡¨ä¸­çš„æ–°èŠ‚ç‚¹ï¼Œå¹¶ä½¿åŸé“¾è¡¨å’Œå¤åˆ¶é“¾è¡¨ä¸­çš„è¿™äº›æŒ‡é’ˆèƒ½å¤Ÿè¡¨ç¤ºç›¸åŒçš„é“¾è¡¨çŠ¶æ€ã€‚**å¤åˆ¶é“¾è¡¨ä¸­çš„æŒ‡é’ˆéƒ½ä¸åº”æŒ‡å‘åŸé“¾è¡¨ä¸­çš„èŠ‚ç‚¹** ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœåŸé“¾è¡¨ä¸­æœ‰ `X` å’Œ `Y` ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œå…¶ä¸­ `X.random --> Y` ã€‚é‚£ä¹ˆåœ¨å¤åˆ¶é“¾è¡¨ä¸­å¯¹åº”çš„ä¸¤ä¸ªèŠ‚ç‚¹ `x` å’Œ `y` ï¼ŒåŒæ ·æœ‰
`x.random --> y` ã€‚

è¿”å›å¤åˆ¶é“¾è¡¨çš„å¤´èŠ‚ç‚¹ã€‚

ç”¨ä¸€ä¸ªç”± `n` ä¸ªèŠ‚ç‚¹ç»„æˆçš„é“¾è¡¨æ¥è¡¨ç¤ºè¾“å…¥/è¾“å‡ºä¸­çš„é“¾è¡¨ã€‚æ¯ä¸ªèŠ‚ç‚¹ç”¨ä¸€ä¸ª `[val, random_index]` è¡¨ç¤ºï¼š

  * `val`ï¼šä¸€ä¸ªè¡¨ç¤º `Node.val` çš„æ•´æ•°ã€‚
  * `random_index`ï¼šéšæœºæŒ‡é’ˆæŒ‡å‘çš„èŠ‚ç‚¹ç´¢å¼•ï¼ˆèŒƒå›´ä» `0` åˆ° `n-1`ï¼‰ï¼›å¦‚æœä¸æŒ‡å‘ä»»ä½•èŠ‚ç‚¹ï¼Œåˆ™ä¸º  `null` ã€‚

ä½ çš„ä»£ç  **åª** æ¥å—åŸé“¾è¡¨çš„å¤´èŠ‚ç‚¹ `head` ä½œä¸ºä¼ å…¥å‚æ•°ã€‚



**ç¤ºä¾‹ 1ï¼š**

![](https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2020/01/09/e1.png)

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** head = [[7,null],[13,0],[11,4],[10,2],[1,0]]
> 
> **è¾“å‡ºï¼š**[[7,null],[13,0],[11,4],[10,2],[1,0]]
> 
> 

**ç¤ºä¾‹ 2ï¼š**

![](https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2020/01/09/e2.png)

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** head = [[1,1],[2,1]]
> 
> **è¾“å‡ºï¼š**[[1,1],[2,1]]
> 
> 

**ç¤ºä¾‹ 3ï¼š**

**![](https://assets.leetcode-cn.com/aliyun-lc-
upload/uploads/2020/01/09/e3.png)**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** head = [[3,null],[3,0],[3,null]]
> 
> **è¾“å‡ºï¼š**[[3,null],[3,0],[3,null]]
> 
> 



**æç¤ºï¼š**

  * `0 <= n <= 1000`
  * `-10^4 <= Node.val <= 10^4`
  * `Node.random` ä¸º `null` æˆ–æŒ‡å‘é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ã€‚




## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 133 | [å…‹éš†å›¾](https://leetcode.com/problems/clone-graph) | [[âœ“]](https://2xiao.github.io/leetcode-js/leetcode/problem/0133) |  [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/leetcode/outline/tag/depth-first-search.md) [`å¹¿åº¦ä¼˜å…ˆæœç´¢`](/leetcode/outline/tag/breadth-first-search.md) [`å›¾`](/leetcode/outline/tag/graph.md) `1+` | <font color=#ffb800>Medium</font> |
| 1485 | [å…‹éš†å«éšæœºæŒ‡é’ˆçš„äºŒå‰æ ‘](https://leetcode.com/problems/clone-binary-tree-with-random-pointer) |  |  [`æ ‘`](/leetcode/outline/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/leetcode/outline/tag/depth-first-search.md) [`å¹¿åº¦ä¼˜å…ˆæœç´¢`](/leetcode/outline/tag/breadth-first-search.md) `2+` | <font color=#ffb800>Medium</font> |
| 1490 | [å…‹éš† N å‰æ ‘](https://leetcode.com/problems/clone-n-ary-tree) |  |  [`æ ‘`](/leetcode/outline/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/leetcode/outline/tag/depth-first-search.md) [`å¹¿åº¦ä¼˜å…ˆæœç´¢`](/leetcode/outline/tag/breadth-first-search.md) `1+` | <font color=#ffb800>Medium</font> |

<style>
.blue {
    background-color: #096dd9;
    padding: 0.25rem 0.5rem;
    margin: 0;
    font-size: 0.85em;
    border-radius: 3px;
    color: white;
    font-weight: 500;
}
table th:first-of-type { width: 10%; }
table th:nth-of-type(2) { width: 35%; }
table th:nth-of-type(3) { width: 10%; }
table th:nth-of-type(4) { width: 35%; }
table th:nth-of-type(5) { width: 10%; }
</style>
