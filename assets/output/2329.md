---
title: 2329. 产品销售分析Ⅴ 🔒
description: LeetCode 2329. 产品销售分析Ⅴ 🔒题解，Product Sales Analysis V，包含解题思路、复杂度分析以及完整的 JavaScript 代码实现。
keywords:
  - LeetCode
  - 2329. 产品销售分析Ⅴ 🔒
  - 产品销售分析Ⅴ
  - Product Sales Analysis V
  - 解题思路
  - 数据库
---

# 2329. 产品销售分析Ⅴ 🔒

🟢 <font color=#15bd66>Easy</font>&emsp; 🔖&ensp; [`数据库`](/tag/database.md)&emsp; 🔗&ensp;[`力扣`](https://leetcode.cn/problems/product-sales-analysis-v) [`LeetCode`](https://leetcode.com/problems/product-sales-analysis-v)

## 题目

Table: `Sales`

> 
> 
> 
> 
> 
> +-------------+-------+
> 
> | Column Name | Type  |
> 
> +-------------+-------+
> 
> | sale_id> 
>  | int   |
> 
> | product_id  | int   |
> 
> | user_id> 
>  | int   |
> 
> | quantity> 
> | int   |
> 
> +-------------+-------+
> 
> sale_id contains unique values.
> 
> product_id is a foreign key (column with unique values) to Product table.
> 
> Each row of this table shows the ID of the product and the quantity purchased by a user.
> 
> 



Table: `Product`

> 
> 
> 
> 
> 
> +-------------+------+
> 
> | Column Name | Type |
> 
> +-------------+------+
> 
> | product_id  | int  |
> 
> | price> 
>    | int  |
> 
> +-------------+------+
> 
> product_id contains unique values.
> 
> Each row of this table indicates the price of each product.
> 
> 



Write a solution to report the spending of each user.

Return the resulting table ordered by `spending` in **descending order**. In
case of a tie, order them by `user_id` in ascending order.

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Sales table:
> 
> +---------+------------+---------+----------+
> 
> | sale_id | product_id | user_id | quantity |
> 
> +---------+------------+---------+----------+
> 
> | 1> 
>    | 1> 
> > 
>   | 101> 
>  | 10> 
>    |
> 
> | 2> 
>    | 2> 
> > 
>   | 101> 
>  | 1> 
> > 
> |
> 
> | 3> 
>    | 3> 
> > 
>   | 102> 
>  | 3> 
> > 
> |
> 
> | 4> 
>    | 3> 
> > 
>   | 102> 
>  | 2> 
> > 
> |
> 
> | 5> 
>    | 2> 
> > 
>   | 103> 
>  | 3> 
> > 
> |
> 
> +---------+------------+---------+----------+
> 
> Product table:
> 
> +------------+-------+
> 
> | product_id | price |
> 
> +------------+-------+
> 
> | 1> 
> > 
>   | 10> 
> |
> 
> | 2> 
> > 
>   | 25> 
> |
> 
> | 3> 
> > 
>   | 15> 
> |
> 
> +------------+-------+
> 
> Output: 
> 
> +---------+----------+
> 
> | user_id | spending |
> 
> +---------+----------+
> 
> | 101> 
>  | 125> 
>   |
> 
> | 102> 
>  | 75> 
>    |
> 
> | 103> 
>  | 75> 
>    |
> 
> +---------+----------+
> 
> Explanation: 
> 
> User 101 spent 10 * 10 + 1 * 25 = 125.
> 
> User 102 spent 3 * 15 + 2 * 15 = 75.
> 
> User 103 spent 3 * 25 = 75.
> 
> Users 102 and 103 spent the same amount and we break the tie by their ID while user 101 is on the top.
> 
> 


## 题目大意

表：`Sales`

> 
> 
> 
> 
> 
> +-------------+-------+
> 
> | Column Name | Type  |
> 
> +-------------+-------+
> 
> | sale_id> 
>  | int   |
> 
> | product_id  | int   |
> 
> | user_id> 
>  | int   |
> 
> | quantity> 
> | int   |
> 
> +-------------+-------+
> 
> sale_id 包含唯一值。
> 
> product_id 是 Product 表的外键。
> 
> 这个表中的每一行展示了产品的 ID 以及某个用户购买的数量。 
> 
> 

表：`Product`

> 
> 
> 
> 
> 
> +-------------+------+
> 
> | Column Name | Type |
> 
> +-------------+------+
> 
> | product_id  | int  |
> 
> | price> 
>    | int  |
> 
> +-------------+------+
> 
> product_id 包含唯一值。
> 
> 这张表中的每一行均表示了某个产品的价格。
> 
> 



编写解决方案，获取每个用户的消费额。

按用户消费额 `spending` **递减** 的顺序返回结果。在消费额相等的情况下，以 `user_id` 递增的顺序将其排序。

结果的格式如下面例子所示：



**示例 1 ：**

> 
> 
> 
> 
> 
> **输入：**
> 
> Sales 表：
> 
> +---------+------------+---------+----------+
> 
> | sale_id | product_id | user_id | quantity |
> 
> +---------+------------+---------+----------+
> 
> | 1> 
>    | 1> 
> > 
>   | 101> 
>  | 10> 
>    |
> 
> | 2> 
>    | 2> 
> > 
>   | 101> 
>  | 1> 
> > 
> |
> 
> | 3> 
>    | 3> 
> > 
>   | 102> 
>  | 3> 
> > 
> |
> 
> | 4> 
>    | 3> 
> > 
>   | 102> 
>  | 2> 
> > 
> |
> 
> | 5> 
>    | 2> 
> > 
>   | 103> 
>  | 3> 
> > 
> |
> 
> +---------+------------+---------+----------+
> 
> Product 表：
> 
> +------------+-------+
> 
> | product_id | price |
> 
> +------------+-------+
> 
> | 1> 
> > 
>   | 10> 
> |
> 
> | 2> 
> > 
>   | 25> 
> |
> 
> | 3> 
> > 
>   | 15> 
> |
> 
> +------------+-------+
> 
> **输出：**
> 
> +---------+----------+
> 
> | user_id | spending |
> 
> +---------+----------+
> 
> | 101> 
>  | 125> 
>   |
> 
> | 102> 
>  | 75> 
>    |
> 
> | 103> 
>  | 75> 
>    |
> 
> +---------+----------+
> 
> **解释：**
> 
> 用户 101 的消费额为 10 * 10 + 1 * 25 = 125 。
> 
> 用户 102 的消费额为 3 * 15 + 2 * 15 = 75 。
> 
> 用户 103 的消费额为 3 * 25 = 75 。
> 
> 用户 101 排在最前，用户 102 与用户 103 的消费额相同，根据 ID 我们可以进一步确认排名，所以用户 102 排在 103 前面。
> 
> 


## 解题思路

#### 复杂度分析

- **时间复杂度**：`O()`，
- **空间复杂度**：`O()`，

## 代码

```javascript

```

## 相关题目

<!-- prettier-ignore -->
| 题号 | 标题 | 题解 | 标签 | 难度 | 力扣 |
| :------: | :------ | :------: | :------ | :------: | :------: |
| 1068 | 产品销售分析 I | [[✓]](/problem/1068.md) |  [`数据库`](/tag/database.md) | 🟢 | [🀄️](https://leetcode.cn/problems/product-sales-analysis-i) [🔗](https://leetcode.com/problems/product-sales-analysis-i) |
| 1069 | 产品销售分析 II 🔒 |  |  [`数据库`](/tag/database.md) | 🟢 | [🀄️](https://leetcode.cn/problems/product-sales-analysis-ii) [🔗](https://leetcode.com/problems/product-sales-analysis-ii) |
| 1070 | 产品销售分析 III |  |  [`数据库`](/tag/database.md) | 🟠 | [🀄️](https://leetcode.cn/problems/product-sales-analysis-iii) [🔗](https://leetcode.com/problems/product-sales-analysis-iii) |