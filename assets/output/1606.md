# [1606. æ‰¾åˆ°å¤„ç†æœ€å¤šè¯·æ±‚çš„æœåŠ¡å™¨](https://leetcode.com/problems/find-servers-that-handled-most-number-of-requests)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`è´ªå¿ƒ`](/leetcode/outline/tag/greedy.md) [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`æœ‰åºé›†åˆ`](/leetcode/outline/tag/ordered-set.md) [`å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰`](/leetcode/outline/tag/heap-priority-queue.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/find-servers-that-handled-most-number-of-requests)


## é¢˜ç›®

You have `k` servers numbered from `0` to `k-1` that are being used to handle
multiple requests simultaneously. Each server has infinite computational
capacity but **cannot handle more than one request at a time**. The requests
are assigned to servers according to a specific algorithm:

  * The `ith` (0-indexed) request arrives.
  * If all servers are busy, the request is dropped (not handled at all).
  * If the `(i % k)th` server is available, assign the request to that server.
  * Otherwise, assign the request to the next available server (wrapping around the list of servers and starting from 0 if necessary). For example, if the `ith` server is busy, try to assign the request to the `(i+1)th` server, then the `(i+2)th` server, and so on.

You are given a **strictly increasing** array `arrival` of positive integers,
where `arrival[i]` represents the arrival time of the `ith` request, and
another array `load`, where `load[i]` represents the load of the `ith` request
(the time it takes to complete). Your goal is to find the **busiest
server(s)**. A server is considered **busiest** if it handled the most number
of requests successfully among all the servers.

Return _a list containing the IDs (0-indexed) of the**busiest server(s)**_.
You may return the IDs in any order.



**Example 1:**

![](https://assets.leetcode.com/uploads/2020/09/08/load-1.png)

> Input: k = 3, arrival = [1,2,3,4,5], load = [5,2,3,3,3] 
> 
> Output: [1] 
> 
> Explanation: 
> 
> All of the servers start out available.
> 
> The first 3 requests are handled by the first 3 servers in order.
> 
> Request 3 comes in. Server 0 is busy, so it's assigned to the next available server, which is 1.
> 
> Request 4 comes in. It cannot be handled since all servers are busy, so it is dropped.
> 
> Servers 0 and 2 handled one request each, while server 1 handled two requests. Hence server 1 is the busiest server.

**Example 2:**

> Input: k = 3, arrival = [1,2,3,4], load = [1,2,1,2]
> 
> Output: [0]
> 
> Explanation: 
> 
> The first 3 requests are handled by first 3 servers.
> 
> Request 3 comes in. It is handled by server 0 since the server is available.
> 
> Server 0 handled two requests, while servers 1 and 2 handled one request each. Hence server 0 is the busiest server.

**Example 3:**

> Input: k = 3, arrival = [1,2,3], load = [10,12,11]
> 
> Output: [0,1,2]
> 
> Explanation: Each server handles a single request, so they are all considered the busiest.

**Constraints:**

  * `1 <= k <= 10^5`
  * `1 <= arrival.length, load.length <= 10^5`
  * `arrival.length == load.length`
  * `1 <= arrival[i], load[i] <= 10^9`
  * `arrival` is **strictly increasing**.


## é¢˜ç›®å¤§æ„

ä½ æœ‰ `k` ä¸ªæœåŠ¡å™¨ï¼Œç¼–å·ä¸º `0` åˆ° `k-1` ï¼Œå®ƒä»¬å¯ä»¥åŒæ—¶å¤„ç†å¤šä¸ªè¯·æ±‚ç»„ã€‚æ¯ä¸ªæœåŠ¡å™¨æœ‰æ— ç©·çš„è®¡ç®—èƒ½åŠ›ä½†æ˜¯ **ä¸èƒ½åŒæ—¶å¤„ç†è¶…è¿‡ä¸€ä¸ªè¯·æ±‚**
ã€‚è¯·æ±‚åˆ†é…åˆ°æœåŠ¡å™¨çš„è§„åˆ™å¦‚ä¸‹ï¼š

  * ç¬¬ `i` ï¼ˆåºå·ä» 0 å¼€å§‹ï¼‰ä¸ªè¯·æ±‚åˆ°è¾¾ã€‚
  * å¦‚æœæ‰€æœ‰æœåŠ¡å™¨éƒ½å·²è¢«å æ®ï¼Œé‚£ä¹ˆè¯¥è¯·æ±‚è¢«èˆå¼ƒï¼ˆå®Œå…¨ä¸å¤„ç†ï¼‰ã€‚
  * å¦‚æœç¬¬ `(i % k)` ä¸ªæœåŠ¡å™¨ç©ºé—²ï¼Œé‚£ä¹ˆå¯¹åº”æœåŠ¡å™¨ä¼šå¤„ç†è¯¥è¯·æ±‚ã€‚
  * å¦åˆ™ï¼Œå°†è¯·æ±‚å®‰æ’ç»™ä¸‹ä¸€ä¸ªç©ºé—²çš„æœåŠ¡å™¨ï¼ˆæœåŠ¡å™¨æ„æˆä¸€ä¸ªç¯ï¼Œå¿…è¦çš„è¯å¯èƒ½ä»ç¬¬ 0 ä¸ªæœåŠ¡å™¨å¼€å§‹ç»§ç»­æ‰¾ä¸‹ä¸€ä¸ªç©ºé—²çš„æœåŠ¡å™¨ï¼‰ã€‚æ¯”æ–¹è¯´ï¼Œå¦‚æœç¬¬ `i` ä¸ªæœåŠ¡å™¨åœ¨å¿™ï¼Œé‚£ä¹ˆä¼šæŸ¥çœ‹ç¬¬ `(i+1)` ä¸ªæœåŠ¡å™¨ï¼Œç¬¬ `(i+2)` ä¸ªæœåŠ¡å™¨ç­‰ç­‰ã€‚

ç»™ä½ ä¸€ä¸ª **ä¸¥æ ¼é€’å¢**  çš„æ­£æ•´æ•°æ•°ç»„ `arrival` ï¼Œè¡¨ç¤ºç¬¬ `i` ä¸ªä»»åŠ¡çš„åˆ°è¾¾æ—¶é—´ï¼Œå’Œå¦ä¸€ä¸ªæ•°ç»„ `load` ï¼Œå…¶ä¸­ `load[i]`
è¡¨ç¤ºç¬¬ `i` ä¸ªè¯·æ±‚çš„å·¥ä½œé‡ï¼ˆä¹Ÿå°±æ˜¯æœåŠ¡å™¨å®Œæˆå®ƒæ‰€éœ€è¦çš„æ—¶é—´ï¼‰ã€‚ä½ çš„ä»»åŠ¡æ˜¯æ‰¾åˆ° **æœ€ç¹å¿™çš„æœåŠ¡å™¨**
ã€‚æœ€ç¹å¿™å®šä¹‰ä¸ºä¸€ä¸ªæœåŠ¡å™¨å¤„ç†çš„è¯·æ±‚æ•°æ˜¯æ‰€æœ‰æœåŠ¡å™¨é‡Œæœ€å¤šçš„ã€‚

è¯·ä½ è¿”å›åŒ…å«æ‰€æœ‰ **æœ€ç¹å¿™æœåŠ¡å™¨**  åºå·çš„åˆ—è¡¨ï¼Œä½ å¯ä»¥ä»¥ä»»æ„é¡ºåºè¿”å›è¿™ä¸ªåˆ—è¡¨ã€‚



**ç¤ºä¾‹ 1ï¼š**

![](https://assets.leetcode-cn.com/aliyun-lc-
upload/uploads/2020/10/03/load-1.png)

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** k = 3, arrival = [1,2,3,4,5], load = [5,2,3,3,3] 
> 
> **è¾“å‡ºï¼š**[1] 
> 
> **è§£é‡Šï¼š**
> 
> æ‰€æœ‰æœåŠ¡å™¨ä¸€å¼€å§‹éƒ½æ˜¯ç©ºé—²çš„ã€‚
> 
> å‰ 3 ä¸ªè¯·æ±‚åˆ†åˆ«ç”±å‰ 3 å°æœåŠ¡å™¨ä¾æ¬¡å¤„ç†ã€‚
> 
> è¯·æ±‚ 3 è¿›æ¥çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨ 0 è¢«å æ®ï¼Œæ‰€ä»¥å®ƒè¢«å®‰æ’åˆ°ä¸‹ä¸€å°ç©ºé—²çš„æœåŠ¡å™¨ï¼Œä¹Ÿå°±æ˜¯æœåŠ¡å™¨ 1 ã€‚
> 
> è¯·æ±‚ 4 è¿›æ¥çš„æ—¶å€™ï¼Œç”±äºæ‰€æœ‰æœåŠ¡å™¨éƒ½è¢«å æ®ï¼Œè¯¥è¯·æ±‚è¢«èˆå¼ƒã€‚
> 
> æœåŠ¡å™¨ 0 å’Œ 2 åˆ†åˆ«éƒ½å¤„ç†äº†ä¸€ä¸ªè¯·æ±‚ï¼ŒæœåŠ¡å™¨ 1 å¤„ç†äº†ä¸¤ä¸ªè¯·æ±‚ã€‚æ‰€ä»¥æœåŠ¡å™¨ 1 æ˜¯æœ€å¿™çš„æœåŠ¡å™¨ã€‚
> 
> 

**ç¤ºä¾‹ 2ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** k = 3, arrival = [1,2,3,4], load = [1,2,1,2]
> 
> **è¾“å‡ºï¼š**[0]
> 
> **è§£é‡Šï¼š**
> 
> å‰ 3 ä¸ªè¯·æ±‚åˆ†åˆ«è¢«å‰ 3 ä¸ªæœåŠ¡å™¨å¤„ç†ã€‚
> 
> è¯·æ±‚ 3 è¿›æ¥ï¼Œç”±äºæœåŠ¡å™¨ 0 ç©ºé—²ï¼Œå®ƒè¢«æœåŠ¡å™¨ 0 å¤„ç†ã€‚
> 
> æœåŠ¡å™¨ 0 å¤„ç†äº†ä¸¤ä¸ªè¯·æ±‚ï¼ŒæœåŠ¡å™¨ 1 å’Œ 2 åˆ†åˆ«å¤„ç†äº†ä¸€ä¸ªè¯·æ±‚ã€‚æ‰€ä»¥æœåŠ¡å™¨ 0 æ˜¯æœ€å¿™çš„æœåŠ¡å™¨ã€‚
> 
> 

**ç¤ºä¾‹ 3ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** k = 3, arrival = [1,2,3], load = [10,12,11]
> 
> **è¾“å‡ºï¼š**[0,1,2]
> 
> **è§£é‡Šï¼š** æ¯ä¸ªæœåŠ¡å™¨åˆ†åˆ«å¤„ç†äº†ä¸€ä¸ªè¯·æ±‚ï¼Œæ‰€ä»¥å®ƒä»¬éƒ½æ˜¯æœ€å¿™çš„æœåŠ¡å™¨ã€‚
> 
> 

**ç¤ºä¾‹ 4ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** k = 3, arrival = [1,2,3,4,8,9,10], load = [5,2,10,3,1,2,2]
> 
> **è¾“å‡ºï¼š**[1]
> 
> 

**ç¤ºä¾‹ 5ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** k = 1, arrival = [1], load = [1]
> 
> **è¾“å‡ºï¼š**[0]
> 
> 



**æç¤ºï¼š**

  * `1 <= k <= 10^5`
  * `1 <= arrival.length, load.length <= 10^5`
  * `arrival.length == load.length`
  * `1 <= arrival[i], load[i] <= 10^9`
  * `arrival` ä¿è¯ **ä¸¥æ ¼é€’å¢**  ã€‚


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 2402 | [ä¼šè®®å®¤ III](https://leetcode.com/problems/meeting-rooms-iii) |  |  [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`å“ˆå¸Œè¡¨`](/leetcode/outline/tag/hash-table.md) [`æ’åº`](/leetcode/outline/tag/sorting.md) `2+` | <font color=#ff334b>Hard</font> |

<style>
.blue {
    background-color: #096dd9;
    padding: 0.25rem 0.5rem;
    margin: 0;
    font-size: 0.85em;
    border-radius: 3px;
    color: white;
    font-weight: 500;
}
table th:first-of-type { width: 10%; }
table th:nth-of-type(2) { width: 35%; }
table th:nth-of-type(3) { width: 10%; }
table th:nth-of-type(4) { width: 35%; }
table th:nth-of-type(5) { width: 10%; }
</style>
