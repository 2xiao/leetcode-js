# [1597. æ ¹æ®ä¸­ç¼€è¡¨è¾¾å¼æ„é€ äºŒå‰è¡¨è¾¾å¼æ ‘](https://leetcode.com/problems/build-binary-expression-tree-from-infix-expression)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ ˆ`](/tag/stack.md) [`æ ‘`](/tag/tree.md) [`å­—ç¬¦ä¸²`](/tag/string.md) [`äºŒå‰æ ‘`](/tag/binary-tree.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/build-binary-expression-tree-from-infix-expression)

## é¢˜ç›®

A **[binary expression
tree](https://en.wikipedia.org/wiki/Binary_expression_tree)** is a kind of
binary tree used to represent arithmetic expressions. Each node of a binary
expression tree has either zero or two children. Leaf nodes (nodes with 0
children) correspond to operands (numbers), and internal nodes (nodes with 2
children) correspond to the operators `'+'` (addition), `'-'` (subtraction),
`'*'` (multiplication), and `'/'` (division).

For each internal node with operator `o`, the [**infix
expression**](https://en.wikipedia.org/wiki/Infix_notation) it represents is
`(A o B)`, where `A` is the expression the left subtree represents and `B` is
the expression the right subtree represents.

You are given a string `s`, an **infix expression** containing operands, the
operators described above, and parentheses `'('` and `')'`.

Return _any valid**binary expression tree** , whose **[in-order
traversal](https://en.wikipedia.org/wiki/Tree_traversal#In-order_\(LNR\))**
reproduces _`s` _after omitting the parenthesis from it._

**Please note that order of operations applies in**`s`**.** That is,
expressions in parentheses are evaluated first, and multiplication and
division happen before addition and subtraction.

Operands must also appear in the **same order** in both `s` and the in-order
traversal of the tree.



**Example 1:**

![](https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/1500-1599/1597.Build%20Binary%20Expression%20Tree%20From%20Infix%20Expression/images/ex1-4.png)

> Input: s = "3*4-2*5"
> 
> Output: [-,*,*,3,4,2,5]
> 
> Explanation: The tree above is the only valid tree whose inorder traversal produces s.

**Example 2:**

![](https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/1500-1599/1597.Build%20Binary%20Expression%20Tree%20From%20Infix%20Expression/images/ex1-2.png)

> Input: s = "2-3/(5*2)+1"
> 
> Output: [+,-,1,2,/,null,null,null,null,3,*,null,null,5,2]
> 
> Explanation: The inorder traversal of the tree above is 2-3/5*2+1 which is the same as s without the parenthesis. The tree also produces the correct result and its operands are in the same order as they appear in s.
> 
> The tree below is also a valid binary expression tree with the same inorder traversal as s, but it not a valid answer because it does not evaluate to the same value.
> 
> ![](https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/1500-1599/1597.Build%20Binary%20Expression%20Tree%20From%20Infix%20Expression/images/ex1-1.png)
> 
> The third tree below is also not valid. Although it produces the same result and is equivalent to the above trees, its inorder traversal does not produce s and its operands are not in the same order as s.
> 
> ![](https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/1500-1599/1597.Build%20Binary%20Expression%20Tree%20From%20Infix%20Expression/images/ex1-3.png)

**Example 3:**

> Input: s = "1+2+3+4+5"
> 
> Output: [+,+,5,+,4,null,null,+,3,null,null,1,2]
> 
> Explanation: The tree [+,+,5,+,+,null,null,1,2,3,4] is also one of many other valid trees.

**Constraints:**

  * `1 <= s.length <= 100`
  * `s` consists of digits and the characters `'('`, `')'`, `'+'`, `'-'`, `'*'`, and `'/'`.
  * Operands in `s` are **exactly** 1 digit.
  * It is guaranteed that `s` is a valid expression.


## é¢˜ç›®å¤§æ„

**äºŒå‰è¡¨è¾¾å¼æ ‘** æ˜¯ä¸€ç§è¡¨è¾¾ç®—æœ¯è¡¨è¾¾å¼çš„äºŒå‰æ ‘ã€‚äºŒå‰è¡¨è¾¾å¼æ ‘ä¸­çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½æœ‰é›¶ä¸ªæˆ–ä¸¤ä¸ªå­èŠ‚ç‚¹ã€‚ å¶èŠ‚ç‚¹ï¼ˆæœ‰ 0
ä¸ªå­èŠ‚ç‚¹çš„èŠ‚ç‚¹ï¼‰è¡¨ç¤ºæ“ä½œæ•°ï¼Œéå¶èŠ‚ç‚¹ï¼ˆæœ‰ 2 ä¸ªå­èŠ‚ç‚¹çš„èŠ‚ç‚¹ï¼‰è¡¨ç¤ºè¿ç®—ç¬¦ï¼š `'+'` ï¼ˆåŠ ï¼‰ã€ `'-'` ï¼ˆå‡ï¼‰ã€ `'*'` ï¼ˆä¹˜ï¼‰å’Œ `'/'`
ï¼ˆé™¤ï¼‰ã€‚

å¯¹äºæ¯ä¸€ä¸ªè¿ç®—ç¬¦ä¸º `o`
çš„éå¶èŠ‚ç‚¹ï¼Œå¯¹åº”çš„**[ä¸­ç¼€è¡¨è¾¾å¼](http://baike.baidu.com/item/ä¸­ç¼€è¡¨è¾¾å¼/2725244?fr=aladdin)** ä¸º
`(A o B)`ï¼Œå…¶ä¸­ `A` æ˜¯å·¦å­æ ‘æ‰€è¡¨è¾¾çš„è¡¨è¾¾å¼ï¼Œ `B` æ˜¯å³å­æ ‘æ‰€è¡¨è¾¾çš„è¡¨è¾¾å¼ã€‚

ç»™å®šä¸€ä¸ª**ä¸­ç¼€è¡¨è¾¾å¼** å­—ç¬¦ä¸² `s`ï¼Œå…¶ä¸­åŒ…å«æ“ä½œæ•°ã€ä¸Šé¢æåˆ°çš„è¿ç®—ç¬¦ï¼Œä»¥åŠæ‹¬å· `'('` ä¸ `')'` ã€‚

è¿”å›ä¸€ä¸ªæœ‰æ•ˆçš„**äºŒå‰è¡¨è¾¾å¼æ ‘** ï¼Œå…¶
[**ä¸­åºéå†**](http://baike.baidu.com/item/ä¸­åºéå†/757281?fr=aladdin) åºåˆ—å¯¹åº”è¡¨è¾¾å¼ `s`
æ¶ˆé™¤æ‹¬å·åçš„åºåˆ—ï¼ˆè¯¦æƒ…å‚è§ä¸‹é¢çš„ç¤ºä¾‹ï¼‰ _ã€‚_

**æ³¨æ„ï¼Œè¡¨è¾¾å¼çš„ä¸€èˆ¬è§£æé¡ºåºé€‚ç”¨äº  **`s`ï¼Œå³ä¼˜å…ˆè§£ææ‹¬å·å†…çš„è¡¨è¾¾å¼ï¼Œç„¶åè§£æä¹˜é™¤æ³•ï¼Œæœ€åè§£æåŠ å‡æ³•ã€‚

åŒæ—¶ï¼Œæ“ä½œæ•°åœ¨ `s` å’Œæ ‘çš„ä¸­åºéå†ä¸­ **å‡ºç°é¡ºåºç›¸åŒ** ã€‚



**ç¤ºä¾‹ 1ï¼š**

![](https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/1500-1599/1597.Build%20Binary%20Expression%20Tree%20From%20Infix%20Expression/images/ex1-4.png)

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** s = "3*4-2*5"
> 
> **è¾“å‡ºï¼š**[-,*,*,3,4,2,5]
> 
> **è§£é‡Šï¼š** ä¸Šé¢æ˜¯å”¯ä¸€ä¸€ç§æœ‰æ•ˆçš„äºŒå‰è¡¨è¾¾å¼æ ‘ï¼Œå…¶ä¸­åºéå†ç”Ÿæˆ s ã€‚
> 
> 

**ç¤ºä¾‹ 2ï¼š**

![](https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/1500-1599/1597.Build%20Binary%20Expression%20Tree%20From%20Infix%20Expression/images/ex1-2.png)

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** s = "2-3/(5*2)+1"
> 
> **è¾“å‡ºï¼š**[+,-,1,2,/,null,null,null,null,3,*,null,null,5,2]
> 
> **è§£é‡Šï¼š** ä¸Šé¢çš„æ ‘çš„ä¸­åºéå†ä¸º 2-3/5*2+1 ï¼Œä¸ s æ¶ˆé™¤æ‹¬å·åç›¸åŒã€‚è¯¥æ ‘è¿˜ä¼šç”Ÿæˆæ­£ç¡®çš„ç»“æœï¼Œå…¶æ“ä½œæ•°çš„é¡ºåºä¸ s ä¸­å‡ºç°çš„é¡ºåºç›¸åŒã€‚
> 
> ä¸‹é¢çš„æ ‘ä¹Ÿæ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„äºŒå‰è¡¨è¾¾å¼æ ‘ï¼Œå…·æœ‰ä¸ s ç›¸åŒçš„ä¸­åºéå†ï¼Œä½†å®ƒä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ç­”æ¡ˆï¼Œå› ä¸ºå®ƒçš„æ±‚å€¼ç»“æœä¸åŒã€‚
> 
> ![](https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/1500-1599/1597.Build%20Binary%20Expression%20Tree%20From%20Infix%20Expression/images/ex1-1.png)
> 
> ä¸‹é¢çš„æ ‘ä¹Ÿæ˜¯æ— æ•ˆçš„ã€‚å°½ç®¡å®ƒçš„è®¡ç®—ç»“æœç›¸ç­‰å¹¶ä¸ä¸Šè¿°æ ‘ç­‰æ•ˆï¼Œä½†å…¶ä¸­åºéå†ä¸ä¼šäº§ç”Ÿ s ï¼Œå¹¶ä¸”å…¶æ“ä½œæ•°ä¸ s ä¸­çš„é¡ºåºä¹Ÿä¸ç›¸åŒã€‚
> 
> ![](https://fastly.jsdelivr.net/gh/doocs/leetcode@main/solution/1500-1599/1597.Build%20Binary%20Expression%20Tree%20From%20Infix%20Expression/images/ex1-3.png)
> 
> 

**ç¤ºä¾‹ 3ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** s = "1+2+3+4+5"
> 
> **è¾“å‡ºï¼š**[+,+,5,+,4,null,null,+,3,null,null,1,2]
> 
> **è§£é‡Šï¼š** äºŒå‰æ ‘ [+,+,5,+,+,null,null,1,2,3,4] ä¹Ÿæ˜¯è¯¸å¤šæœ‰æ•ˆçš„äºŒå‰è¡¨è¾¾å¼æ ‘ä¹‹ä¸€ã€‚



**æç¤º:**

  * `1 <= s.length <= 100`
  * `s` ä¸­åŒ…å«æ•°å­—å’Œå­—ç¬¦ `'('`ã€ `')'`ã€`'+'`ã€ `'-'`ã€ `'*'`ã€ `'/'` ã€‚
  * `s` ä¸­çš„æ“ä½œæ•° **æ°å¥½** æ˜¯ä¸€ä½æ•°å­—ã€‚
  * é¢˜ç›®æ•°æ®ä¿è¯ `s` æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„è¡¨è¾¾å¼ã€‚


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 772 | [åŸºæœ¬è®¡ç®—å™¨ III](https://leetcode.com/problems/basic-calculator-iii) | [[âœ“]](/problem/0772.md) |  [`æ ˆ`](/tag/stack.md) [`é€’å½’`](/tag/recursion.md) [`æ•°å­¦`](/tag/math.md) `1+` | <font color=#ff334b>Hard</font> |
| 1612 | [æ£€æŸ¥ä¸¤æ£µäºŒå‰è¡¨è¾¾å¼æ ‘æ˜¯å¦ç­‰ä»·](https://leetcode.com/problems/check-if-two-expression-trees-are-equivalent) |  |  [`æ ‘`](/tag/tree.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/tag/depth-first-search.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) `2+` | <font color=#ffb800>Medium</font> |