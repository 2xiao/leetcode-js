# [2983. å›æ–‡ä¸²é‡æ–°æ’åˆ—æŸ¥è¯¢](https://leetcode.com/problems/palindrome-rearrangement-queries)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) [`å­—ç¬¦ä¸²`](/tag/string.md) [`å‰ç¼€å’Œ`](/tag/prefix-sum.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/palindrome-rearrangement-queries)

## é¢˜ç›®

You are given a **0-indexed** string `s` having an **even** length `n`.

You are also given a **0-indexed** 2D integer array, `queries`, where
`queries[i] = [ai, bi, ci, di]`.

For each query `i`, you are allowed to perform the following operations:

  * Rearrange the characters within the **substring** `s[ai:bi]`, where `0 <= ai <= bi < n / 2`.
  * Rearrange the characters within the **substring** `s[ci:di]`, where `n / 2 <= ci <= di < n`.

For each query, your task is to determine whether it is possible to make `s` a
**palindrome** by performing the operations.

Each query is answered **independently** of the others.

Return _a**0-indexed** array _`answer` _, where_`answer[i] == true` _if it is
possible to make_`s` _a palindrome by performing operations specified by
the_`ith` _query, and_`false` _otherwise._

  * A **substring** is a contiguous sequence of characters within a string.
  * `s[x:y]` represents the substring consisting of characters from the index `x` to index `y` in `s`, **both inclusive**.



**Example 1:**

> Input: s = "abcabc", queries = [[1,1,3,5],[0,2,5,5]]
> 
> Output: [true,true]
> 
> Explanation: In this example, there are two queries:
> 
> In the first query:
> - a0 = 1, b0 = 1, c0 = 3, d0 = 5.
> - So, you are allowed to rearrange s[1:1] => a _b_ cabc and s[3:5] => abc _abc_.
> - To make s a palindrome, s[3:5] can be rearranged to become => abc _cba_.
> - Now, s is a palindrome. So, answer[0] = true.
> 
> In the second query:
> - a1 = 0, b1 = 2, c1 = 5, d1 = 5.
> - So, you are allowed to rearrange s[0:2] => _abc_ abc and s[5:5] => abcab _c_.
> - To make s a palindrome, s[0:2] can be rearranged to become => _cba_ abc.
> - Now, s is a palindrome. So, answer[1] = true.

**Example 2:**

> Input: s = "abbcdecbba", queries = [[0,2,7,9]]
> 
> Output: [false]
> 
> Explanation: In this example, there is only one query.
> 
> a0 = 0, b0 = 2, c0 = 7, d0 = 9.
> 
> So, you are allowed to rearrange s[0:2] => _abb_ cdecbba and s[7:9] => abbcdec _bba_.
> 
> It is not possible to make s a palindrome by rearranging these substrings because s[3:6] is not a palindrome.
> 
> So, answer[0] = false.

**Example 3:**

> Input: s = "acbcab", queries = [[1,2,4,5]]
> 
> Output: [true]
> 
> Explanation: In this example, there is only one query.
> 
> a0 = 1, b0 = 2, c0 = 4, d0 = 5.
> 
> So, you are allowed to rearrange s[1:2] => a _cb_ cab and s[4:5] => acbc _ab_.
> 
> To make s a palindrome s[1:2] can be rearranged to become a _bc_ cab.
> 
> Then, s[4:5] can be rearranged to become abcc _ba_.
> 
> Now, s is a palindrome. So, answer[0] = true.



**Constraints:**

  * `2 <= n == s.length <= 10^5`
  * `1 <= queries.length <= 10^5`
  * `queries[i].length == 4`
  * `ai == queries[i][0], bi == queries[i][1]`
  * `ci == queries[i][2], di == queries[i][3]`
  * `0 <= ai <= bi < n / 2`
  * `n / 2 <= ci <= di < n `
  * `n` is even.
  * `s` consists of only lowercase English letters.


## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º **å¶æ•°**  `n` ï¼Œä¸‹æ ‡ä» **0**  å¼€å§‹çš„å­—ç¬¦ä¸² `s` ã€‚

åŒæ—¶ç»™ä½ ä¸€ä¸ªä¸‹æ ‡ä» **0**  å¼€å§‹çš„äºŒç»´æ•´æ•°æ•°ç»„ `queries` ï¼Œå…¶ä¸­ `queries[i] = [ai, bi, ci, di]` ã€‚

å¯¹äºæ¯ä¸ªæŸ¥è¯¢ `i` ï¼Œä½ éœ€è¦æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

  * å°†ä¸‹æ ‡åœ¨èŒƒå›´ `0 <= ai <= bi < n / 2` å†…çš„ **å­å­—ç¬¦ä¸²**  `s[ai:bi]` ä¸­çš„å­—ç¬¦é‡æ–°æ’åˆ—ã€‚
  * å°†ä¸‹æ ‡åœ¨èŒƒå›´ `n / 2 <= ci <= di < n` å†…çš„ **å­å­—ç¬¦ä¸²**  `s[ci:di]` ä¸­çš„å­—ç¬¦é‡æ–°æ’åˆ—ã€‚

å¯¹äºæ¯ä¸ªæŸ¥è¯¢ï¼Œä½ çš„ä»»åŠ¡æ˜¯åˆ¤æ–­æ‰§è¡Œæ“ä½œåèƒ½å¦è®© `s` å˜æˆä¸€ä¸ª **å›æ–‡ä¸²** ã€‚

æ¯ä¸ªæŸ¥è¯¢ä¸å…¶ä»–æŸ¥è¯¢éƒ½æ˜¯ **ç‹¬ç«‹çš„**  ã€‚

è¯·ä½ è¿”å›ä¸€ä¸ªä¸‹æ ‡ä» **0**  å¼€å§‹çš„æ•°ç»„ _ _`answer` ï¼Œå¦‚æœç¬¬ `i` ä¸ªæŸ¥è¯¢æ‰§è¡Œæ“ä½œåï¼Œå¯ä»¥å°† `s` å˜ä¸ºä¸€ä¸ªå›æ–‡ä¸²ï¼Œé‚£ä¹ˆ _
_`answer[i] = true`ï¼Œå¦åˆ™ä¸º _ _`false` ã€‚

  * **å­å­—ç¬¦ä¸²**  æŒ‡çš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ä¸€æ®µè¿ç»­çš„å­—ç¬¦åºåˆ—ã€‚
  * `s[x:y]` è¡¨ç¤º `s` ä¸­ä»ä¸‹æ ‡ `x` åˆ° `y` ä¸”ä¸¤ä¸ªç«¯ç‚¹ **éƒ½åŒ…å«**  çš„å­å­—ç¬¦ä¸²ã€‚



**ç¤ºä¾‹ 1ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** s = "abcabc", queries = [[1,1,3,5],[0,2,5,5]]
> 
> **è¾“å‡ºï¼š**[true,true]
> 
> **è§£é‡Šï¼š** è¿™ä¸ªä¾‹å­ä¸­ï¼Œæœ‰ 2 ä¸ªæŸ¥è¯¢ï¼š
> 
> ç¬¬ä¸€ä¸ªæŸ¥è¯¢ï¼š
> - a0 = 1, b0 = 1, c0 = 3, d0 = 5
> - ä½ å¯ä»¥é‡æ–°æ’åˆ— s[1:1] => a _**b**_ cabc å’Œ s[3:5] => abc _**abc**_  ã€‚
> - ä¸ºäº†è®© s å˜ä¸ºå›æ–‡ä¸²ï¼Œs[3:5] å¯ä»¥é‡æ–°æ’åˆ—å¾—åˆ° => abc** _cba_** ã€‚
> - ç°åœ¨ s æ˜¯ä¸€ä¸ªå›æ–‡ä¸²ã€‚æ‰€ä»¥ answer[0] = true ã€‚
> 
> ç¬¬äºŒä¸ªæŸ¥è¯¢ï¼š
> - a1 = 0, b1 = 2, c1 = 5, d1 = 5.
> - ä½ å¯ä»¥é‡æ–°æ’åˆ— s[0:2] => _**abc**_ abc å’Œ s[5:5] => abcab** _c_**  ã€‚
> - ä¸ºäº†è®© s å˜ä¸ºå›æ–‡ä¸²ï¼Œs[0:2] å¯ä»¥é‡æ–°æ’åˆ—å¾—åˆ° => _**cba**_ abc ã€‚
> - ç°åœ¨ s æ˜¯ä¸€ä¸ªå›æ–‡ä¸²ï¼Œæ‰€ä»¥ answer[1] = true ã€‚
> 
> 

**ç¤ºä¾‹ 2ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** s = "abbcdecbba", queries = [[0,2,7,9]]
> 
> **è¾“å‡ºï¼š**[false]
> 
> **è§£é‡Šï¼š** è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œåªæœ‰ä¸€ä¸ªæŸ¥è¯¢ã€‚
> 
> a0 = 0, b0 = 2, c0 = 7, d0 = 9.
> 
> ä½ å¯ä»¥é‡æ–°æ’åˆ— s[0:2] => _**abb**_ cdecbba å’Œ s[7:9] => abbcdec _**bba**_  ã€‚
> 
> æ— æ³•é€šè¿‡é‡æ–°æ’åˆ—è¿™äº›å­å­—ç¬¦ä¸²ä½¿ s å˜ä¸ºä¸€ä¸ªå›æ–‡ä¸²ï¼Œå› ä¸º s[3:6] ä¸æ˜¯ä¸€ä¸ªå›æ–‡ä¸²ã€‚
> 
> æ‰€ä»¥ answer[0] = false ã€‚

**ç¤ºä¾‹ 3ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** s = "acbcab", queries = [[1,2,4,5]]
> 
> **è¾“å‡ºï¼š**[true]
> 
> **è§£é‡Šï¼š** è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œåªæœ‰ä¸€ä¸ªæŸ¥è¯¢ã€‚
> 
> a0 = 1, b0 = 2, c0 = 4, d0 = 5.
> 
> ä½ å¯ä»¥é‡æ–°æ’åˆ— s[1:2] => a _**cb**_ cab å’Œ s[4:5] => acbc** _ab_**  ã€‚
> 
> ä¸ºäº†è®© s å˜ä¸ºå›æ–‡ä¸²ï¼Œs[1:2] å¯ä»¥é‡æ–°æ’åˆ—å¾—åˆ° => a _**bc**_ cab ã€‚
> 
> ç„¶å s[4:5] é‡æ–°æ’åˆ—å¾—åˆ° abcc _**ba**_  ã€‚
> 
> ç°åœ¨ s æ˜¯ä¸€ä¸ªå›æ–‡ä¸²ï¼Œæ‰€ä»¥ answer[0] = true ã€‚



**æç¤ºï¼š**

  * `2 <= n == s.length <= 10^5`
  * `1 <= queries.length <= 10^5`
  * `queries[i].length == 4`
  * `ai == queries[i][0], bi == queries[i][1]`
  * `ci == queries[i][2], di == queries[i][3]`
  * `0 <= ai <= bi < n / 2`
  * `n / 2 <= ci <= di < n `
  * `n` æ˜¯ä¸€ä¸ªå¶æ•°ã€‚
  * `s` åªåŒ…å«å°å†™è‹±æ–‡å­—æ¯ã€‚


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 1147 | [æ®µå¼å›æ–‡](https://leetcode.com/problems/longest-chunked-palindrome-decomposition) |  |  [`è´ªå¿ƒ`](/tag/greedy.md) [`åŒæŒ‡é’ˆ`](/tag/two-pointers.md) [`å­—ç¬¦ä¸²`](/tag/string.md) `3+` | <font color=#ff334b>Hard</font> |

<style>
.blue {
    background-color: #096dd9;
    padding: 0.25rem 0.5rem;
    margin: 0;
    font-size: 0.85em;
    border-radius: 3px;
    color: white;
    font-weight: 500;
}
table th:first-of-type { width: 10%; }
table th:nth-of-type(2) { width: 35%; }
table th:nth-of-type(3) { width: 10%; }
table th:nth-of-type(4) { width: 35%; }
table th:nth-of-type(5) { width: 10%; }
</style>
