# [1715. è‹¹æœå’Œæ©˜å­çš„ä¸ªæ•°](https://leetcode.com/problems/count-apples-and-oranges)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/count-apples-and-oranges)

## é¢˜ç›®

Table: `Boxes`

> 
> 
> 
> 
> 
> +--------------+------+
> 
> | Column Name  | Type |
> 
> +--------------+------+
> 
> | box_id> 
>    | int  |
> 
> | chest_id> 
>  | int  |
> 
> | apple_count  | int  |
> 
> | orange_count | int  |
> 
> +--------------+------+
> 
> box_id is the column with unique values for this table.
> 
> chest_id is a foreign key (reference column) of the chests table.
> 
> This table contains information about the boxes and the number of oranges and apples they have. Each box may include a chest, which also can contain oranges and apples.
> 
> 



Table: `Chests`

> 
> 
> 
> 
> 
> +--------------+------+
> 
> | Column Name  | Type |
> 
> +--------------+------+
> 
> | chest_id> 
>  | int  |
> 
> | apple_count  | int  |
> 
> | orange_count | int  |
> 
> +--------------+------+
> 
> chest_id is the column with unique values for this table.
> 
> This table contains information about the chests and the corresponding number of oranges and apples they have.
> 
> 



Write a solution to count the number of apples and oranges in all the boxes.
If a box contains a chest, you should also include the number of apples and
oranges it has.

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Boxes table:
> 
> +--------+----------+-------------+--------------+
> 
> | box_id | chest_id | apple_count | orange_count |
> 
> +--------+----------+-------------+--------------+
> 
> | 2> 
>   | null> 
>  | 6> 
> > 
>    | 15> 
> > 
>    |
> 
> | 18> 
>  | 14> 
>    | 4> 
> > 
>    | 15> 
> > 
>    |
> 
> | 19> 
>  | 3> 
> > 
> | 8> 
> > 
>    | 4> 
> > 
> > 
> |
> 
> | 12> 
>  | 2> 
> > 
> | 19> 
> > 
>   | 20> 
> > 
>    |
> 
> | 20> 
>  | 6> 
> > 
> | 12> 
> > 
>   | 9> 
> > 
> > 
> |
> 
> | 8> 
>   | 6> 
> > 
> | 9> 
> > 
>    | 9> 
> > 
> > 
> |
> 
> | 3> 
>   | 14> 
>    | 16> 
> > 
>   | 7> 
> > 
> > 
> |
> 
> +--------+----------+-------------+--------------+
> 
> Chests table:
> 
> +----------+-------------+--------------+
> 
> | chest_id | apple_count | orange_count |
> 
> +----------+-------------+--------------+
> 
> | 6> 
> > 
> | 5> 
> > 
>    | 6> 
> > 
> > 
> |
> 
> | 14> 
>    | 20> 
> > 
>   | 10> 
> > 
>    |
> 
> | 2> 
> > 
> | 8> 
> > 
>    | 8> 
> > 
> > 
> |
> 
> | 3> 
> > 
> | 19> 
> > 
>   | 4> 
> > 
> > 
> |
> 
> | 16> 
>    | 19> 
> > 
>   | 19> 
> > 
>    |
> 
> +----------+-------------+--------------+
> 
> Output: 
> 
> +-------------+--------------+
> 
> | apple_count | orange_count |
> 
> +-------------+--------------+
> 
> | 151> 
> > 
>  | 123> 
> > 
>   |
> 
> +-------------+--------------+
> 
> Explanation: 
> 
> box 2 has 6 apples and 15 oranges.
> 
> box 18 has 4 + 20 (from the chest) = 24 apples and 15 + 10 (from the chest) = 25 oranges.
> 
> box 19 has 8 + 19 (from the chest) = 27 apples and 4 + 4 (from the chest) = 8 oranges.
> 
> box 12 has 19 + 8 (from the chest) = 27 apples and 20 + 8 (from the chest) = 28 oranges.
> 
> box 20 has 12 + 5 (from the chest) = 17 apples and 9 + 6 (from the chest) = 15 oranges.
> 
> box 8 has 9 + 5 (from the chest) = 14 apples and 9 + 6 (from the chest) = 15 oranges.
> 
> box 3 has 16 + 20 (from the chest) = 36 apples and 7 + 10 (from the chest) = 17 oranges.
> 
> Total number of apples = 6 + 24 + 27 + 27 + 17 + 14 + 36 = 151
> 
> Total number of oranges = 15 + 25 + 8 + 28 + 15 + 15 + 17 = 123
> 
> 


## é¢˜ç›®å¤§æ„

è¡¨ï¼š `Boxes`

> 
> 
> 
> 
> 
> +--------------+------+
> 
> | Column Name  | Type |
> 
> +--------------+------+
> 
> | box_id> 
>    | int  |
> 
> | chest_id> 
>  | int  |
> 
> | apple_count  | int  |
> 
> | orange_count | int  |
> 
> +--------------+------+
> 
> box_id æ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚
> 
> chest_id æ˜¯ chests è¡¨çš„å¤–é”®ã€‚
> 
> è¯¥è¡¨åŒ…å«å¤§ç®±å­ (box) ä¸­åŒ…å«çš„è‹¹æœå’Œæ©˜å­çš„ä¸ªæ•°ã€‚æ¯ä¸ªå¤§ç®±å­ä¸­å¯èƒ½åŒ…å«ä¸€ä¸ªå°ç›’å­ (chest) ï¼Œå°ç›’å­ä¸­ä¹ŸåŒ…å«è‹¥å¹²è‹¹æœå’Œæ©˜å­ã€‚



è¡¨ï¼š `Chests`

> 
> 
> 
> 
> 
> +--------------+------+
> 
> | Column Name  | Type |
> 
> +--------------+------+
> 
> | chest_id> 
>  | int  |
> 
> | apple_count  | int  |
> 
> | orange_count | int  |
> 
> +--------------+------+
> 
> chest_id æ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚
> 
> è¯¥è¡¨åŒ…å«å°ç›’å­çš„ä¿¡æ¯ï¼Œä»¥åŠå°ç›’å­ä¸­åŒ…å«çš„è‹¹æœå’Œæ©˜å­çš„ä¸ªæ•°ã€‚



ç¼–å†™ SQL è¯­å¥ï¼ŒæŸ¥è¯¢æ¯ä¸ªå¤§ç®±å­ä¸­è‹¹æœå’Œæ©˜å­çš„ä¸ªæ•°ã€‚å¦‚æœå¤§ç®±å­ä¸­åŒ…å«å°ç›’å­ï¼Œè¿˜åº”å½“åŒ…å«å°ç›’å­ä¸­è‹¹æœå’Œæ©˜å­çš„ä¸ªæ•°ã€‚

ä»¥ä»»æ„é¡ºåºè¿”å›ç»“æœè¡¨ã€‚

æŸ¥è¯¢ç»“æœçš„æ ¼å¼å¦‚ä¸‹ç¤ºä¾‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1:**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š**
> 
> Boxes è¡¨ï¼š
> 
> +--------+----------+-------------+--------------+
> 
> | box_id | chest_id | apple_count | orange_count |
> 
> +--------+----------+-------------+--------------+
> 
> | 2> 
>   | null> 
>  | 6> 
> > 
>    | 15> 
> > 
>    |
> 
> | 18> 
>  | 14> 
>    | 4> 
> > 
>    | 15> 
> > 
>    |
> 
> | 19> 
>  | 3> 
> > 
> | 8> 
> > 
>    | 4> 
> > 
> > 
> |
> 
> | 12> 
>  | 2> 
> > 
> | 19> 
> > 
>   | 20> 
> > 
>    |
> 
> | 20> 
>  | 6> 
> > 
> | 12> 
> > 
>   | 9> 
> > 
> > 
> |
> 
> | 8> 
>   | 6> 
> > 
> | 9> 
> > 
>    | 9> 
> > 
> > 
> |
> 
> | 3> 
>   | 14> 
>    | 16> 
> > 
>   | 7> 
> > 
> > 
> |
> 
> +--------+----------+-------------+--------------+
> 
> Chests è¡¨ï¼š
> 
> +----------+-------------+--------------+
> 
> | chest_id | apple_count | orange_count |
> 
> +----------+-------------+--------------+
> 
> | 6> 
> > 
> | 5> 
> > 
>    | 6> 
> > 
> > 
> |
> 
> | 14> 
>    | 20> 
> > 
>   | 10> 
> > 
>    |
> 
> | 2> 
> > 
> | 8> 
> > 
>    | 8> 
> > 
> > 
> |
> 
> | 3> 
> > 
> | 19> 
> > 
>   | 4> 
> > 
> > 
> |
> 
> | 16> 
>    | 19> 
> > 
>   | 19> 
> > 
>    |
> 
> +----------+-------------+--------------+
> 
> **è¾“å‡ºï¼š**
> 
> +-------------+--------------+
> 
> | apple_count | orange_count |
> 
> +-------------+--------------+
> 
> | 151> 
> > 
>  | 123> 
> > 
>   |
> 
> +-------------+--------------+
> 
> **è§£é‡Šï¼š**
> 
> å¤§ç®±å­ 2 ä¸­æœ‰ 6 ä¸ªè‹¹æœå’Œ 15 ä¸ªæ©˜å­ã€‚
> 
> å¤§ç®±å­ 18 ä¸­æœ‰ 4 + 20 (åœ¨å°ç›’å­ä¸­) = 24 ä¸ªè‹¹æœå’Œ 15 + 10 (åœ¨å°ç›’å­ä¸­) = 25 ä¸ªæ©˜å­ã€‚
> 
> å¤§ç®±å­ 19 ä¸­æœ‰ 8 + 19 (åœ¨å°ç›’å­ä¸­) = 27 ä¸ªè‹¹æœå’Œ 4 + 4 (åœ¨å°ç›’å­ä¸­) = 8 ä¸ªæ©˜å­ã€‚
> 
> å¤§ç®±å­ 12 ä¸­æœ‰ 19 + 8 (åœ¨å°ç›’å­ä¸­) = 27 ä¸ªè‹¹æœå’Œ 20 + 8 (åœ¨å°ç›’å­ä¸­) = 28 ä¸ªæ©˜å­ã€‚
> 
> å¤§ç®±å­ 20 ä¸­æœ‰ 12 + 5 (åœ¨å°ç›’å­ä¸­) = 17 ä¸ªè‹¹æœå’Œ 9 + 6 (åœ¨å°ç›’å­ä¸­) = 15 ä¸ªæ©˜å­ã€‚
> 
> å¤§ç®±å­ 8 ä¸­æœ‰ 9 + 5 (åœ¨å°ç›’å­ä¸­) = 14 ä¸ªè‹¹æœå’Œ 9 + 6 (åœ¨å°ç›’å­ä¸­) = 15 ä¸ªæ©˜å­ã€‚
> 
> å¤§ç®±å­ 3 ä¸­æœ‰ 16 + 20 (åœ¨å°ç›’å­ä¸­) = 36 ä¸ªè‹¹æœå’Œ 7 + 10 (åœ¨å°ç›’å­ä¸­) = 17 ä¸ªæ©˜å­ã€‚
> 
> è‹¹æœçš„æ€»ä¸ªæ•° = 6 + 24 + 27 + 27 + 17 + 14 + 36 = 151
> 
> æ©˜å­çš„æ€»ä¸ªæ•° = 15 + 25 + 8 + 28 + 15 + 15 + 17 = 123


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```