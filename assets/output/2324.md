---
title: 2324. 产品销售分析 IV 🔒
description: LeetCode 2324. 产品销售分析 IV 🔒题解，Product Sales Analysis IV，包含解题思路、复杂度分析以及完整的 JavaScript 代码实现。
keywords:
  - LeetCode
  - 2324. 产品销售分析 IV 🔒
  - 产品销售分析 IV
  - Product Sales Analysis IV
  - 解题思路
  - 数据库
---

# 2324. 产品销售分析 IV 🔒

🟠 <font color=#ffb800>Medium</font>&emsp; 🔖&ensp; [`数据库`](/tag/database.md)&emsp; 🔗&ensp;[`力扣`](https://leetcode.cn/problems/product-sales-analysis-iv) [`LeetCode`](https://leetcode.com/problems/product-sales-analysis-iv)

## 题目

Table: `Sales`

> 
> 
> 
> 
> 
> +-------------+-------+
> 
> | Column Name | Type  |
> 
> +-------------+-------+
> 
> | sale_id> 
>  | int   |
> 
> | product_id  | int   |
> 
> | user_id> 
>  | int   |
> 
> | quantity> 
> | int   |
> 
> +-------------+-------+
> 
> sale_id contains unique values.
> 
> product_id is a foreign key (reference column) to Product table.
> 
> Each row of this table shows the ID of the product and the quantity purchased by a user.
> 
> 



Table: `Product`

> 
> 
> 
> 
> 
> +-------------+------+
> 
> | Column Name | Type |
> 
> +-------------+------+
> 
> | product_id  | int  |
> 
> | price> 
>    | int  |
> 
> +-------------+------+
> 
> product_id contains unique values.
> 
> Each row of this table indicates the price of each product.
> 
> 



Write a solution that reports for each user the product id on which the user
spent the most money. In case the same user spent the most money on two or
more products, report all of them.

Return the resulting table in **any order**.

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Sales table:
> 
> +---------+------------+---------+----------+
> 
> | sale_id | product_id | user_id | quantity |
> 
> +---------+------------+---------+----------+
> 
> | 1> 
>    | 1> 
> > 
>   | 101> 
>  | 10> 
>    |
> 
> | 2> 
>    | 3> 
> > 
>   | 101> 
>  | 7> 
> > 
> |
> 
> | 3> 
>    | 1> 
> > 
>   | 102> 
>  | 9> 
> > 
> |
> 
> | 4> 
>    | 2> 
> > 
>   | 102> 
>  | 6> 
> > 
> |
> 
> | 5> 
>    | 3> 
> > 
>   | 102> 
>  | 10> 
>    |
> 
> | 6> 
>    | 1> 
> > 
>   | 102> 
>  | 6> 
> > 
> |
> 
> +---------+------------+---------+----------+
> 
> Product table:
> 
> +------------+-------+
> 
> | product_id | price |
> 
> +------------+-------+
> 
> | 1> 
> > 
>   | 10> 
> |
> 
> | 2> 
> > 
>   | 25> 
> |
> 
> | 3> 
> > 
>   | 15> 
> |
> 
> +------------+-------+
> 
> Output: 
> 
> +---------+------------+
> 
> | user_id | product_id |
> 
> +---------+------------+
> 
> | 101> 
>  | 3> 
> > 
>   |
> 
> | 102> 
>  | 1> 
> > 
>   |
> 
> | 102> 
>  | 2> 
> > 
>   |
> 
> | 102> 
>  | 3> 
> > 
>   |
> 
> +---------+------------+ 
> 
> Explanation: 
> 
> User 101:
> 
> > - Spent 10 * 10 = 100 on product 1.
> 
> > - Spent 7 * 15 = 105 on product 3.
> 
> User 101 spent the most money on product 3.
> 
> User 102:
> 
> > - Spent (9 + 6) * 10 = 150 on product 1.
> 
> > - Spent 6 * 25 = 150 on product 2.
> 
> > - Spent 10 * 15 = 150 on product 3.
> 
> User 102 spent the most money on products 1, 2, and 3.
> 
> 


## 题目大意

表: `Sales`

> 
> 
> 
> 
> 
> +-------------+-------+
> 
> | Column Name | Type  |
> 
> +-------------+-------+
> 
> | sale_id> 
>  | int   |
> 
> | product_id  | int   |
> 
> | user_id> 
>  | int   |
> 
> | quantity> 
> | int   |
> 
> +-------------+-------+
> 
> sale_id 包含唯一值。
> 
> product_id 是 product 表的外键。
> 
> 该表的每一行都显示了产品的 ID 和用户购买的数量。
> 
> 



表: `Product`

> 
> 
> 
> 
> 
> +-------------+------+
> 
> | Column Name | Type |
> 
> +-------------+------+
> 
> | product_id  | int  |
> 
> | price> 
>    | int  |
> 
> +-------------+------+
> 
> product_id 包含唯一值。
> 
> 该表的每一行都表示每种产品的价格。
> 
> 



编写解决方案，为每个用户获取其消费最多的产品 id。如果同一用户在两个或多个产品上花费了最多的钱，请获取所有花费了最多的钱的产品。

以 **任意顺序** 返回结果表。

查询结果格式如下所示。



**示例 1:**

> 
> 
> 
> 
> 
> **输入:** 
> 
> Sales 表:
> 
> +---------+------------+---------+----------+
> 
> | sale_id | product_id | user_id | quantity |
> 
> +---------+------------+---------+----------+
> 
> | 1> 
>    | 1> 
> > 
>   | 101> 
>  | 10> 
>    |
> 
> | 2> 
>    | 3> 
> > 
>   | 101> 
>  | 7> 
> > 
> |
> 
> | 3> 
>    | 1> 
> > 
>   | 102> 
>  | 9> 
> > 
> |
> 
> | 4> 
>    | 2> 
> > 
>   | 102> 
>  | 6> 
> > 
> |
> 
> | 5> 
>    | 3> 
> > 
>   | 102> 
>  | 10> 
>    |
> 
> | 6> 
>    | 1> 
> > 
>   | 102> 
>  | 6> 
> > 
> |
> 
> +---------+------------+---------+----------+
> 
> Product 表:
> 
> +------------+-------+
> 
> | product_id | price |
> 
> +------------+-------+
> 
> | 1> 
> > 
>   | 10> 
> |
> 
> | 2> 
> > 
>   | 25> 
> |
> 
> | 3> 
> > 
>   | 15> 
> |
> 
> +------------+-------+
> 
> **输出:** 
> 
> +---------+------------+
> 
> | user_id | product_id |
> 
> +---------+------------+
> 
> | 101> 
>  | 3> 
> > 
>   |
> 
> | 102> 
>  | 1> 
> > 
>   |
> 
> | 102> 
>  | 2> 
> > 
>   |
> 
> | 102> 
>  | 3> 
> > 
>   |
> 
> +---------+------------+ 
> 
> **解释:** 
> 
> 用户 101:
> 
> > - 在产品 1 上花费 10 * 10 = 100。
> 
> > - 在产品 3 上花费 7 * 15 = 105。
> 
> 用户101在产品3上花的钱最多。
> 
> 用户 102:
> 
> > - 在产品 1 上花费 (9 + 6)* 10 = 150
> 
> > - 在产品 2 上花费 6 * 25 = 150
> 
> > - 在产品 3 上花费 10 * 15 = 150。
> 
> 用户 102 在产品 1、2、3 上花的钱最多。
> 
> 


## 解题思路

#### 复杂度分析

- **时间复杂度**：`O()`，
- **空间复杂度**：`O()`，

## 代码

```javascript

```

## 相关题目

<!-- prettier-ignore -->
| 题号 | 标题 | 题解 | 标签 | 难度 | 力扣 |
| :------: | :------ | :------: | :------ | :------: | :------: |
| 1068 | 产品销售分析 I | [[✓]](/problem/1068.md) |  [`数据库`](/tag/database.md) | 🟢 | [🀄️](https://leetcode.cn/problems/product-sales-analysis-i) [🔗](https://leetcode.com/problems/product-sales-analysis-i) |
| 1069 | 产品销售分析 II 🔒 |  |  [`数据库`](/tag/database.md) | 🟢 | [🀄️](https://leetcode.cn/problems/product-sales-analysis-ii) [🔗](https://leetcode.com/problems/product-sales-analysis-ii) |
| 1070 | 产品销售分析 III |  |  [`数据库`](/tag/database.md) | 🟠 | [🀄️](https://leetcode.cn/problems/product-sales-analysis-iii) [🔗](https://leetcode.com/problems/product-sales-analysis-iii) |