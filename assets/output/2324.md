---
title: 2324. äº§å“é”€å”®åˆ†æ IV ğŸ”’
description: LeetCode,2324. äº§å“é”€å”®åˆ†æ IV ğŸ”’,äº§å“é”€å”®åˆ†æ IV,Product Sales Analysis IV,è§£é¢˜æ€è·¯,æ•°æ®åº“
keywords:
  - LeetCode
  - 2324. äº§å“é”€å”®åˆ†æ IV ğŸ”’
  - äº§å“é”€å”®åˆ†æ IV
  - Product Sales Analysis IV
  - è§£é¢˜æ€è·¯
  - æ•°æ®åº“
---

# 2324. äº§å“é”€å”®åˆ†æ IV ğŸ”’

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/product-sales-analysis-iv) [`LeetCode`](https://leetcode.com/problems/product-sales-analysis-iv)

## é¢˜ç›®

Table: `Sales`

> 
> 
> 
> 
> 
> +-------------+-------+
> 
> | Column Name | Type  |
> 
> +-------------+-------+
> 
> | sale_id> 
>  | int   |
> 
> | product_id  | int   |
> 
> | user_id> 
>  | int   |
> 
> | quantity> 
> | int   |
> 
> +-------------+-------+
> 
> sale_id contains unique values.
> 
> product_id is a foreign key (reference column) to Product table.
> 
> Each row of this table shows the ID of the product and the quantity purchased by a user.
> 
> 



Table: `Product`

> 
> 
> 
> 
> 
> +-------------+------+
> 
> | Column Name | Type |
> 
> +-------------+------+
> 
> | product_id  | int  |
> 
> | price> 
>    | int  |
> 
> +-------------+------+
> 
> product_id contains unique values.
> 
> Each row of this table indicates the price of each product.
> 
> 



Write a solution that reports for each user the product id on which the user
spent the most money. In case the same user spent the most money on two or
more products, report all of them.

Return the resulting table in **any order**.

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Sales table:
> 
> +---------+------------+---------+----------+
> 
> | sale_id | product_id | user_id | quantity |
> 
> +---------+------------+---------+----------+
> 
> | 1> 
>    | 1> 
> > 
>   | 101> 
>  | 10> 
>    |
> 
> | 2> 
>    | 3> 
> > 
>   | 101> 
>  | 7> 
> > 
> |
> 
> | 3> 
>    | 1> 
> > 
>   | 102> 
>  | 9> 
> > 
> |
> 
> | 4> 
>    | 2> 
> > 
>   | 102> 
>  | 6> 
> > 
> |
> 
> | 5> 
>    | 3> 
> > 
>   | 102> 
>  | 10> 
>    |
> 
> | 6> 
>    | 1> 
> > 
>   | 102> 
>  | 6> 
> > 
> |
> 
> +---------+------------+---------+----------+
> 
> Product table:
> 
> +------------+-------+
> 
> | product_id | price |
> 
> +------------+-------+
> 
> | 1> 
> > 
>   | 10> 
> |
> 
> | 2> 
> > 
>   | 25> 
> |
> 
> | 3> 
> > 
>   | 15> 
> |
> 
> +------------+-------+
> 
> Output: 
> 
> +---------+------------+
> 
> | user_id | product_id |
> 
> +---------+------------+
> 
> | 101> 
>  | 3> 
> > 
>   |
> 
> | 102> 
>  | 1> 
> > 
>   |
> 
> | 102> 
>  | 2> 
> > 
>   |
> 
> | 102> 
>  | 3> 
> > 
>   |
> 
> +---------+------------+ 
> 
> Explanation: 
> 
> User 101:
> 
> > - Spent 10 * 10 = 100 on product 1.
> 
> > - Spent 7 * 15 = 105 on product 3.
> 
> User 101 spent the most money on product 3.
> 
> User 102:
> 
> > - Spent (9 + 6) * 10 = 150 on product 1.
> 
> > - Spent 6 * 25 = 150 on product 2.
> 
> > - Spent 10 * 15 = 150 on product 3.
> 
> User 102 spent the most money on products 1, 2, and 3.
> 
> 


## é¢˜ç›®å¤§æ„

è¡¨: `Sales`

> 
> 
> 
> 
> 
> +-------------+-------+
> 
> | Column Name | Type  |
> 
> +-------------+-------+
> 
> | sale_id> 
>  | int   |
> 
> | product_id  | int   |
> 
> | user_id> 
>  | int   |
> 
> | quantity> 
> | int   |
> 
> +-------------+-------+
> 
> sale_id åŒ…å«å”¯ä¸€å€¼ã€‚
> 
> product_id æ˜¯ product è¡¨çš„å¤–é”®ã€‚
> 
> è¯¥è¡¨çš„æ¯ä¸€è¡Œéƒ½æ˜¾ç¤ºäº†äº§å“çš„ ID å’Œç”¨æˆ·è´­ä¹°çš„æ•°é‡ã€‚
> 
> 



è¡¨: `Product`

> 
> 
> 
> 
> 
> +-------------+------+
> 
> | Column Name | Type |
> 
> +-------------+------+
> 
> | product_id  | int  |
> 
> | price> 
>    | int  |
> 
> +-------------+------+
> 
> product_id åŒ…å«å”¯ä¸€å€¼ã€‚
> 
> è¯¥è¡¨çš„æ¯ä¸€è¡Œéƒ½è¡¨ç¤ºæ¯ç§äº§å“çš„ä»·æ ¼ã€‚
> 
> 



ç¼–å†™è§£å†³æ–¹æ¡ˆï¼Œä¸ºæ¯ä¸ªç”¨æˆ·è·å–å…¶æ¶ˆè´¹æœ€å¤šçš„äº§å“ idã€‚å¦‚æœåŒä¸€ç”¨æˆ·åœ¨ä¸¤ä¸ªæˆ–å¤šä¸ªäº§å“ä¸ŠèŠ±è´¹äº†æœ€å¤šçš„é’±ï¼Œè¯·è·å–æ‰€æœ‰èŠ±è´¹äº†æœ€å¤šçš„é’±çš„äº§å“ã€‚

ä»¥ **ä»»æ„é¡ºåº** è¿”å›ç»“æœè¡¨ã€‚

æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1:**

> 
> 
> 
> 
> 
> **è¾“å…¥:** 
> 
> Sales è¡¨:
> 
> +---------+------------+---------+----------+
> 
> | sale_id | product_id | user_id | quantity |
> 
> +---------+------------+---------+----------+
> 
> | 1> 
>    | 1> 
> > 
>   | 101> 
>  | 10> 
>    |
> 
> | 2> 
>    | 3> 
> > 
>   | 101> 
>  | 7> 
> > 
> |
> 
> | 3> 
>    | 1> 
> > 
>   | 102> 
>  | 9> 
> > 
> |
> 
> | 4> 
>    | 2> 
> > 
>   | 102> 
>  | 6> 
> > 
> |
> 
> | 5> 
>    | 3> 
> > 
>   | 102> 
>  | 10> 
>    |
> 
> | 6> 
>    | 1> 
> > 
>   | 102> 
>  | 6> 
> > 
> |
> 
> +---------+------------+---------+----------+
> 
> Product è¡¨:
> 
> +------------+-------+
> 
> | product_id | price |
> 
> +------------+-------+
> 
> | 1> 
> > 
>   | 10> 
> |
> 
> | 2> 
> > 
>   | 25> 
> |
> 
> | 3> 
> > 
>   | 15> 
> |
> 
> +------------+-------+
> 
> **è¾“å‡º:** 
> 
> +---------+------------+
> 
> | user_id | product_id |
> 
> +---------+------------+
> 
> | 101> 
>  | 3> 
> > 
>   |
> 
> | 102> 
>  | 1> 
> > 
>   |
> 
> | 102> 
>  | 2> 
> > 
>   |
> 
> | 102> 
>  | 3> 
> > 
>   |
> 
> +---------+------------+ 
> 
> **è§£é‡Š:** 
> 
> ç”¨æˆ· 101:
> 
> > - åœ¨äº§å“ 1 ä¸ŠèŠ±è´¹ 10 * 10 = 100ã€‚
> 
> > - åœ¨äº§å“ 3 ä¸ŠèŠ±è´¹ 7 * 15 = 105ã€‚
> 
> ç”¨æˆ·101åœ¨äº§å“3ä¸ŠèŠ±çš„é’±æœ€å¤šã€‚
> 
> ç”¨æˆ· 102:
> 
> > - åœ¨äº§å“ 1 ä¸ŠèŠ±è´¹ (9 + 6)* 10 = 150
> 
> > - åœ¨äº§å“ 2 ä¸ŠèŠ±è´¹ 6 * 25 = 150
> 
> > - åœ¨äº§å“ 3 ä¸ŠèŠ±è´¹ 10 * 15 = 150ã€‚
> 
> ç”¨æˆ· 102 åœ¨äº§å“ 1ã€2ã€3 ä¸ŠèŠ±çš„é’±æœ€å¤šã€‚
> 
> 


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ | åŠ›æ‰£ |
| :------: | :------ | :------: | :------ | :------: | :------: |
| 1068 | äº§å“é”€å”®åˆ†æ I |  |  [`æ•°æ®åº“`](/tag/database.md) | ğŸŸ¢ | [ğŸ€„ï¸](https://leetcode.cn/problems/product-sales-analysis-i) [ğŸ”—](https://leetcode.com/problems/product-sales-analysis-i) |
| 1069 | äº§å“é”€å”®åˆ†æ II ğŸ”’ |  |  [`æ•°æ®åº“`](/tag/database.md) | ğŸŸ¢ | [ğŸ€„ï¸](https://leetcode.cn/problems/product-sales-analysis-ii) [ğŸ”—](https://leetcode.com/problems/product-sales-analysis-ii) |
| 1070 | äº§å“é”€å”®åˆ†æ III |  |  [`æ•°æ®åº“`](/tag/database.md) | ğŸŸ  | [ğŸ€„ï¸](https://leetcode.cn/problems/product-sales-analysis-iii) [ğŸ”—](https://leetcode.com/problems/product-sales-analysis-iii) |