# [3057. å‘˜å·¥é¡¹ç›®åˆ†é…](https://leetcode.com/problems/employees-project-allocation)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`æ•°æ®åº“`](/tag/database.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/employees-project-allocation)

## é¢˜ç›®

Table: `Project`

> 
> 
> 
> 
> 
> +-------------+---------+
> 
> | Column Name | Type> 
> |
> 
> +-------------+---------+
> 
> | project_id  | int> 
>  |
> 
> | employee_id | int> 
>  |
> 
> | workload> 
> | int> 
>  |
> 
> +-------------+---------+
> 
> employee_id is the primary key (column with unique values) of this table.
> 
> employee_id is a foreign key (reference column) to Employee table.
> 
> Each row of this table indicates that the employee with employee_id is working on the project with project_id and the workload of the project.
> 
> 

Table: `Employees`

> 
> 
> 
> 
> 
> +------------------+---------+
> 
> | Column Name> 
>   | Type> 
> |
> 
> +------------------+---------+
> 
> | employee_id> 
>   | int> 
>  |
> 
> | name> 
> > 
> > 
>  | varchar |
> 
> | team> 
> > 
> > 
>  | varchar |
> 
> +------------------+---------+
> 
> employee_id is the primary key (column with unique values) of this table.
> 
> Each row of this table contains information about one employee.
> 
> 

Write a solution to find the **employees** who are allocated to projects with
a **workload that exceeds the average** workload of all employees for **their
respective teams**

Return t _he result table ordered by_ `employee_id`, `project_id`
_in**ascending** order._

The result format is in the following example.



**Example 1:**

> Input: 
> 
> Project table:
> 
> +-------------+-------------+----------+
> 
> | project_id  | employee_id | workload |
> 
> +-------------+-------------+----------+
> 
> | 1> 
> > 
>    | 1> 
> > 
>    |  45> 
>   |
> 
> | 1> 
> > 
>    | 2> 
> > 
>    |  90> 
>   | 
> 
> | 2> 
> > 
>    | 3> 
> > 
>    |  12> 
>   |
> 
> | 2> 
> > 
>    | 4> 
> > 
>    |  68> 
>   |
> 
> +-------------+-------------+----------+
> 
> Employees table:
> 
> +-------------+--------+------+
> 
> | employee_id | name   | team |
> 
> +-------------+--------+------+
> 
> | 1> 
> > 
>    | Khaled | A> 
> |
> 
> | 2> 
> > 
>    | Ali> 
> | B> 
> |
> 
> | 3> 
> > 
>    | John   | B> 
> |
> 
> | 4> 
> > 
>    | Doe> 
> | A> 
> |
> 
> +-------------+--------+------+
> 
> Output: 
> 
> +-------------+------------+---------------+------------------+
> 
> | employee_id | project_id | employee_name | project_workload |
> 
> +-------------+------------+---------------+------------------+  
> 
> | 2> 
> > 
>    | 1> 
> > 
>   | Ali> 
> > 
>    | 90> 
> > 
> > 
>    | 
> 
> | 4> 
> > 
>    | 2> 
> > 
>   | Doe> 
> > 
>    | 68> 
> > 
> > 
>    | 
> 
> +-------------+------------+---------------+------------------+
> 
> Explanation: 
> - Employee with ID 1 has a project workload of 45 and belongs to Team A, where the average workload is 56.50. Since his project workload does not exceed the team's average workload, he will be excluded.
> - Employee with ID 2 has a project workload of 90 and belongs to Team B, where the average workload is 51.00. Since his project workload does exceed the team's average workload, he will be included.
> - Employee with ID 3 has a project workload of 12 and belongs to Team B, where the average workload is 51.00. Since his project workload does not exceed the team's average workload, he will be excluded.
> - Employee with ID 4 has a project workload of 68 and belongs to Team A, where the average workload is 56.50. Since his project workload does exceed the team's average workload, he will be included.
> 
> Result table orderd by employee_id, project_id in ascending order.
> 
> 


## é¢˜ç›®å¤§æ„

è¡¨ï¼š`Project`

> 
> 
> 
> 
> 
> +-------------+---------+
> 
> | Column Name | Type> 
> |
> 
> +-------------+---------+
> 
> | project_id  | int> 
>  |
> 
> | employee_id | int> 
>  |
> 
> | workload> 
> | int> 
>  |
> 
> +-------------+---------+
> 
> employee_id æ˜¯è¿™å¼ è¡¨çš„ä¸»é”®ï¼ˆæœ‰ä¸åŒå€¼çš„åˆ—ï¼‰ã€‚
> 
> employee_id æ˜¯ Employee è¡¨çš„å¤–é”®ï¼ˆå¼•ç”¨åˆ—ï¼‰ã€‚
> 
> è¿™å¼ è¡¨çš„æ¯ä¸€è¡Œè¡¨ç¤º employee_id æ‰€æŒ‡çš„å‘˜å·¥æ­£åœ¨ project_id æ‰€æŒ‡çš„é¡¹ç›®ä¸Šå·¥ä½œï¼Œä»¥åŠé¡¹ç›®çš„å·¥ä½œé‡ã€‚
> 
> 

è¡¨ï¼š`Employees`

> 
> 
> 
> 
> 
> +------------------+---------+
> 
> | Column Name> 
>   | Type> 
> |
> 
> +------------------+---------+
> 
> | employee_id> 
>   | int> 
>  |
> 
> | name> 
> > 
> > 
>  | varchar |
> 
> | team> 
> > 
> > 
>  | varchar |
> 
> +------------------+---------+
> 
> employee_id æ˜¯è¿™å¼ è¡¨çš„ä¸»é”®ï¼ˆæœ‰ä¸åŒå€¼çš„åˆ—ï¼‰ã€‚
> 
> è¿™å¼ è¡¨çš„æ¯ä¸€è¡ŒåŒ…å«ä¸€ä¸ªå‘˜å·¥çš„ä¿¡æ¯ã€‚
> 
> 

ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œæ‰¾å‡ºåˆ†é…ç»™é¡¹ç›®çš„å·¥ä½œé‡ **è¶…è¿‡å„è‡ªå›¢é˜Ÿ** æ‰€æœ‰å‘˜å·¥ **å¹³å‡å·¥ä½œé‡** çš„ **å‘˜å·¥** ã€‚

è¿”å›ç»“æœè¡¨ï¼Œä»¥ `employee_id`ï¼Œ`project_id` **å‡åº** æ’åºã€‚

ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚



**ç¤ºä¾‹ 1ï¼š**

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** 
> 
> Project è¡¨ï¼š
> 
> +-------------+-------------+----------+
> 
> | project_id  | employee_id | workload |
> 
> +-------------+-------------+----------+
> 
> | 1> 
> > 
>    | 1> 
> > 
>    |  45> 
>   |
> 
> | 1> 
> > 
>    | 2> 
> > 
>    |  90> 
>   | 
> 
> | 2> 
> > 
>    | 3> 
> > 
>    |  12> 
>   |
> 
> | 2> 
> > 
>    | 4> 
> > 
>    |  68> 
>   |
> 
> +-------------+-------------+----------+
> 
> Employees è¡¨ï¼š
> 
> +-------------+--------+------+
> 
> | employee_id | name   | team |
> 
> +-------------+--------+------+
> 
> | 1> 
> > 
>    | Khaled | A> 
> |
> 
> | 2> 
> > 
>    | Ali> 
> | B> 
> |
> 
> | 3> 
> > 
>    | John   | B> 
> |
> 
> | 4> 
> > 
>    | Doe> 
> | A> 
> |
> 
> +-------------+--------+------+
> 
> **è¾“å‡ºï¼š** 
> 
> +-------------+------------+---------------+------------------+
> 
> | employee_id | project_id | employee_name | project_workload |
> 
> +-------------+------------+---------------+------------------+  
> 
> | 2> 
> > 
>    | 1> 
> > 
>   | Ali> 
> > 
>    | 90> 
> > 
> > 
>    | 
> 
> | 4> 
> > 
>    | 2> 
> > 
>   | Doe> 
> > 
>    | 68> 
> > 
> > 
>    | 
> 
> +-------------+------------+---------------+------------------+
> 
> **è§£é‡Šï¼š** 
> - ID ä¸º 1 çš„å‘˜å·¥é¡¹ç›®å·¥ä½œé‡ä¸º 45 å¹¶å±äº Team Aï¼Œå…¶ä¸­å¹³å‡å·¥ä½œé‡ä¸º 56.50ã€‚å› ä¸ºè¿™ä¸ªé¡¹ç›®å·¥ä½œé‡æ²¡æœ‰è¶…è¿‡å°ç»„çš„å¹³å‡å·¥ä½œé‡ï¼Œä»–å°†è¢«æ’é™¤ã€‚
> - ID ä¸º 2 çš„å‘˜å·¥é¡¹ç›®å·¥ä½œé‡ä¸º 90 å¹¶å±äº Team Bï¼Œå…¶ä¸­å¹³å‡å·¥ä½œé‡ä¸º 51.00ã€‚å› ä¸ºè¿™ä¸ªé¡¹ç›®å·¥ä½œé‡è¶…è¿‡å°ç»„çš„å¹³å‡å·¥ä½œé‡ï¼Œä»–å°†åŒ…å«åœ¨ç»“æœä¸­ã€‚
> - ID ä¸º 3 çš„å‘˜å·¥é¡¹ç›®å·¥ä½œé‡ä¸º 12 å¹¶å±äº Team Bï¼Œå…¶ä¸­å¹³å‡å·¥ä½œé‡ä¸º 51.00ã€‚å› ä¸ºè¿™ä¸ªé¡¹ç›®å·¥ä½œé‡æ²¡æœ‰è¶…è¿‡å°ç»„çš„å¹³å‡å·¥ä½œé‡ï¼Œä»–å°†è¢«æ’é™¤ã€‚
> - ID ä¸º 4 çš„å‘˜å·¥é¡¹ç›®å·¥ä½œé‡ä¸º 68 å¹¶å±äº Team Aï¼Œå…¶ä¸­å¹³å‡å·¥ä½œé‡ä¸º 56.50ã€‚å› ä¸ºè¿™ä¸ªé¡¹ç›®å·¥ä½œé‡è¶…è¿‡å°ç»„çš„å¹³å‡å·¥ä½œé‡ï¼Œä»–å°†åŒ…å«åœ¨ç»“æœä¸­ã€‚
> 
> ç»“æœè¡¨ä»¥ employee_idï¼Œproject_id å‡åºæ’åºã€‚
> 
> 


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```