# [1938. æŸ¥è¯¢æœ€å¤§åŸºå› å·®](https://leetcode.com/problems/maximum-genetic-difference-query)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`ä½è¿ç®—`](/leetcode/outline/tag/bit-manipulation.md) [`æ·±åº¦ä¼˜å…ˆæœç´¢`](/leetcode/outline/tag/depth-first-search.md) [`å­—å…¸æ ‘`](/leetcode/outline/tag/trie.md) [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`å“ˆå¸Œè¡¨`](/leetcode/outline/tag/hash-table.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/maximum-genetic-difference-query)


## é¢˜ç›®

There is a rooted tree consisting of `n` nodes numbered `0` to `n - 1`. Each
node's number denotes its **unique genetic value** (i.e. the genetic value of
node `x` is `x`). The **genetic difference** between two genetic values is
defined as the **bitwise-****XOR** of their values. You are given the integer
array `parents`, where `parents[i]` is the parent for node `i`. If node `x` is
the **root** of the tree, then `parents[x] == -1`.

You are also given the array `queries` where `queries[i] = [nodei, vali]`. For
each query `i`, find the **maximum genetic difference** between `vali` and
`pi`, where `pi` is the genetic value of any node that is on the path between
`nodei` and the root (including `nodei` and the root). More formally, you want
to maximize `vali XOR pi`.

Return _an array_`ans` _where_`ans[i]`_is the answer to the_`ith` _query_.



**Example 1:**

![](https://assets.leetcode.com/uploads/2021/06/29/c1.png)

> Input: parents = [-1,0,1,1], queries = [[0,2],[3,2],[2,5]]
> 
> Output: [2,3,7]
> 
> Explanation: The queries are processed as follows:
> - [0,2]: The node with the maximum genetic difference is 0, with a difference of 2 XOR 0 = 2.
> - [3,2]: The node with the maximum genetic difference is 1, with a difference of 2 XOR 1 = 3.
> - [2,5]: The node with the maximum genetic difference is 2, with a difference of 5 XOR 2 = 7.

**Example 2:**

![](https://assets.leetcode.com/uploads/2021/06/29/c2.png)

> Input: parents = [3,7,-1,2,0,7,0,2], queries = [[4,6],[1,15],[0,5]]
> 
> Output: [6,14,7]
> 
> Explanation: The queries are processed as follows:
> - [4,6]: The node with the maximum genetic difference is 0, with a difference of 6 XOR 0 = 6.
> - [1,15]: The node with the maximum genetic difference is 1, with a difference of 15 XOR 1 = 14.
> - [0,5]: The node with the maximum genetic difference is 2, with a difference of 5 XOR 2 = 7.

**Constraints:**

  * `2 <= parents.length <= 10^5`
  * `0 <= parents[i] <= parents.length - 1` for every node `i` that is **not** the root.
  * `parents[root] == -1`
  * `1 <= queries.length <= 3 * 10^4`
  * `0 <= nodei <= parents.length - 1`
  * `0 <= vali <= 2 * 10^5`


## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€æ£µ `n` ä¸ªèŠ‚ç‚¹çš„æœ‰æ ¹æ ‘ï¼ŒèŠ‚ç‚¹ç¼–å·ä» `0` åˆ° `n - 1` ã€‚æ¯ä¸ªèŠ‚ç‚¹çš„ç¼–å·è¡¨ç¤ºè¿™ä¸ªèŠ‚ç‚¹çš„ **ç‹¬ä¸€æ— äºŒçš„åŸºå› å€¼** ï¼ˆä¹Ÿå°±æ˜¯è¯´èŠ‚ç‚¹ `x`
çš„åŸºå› å€¼ä¸º `x`ï¼‰ã€‚ä¸¤ä¸ªåŸºå› å€¼çš„ **åŸºå› å·®** æ˜¯ä¸¤è€…çš„ **å¼‚æˆ–å’Œ** ã€‚ç»™ä½ æ•´æ•°æ•°ç»„ `parents` ï¼Œå…¶ä¸­ `parents[i]` æ˜¯èŠ‚ç‚¹
`i` çš„çˆ¶èŠ‚ç‚¹ã€‚å¦‚æœèŠ‚ç‚¹ `x` æ˜¯æ ‘çš„ **æ ¹** ï¼Œé‚£ä¹ˆ `parents[x] == -1` ã€‚

ç»™ä½ æŸ¥è¯¢æ•°ç»„ `queries` ï¼Œå…¶ä¸­ `queries[i] = [nodei, vali]` ã€‚å¯¹äºæŸ¥è¯¢ `i` ï¼Œè¯·ä½ æ‰¾åˆ° `vali` å’Œ
`pi` çš„ **æœ€å¤§åŸºå› å·®** ï¼Œå…¶ä¸­ `pi` æ˜¯èŠ‚ç‚¹ `nodei` åˆ°æ ¹ä¹‹é—´çš„ä»»æ„èŠ‚ç‚¹ï¼ˆåŒ…å« `nodei` å’Œæ ¹èŠ‚ç‚¹ï¼‰ã€‚æ›´æ­£å¼çš„ï¼Œä½ æƒ³è¦æœ€å¤§åŒ–
`vali XOR pi` ã€‚

è¯·ä½ è¿”å›æ•°ç»„ __`ans` ï¼Œå…¶ä¸­ `ans[i]` æ˜¯ç¬¬ `i` ä¸ªæŸ¥è¯¢çš„ç­”æ¡ˆã€‚

**ç¤ºä¾‹ 1ï¼š**

![](https://assets.leetcode.com/uploads/2021/06/29/c1.png)

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** parents = [-1,0,1,1], queries = [[0,2],[3,2],[2,5]]
> 
> **è¾“å‡ºï¼š**[2,3,7]
> 
> **è§£é‡Šï¼š** æŸ¥è¯¢æ•°ç»„å¤„ç†å¦‚ä¸‹ï¼š
> - [0,2]ï¼šæœ€å¤§åŸºå› å·®çš„å¯¹åº”èŠ‚ç‚¹ä¸º 0 ï¼ŒåŸºå› å·®ä¸º 2 XOR 0 = 2 ã€‚
> - [3,2]ï¼šæœ€å¤§åŸºå› å·®çš„å¯¹åº”èŠ‚ç‚¹ä¸º 1 ï¼ŒåŸºå› å·®ä¸º 2 XOR 1 = 3 ã€‚
> - [2,5]ï¼šæœ€å¤§åŸºå› å·®çš„å¯¹åº”èŠ‚ç‚¹ä¸º 2 ï¼ŒåŸºå› å·®ä¸º 5 XOR 2 = 7 ã€‚
> 
> 

**ç¤ºä¾‹ 2ï¼š**

![](https://assets.leetcode.com/uploads/2021/06/29/c2.png)

> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** parents = [3,7,-1,2,0,7,0,2], queries = [[4,6],[1,15],[0,5]]
> 
> **è¾“å‡ºï¼š**[6,14,7]
> 
> **è§£é‡Šï¼š** æŸ¥è¯¢æ•°ç»„å¤„ç†å¦‚ä¸‹ï¼š
> - [4,6]ï¼šæœ€å¤§åŸºå› å·®çš„å¯¹åº”èŠ‚ç‚¹ä¸º 0 ï¼ŒåŸºå› å·®ä¸º 6 XOR 0 = 6 ã€‚
> - [1,15]ï¼šæœ€å¤§åŸºå› å·®çš„å¯¹åº”èŠ‚ç‚¹ä¸º 1 ï¼ŒåŸºå› å·®ä¸º 15 XOR 1 = 14 ã€‚
> - [0,5]ï¼šæœ€å¤§åŸºå› å·®çš„å¯¹åº”èŠ‚ç‚¹ä¸º 2 ï¼ŒåŸºå› å·®ä¸º 5 XOR 2 = 7 ã€‚
> 
> 

**æç¤ºï¼š**

  * `2 <= parents.length <= 10^5`
  * å¯¹äºæ¯ä¸ª **ä¸æ˜¯** æ ¹èŠ‚ç‚¹çš„ `i` ï¼Œæœ‰ `0 <= parents[i] <= parents.length - 1` ã€‚
  * `parents[root] == -1`
  * `1 <= queries.length <= 3 * 10^4`
  * `0 <= nodei <= parents.length - 1`
  * `0 <= vali <= 2 * 10^5`


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 1707 | [ä¸æ•°ç»„ä¸­å…ƒç´ çš„æœ€å¤§å¼‚æˆ–å€¼](https://leetcode.com/problems/maximum-xor-with-an-element-from-array) |  |  [`ä½è¿ç®—`](/leetcode/outline/tag/bit-manipulation.md) [`å­—å…¸æ ‘`](/leetcode/outline/tag/trie.md) [`æ•°ç»„`](/leetcode/outline/tag/array.md) | <font color=#ff334b>Hard</font> |

<style>
.blue {
    background-color: #096dd9;
    padding: 0.25rem 0.5rem;
    margin: 0;
    font-size: 0.85em;
    border-radius: 3px;
    color: white;
    font-weight: 500;
}
table th:first-of-type { width: 10%; }
table th:nth-of-type(2) { width: 35%; }
table th:nth-of-type(3) { width: 10%; }
table th:nth-of-type(4) { width: 35%; }
table th:nth-of-type(5) { width: 10%; }
</style>
