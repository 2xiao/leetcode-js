# [2836. åœ¨ä¼ çƒæ¸¸æˆä¸­æœ€å¤§åŒ–å‡½æ•°å€¼](https://leetcode.com/problems/maximize-value-of-function-in-a-ball-passing-game)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`ä½è¿ç®—`](/leetcode/outline/tag/bit-manipulation.md) [`æ•°ç»„`](/leetcode/outline/tag/array.md) [`åŠ¨æ€è§„åˆ’`](/leetcode/outline/tag/dynamic-programming.md)&emsp; ğŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/maximize-value-of-function-in-a-ball-passing-game)


## é¢˜ç›®

You are given an integer array `receiver` of length `n` and an integer `k`.
`n` players are playing a ball-passing game.

You choose the starting player, `i`. The game proceeds as follows: player `i`
passes the ball to player `receiver[i]`, who then passes it to
`receiver[receiver[i]]`, and so on, for `k` passes in total. The game's score
is the sum of the indices of the players who touched the ball, including
repetitions, i.e. `i + receiver[i] + receiver[receiver[i]] + ... +
receiver(k)[i]`.

Return the **maximum**  possible score.

**Notes:**

  * `receiver` may contain duplicates.
  * `receiver[i]` may be equal to `i`.



**Example 1:**

**Input:** receiver = [2,0,1], k = 4

**Output:** 6

**Explanation:**

Starting with player `i = 2` the initial score is 2:

Pass | Sender Index | Receiver Index | Score  
---|---|---|---  
1 | 2 | 1 | 3  
2 | 1 | 0 | 3  
3 | 0 | 2 | 5  
4 | 2 | 1 | 6  
  
**Example 2:**

**Input:** receiver = [1,1,1,2,3], k = 3

**Output:** 10

**Explanation:**

Starting with player `i = 4` the initial score is 4:

Pass | Sender Index | Receiver Index | Score  
---|---|---|---  
1 | 4 | 3 | 7  
2 | 3 | 2 | 9  
3 | 2 | 1 | 10  
  


**Constraints:**

  * `1 <= receiver.length == n <= 10^5`
  * `0 <= receiver[i] <= n - 1`
  * `1 <= k <= 1010`


## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º `n` ä¸‹æ ‡ä» **0**  å¼€å§‹çš„æ•´æ•°æ•°ç»„ `receiver` å’Œä¸€ä¸ªæ•´æ•° `k` ã€‚

æ€»å…±æœ‰ `n` åç©å®¶ï¼Œç©å®¶ **ç¼–å·**  äº’ä¸ç›¸åŒï¼Œä¸”ä¸º `[0, n - 1]` ä¸­çš„æ•´æ•°ã€‚è¿™äº›ç©å®¶ç©ä¸€ä¸ªä¼ çƒæ¸¸æˆï¼Œ`receiver[i]`
è¡¨ç¤ºç¼–å·ä¸º `i` çš„ç©å®¶ä¼šä¼ çƒç»™ç¼–å·ä¸º `receiver[i]` çš„ç©å®¶ã€‚ç©å®¶å¯ä»¥ä¼ çƒç»™è‡ªå·±ï¼Œä¹Ÿå°±æ˜¯è¯´ `receiver[i]` å¯èƒ½ç­‰äº `i` ã€‚

ä½ éœ€è¦ä» `n` åç©å®¶ä¸­é€‰æ‹©ä¸€åç©å®¶ä½œä¸ºæ¸¸æˆå¼€å§‹æ—¶å”¯ä¸€æ‰‹ä¸­æœ‰çƒçš„ç©å®¶ï¼Œçƒä¼šè¢«ä¼  **æ°å¥½**  `k` æ¬¡ã€‚

å¦‚æœé€‰æ‹©ç¼–å·ä¸º `x` çš„ç©å®¶ä½œä¸ºå¼€å§‹ç©å®¶ï¼Œå®šä¹‰å‡½æ•° `f(x)` è¡¨ç¤ºä»ç¼–å·ä¸º `x` çš„ç©å®¶å¼€å§‹ï¼Œ`k` æ¬¡ä¼ çƒå†…æ‰€æœ‰æ¥è§¦è¿‡çƒç©å®¶çš„ç¼–å·ä¹‹ **å’Œ**
ï¼Œå¦‚æœæœ‰ç©å®¶å¤šæ¬¡è§¦çƒï¼Œåˆ™ **ç´¯åŠ å¤šæ¬¡**  ã€‚æ¢å¥è¯è¯´ï¼Œ `f(x) = x + receiver[x] + receiver[receiver[x]]
+ ... + receiver(k)[x]` ã€‚

ä½ çš„ä»»åŠ¡æ—¶é€‰æ‹©å¼€å§‹ç©å®¶ `x` ï¼Œç›®çš„æ˜¯**  æœ€å¤§åŒ–** `f(x)` ã€‚

è¯·ä½ è¿”å›å‡½æ•°çš„ **æœ€å¤§å€¼**  ã€‚

**æ³¨æ„ï¼š**`receiver` å¯èƒ½å«æœ‰é‡å¤å…ƒç´ ã€‚



**ç¤ºä¾‹ 1ï¼š**

ä¼ é€’æ¬¡æ•° | ä¼ çƒè€…ç¼–å· | æ¥çƒè€…ç¼–å· | x + æ‰€æœ‰æ¥çƒè€…ç¼–å·  
---|---|---|---  
  |   |   | 2  
1 | 2 | 1 | 3  
2 | 1 | 0 | 3  
3 | 0 | 2 | 5  
4 | 2 | 1 | 6  
  


> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** receiver = [2,0,1], k = 4
> 
> **è¾“å‡ºï¼š** 6
> 
> **è§£é‡Šï¼š** ä¸Šè¡¨å±•ç¤ºäº†ä»ç¼–å·ä¸º x = 2 å¼€å§‹çš„æ¸¸æˆè¿‡ç¨‹ã€‚
> 
> ä»è¡¨ä¸­å¯çŸ¥ï¼Œf(2) ç­‰äº 6 ã€‚
> 
> 6 æ˜¯èƒ½å¾—åˆ°æœ€å¤§çš„å‡½æ•°å€¼ã€‚
> 
> æ‰€ä»¥è¾“å‡ºä¸º 6 ã€‚
> 
> 

**ç¤ºä¾‹ 2ï¼š**

ä¼ é€’æ¬¡æ•° | ä¼ çƒè€…ç¼–å· | æ¥çƒè€…ç¼–å· | x + æ‰€æœ‰æ¥çƒè€…ç¼–å·  
---|---|---|---  
  |   |   | 4  
1 | 4 | 3 | 7  
2 | 3 | 2 | 9  
3 | 2 | 1 | 10  
  


> 
> 
> 
> 
> 
> **è¾“å…¥ï¼š** receiver = [1,1,1,2,3], k = 3
> 
> **è¾“å‡ºï¼š** 10
> 
> **è§£é‡Šï¼š** ä¸Šè¡¨å±•ç¤ºäº†ä»ç¼–å·ä¸º x = 4 å¼€å§‹çš„æ¸¸æˆè¿‡ç¨‹ã€‚
> 
> ä»è¡¨ä¸­å¯çŸ¥ï¼Œf(4) ç­‰äº 10 ã€‚
> 
> 10 æ˜¯èƒ½å¾—åˆ°æœ€å¤§çš„å‡½æ•°å€¼ã€‚
> 
> æ‰€ä»¥è¾“å‡ºä¸º 10 ã€‚
> 
> 



**æç¤ºï¼š**

  * `1 <= receiver.length == n <= 10^5`
  * `0 <= receiver[i] <= n - 1`
  * `1 <= k <= 1010`


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

:::: md-demo ç›¸å…³é¢˜ç›®
- [1696. è·³è·ƒæ¸¸æˆ VI](https://leetcode.com/problems/jump-game-vi)

::::
