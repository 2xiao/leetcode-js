# [3187. æ•°ç»„ä¸­çš„å³°å€¼](https://leetcode.com/problems/peaks-in-array)

ðŸ”´ <font color=#ff334b>Hard</font>&emsp; ðŸ”–&ensp; [`æ ‘çŠ¶æ•°ç»„`](/leetcode/outline/tag/binary-indexed-tree.md) [`çº¿æ®µæ ‘`](/leetcode/outline/tag/segment-tree.md) [`æ•°ç»„`](/leetcode/outline/tag/array.md)&emsp; ðŸ”—&ensp;[`LeetCode`](https://leetcode.com/problems/peaks-in-array)


## é¢˜ç›®

A **peak** in an array `arr` is an element that is **greater** than its
previous and next element in `arr`.

You are given an integer array `nums` and a 2D integer array `queries`.

You have to process queries of two types:

  * `queries[i] = [1, li, ri]`, determine the count of **peak** elements in the subarray `nums[li..ri]`.
  * `queries[i] = [2, indexi, vali]`, change `nums[indexi]` to `vali`.

Return an array `answer` containing the results of the queries of the first
type in order.

**Notes:**

  * The **first** and the **last** element of an array or a subarray **cannot** be a peak.



**Example 1:**

**Input:** nums = [3,1,4,2,5], queries = [[2,3,4],[1,0,4]]

**Output:** [0]

**Explanation:**

First query: We change `nums[3]` to 4 and `nums` becomes `[3,1,4,4,5]`.

Second query: The number of peaks in the `[3,1,4,4,5]` is 0.

**Example 2:**

**Input:** nums = [4,1,4,2,1,5], queries = [[2,2,4],[1,0,2],[1,0,4]]

**Output:** [0,1]

**Explanation:**

First query: `nums[2]` should become 4, but it is already set to 4.

Second query: The number of peaks in the `[4,1,4]` is 0.

Third query: The second 4 is a peak in the `[4,1,4,2,1]`.



**Constraints:**

  * `3 <= nums.length <= 10^5`
  * `1 <= nums[i] <= 10^5`
  * `1 <= queries.length <= 10^5`
  * `queries[i][0] == 1` or `queries[i][0] == 2`
  * For all `i` that: 
> 
> * `queries[i][0] == 1`: `0 <= queries[i][1] <= queries[i][2] <= nums.length - 1`
> 
> * `queries[i][0] == 2`: `0 <= queries[i][1] <= nums.length - 1`, `1 <= queries[i][2] <= 10^5`


## é¢˜ç›®å¤§æ„

æ•°ç»„ `arr` ä¸­ **å¤§äºŽ**  å‰é¢å’ŒåŽé¢ç›¸é‚»å…ƒç´ çš„å…ƒç´ è¢«ç§°ä¸º **å³°å€¼**  å…ƒç´ ã€‚

ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums` å’Œä¸€ä¸ªäºŒç»´æ•´æ•°æ•°ç»„ `queries` ã€‚

ä½ éœ€è¦å¤„ç†ä»¥ä¸‹ä¸¤ç§ç±»åž‹çš„æ“ä½œï¼š

  * `queries[i] = [1, li, ri]` ï¼Œæ±‚å‡ºå­æ•°ç»„ `nums[li..ri]` ä¸­ **å³°å€¼**  å…ƒç´ çš„æ•°ç›®ã€‚
  * `queries[i] = [2, indexi, vali]` ï¼Œå°† `nums[indexi]` å˜ä¸º `vali` ã€‚

è¯·ä½ è¿”å›žä¸€ä¸ªæ•°ç»„ `answer` ï¼Œå®ƒä¾æ¬¡åŒ…å«æ¯ä¸€ä¸ªç¬¬ä¸€ç§æ“ä½œçš„ç­”æ¡ˆã€‚

**æ³¨æ„ï¼š**

  * å­æ•°ç»„ä¸­ **ç¬¬ä¸€ä¸ª**  å’Œ **æœ€åŽä¸€ä¸ª**  å…ƒç´ éƒ½ **ä¸æ˜¯**  å³°å€¼å…ƒç´ ã€‚



**ç¤ºä¾‹ 1ï¼š**

**è¾“å…¥ï¼š** nums = [3,1,4,2,5], queries = [[2,3,4],[1,0,4]]

**è¾“å‡ºï¼š**[0]

**è§£é‡Šï¼š**

ç¬¬ä¸€ä¸ªæ“ä½œï¼šæˆ‘ä»¬å°† `nums[3]` å˜ä¸º 4 ï¼Œ`nums` å˜ä¸º `[3,1,4,4,5]` ã€‚

ç¬¬äºŒä¸ªæ“ä½œï¼š`[3,1,4,4,5]` ä¸­å³°å€¼å…ƒç´ çš„æ•°ç›®ä¸º 0 ã€‚

**ç¤ºä¾‹ 2ï¼š**

**è¾“å…¥ï¼š** nums = [4,1,4,2,1,5], queries = [[2,2,4],[1,0,2],[1,0,4]]

**è¾“å‡ºï¼š**[0,1]

**è§£é‡Šï¼š**

ç¬¬ä¸€ä¸ªæ“ä½œï¼š`nums[2]` å˜ä¸º 4 ï¼Œå®ƒå·²ç»æ˜¯ 4 äº†ï¼Œæ‰€ä»¥ä¿æŒä¸å˜ã€‚

ç¬¬äºŒä¸ªæ“ä½œï¼š`[4,1,4]` ä¸­å³°å€¼å…ƒç´ çš„æ•°ç›®ä¸º 0 ã€‚

ç¬¬ä¸‰ä¸ªæ“ä½œï¼šç¬¬äºŒä¸ª 4 æ˜¯ `[4,1,4,2,1]` ä¸­çš„å³°å€¼å…ƒç´ ã€‚



**æç¤ºï¼š**

  * `3 <= nums.length <= 10^5`
  * `1 <= nums[i] <= 10^5`
  * `1 <= queries.length <= 10^5`
  * `queries[i][0] == 1` æˆ–è€… `queries[i][0] == 2`
  * å¯¹äºŽæ‰€æœ‰çš„ `i` ï¼Œéƒ½æœ‰ï¼š 
> 
> * `queries[i][0] == 1` ï¼š`0 <= queries[i][1] <= queries[i][2] <= nums.length - 1`
> 
> * `queries[i][0] == 2` ï¼š`0 <= queries[i][1] <= nums.length - 1`, `1 <= queries[i][2] <= 10^5`


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æž

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```