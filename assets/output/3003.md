# [3003. æ‰§è¡Œæ“ä½œåçš„æœ€å¤§åˆ†å‰²æ•°é‡](https://2xiao.github.io/leetcode-js/problem/3003.html)

ğŸ”´ <font color=#ff334b>Hard</font>&emsp; ğŸ”–&ensp; [`ä½è¿ç®—`](/tag/bit-manipulation.md) [`å­—ç¬¦ä¸²`](/tag/string.md) [`åŠ¨æ€è§„åˆ’`](/tag/dynamic-programming.md) [`çŠ¶æ€å‹ç¼©`](/tag/bitmask.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/maximize-the-number-of-partitions-after-operations) [`LeetCode`](https://leetcode.com/problems/maximize-the-number-of-partitions-after-operations)

## é¢˜ç›®

You are given a string `s` and an integer `k`.

First, you are allowed to change **at most** **one** index in `s` to another
lowercase English letter.

After that, do the following partitioning operation until `s` is **empty** :

  * Choose the **longest** **prefix** of `s` containing at most `k` **distinct** characters.
  * **Delete** the prefix from `s` and increase the number of partitions by one. The remaining characters (if any) in `s` maintain their initial order.

Return an integer denoting the **maximum** number of resulting partitions
after the operations by optimally choosing at most one index to change.



**Example 1:**

**Input:** s = "accca", k = 2

**Output:** 3

**Explanation:**

The optimal way is to change `s[2]` to something other than a and c, for
example, b. then it becomes `"acbca"`.

Then we perform the operations:

  1. The longest prefix containing at most 2 distinct characters is `"ac"`, we remove it and `s` becomes `"bca"`.
  2. Now The longest prefix containing at most 2 distinct characters is `"bc"`, so we remove it and `s` becomes `"a"`.
  3. Finally, we remove `"a"` and `s` becomes empty, so the procedure ends.

Doing the operations, the string is divided into 3 partitions, so the answer
is 3.

**Example 2:**

**Input:** s = "aabaab", k = 3

**Output:** 1

**Explanation:**

Initially `s` contains 2 distinct characters, so whichever character we
change, it will contain at most 3 distinct characters, so the longest prefix
with at most 3 distinct characters would always be all of it, therefore the
answer is 1.

**Example 3:**

**Input:** s = "xxyz", k = 1

**Output:** 4

**Explanation:**

The optimal way is to change `s[0]` or `s[1]` to something other than
characters in `s`, for example, to change `s[0]` to `w`.

Then `s` becomes `"wxyz"`, which consists of 4 distinct characters, so as `k`
is 1, it will divide into 4 partitions.



**Constraints:**

  * `1 <= s.length <= 10^4`
  * `s` consists only of lowercase English letters.
  * `1 <= k <= 26`


## é¢˜ç›®å¤§æ„

ç»™ä½ ä¸€ä¸ªä¸‹æ ‡ä» **0** å¼€å§‹çš„å­—ç¬¦ä¸² `s` å’Œä¸€ä¸ªæ•´æ•° `k`ã€‚

ä½ éœ€è¦æ‰§è¡Œä»¥ä¸‹åˆ†å‰²æ“ä½œï¼Œç›´åˆ°å­—ç¬¦ä¸² `s `å˜ä¸º **ç©º** ï¼š

  * é€‰æ‹© `s` çš„æœ€é•¿ **å‰ç¼€** ï¼Œè¯¥å‰ç¼€æœ€å¤šåŒ…å« `k `ä¸ª **ä¸åŒ  **å­—ç¬¦ã€‚
  * **åˆ é™¤  **è¿™ä¸ªå‰ç¼€ï¼Œå¹¶å°†åˆ†å‰²æ•°é‡åŠ ä¸€ã€‚å¦‚æœæœ‰å‰©ä½™å­—ç¬¦ï¼Œå®ƒä»¬åœ¨ `s` ä¸­ä¿æŒåŸæ¥çš„é¡ºåºã€‚

æ‰§è¡Œæ“ä½œä¹‹ **å‰** ï¼Œä½ å¯ä»¥å°† `s` ä¸­ **è‡³å¤šä¸€å¤„** ä¸‹æ ‡çš„å¯¹åº”å­—ç¬¦æ›´æ”¹ä¸ºå¦ä¸€ä¸ªå°å†™è‹±æ–‡å­—æ¯ã€‚

åœ¨æœ€ä¼˜é€‰æ‹©æƒ…å½¢ä¸‹æ”¹å˜è‡³å¤šä¸€å¤„ä¸‹æ ‡å¯¹åº”å­—ç¬¦åï¼Œç”¨æ•´æ•°è¡¨ç¤ºå¹¶è¿”å›æ“ä½œç»“æŸæ—¶å¾—åˆ°çš„ **æœ€å¤§** åˆ†å‰²æ•°é‡ã€‚



**ç¤ºä¾‹ 1ï¼š**

**è¾“å…¥ï¼š** s = "accca", k = 2

**è¾“å‡ºï¼š** 3

**è§£é‡Šï¼š**

æœ€å¥½çš„æ–¹å¼æ˜¯æŠŠ `s[2]` å˜ä¸ºé™¤äº† a å’Œ c ä¹‹å¤–çš„ä¸œè¥¿ï¼Œæ¯”å¦‚ bã€‚ç„¶åå®ƒå˜æˆäº† `"acbca"`ã€‚

ç„¶åæˆ‘ä»¬æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

  1. æœ€å¤šåŒ…å« 2 ä¸ªä¸åŒå­—ç¬¦çš„æœ€é•¿å‰ç¼€æ˜¯ `"ac"`ï¼Œæˆ‘ä»¬åˆ é™¤å®ƒç„¶å `s` å˜ä¸º `"bca"`ã€‚
  2. ç°åœ¨æœ€å¤šåŒ…å« 2 ä¸ªä¸åŒå­—ç¬¦çš„æœ€é•¿å‰ç¼€æ˜¯ `"bc"`ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ é™¤å®ƒç„¶å `s` å˜ä¸º `"a"`ã€‚
  3. æœ€åï¼Œæˆ‘ä»¬åˆ é™¤ `"a"` å¹¶ä¸” `s` å˜æˆç©ºä¸²ï¼Œæ‰€ä»¥è¯¥è¿‡ç¨‹ç»“æŸã€‚

è¿›è¡Œæ“ä½œæ—¶ï¼Œå­—ç¬¦ä¸²è¢«åˆ†æˆ 3 ä¸ªéƒ¨åˆ†ï¼Œæ‰€ä»¥ç­”æ¡ˆæ˜¯ 3ã€‚

**ç¤ºä¾‹ 2ï¼š**

**è¾“å…¥ï¼š** s = "aabaab", k = 3

**è¾“å‡ºï¼š** 1

**è§£é‡Šï¼š**

ä¸€å¼€å§‹ `s` åŒ…å« 2 ä¸ªä¸åŒçš„å­—ç¬¦ï¼Œæ‰€ä»¥æ— è®ºæˆ‘ä»¬æ”¹å˜å“ªä¸ªï¼Œ å®ƒæœ€å¤šåŒ…å« 3 ä¸ªä¸åŒå­—ç¬¦ï¼Œå› æ­¤æœ€å¤šåŒ…å« 3 ä¸ªä¸åŒå­—ç¬¦çš„æœ€é•¿å‰ç¼€å§‹ç»ˆæ˜¯æ‰€æœ‰å­—ç¬¦ï¼Œå› æ­¤ç­”æ¡ˆæ˜¯
1ã€‚

**ç¤ºä¾‹ 3ï¼š**

**è¾“å…¥ï¼š** s = "xxyz", k = 1

**è¾“å‡ºï¼š** 4

**è§£é‡Šï¼š**

æœ€å¥½çš„æ–¹å¼æ˜¯å°† `s[0]` æˆ– `s[1]` å˜ä¸º `s` ä¸­å­—ç¬¦ä»¥å¤–çš„ä¸œè¥¿ï¼Œä¾‹å¦‚å°† `s[0]` å˜ä¸º `w`ã€‚

ç„¶å `s` å˜ä¸º `"wxyz"`ï¼ŒåŒ…å« 4 ä¸ªä¸åŒçš„å­—ç¬¦ï¼Œæ‰€ä»¥å½“ `k` ä¸º 1ï¼Œå®ƒå°†åˆ†ä¸º 4 ä¸ªéƒ¨åˆ†ã€‚



**æç¤ºï¼š**

  * `1 <= s.length <= 10^4`
  * `s` åªåŒ…å«å°å†™è‹±æ–‡å­—æ¯ã€‚
  * `1 <= k <= 26`


## è§£é¢˜æ€è·¯

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ
- **ç©ºé—´å¤æ‚åº¦**ï¼š`O()`ï¼Œ

## ä»£ç 

```javascript

```

## ç›¸å…³é¢˜ç›®

<!-- prettier-ignore -->
| é¢˜å· | æ ‡é¢˜ | é¢˜è§£ | æ ‡ç­¾ | éš¾åº¦ |
| :------: | :------ | :------: | :------ | :------ |
| 1177 | [æ„å»ºå›æ–‡ä¸²æ£€æµ‹](https://leetcode.com/problems/can-make-palindrome-from-substring) |  |  [`ä½è¿ç®—`](/tag/bit-manipulation.md) [`æ•°ç»„`](/tag/array.md) [`å“ˆå¸Œè¡¨`](/tag/hash-table.md) `2+` | <font color=#ffb800>Medium</font> |