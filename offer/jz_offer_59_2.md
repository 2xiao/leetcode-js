# [59-II. é˜Ÿåˆ—çš„æœ€å¤§å€¼](https://2xiao.github.io/leetcode-js/offer/jz_offer_59_2.html)

ğŸŸ  <font color=#ffb800>Medium</font>&emsp; ğŸ”–&ensp; [`è®¾è®¡`](/tag/design.md) [`é˜Ÿåˆ—`](/tag/queue.md) [`å•è°ƒé˜Ÿåˆ—`](/tag/monotonic-queue.md)&emsp; ğŸ”—&ensp;[`åŠ›æ‰£`](https://leetcode.cn/problems/dui-lie-de-zui-da-zhi-lcof)

## é¢˜ç›®

è¯·è®¾è®¡ä¸€ä¸ªè‡ªåŠ©ç»“è´¦ç³»ç»Ÿï¼Œè¯¥ç³»ç»Ÿéœ€è¦é€šè¿‡ä¸€ä¸ªé˜Ÿåˆ—æ¥æ¨¡æ‹Ÿé¡¾å®¢é€šè¿‡è´­ç‰©è½¦çš„ç»“ç®—è¿‡ç¨‹ï¼Œéœ€è¦å®ç°çš„åŠŸèƒ½æœ‰ï¼š

- `get_max()`ï¼šè·å–ç»“ç®—å•†å“ä¸­çš„æœ€é«˜ä»·æ ¼ï¼Œå¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™è¿”å› -1
- `add(value)`ï¼šå°†ä»·æ ¼ä¸º `value` çš„å•†å“åŠ å…¥å¾…ç»“ç®—å•†å“é˜Ÿåˆ—çš„å°¾éƒ¨
- `remove()`ï¼šç§»é™¤ç¬¬ä¸€ä¸ªå¾…ç»“ç®—çš„å•†å“ä»·æ ¼ï¼Œå¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™è¿”å› -1

æ³¨æ„ï¼Œä¸ºä¿è¯è¯¥ç³»ç»Ÿè¿è½¬é«˜æ•ˆæ€§ï¼Œä»¥ä¸Šå‡½æ•°çš„å‡æ‘Šæ—¶é—´å¤æ‚åº¦å‡ä¸º O(1)

**ç¤ºä¾‹ 1ï¼š**

> è¾“å…¥:
>
> ["Checkout","add","add","get_max","remove","get_max"]
>
> [[],[4],[7],[],[],[]]
>
> è¾“å‡º: [null,null,null,7,4,7]

**ç¤ºä¾‹ 2ï¼š**

> è¾“å…¥:
>
> ["Checkout","remove","get_max"]
>
> [[],[],[]]
>
> è¾“å‡º: [null,-1,-1]

**æç¤ºï¼š**

- `1 <= get_max, add, remove çš„æ€»æ“ä½œæ•° <= 10000`
- `1 <= value <= 10^5`

## è§£é¢˜æ€è·¯

ä¸ºç¡®ä¿æ¯ä¸ªæ“ä½œçš„å‡æ‘Šæ—¶é—´å¤æ‚åº¦ä¸º `O(1)`ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªåŒç«¯é˜Ÿåˆ—ï¼ˆDequeï¼‰æ¥ç»´æŠ¤å½“å‰çš„å•†å“ä»·æ ¼é˜Ÿåˆ—ï¼ŒåŒæ—¶ç»´æŠ¤ä¸€ä¸ªè¾…åŠ©é˜Ÿåˆ—æ¥è¿½è¸ªå½“å‰é˜Ÿåˆ—ä¸­çš„æœ€å¤§ä»·æ ¼ã€‚

1. **ä¸»è¦é˜Ÿåˆ—**ï¼šç”¨äºå­˜å‚¨å¾…ç»“ç®—å•†å“çš„ä»·æ ¼ã€‚
2. **è¾…åŠ©é˜Ÿåˆ—**ï¼šç”¨äºå­˜å‚¨å½“å‰çš„æœ€å¤§ä»·æ ¼ã€‚å½“æ·»åŠ å•†å“æ—¶ï¼Œå°†æ–°ä»·æ ¼ä¸è¾…åŠ©é˜Ÿåˆ—çš„å°¾éƒ¨å…ƒç´ è¿›è¡Œæ¯”è¾ƒï¼Œç¡®ä¿è¾…åŠ©é˜Ÿåˆ—ä¸­çš„å…ƒç´ å§‹ç»ˆæ˜¯ä»å¤§åˆ°å°æ’åºçš„ã€‚
3. **æ“ä½œ**ï¼š
   - `add(value)`ï¼šå°†å•†å“ä»·æ ¼ `value` æ·»åŠ åˆ°ä¸»è¦é˜Ÿåˆ—ï¼Œå¹¶æ›´æ–°è¾…åŠ©é˜Ÿåˆ—ï¼Œå°†æ¯”å½“å‰ä»·æ ¼å°çš„å…ƒç´ å…¨éƒ¨å‡ºé˜Ÿï¼Œç›´åˆ°è¾…åŠ©é˜Ÿåˆ—ä¸ºç©ºæˆ–é˜Ÿå°¾å…ƒç´ å¤§äºå½“å‰ä»·æ ¼ï¼Œç„¶åå°†å½“å‰ä»·æ ¼æ·»åŠ åˆ°è¾…åŠ©é˜Ÿåˆ—ã€‚
   - `remove()`ï¼šç§»é™¤ä¸»è¦é˜Ÿåˆ—çš„å¤´éƒ¨å…ƒç´ ï¼Œå¦‚æœç§»é™¤çš„å€¼æ˜¯å½“å‰æœ€å¤§å€¼ï¼Œåˆ™æ›´æ–°è¾…åŠ©é˜Ÿåˆ—ï¼Œç§»é™¤è¾…åŠ©é˜Ÿåˆ—çš„å¤´éƒ¨å…ƒç´ ã€‚
   - `get_max()`ï¼šè¿”å›è¾…åŠ©é˜Ÿåˆ—çš„å¤´éƒ¨å…ƒç´ ï¼Œå³å½“å‰æœ€å¤§ä»·æ ¼ã€‚

#### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š`O(1)`

  - **`add(value)`**ï¼šå‡æ‘Šæ—¶é—´å¤æ‚åº¦ä¸º `O(1)`ï¼Œå°½ç®¡åœ¨æœ€åæƒ…å†µä¸‹å¯èƒ½éœ€è¦æ¸…ç©ºè¾…åŠ©é˜Ÿåˆ—ï¼Œä½†è¿™æ¬¡æ“ä½œçš„ä»£ä»·ä¼šåœ¨åç»­çš„ `add` æ“ä½œä¸­å‡æ‘Šã€‚
  - **`remove()`**ï¼šå‡æ‘Šæ—¶é—´å¤æ‚åº¦ä¸º `O(1)`ï¼Œç§»é™¤æ“ä½œä»…æ¶‰åŠä»ä¸»è¦é˜Ÿåˆ—ä¸­ç§»é™¤ä¸€ä¸ªå…ƒç´ ã€‚
  - **`get_max()`**ï¼šæ—¶é—´å¤æ‚åº¦ä¸º `O(1)`ï¼Œç›´æ¥è¿”å›è¾…åŠ©é˜Ÿåˆ—çš„å¤´éƒ¨å…ƒç´ ã€‚

- **ç©ºé—´å¤æ‚åº¦**ï¼š`O(n)`ï¼Œéœ€è¦ä¸¤ä¸ªé˜Ÿåˆ—å­˜å‚¨å¾…ç»“ç®—å•†å“çš„ä»·æ ¼åŠå½“å‰çš„æœ€å¤§ä»·æ ¼ï¼Œæœ€åçš„æƒ…å†µï¼Œç©ºé—´å¤æ‚åº¦ä¸º `O(n)`ã€‚

## ä»£ç 

```javascript
class Checkout {
	constructor() {
		this.queue = []; // ä¸»é˜Ÿåˆ—
		this.maxQueue = []; // è¾…åŠ©é˜Ÿåˆ—
	}

	// æ·»åŠ å•†å“ä»·æ ¼åˆ°é˜Ÿåˆ—
	add(value) {
		this.queue.push(value);
		// æ›´æ–°æœ€å¤§å€¼é˜Ÿåˆ—
		while (
			this.maxQueue.length > 0 &&
			this.maxQueue[this.maxQueue.length - 1] < value
		) {
			this.maxQueue.pop();
		}
		this.maxQueue.push(value);
	}

	// ç§»é™¤é˜Ÿåˆ—å¤´éƒ¨çš„å•†å“ä»·æ ¼
	remove() {
		// é˜Ÿåˆ—ä¸ºç©º
		if (this.queue.length === 0) {
			return -1;
		}

		// ç§»é™¤é˜Ÿåˆ—å¤´éƒ¨
		const removedValue = this.queue.shift();

		// å¦‚æœç§»é™¤çš„å€¼æ˜¯å½“å‰æœ€å¤§å€¼ï¼Œåˆ™æ›´æ–°è¾…åŠ©é˜Ÿåˆ—
		if (removedValue === this.maxQueue[0]) {
			this.maxQueue.shift();
		}
		return removedValue;
	}

	// è·å–å½“å‰é˜Ÿåˆ—ä¸­çš„æœ€é«˜ä»·æ ¼
	get_max() {
		// è¿”å›è¾…åŠ©é˜Ÿåˆ—å¤´éƒ¨çš„å€¼
		return this.maxQueue.length > 0 ? this.maxQueue[0] : -1;
	}
}
```
